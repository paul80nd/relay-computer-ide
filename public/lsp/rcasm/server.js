var Jy=Object.create;var mi=Object.defineProperty;var Qy=Object.getOwnPropertyDescriptor;var Zy=Object.getOwnPropertyNames;var Ky=Object.getPrototypeOf,ev=Object.prototype.hasOwnProperty;var tv=(n,t)=>()=>(n&&(t=n(n=0)),t);var N=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),nv=(n,t)=>{for(var e in t)mi(n,e,{get:t[e],enumerable:!0})},dl=(n,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Zy(t))!ev.call(n,i)&&i!==e&&mi(n,i,{get:()=>t[i],enumerable:!(r=Qy(t,i))||r.enumerable});return n};var at=(n,t,e)=>(e=n!=null?Jy(Ky(n)):{},dl(t||!n||!n.__esModule?mi(e,"default",{value:n,enumerable:!0}):e,n)),bo=n=>dl(mi({},"__esModule",{value:!0}),n);var pn=N(we=>{"use strict";Object.defineProperty(we,"__esModule",{value:!0});we.stringArray=we.array=we.func=we.error=we.number=we.string=we.boolean=void 0;function rv(n){return n===!0||n===!1}we.boolean=rv;function pl(n){return typeof n=="string"||n instanceof String}we.string=pl;function iv(n){return typeof n=="number"||n instanceof Number}we.number=iv;function sv(n){return n instanceof Error}we.error=sv;function ov(n){return typeof n=="function"}we.func=ov;function hl(n){return Array.isArray(n)}we.array=hl;function av(n){return hl(n)&&n.every(t=>pl(t))}we.stringArray=av});var Ho=N(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.Message=F.NotificationType9=F.NotificationType8=F.NotificationType7=F.NotificationType6=F.NotificationType5=F.NotificationType4=F.NotificationType3=F.NotificationType2=F.NotificationType1=F.NotificationType0=F.NotificationType=F.RequestType9=F.RequestType8=F.RequestType7=F.RequestType6=F.RequestType5=F.RequestType4=F.RequestType3=F.RequestType2=F.RequestType1=F.RequestType=F.RequestType0=F.AbstractMessageSignature=F.ParameterStructures=F.ResponseError=F.ErrorCodes=void 0;var Vt=pn(),Do;(function(n){n.ParseError=-32700,n.InvalidRequest=-32600,n.MethodNotFound=-32601,n.InvalidParams=-32602,n.InternalError=-32603,n.jsonrpcReservedErrorRangeStart=-32099,n.serverErrorStart=-32099,n.MessageWriteError=-32099,n.MessageReadError=-32098,n.PendingResponseRejected=-32097,n.ConnectionInactive=-32096,n.ServerNotInitialized=-32002,n.UnknownErrorCode=-32001,n.jsonrpcReservedErrorRangeEnd=-32e3,n.serverErrorEnd=-32e3})(Do||(F.ErrorCodes=Do={}));var xo=class n extends Error{constructor(t,e,r){super(e),this.code=Vt.number(t)?t:Do.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,n.prototype)}toJson(){let t={code:this.code,message:this.message};return this.data!==void 0&&(t.data=this.data),t}};F.ResponseError=xo;var $e=class n{constructor(t){this.kind=t}static is(t){return t===n.auto||t===n.byName||t===n.byPosition}toString(){return this.kind}};F.ParameterStructures=$e;$e.auto=new $e("auto");$e.byPosition=new $e("byPosition");$e.byName=new $e("byName");var ce=class{constructor(t,e){this.method=t,this.numberOfParams=e}get parameterStructures(){return $e.auto}};F.AbstractMessageSignature=ce;var Ro=class extends ce{constructor(t){super(t,0)}};F.RequestType0=Ro;var _o=class extends ce{constructor(t,e=$e.auto){super(t,1),this._parameterStructures=e}get parameterStructures(){return this._parameterStructures}};F.RequestType=_o;var So=class extends ce{constructor(t,e=$e.auto){super(t,1),this._parameterStructures=e}get parameterStructures(){return this._parameterStructures}};F.RequestType1=So;var wo=class extends ce{constructor(t){super(t,2)}};F.RequestType2=wo;var Co=class extends ce{constructor(t){super(t,3)}};F.RequestType3=Co;var Po=class extends ce{constructor(t){super(t,4)}};F.RequestType4=Po;var To=class extends ce{constructor(t){super(t,5)}};F.RequestType5=To;var Eo=class extends ce{constructor(t){super(t,6)}};F.RequestType6=Eo;var qo=class extends ce{constructor(t){super(t,7)}};F.RequestType7=qo;var $o=class extends ce{constructor(t){super(t,8)}};F.RequestType8=$o;var Oo=class extends ce{constructor(t){super(t,9)}};F.RequestType9=Oo;var Mo=class extends ce{constructor(t,e=$e.auto){super(t,1),this._parameterStructures=e}get parameterStructures(){return this._parameterStructures}};F.NotificationType=Mo;var Lo=class extends ce{constructor(t){super(t,0)}};F.NotificationType0=Lo;var No=class extends ce{constructor(t,e=$e.auto){super(t,1),this._parameterStructures=e}get parameterStructures(){return this._parameterStructures}};F.NotificationType1=No;var ko=class extends ce{constructor(t){super(t,2)}};F.NotificationType2=ko;var Io=class extends ce{constructor(t){super(t,3)}};F.NotificationType3=Io;var Ao=class extends ce{constructor(t){super(t,4)}};F.NotificationType4=Ao;var jo=class extends ce{constructor(t){super(t,5)}};F.NotificationType5=jo;var Fo=class extends ce{constructor(t){super(t,6)}};F.NotificationType6=Fo;var zo=class extends ce{constructor(t){super(t,7)}};F.NotificationType7=zo;var Bo=class extends ce{constructor(t){super(t,8)}};F.NotificationType8=Bo;var Uo=class extends ce{constructor(t){super(t,9)}};F.NotificationType9=Uo;var ml;(function(n){function t(i){let s=i;return s&&Vt.string(s.method)&&(Vt.string(s.id)||Vt.number(s.id))}n.isRequest=t;function e(i){let s=i;return s&&Vt.string(s.method)&&i.id===void 0}n.isNotification=e;function r(i){let s=i;return s&&(s.result!==void 0||!!s.error)&&(Vt.string(s.id)||Vt.number(s.id)||s.id===null)}n.isResponse=r})(ml||(F.Message=ml={}))});var Vo=N(Et=>{"use strict";var gl;Object.defineProperty(Et,"__esModule",{value:!0});Et.LRUCache=Et.LinkedMap=Et.Touch=void 0;var Ce;(function(n){n.None=0,n.First=1,n.AsOld=n.First,n.Last=2,n.AsNew=n.Last})(Ce||(Et.Touch=Ce={}));var gi=class{constructor(){this[gl]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(t){return this._map.has(t)}get(t,e=Ce.None){let r=this._map.get(t);if(r)return e!==Ce.None&&this.touch(r,e),r.value}set(t,e,r=Ce.None){let i=this._map.get(t);if(i)i.value=e,r!==Ce.None&&this.touch(i,r);else{switch(i={key:t,value:e,next:void 0,previous:void 0},r){case Ce.None:this.addItemLast(i);break;case Ce.First:this.addItemFirst(i);break;case Ce.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(t,i),this._size++}return this}delete(t){return!!this.remove(t)}remove(t){let e=this._map.get(t);if(e)return this._map.delete(t),this.removeItem(e),this._size--,e.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let t=this._head;return this._map.delete(t.key),this.removeItem(t),this._size--,t.value}forEach(t,e){let r=this._state,i=this._head;for(;i;){if(e?t.bind(e)(i.value,i.key,this):t(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let t=this._state,e=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==t)throw new Error("LinkedMap got modified during iteration.");if(e){let i={value:e.key,done:!1};return e=e.next,i}else return{value:void 0,done:!0}}};return r}values(){let t=this._state,e=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==t)throw new Error("LinkedMap got modified during iteration.");if(e){let i={value:e.value,done:!1};return e=e.next,i}else return{value:void 0,done:!0}}};return r}entries(){let t=this._state,e=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==t)throw new Error("LinkedMap got modified during iteration.");if(e){let i={value:[e.key,e.value],done:!1};return e=e.next,i}else return{value:void 0,done:!0}}};return r}[(gl=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(t){if(t>=this.size)return;if(t===0){this.clear();return}let e=this._head,r=this.size;for(;e&&r>t;)this._map.delete(e.key),e=e.next,r--;this._head=e,this._size=r,e&&(e.previous=void 0),this._state++}addItemFirst(t){if(!this._head&&!this._tail)this._tail=t;else if(this._head)t.next=this._head,this._head.previous=t;else throw new Error("Invalid list");this._head=t,this._state++}addItemLast(t){if(!this._head&&!this._tail)this._head=t;else if(this._tail)t.previous=this._tail,this._tail.next=t;else throw new Error("Invalid list");this._tail=t,this._state++}removeItem(t){if(t===this._head&&t===this._tail)this._head=void 0,this._tail=void 0;else if(t===this._head){if(!t.next)throw new Error("Invalid list");t.next.previous=void 0,this._head=t.next}else if(t===this._tail){if(!t.previous)throw new Error("Invalid list");t.previous.next=void 0,this._tail=t.previous}else{let e=t.next,r=t.previous;if(!e||!r)throw new Error("Invalid list");e.previous=r,r.next=e}t.next=void 0,t.previous=void 0,this._state++}touch(t,e){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(e!==Ce.First&&e!==Ce.Last)){if(e===Ce.First){if(t===this._head)return;let r=t.next,i=t.previous;t===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),t.previous=void 0,t.next=this._head,this._head.previous=t,this._head=t,this._state++}else if(e===Ce.Last){if(t===this._tail)return;let r=t.next,i=t.previous;t===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),t.next=void 0,t.previous=this._tail,this._tail.next=t,this._tail=t,this._state++}}}toJSON(){let t=[];return this.forEach((e,r)=>{t.push([r,e])}),t}fromJSON(t){this.clear();for(let[e,r]of t)this.set(e,r)}};Et.LinkedMap=gi;var Wo=class extends gi{constructor(t,e=1){super(),this._limit=t,this._ratio=Math.min(Math.max(0,e),1)}get limit(){return this._limit}set limit(t){this._limit=t,this.checkTrim()}get ratio(){return this._ratio}set ratio(t){this._ratio=Math.min(Math.max(0,t),1),this.checkTrim()}get(t,e=Ce.AsNew){return super.get(t,e)}peek(t){return super.get(t,Ce.None)}set(t,e){return super.set(t,e,Ce.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};Et.LRUCache=Wo});var vl=N(yi=>{"use strict";Object.defineProperty(yi,"__esModule",{value:!0});yi.Disposable=void 0;var yl;(function(n){function t(e){return{dispose:e}}n.create=t})(yl||(yi.Disposable=yl={}))});var qt=N(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});var Go;function Xo(){if(Go===void 0)throw new Error("No runtime abstraction layer installed");return Go}(function(n){function t(e){if(e===void 0)throw new Error("No runtime abstraction layer provided");Go=e}n.install=t})(Xo||(Xo={}));Yo.default=Xo});var mn=N(hn=>{"use strict";Object.defineProperty(hn,"__esModule",{value:!0});hn.Emitter=hn.Event=void 0;var cv=qt(),bl;(function(n){let t={dispose(){}};n.None=function(){return t}})(bl||(hn.Event=bl={}));var Jo=class{add(t,e=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(t),this._contexts.push(e),Array.isArray(r)&&r.push({dispose:()=>this.remove(t,e)})}remove(t,e=null){if(!this._callbacks)return;let r=!1;for(let i=0,s=this._callbacks.length;i<s;i++)if(this._callbacks[i]===t)if(this._contexts[i]===e){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...t){if(!this._callbacks)return[];let e=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let s=0,a=r.length;s<a;s++)try{e.push(r[s].apply(i[s],t))}catch(l){(0,cv.default)().console.error(l)}return e}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},vi=class n{constructor(t){this._options=t}get event(){return this._event||(this._event=(t,e,r)=>{this._callbacks||(this._callbacks=new Jo),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(t,e);let i={dispose:()=>{this._callbacks&&(this._callbacks.remove(t,e),i.dispose=n._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(i),i}),this._event}fire(t){this._callbacks&&this._callbacks.invoke.call(this._callbacks,t)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};hn.Emitter=vi;vi._noop=function(){}});var xi=N(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});gn.CancellationTokenSource=gn.CancellationToken=void 0;var uv=qt(),lv=pn(),Qo=mn(),bi;(function(n){n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Qo.Event.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Qo.Event.None});function t(e){let r=e;return r&&(r===n.None||r===n.Cancelled||lv.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}n.is=t})(bi||(gn.CancellationToken=bi={}));var fv=Object.freeze(function(n,t){let e=(0,uv.default)().timer.setTimeout(n.bind(t),0);return{dispose(){e.dispose()}}}),Di=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?fv:(this._emitter||(this._emitter=new Qo.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},Zo=class{get token(){return this._token||(this._token=new Di),this._token}cancel(){this._token?this._token.cancel():this._token=bi.Cancelled}dispose(){this._token?this._token instanceof Di&&this._token.dispose():this._token=bi.None}};gn.CancellationTokenSource=Zo});var Dl=N(yn=>{"use strict";Object.defineProperty(yn,"__esModule",{value:!0});yn.SharedArrayReceiverStrategy=yn.SharedArraySenderStrategy=void 0;var dv=xi(),ir;(function(n){n.Continue=0,n.Cancelled=1})(ir||(ir={}));var Ko=class{constructor(){this.buffers=new Map}enableCancellation(t){if(t.id===null)return;let e=new SharedArrayBuffer(4),r=new Int32Array(e,0,1);r[0]=ir.Continue,this.buffers.set(t.id,e),t.$cancellationData=e}async sendCancellation(t,e){let r=this.buffers.get(e);if(r===void 0)return;let i=new Int32Array(r,0,1);Atomics.store(i,0,ir.Cancelled)}cleanup(t){this.buffers.delete(t)}dispose(){this.buffers.clear()}};yn.SharedArraySenderStrategy=Ko;var ea=class{constructor(t){this.data=new Int32Array(t,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===ir.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},ta=class{constructor(t){this.token=new ea(t)}cancel(){}dispose(){}},na=class{constructor(){this.kind="request"}createCancellationTokenSource(t){let e=t.$cancellationData;return e===void 0?new dv.CancellationTokenSource:new ta(e)}};yn.SharedArrayReceiverStrategy=na});var ia=N(Ri=>{"use strict";Object.defineProperty(Ri,"__esModule",{value:!0});Ri.Semaphore=void 0;var pv=qt(),ra=class{constructor(t=1){if(t<=0)throw new Error("Capacity must be greater than 0");this._capacity=t,this._active=0,this._waiting=[]}lock(t){return new Promise((e,r)=>{this._waiting.push({thunk:t,resolve:e,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,pv.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let t=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let e=t.thunk();e instanceof Promise?e.then(r=>{this._active--,t.resolve(r),this.runNext()},r=>{this._active--,t.reject(r),this.runNext()}):(this._active--,t.resolve(e),this.runNext())}catch(e){this._active--,t.reject(e),this.runNext()}}};Ri.Semaphore=ra});var Rl=N($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.ReadableStreamMessageReader=$t.AbstractMessageReader=$t.MessageReader=void 0;var oa=qt(),vn=pn(),sa=mn(),hv=ia(),xl;(function(n){function t(e){let r=e;return r&&vn.func(r.listen)&&vn.func(r.dispose)&&vn.func(r.onError)&&vn.func(r.onClose)&&vn.func(r.onPartialMessage)}n.is=t})(xl||($t.MessageReader=xl={}));var _i=class{constructor(){this.errorEmitter=new sa.Emitter,this.closeEmitter=new sa.Emitter,this.partialMessageEmitter=new sa.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(t){this.errorEmitter.fire(this.asError(t))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(t){this.partialMessageEmitter.fire(t)}asError(t){return t instanceof Error?t:new Error(`Reader received error. Reason: ${vn.string(t.message)?t.message:"unknown"}`)}};$t.AbstractMessageReader=_i;var aa;(function(n){function t(e){let r,i,s,a=new Map,l,f=new Map;if(e===void 0||typeof e=="string")r=e??"utf-8";else{if(r=e.charset??"utf-8",e.contentDecoder!==void 0&&(s=e.contentDecoder,a.set(s.name,s)),e.contentDecoders!==void 0)for(let h of e.contentDecoders)a.set(h.name,h);if(e.contentTypeDecoder!==void 0&&(l=e.contentTypeDecoder,f.set(l.name,l)),e.contentTypeDecoders!==void 0)for(let h of e.contentTypeDecoders)f.set(h.name,h)}return l===void 0&&(l=(0,oa.default)().applicationJson.decoder,f.set(l.name,l)),{charset:r,contentDecoder:s,contentDecoders:a,contentTypeDecoder:l,contentTypeDecoders:f}}n.fromOptions=t})(aa||(aa={}));var ca=class extends _i{constructor(t,e){super(),this.readable=t,this.options=aa.fromOptions(e),this.buffer=(0,oa.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new hv.Semaphore(1)}set partialMessageTimeout(t){this._partialMessageTimeout=t}get partialMessageTimeout(){return this._partialMessageTimeout}listen(t){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=t;let e=this.readable.onData(r=>{this.onData(r)});return this.readable.onError(r=>this.fireError(r)),this.readable.onClose(()=>this.fireClose()),e}onData(t){try{for(this.buffer.append(t);;){if(this.nextMessageLength===-1){let r=this.buffer.tryReadHeaders(!0);if(!r)return;let i=r.get("content-length");if(!i){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(r))}`));return}let s=parseInt(i);if(isNaN(s)){this.fireError(new Error(`Content-Length value must be a number. Got ${i}`));return}this.nextMessageLength=s}let e=this.buffer.tryReadBody(this.nextMessageLength);if(e===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let r=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(e):e,i=await this.options.contentTypeDecoder.decode(r,this.options);this.callback(i)}).catch(r=>{this.fireError(r)})}}catch(e){this.fireError(e)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,oa.default)().timer.setTimeout((t,e)=>{this.partialMessageTimer=void 0,t===this.messageToken&&(this.firePartialMessage({messageToken:t,waitingTime:e}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};$t.ReadableStreamMessageReader=ca});var Pl=N(Ot=>{"use strict";Object.defineProperty(Ot,"__esModule",{value:!0});Ot.WriteableStreamMessageWriter=Ot.AbstractMessageWriter=Ot.MessageWriter=void 0;var _l=qt(),sr=pn(),mv=ia(),Sl=mn(),gv="Content-Length: ",wl=`\r
`,Cl;(function(n){function t(e){let r=e;return r&&sr.func(r.dispose)&&sr.func(r.onClose)&&sr.func(r.onError)&&sr.func(r.write)}n.is=t})(Cl||(Ot.MessageWriter=Cl={}));var Si=class{constructor(){this.errorEmitter=new Sl.Emitter,this.closeEmitter=new Sl.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(t,e,r){this.errorEmitter.fire([this.asError(t),e,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(t){return t instanceof Error?t:new Error(`Writer received error. Reason: ${sr.string(t.message)?t.message:"unknown"}`)}};Ot.AbstractMessageWriter=Si;var ua;(function(n){function t(e){return e===void 0||typeof e=="string"?{charset:e??"utf-8",contentTypeEncoder:(0,_l.default)().applicationJson.encoder}:{charset:e.charset??"utf-8",contentEncoder:e.contentEncoder,contentTypeEncoder:e.contentTypeEncoder??(0,_l.default)().applicationJson.encoder}}n.fromOptions=t})(ua||(ua={}));var la=class extends Si{constructor(t,e){super(),this.writable=t,this.options=ua.fromOptions(e),this.errorCount=0,this.writeSemaphore=new mv.Semaphore(1),this.writable.onError(r=>this.fireError(r)),this.writable.onClose(()=>this.fireClose())}async write(t){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(t,this.options).then(r=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(r):r).then(r=>{let i=[];return i.push(gv,r.byteLength.toString(),wl),i.push(wl),this.doWrite(t,i,r)},r=>{throw this.fireError(r),r}))}async doWrite(t,e,r){try{return await this.writable.write(e.join(""),"ascii"),this.writable.write(r)}catch(i){return this.handleError(i,t),Promise.reject(i)}}handleError(t,e){this.errorCount++,this.fireError(t,e,this.errorCount)}end(){this.writable.end()}};Ot.WriteableStreamMessageWriter=la});var Tl=N(wi=>{"use strict";Object.defineProperty(wi,"__esModule",{value:!0});wi.AbstractMessageBuffer=void 0;var yv=13,vv=10,bv=`\r
`,fa=class{constructor(t="utf-8"){this._encoding=t,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(t){let e=typeof t=="string"?this.fromString(t,this._encoding):t;this._chunks.push(e),this._totalLength+=e.byteLength}tryReadHeaders(t=!1){if(this._chunks.length===0)return;let e=0,r=0,i=0,s=0;e:for(;r<this._chunks.length;){let h=this._chunks[r];for(i=0;i<h.length;){switch(h[i]){case yv:switch(e){case 0:e=1;break;case 2:e=3;break;default:e=0}break;case vv:switch(e){case 1:e=2;break;case 3:e=4,i++;break e;default:e=0}break;default:e=0}i++}s+=h.byteLength,r++}if(e!==4)return;let a=this._read(s+i),l=new Map,f=this.toString(a,"ascii").split(bv);if(f.length<2)return l;for(let h=0;h<f.length-2;h++){let b=f[h],C=b.indexOf(":");if(C===-1)throw new Error(`Message header must separate key and value using ':'
${b}`);let S=b.substr(0,C),T=b.substr(C+1).trim();l.set(t?S.toLowerCase():S,T)}return l}tryReadBody(t){if(!(this._totalLength<t))return this._read(t)}get numberOfBytes(){return this._totalLength}_read(t){if(t===0)return this.emptyBuffer();if(t>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===t){let s=this._chunks[0];return this._chunks.shift(),this._totalLength-=t,this.asNative(s)}if(this._chunks[0].byteLength>t){let s=this._chunks[0],a=this.asNative(s,t);return this._chunks[0]=s.slice(t),this._totalLength-=t,a}let e=this.allocNative(t),r=0,i=0;for(;t>0;){let s=this._chunks[i];if(s.byteLength>t){let a=s.slice(0,t);e.set(a,r),r+=t,this._chunks[i]=s.slice(t),this._totalLength-=t,t-=t}else e.set(s,r),r+=s.byteLength,this._chunks.shift(),this._totalLength-=s.byteLength,t-=s.byteLength}return e}};wi.AbstractMessageBuffer=fa});var Ml=N(V=>{"use strict";Object.defineProperty(V,"__esModule",{value:!0});V.createMessageConnection=V.ConnectionOptions=V.MessageStrategy=V.CancellationStrategy=V.CancellationSenderStrategy=V.CancellationReceiverStrategy=V.RequestCancellationReceiverStrategy=V.IdCancellationReceiverStrategy=V.ConnectionStrategy=V.ConnectionError=V.ConnectionErrors=V.LogTraceNotification=V.SetTraceNotification=V.TraceFormat=V.TraceValues=V.Trace=V.NullLogger=V.ProgressType=V.ProgressToken=void 0;var El=qt(),fe=pn(),B=Ho(),ql=Vo(),or=mn(),da=xi(),ur;(function(n){n.type=new B.NotificationType("$/cancelRequest")})(ur||(ur={}));var pa;(function(n){function t(e){return typeof e=="string"||typeof e=="number"}n.is=t})(pa||(V.ProgressToken=pa={}));var ar;(function(n){n.type=new B.NotificationType("$/progress")})(ar||(ar={}));var ha=class{constructor(){}};V.ProgressType=ha;var ma;(function(n){function t(e){return fe.func(e)}n.is=t})(ma||(ma={}));V.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var te;(function(n){n[n.Off=0]="Off",n[n.Messages=1]="Messages",n[n.Compact=2]="Compact",n[n.Verbose=3]="Verbose"})(te||(V.Trace=te={}));var $l;(function(n){n.Off="off",n.Messages="messages",n.Compact="compact",n.Verbose="verbose"})($l||(V.TraceValues=$l={}));(function(n){function t(r){if(!fe.string(r))return n.Off;switch(r=r.toLowerCase(),r){case"off":return n.Off;case"messages":return n.Messages;case"compact":return n.Compact;case"verbose":return n.Verbose;default:return n.Off}}n.fromString=t;function e(r){switch(r){case n.Off:return"off";case n.Messages:return"messages";case n.Compact:return"compact";case n.Verbose:return"verbose";default:return"off"}}n.toString=e})(te||(V.Trace=te={}));var ke;(function(n){n.Text="text",n.JSON="json"})(ke||(V.TraceFormat=ke={}));(function(n){function t(e){return fe.string(e)?(e=e.toLowerCase(),e==="json"?n.JSON:n.Text):n.Text}n.fromString=t})(ke||(V.TraceFormat=ke={}));var ga;(function(n){n.type=new B.NotificationType("$/setTrace")})(ga||(V.SetTraceNotification=ga={}));var Ci;(function(n){n.type=new B.NotificationType("$/logTrace")})(Ci||(V.LogTraceNotification=Ci={}));var cr;(function(n){n[n.Closed=1]="Closed",n[n.Disposed=2]="Disposed",n[n.AlreadyListening=3]="AlreadyListening"})(cr||(V.ConnectionErrors=cr={}));var bn=class n extends Error{constructor(t,e){super(e),this.code=t,Object.setPrototypeOf(this,n.prototype)}};V.ConnectionError=bn;var ya;(function(n){function t(e){let r=e;return r&&fe.func(r.cancelUndispatched)}n.is=t})(ya||(V.ConnectionStrategy=ya={}));var Pi;(function(n){function t(e){let r=e;return r&&(r.kind===void 0||r.kind==="id")&&fe.func(r.createCancellationTokenSource)&&(r.dispose===void 0||fe.func(r.dispose))}n.is=t})(Pi||(V.IdCancellationReceiverStrategy=Pi={}));var va;(function(n){function t(e){let r=e;return r&&r.kind==="request"&&fe.func(r.createCancellationTokenSource)&&(r.dispose===void 0||fe.func(r.dispose))}n.is=t})(va||(V.RequestCancellationReceiverStrategy=va={}));var Ti;(function(n){n.Message=Object.freeze({createCancellationTokenSource(e){return new da.CancellationTokenSource}});function t(e){return Pi.is(e)||va.is(e)}n.is=t})(Ti||(V.CancellationReceiverStrategy=Ti={}));var Ei;(function(n){n.Message=Object.freeze({sendCancellation(e,r){return e.sendNotification(ur.type,{id:r})},cleanup(e){}});function t(e){let r=e;return r&&fe.func(r.sendCancellation)&&fe.func(r.cleanup)}n.is=t})(Ei||(V.CancellationSenderStrategy=Ei={}));var qi;(function(n){n.Message=Object.freeze({receiver:Ti.Message,sender:Ei.Message});function t(e){let r=e;return r&&Ti.is(r.receiver)&&Ei.is(r.sender)}n.is=t})(qi||(V.CancellationStrategy=qi={}));var $i;(function(n){function t(e){let r=e;return r&&fe.func(r.handleMessage)}n.is=t})($i||(V.MessageStrategy=$i={}));var Ol;(function(n){function t(e){let r=e;return r&&(qi.is(r.cancellationStrategy)||ya.is(r.connectionStrategy)||$i.is(r.messageStrategy))}n.is=t})(Ol||(V.ConnectionOptions=Ol={}));var tt;(function(n){n[n.New=1]="New",n[n.Listening=2]="Listening",n[n.Closed=3]="Closed",n[n.Disposed=4]="Disposed"})(tt||(tt={}));function Dv(n,t,e,r){let i=e!==void 0?e:V.NullLogger,s=0,a=0,l=0,f="2.0",h,b=new Map,C,S=new Map,T=new Map,z,Y=new ql.LinkedMap,ne=new Map,G=new Set,R=new Map,x=te.Off,O=ke.Text,Z,me=tt.New,Ht=new or.Emitter,Ur=new or.Emitter,Hr=new or.Emitter,Wr=new or.Emitter,Vr=new or.Emitter,it=r&&r.cancellationStrategy?r.cancellationStrategy:qi.Message;function Gr(g){if(g===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+g.toString()}function Us(g){return g===null?"res-unknown-"+(++l).toString():"res-"+g.toString()}function Hs(){return"not-"+(++a).toString()}function Ws(g,P){B.Message.isRequest(P)?g.set(Gr(P.id),P):B.Message.isResponse(P)?g.set(Us(P.id),P):g.set(Hs(),P)}function Vs(g){}function Xr(){return me===tt.Listening}function Yr(){return me===tt.Closed}function gt(){return me===tt.Disposed}function Xn(){(me===tt.New||me===tt.Listening)&&(me=tt.Closed,Ur.fire(void 0))}function Jr(g){Ht.fire([g,void 0,void 0])}function Qr(g){Ht.fire(g)}n.onClose(Xn),n.onError(Jr),t.onClose(Xn),t.onError(Qr);function Zr(){z||Y.size===0||(z=(0,El.default)().timer.setImmediate(()=>{z=void 0,Gs()}))}function Kr(g){B.Message.isRequest(g)?Ys(g):B.Message.isNotification(g)?Qs(g):B.Message.isResponse(g)?Js(g):Zs(g)}function Gs(){if(Y.size===0)return;let g=Y.shift();try{let P=r?.messageStrategy;$i.is(P)?P.handleMessage(g,Kr):Kr(g)}finally{Zr()}}let Xs=g=>{try{if(B.Message.isNotification(g)&&g.method===ur.type.method){let P=g.params.id,$=Gr(P),I=Y.get($);if(B.Message.isRequest(I)){let re=r?.connectionStrategy,oe=re&&re.cancelUndispatched?re.cancelUndispatched(I,Vs):void 0;if(oe&&(oe.error!==void 0||oe.result!==void 0)){Y.delete($),R.delete(P),oe.id=I.id,nn(oe,g.method,Date.now()),t.write(oe).catch(()=>i.error("Sending response for canceled message failed."));return}}let ie=R.get(P);if(ie!==void 0){ie.cancel(),Yn(g);return}else G.add(P)}Ws(Y,g)}finally{Zr()}};function Ys(g){if(gt())return;function P(J,ae,ee){let ge={jsonrpc:f,id:g.id};J instanceof B.ResponseError?ge.error=J.toJson():ge.result=J===void 0?null:J,nn(ge,ae,ee),t.write(ge).catch(()=>i.error("Sending response failed."))}function $(J,ae,ee){let ge={jsonrpc:f,id:g.id,error:J.toJson()};nn(ge,ae,ee),t.write(ge).catch(()=>i.error("Sending response failed."))}function I(J,ae,ee){J===void 0&&(J=null);let ge={jsonrpc:f,id:g.id,result:J};nn(ge,ae,ee),t.write(ge).catch(()=>i.error("Sending response failed."))}ze(g);let ie=b.get(g.method),re,oe;ie&&(re=ie.type,oe=ie.handler);let le=Date.now();if(oe||h){let J=g.id??String(Date.now()),ae=Pi.is(it.receiver)?it.receiver.createCancellationTokenSource(J):it.receiver.createCancellationTokenSource(g);g.id!==null&&G.has(g.id)&&ae.cancel(),g.id!==null&&R.set(J,ae);try{let ee;if(oe)if(g.params===void 0){if(re!==void 0&&re.numberOfParams!==0){$(new B.ResponseError(B.ErrorCodes.InvalidParams,`Request ${g.method} defines ${re.numberOfParams} params but received none.`),g.method,le);return}ee=oe(ae.token)}else if(Array.isArray(g.params)){if(re!==void 0&&re.parameterStructures===B.ParameterStructures.byName){$(new B.ResponseError(B.ErrorCodes.InvalidParams,`Request ${g.method} defines parameters by name but received parameters by position`),g.method,le);return}ee=oe(...g.params,ae.token)}else{if(re!==void 0&&re.parameterStructures===B.ParameterStructures.byPosition){$(new B.ResponseError(B.ErrorCodes.InvalidParams,`Request ${g.method} defines parameters by position but received parameters by name`),g.method,le);return}ee=oe(g.params,ae.token)}else h&&(ee=h(g.method,g.params,ae.token));let ge=ee;ee?ge.then?ge.then(Re=>{R.delete(J),P(Re,g.method,le)},Re=>{R.delete(J),Re instanceof B.ResponseError?$(Re,g.method,le):Re&&fe.string(Re.message)?$(new B.ResponseError(B.ErrorCodes.InternalError,`Request ${g.method} failed with message: ${Re.message}`),g.method,le):$(new B.ResponseError(B.ErrorCodes.InternalError,`Request ${g.method} failed unexpectedly without providing any details.`),g.method,le)}):(R.delete(J),P(ee,g.method,le)):(R.delete(J),I(ee,g.method,le))}catch(ee){R.delete(J),ee instanceof B.ResponseError?P(ee,g.method,le):ee&&fe.string(ee.message)?$(new B.ResponseError(B.ErrorCodes.InternalError,`Request ${g.method} failed with message: ${ee.message}`),g.method,le):$(new B.ResponseError(B.ErrorCodes.InternalError,`Request ${g.method} failed unexpectedly without providing any details.`),g.method,le)}}else $(new B.ResponseError(B.ErrorCodes.MethodNotFound,`Unhandled method ${g.method}`),g.method,le)}function Js(g){if(!gt())if(g.id===null)g.error?i.error(`Received response message without id: Error is:
${JSON.stringify(g.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let P=g.id,$=ne.get(P);if(eo(g,$),$!==void 0){ne.delete(P);try{if(g.error){let I=g.error;$.reject(new B.ResponseError(I.code,I.message,I.data))}else if(g.result!==void 0)$.resolve(g.result);else throw new Error("Should never happen.")}catch(I){I.message?i.error(`Response handler '${$.method}' failed with message: ${I.message}`):i.error(`Response handler '${$.method}' failed unexpectedly.`)}}}}function Qs(g){if(gt())return;let P,$;if(g.method===ur.type.method){let I=g.params.id;G.delete(I),Yn(g);return}else{let I=S.get(g.method);I&&($=I.handler,P=I.type)}if($||C)try{if(Yn(g),$)if(g.params===void 0)P!==void 0&&P.numberOfParams!==0&&P.parameterStructures!==B.ParameterStructures.byName&&i.error(`Notification ${g.method} defines ${P.numberOfParams} params but received none.`),$();else if(Array.isArray(g.params)){let I=g.params;g.method===ar.type.method&&I.length===2&&pa.is(I[0])?$({token:I[0],value:I[1]}):(P!==void 0&&(P.parameterStructures===B.ParameterStructures.byName&&i.error(`Notification ${g.method} defines parameters by name but received parameters by position`),P.numberOfParams!==g.params.length&&i.error(`Notification ${g.method} defines ${P.numberOfParams} params but received ${I.length} arguments`)),$(...I))}else P!==void 0&&P.parameterStructures===B.ParameterStructures.byPosition&&i.error(`Notification ${g.method} defines parameters by position but received parameters by name`),$(g.params);else C&&C(g.method,g.params)}catch(I){I.message?i.error(`Notification handler '${g.method}' failed with message: ${I.message}`):i.error(`Notification handler '${g.method}' failed unexpectedly.`)}else Hr.fire(g)}function Zs(g){if(!g){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(g,null,4)}`);let P=g;if(fe.string(P.id)||fe.number(P.id)){let $=P.id,I=ne.get($);I&&I.reject(new Error("The received response has neither a result nor an error property."))}}function st(g){if(g!=null)switch(x){case te.Verbose:return JSON.stringify(g,null,4);case te.Compact:return JSON.stringify(g);default:return}}function Wt(g){if(!(x===te.Off||!Z))if(O===ke.Text){let P;(x===te.Verbose||x===te.Compact)&&g.params&&(P=`Params: ${st(g.params)}

`),Z.log(`Sending request '${g.method} - (${g.id})'.`,P)}else yt("send-request",g)}function Ks(g){if(!(x===te.Off||!Z))if(O===ke.Text){let P;(x===te.Verbose||x===te.Compact)&&(g.params?P=`Params: ${st(g.params)}

`:P=`No parameters provided.

`),Z.log(`Sending notification '${g.method}'.`,P)}else yt("send-notification",g)}function nn(g,P,$){if(!(x===te.Off||!Z))if(O===ke.Text){let I;(x===te.Verbose||x===te.Compact)&&(g.error&&g.error.data?I=`Error data: ${st(g.error.data)}

`:g.result?I=`Result: ${st(g.result)}

`:g.error===void 0&&(I=`No result returned.

`)),Z.log(`Sending response '${P} - (${g.id})'. Processing request took ${Date.now()-$}ms`,I)}else yt("send-response",g)}function ze(g){if(!(x===te.Off||!Z))if(O===ke.Text){let P;(x===te.Verbose||x===te.Compact)&&g.params&&(P=`Params: ${st(g.params)}

`),Z.log(`Received request '${g.method} - (${g.id})'.`,P)}else yt("receive-request",g)}function Yn(g){if(!(x===te.Off||!Z||g.method===Ci.type.method))if(O===ke.Text){let P;(x===te.Verbose||x===te.Compact)&&(g.params?P=`Params: ${st(g.params)}

`:P=`No parameters provided.

`),Z.log(`Received notification '${g.method}'.`,P)}else yt("receive-notification",g)}function eo(g,P){if(!(x===te.Off||!Z))if(O===ke.Text){let $;if((x===te.Verbose||x===te.Compact)&&(g.error&&g.error.data?$=`Error data: ${st(g.error.data)}

`:g.result?$=`Result: ${st(g.result)}

`:g.error===void 0&&($=`No result returned.

`)),P){let I=g.error?` Request failed: ${g.error.message} (${g.error.code}).`:"";Z.log(`Received response '${P.method} - (${g.id})' in ${Date.now()-P.timerStart}ms.${I}`,$)}else Z.log(`Received response ${g.id} without active response promise.`,$)}else yt("receive-response",g)}function yt(g,P){if(!Z||x===te.Off)return;let $={isLSPMessage:!0,type:g,message:P,timestamp:Date.now()};Z.log($)}function St(){if(Yr())throw new bn(cr.Closed,"Connection is closed.");if(gt())throw new bn(cr.Disposed,"Connection is disposed.")}function to(){if(Xr())throw new bn(cr.AlreadyListening,"Connection is already listening")}function ei(){if(!Xr())throw new Error("Call listen() first.")}function vt(g){return g===void 0?null:g}function ti(g){if(g!==null)return g}function ni(g){return g!=null&&!Array.isArray(g)&&typeof g=="object"}function Jn(g,P){switch(g){case B.ParameterStructures.auto:return ni(P)?ti(P):[vt(P)];case B.ParameterStructures.byName:if(!ni(P))throw new Error("Received parameters by name but param is not an object literal.");return ti(P);case B.ParameterStructures.byPosition:return[vt(P)];default:throw new Error(`Unknown parameter structure ${g.toString()}`)}}function ri(g,P){let $,I=g.numberOfParams;switch(I){case 0:$=void 0;break;case 1:$=Jn(g.parameterStructures,P[0]);break;default:$=[];for(let ie=0;ie<P.length&&ie<I;ie++)$.push(vt(P[ie]));if(P.length<I)for(let ie=P.length;ie<I;ie++)$.push(null);break}return $}let wt={sendNotification:(g,...P)=>{St();let $,I;if(fe.string(g)){$=g;let re=P[0],oe=0,le=B.ParameterStructures.auto;B.ParameterStructures.is(re)&&(oe=1,le=re);let J=P.length,ae=J-oe;switch(ae){case 0:I=void 0;break;case 1:I=Jn(le,P[oe]);break;default:if(le===B.ParameterStructures.byName)throw new Error(`Received ${ae} parameters for 'by Name' notification parameter structure.`);I=P.slice(oe,J).map(ee=>vt(ee));break}}else{let re=P;$=g.method,I=ri(g,re)}let ie={jsonrpc:f,method:$,params:I};return Ks(ie),t.write(ie).catch(re=>{throw i.error("Sending notification failed."),re})},onNotification:(g,P)=>{St();let $;return fe.func(g)?C=g:P&&(fe.string(g)?($=g,S.set(g,{type:void 0,handler:P})):($=g.method,S.set(g.method,{type:g,handler:P}))),{dispose:()=>{$!==void 0?S.delete($):C=void 0}}},onProgress:(g,P,$)=>{if(T.has(P))throw new Error(`Progress handler for token ${P} already registered`);return T.set(P,$),{dispose:()=>{T.delete(P)}}},sendProgress:(g,P,$)=>wt.sendNotification(ar.type,{token:P,value:$}),onUnhandledProgress:Wr.event,sendRequest:(g,...P)=>{St(),ei();let $,I,ie;if(fe.string(g)){$=g;let J=P[0],ae=P[P.length-1],ee=0,ge=B.ParameterStructures.auto;B.ParameterStructures.is(J)&&(ee=1,ge=J);let Re=P.length;da.CancellationToken.is(ae)&&(Re=Re-1,ie=ae);let Be=Re-ee;switch(Be){case 0:I=void 0;break;case 1:I=Jn(ge,P[ee]);break;default:if(ge===B.ParameterStructures.byName)throw new Error(`Received ${Be} parameters for 'by Name' request parameter structure.`);I=P.slice(ee,Re).map(no=>vt(no));break}}else{let J=P;$=g.method,I=ri(g,J);let ae=g.numberOfParams;ie=da.CancellationToken.is(J[ae])?J[ae]:void 0}let re=s++,oe;ie&&(oe=ie.onCancellationRequested(()=>{let J=it.sender.sendCancellation(wt,re);return J===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${re}`),Promise.resolve()):J.catch(()=>{i.log(`Sending cancellation messages for id ${re} failed`)})}));let le={jsonrpc:f,id:re,method:$,params:I};return Wt(le),typeof it.sender.enableCancellation=="function"&&it.sender.enableCancellation(le),new Promise(async(J,ae)=>{let ee=Be=>{J(Be),it.sender.cleanup(re),oe?.dispose()},ge=Be=>{ae(Be),it.sender.cleanup(re),oe?.dispose()},Re={method:$,timerStart:Date.now(),resolve:ee,reject:ge};try{await t.write(le),ne.set(re,Re)}catch(Be){throw i.error("Sending request failed."),Re.reject(new B.ResponseError(B.ErrorCodes.MessageWriteError,Be.message?Be.message:"Unknown reason")),Be}})},onRequest:(g,P)=>{St();let $=null;return ma.is(g)?($=void 0,h=g):fe.string(g)?($=null,P!==void 0&&($=g,b.set(g,{handler:P,type:void 0}))):P!==void 0&&($=g.method,b.set(g.method,{type:g,handler:P})),{dispose:()=>{$!==null&&($!==void 0?b.delete($):h=void 0)}}},hasPendingResponse:()=>ne.size>0,trace:async(g,P,$)=>{let I=!1,ie=ke.Text;$!==void 0&&(fe.boolean($)?I=$:(I=$.sendNotification||!1,ie=$.traceFormat||ke.Text)),x=g,O=ie,x===te.Off?Z=void 0:Z=P,I&&!Yr()&&!gt()&&await wt.sendNotification(ga.type,{value:te.toString(g)})},onError:Ht.event,onClose:Ur.event,onUnhandledNotification:Hr.event,onDispose:Vr.event,end:()=>{t.end()},dispose:()=>{if(gt())return;me=tt.Disposed,Vr.fire(void 0);let g=new B.ResponseError(B.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let P of ne.values())P.reject(g);ne=new Map,R=new Map,G=new Set,Y=new ql.LinkedMap,fe.func(t.dispose)&&t.dispose(),fe.func(n.dispose)&&n.dispose()},listen:()=>{St(),to(),me=tt.Listening,n.listen(Xs)},inspect:()=>{(0,El.default)().console.log("inspect")}};return wt.onNotification(Ci.type,g=>{if(x===te.Off||!Z)return;let P=x===te.Verbose||x===te.Compact;Z.log(g.message,P?g.verbose:void 0)}),wt.onNotification(ar.type,g=>{let P=T.get(g.token);P?P(g.value):Wr.fire(g)}),wt}V.createMessageConnection=Dv});var Oi=N(w=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0});w.ProgressType=w.ProgressToken=w.createMessageConnection=w.NullLogger=w.ConnectionOptions=w.ConnectionStrategy=w.AbstractMessageBuffer=w.WriteableStreamMessageWriter=w.AbstractMessageWriter=w.MessageWriter=w.ReadableStreamMessageReader=w.AbstractMessageReader=w.MessageReader=w.SharedArrayReceiverStrategy=w.SharedArraySenderStrategy=w.CancellationToken=w.CancellationTokenSource=w.Emitter=w.Event=w.Disposable=w.LRUCache=w.Touch=w.LinkedMap=w.ParameterStructures=w.NotificationType9=w.NotificationType8=w.NotificationType7=w.NotificationType6=w.NotificationType5=w.NotificationType4=w.NotificationType3=w.NotificationType2=w.NotificationType1=w.NotificationType0=w.NotificationType=w.ErrorCodes=w.ResponseError=w.RequestType9=w.RequestType8=w.RequestType7=w.RequestType6=w.RequestType5=w.RequestType4=w.RequestType3=w.RequestType2=w.RequestType1=w.RequestType0=w.RequestType=w.Message=w.RAL=void 0;w.MessageStrategy=w.CancellationStrategy=w.CancellationSenderStrategy=w.CancellationReceiverStrategy=w.ConnectionError=w.ConnectionErrors=w.LogTraceNotification=w.SetTraceNotification=w.TraceFormat=w.TraceValues=w.Trace=void 0;var se=Ho();Object.defineProperty(w,"Message",{enumerable:!0,get:function(){return se.Message}});Object.defineProperty(w,"RequestType",{enumerable:!0,get:function(){return se.RequestType}});Object.defineProperty(w,"RequestType0",{enumerable:!0,get:function(){return se.RequestType0}});Object.defineProperty(w,"RequestType1",{enumerable:!0,get:function(){return se.RequestType1}});Object.defineProperty(w,"RequestType2",{enumerable:!0,get:function(){return se.RequestType2}});Object.defineProperty(w,"RequestType3",{enumerable:!0,get:function(){return se.RequestType3}});Object.defineProperty(w,"RequestType4",{enumerable:!0,get:function(){return se.RequestType4}});Object.defineProperty(w,"RequestType5",{enumerable:!0,get:function(){return se.RequestType5}});Object.defineProperty(w,"RequestType6",{enumerable:!0,get:function(){return se.RequestType6}});Object.defineProperty(w,"RequestType7",{enumerable:!0,get:function(){return se.RequestType7}});Object.defineProperty(w,"RequestType8",{enumerable:!0,get:function(){return se.RequestType8}});Object.defineProperty(w,"RequestType9",{enumerable:!0,get:function(){return se.RequestType9}});Object.defineProperty(w,"ResponseError",{enumerable:!0,get:function(){return se.ResponseError}});Object.defineProperty(w,"ErrorCodes",{enumerable:!0,get:function(){return se.ErrorCodes}});Object.defineProperty(w,"NotificationType",{enumerable:!0,get:function(){return se.NotificationType}});Object.defineProperty(w,"NotificationType0",{enumerable:!0,get:function(){return se.NotificationType0}});Object.defineProperty(w,"NotificationType1",{enumerable:!0,get:function(){return se.NotificationType1}});Object.defineProperty(w,"NotificationType2",{enumerable:!0,get:function(){return se.NotificationType2}});Object.defineProperty(w,"NotificationType3",{enumerable:!0,get:function(){return se.NotificationType3}});Object.defineProperty(w,"NotificationType4",{enumerable:!0,get:function(){return se.NotificationType4}});Object.defineProperty(w,"NotificationType5",{enumerable:!0,get:function(){return se.NotificationType5}});Object.defineProperty(w,"NotificationType6",{enumerable:!0,get:function(){return se.NotificationType6}});Object.defineProperty(w,"NotificationType7",{enumerable:!0,get:function(){return se.NotificationType7}});Object.defineProperty(w,"NotificationType8",{enumerable:!0,get:function(){return se.NotificationType8}});Object.defineProperty(w,"NotificationType9",{enumerable:!0,get:function(){return se.NotificationType9}});Object.defineProperty(w,"ParameterStructures",{enumerable:!0,get:function(){return se.ParameterStructures}});var ba=Vo();Object.defineProperty(w,"LinkedMap",{enumerable:!0,get:function(){return ba.LinkedMap}});Object.defineProperty(w,"LRUCache",{enumerable:!0,get:function(){return ba.LRUCache}});Object.defineProperty(w,"Touch",{enumerable:!0,get:function(){return ba.Touch}});var xv=vl();Object.defineProperty(w,"Disposable",{enumerable:!0,get:function(){return xv.Disposable}});var Ll=mn();Object.defineProperty(w,"Event",{enumerable:!0,get:function(){return Ll.Event}});Object.defineProperty(w,"Emitter",{enumerable:!0,get:function(){return Ll.Emitter}});var Nl=xi();Object.defineProperty(w,"CancellationTokenSource",{enumerable:!0,get:function(){return Nl.CancellationTokenSource}});Object.defineProperty(w,"CancellationToken",{enumerable:!0,get:function(){return Nl.CancellationToken}});var kl=Dl();Object.defineProperty(w,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return kl.SharedArraySenderStrategy}});Object.defineProperty(w,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return kl.SharedArrayReceiverStrategy}});var Da=Rl();Object.defineProperty(w,"MessageReader",{enumerable:!0,get:function(){return Da.MessageReader}});Object.defineProperty(w,"AbstractMessageReader",{enumerable:!0,get:function(){return Da.AbstractMessageReader}});Object.defineProperty(w,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return Da.ReadableStreamMessageReader}});var xa=Pl();Object.defineProperty(w,"MessageWriter",{enumerable:!0,get:function(){return xa.MessageWriter}});Object.defineProperty(w,"AbstractMessageWriter",{enumerable:!0,get:function(){return xa.AbstractMessageWriter}});Object.defineProperty(w,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return xa.WriteableStreamMessageWriter}});var Rv=Tl();Object.defineProperty(w,"AbstractMessageBuffer",{enumerable:!0,get:function(){return Rv.AbstractMessageBuffer}});var _e=Ml();Object.defineProperty(w,"ConnectionStrategy",{enumerable:!0,get:function(){return _e.ConnectionStrategy}});Object.defineProperty(w,"ConnectionOptions",{enumerable:!0,get:function(){return _e.ConnectionOptions}});Object.defineProperty(w,"NullLogger",{enumerable:!0,get:function(){return _e.NullLogger}});Object.defineProperty(w,"createMessageConnection",{enumerable:!0,get:function(){return _e.createMessageConnection}});Object.defineProperty(w,"ProgressToken",{enumerable:!0,get:function(){return _e.ProgressToken}});Object.defineProperty(w,"ProgressType",{enumerable:!0,get:function(){return _e.ProgressType}});Object.defineProperty(w,"Trace",{enumerable:!0,get:function(){return _e.Trace}});Object.defineProperty(w,"TraceValues",{enumerable:!0,get:function(){return _e.TraceValues}});Object.defineProperty(w,"TraceFormat",{enumerable:!0,get:function(){return _e.TraceFormat}});Object.defineProperty(w,"SetTraceNotification",{enumerable:!0,get:function(){return _e.SetTraceNotification}});Object.defineProperty(w,"LogTraceNotification",{enumerable:!0,get:function(){return _e.LogTraceNotification}});Object.defineProperty(w,"ConnectionErrors",{enumerable:!0,get:function(){return _e.ConnectionErrors}});Object.defineProperty(w,"ConnectionError",{enumerable:!0,get:function(){return _e.ConnectionError}});Object.defineProperty(w,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return _e.CancellationReceiverStrategy}});Object.defineProperty(w,"CancellationSenderStrategy",{enumerable:!0,get:function(){return _e.CancellationSenderStrategy}});Object.defineProperty(w,"CancellationStrategy",{enumerable:!0,get:function(){return _e.CancellationStrategy}});Object.defineProperty(w,"MessageStrategy",{enumerable:!0,get:function(){return _e.MessageStrategy}});var _v=qt();w.RAL=_v.default});var Al=N(wa=>{"use strict";Object.defineProperty(wa,"__esModule",{value:!0});var ct=Oi(),Mi=class n extends ct.AbstractMessageBuffer{constructor(t="utf-8"){super(t),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return n.emptyBuffer}fromString(t,e){return new TextEncoder().encode(t)}toString(t,e){return e==="ascii"?this.asciiDecoder.decode(t):new TextDecoder(e).decode(t)}asNative(t,e){return e===void 0?t:t.slice(0,e)}allocNative(t){return new Uint8Array(t)}};Mi.emptyBuffer=new Uint8Array(0);var Ra=class{constructor(t){this.socket=t,this._onData=new ct.Emitter,this._messageListener=e=>{e.data.arrayBuffer().then(i=>{this._onData.fire(new Uint8Array(i))},()=>{(0,ct.RAL)().console.error("Converting blob to array buffer failed.")})},this.socket.addEventListener("message",this._messageListener)}onClose(t){return this.socket.addEventListener("close",t),ct.Disposable.create(()=>this.socket.removeEventListener("close",t))}onError(t){return this.socket.addEventListener("error",t),ct.Disposable.create(()=>this.socket.removeEventListener("error",t))}onEnd(t){return this.socket.addEventListener("end",t),ct.Disposable.create(()=>this.socket.removeEventListener("end",t))}onData(t){return this._onData.event(t)}},_a=class{constructor(t){this.socket=t}onClose(t){return this.socket.addEventListener("close",t),ct.Disposable.create(()=>this.socket.removeEventListener("close",t))}onError(t){return this.socket.addEventListener("error",t),ct.Disposable.create(()=>this.socket.removeEventListener("error",t))}onEnd(t){return this.socket.addEventListener("end",t),ct.Disposable.create(()=>this.socket.removeEventListener("end",t))}write(t,e){if(typeof t=="string"){if(e!==void 0&&e!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${e}`);this.socket.send(t)}else this.socket.send(t);return Promise.resolve()}end(){this.socket.close()}},Sv=new TextEncoder,Il=Object.freeze({messageBuffer:Object.freeze({create:n=>new Mi(n)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(n,t)=>{if(t.charset!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t.charset}`);return Promise.resolve(Sv.encode(JSON.stringify(n,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(n,t)=>{if(!(n instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(t.charset).decode(n)))}})}),stream:Object.freeze({asReadableStream:n=>new Ra(n),asWritableStream:n=>new _a(n)}),console,timer:Object.freeze({setTimeout(n,t,...e){let r=setTimeout(n,t,...e);return{dispose:()=>clearTimeout(r)}},setImmediate(n,...t){let e=setTimeout(n,0,...t);return{dispose:()=>clearTimeout(e)}},setInterval(n,t,...e){let r=setInterval(n,t,...e);return{dispose:()=>clearInterval(r)}}})});function Sa(){return Il}(function(n){function t(){ct.RAL.install(Il)}n.install=t})(Sa||(Sa={}));wa.default=Sa});var Gt=N(Ie=>{"use strict";var wv=Ie&&Ie.__createBinding||(Object.create?(function(n,t,e,r){r===void 0&&(r=e);var i=Object.getOwnPropertyDescriptor(t,e);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(n,r,i)}):(function(n,t,e,r){r===void 0&&(r=e),n[r]=t[e]})),Cv=Ie&&Ie.__exportStar||function(n,t){for(var e in n)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&wv(t,n,e)};Object.defineProperty(Ie,"__esModule",{value:!0});Ie.createMessageConnection=Ie.BrowserMessageWriter=Ie.BrowserMessageReader=void 0;var Pv=Al();Pv.default.install();var Dn=Oi();Cv(Oi(),Ie);var Ca=class extends Dn.AbstractMessageReader{constructor(t){super(),this._onData=new Dn.Emitter,this._messageListener=e=>{this._onData.fire(e.data)},t.addEventListener("error",e=>this.fireError(e)),t.onmessage=this._messageListener}listen(t){return this._onData.event(t)}};Ie.BrowserMessageReader=Ca;var Pa=class extends Dn.AbstractMessageWriter{constructor(t){super(),this.port=t,this.errorCount=0,t.addEventListener("error",e=>this.fireError(e))}write(t){try{return this.port.postMessage(t),Promise.resolve()}catch(e){return this.handleError(e,t),Promise.reject(e)}}handleError(t,e){this.errorCount++,this.fireError(t,e,this.errorCount)}end(){}};Ie.BrowserMessageWriter=Pa;function Tv(n,t,e,r){return e===void 0&&(e=Dn.NullLogger),Dn.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,Dn.createMessageConnection)(n,t,e,r)}Ie.createMessageConnection=Tv});var Ta=N((PD,jl)=>{"use strict";jl.exports=Gt()});var zi={};nv(zi,{AnnotatedTextEdit:()=>Dt,ChangeAnnotation:()=>Xt,ChangeAnnotationIdentifier:()=>Se,CodeAction:()=>uc,CodeActionContext:()=>cc,CodeActionKind:()=>ac,CodeActionTriggerKind:()=>gr,CodeDescription:()=>Aa,CodeLens:()=>lc,Color:()=>Ni,ColorInformation:()=>Oa,ColorPresentation:()=>Ma,Command:()=>Yt,CompletionItem:()=>Ya,CompletionItemKind:()=>Ua,CompletionItemLabelDetails:()=>Xa,CompletionItemTag:()=>Wa,CompletionList:()=>Ja,CreateFile:()=>Rn,DeleteFile:()=>Sn,Diagnostic:()=>dr,DiagnosticRelatedInformation:()=>ki,DiagnosticSeverity:()=>ka,DiagnosticTag:()=>Ia,DocumentHighlight:()=>tc,DocumentHighlightKind:()=>ec,DocumentLink:()=>dc,DocumentSymbol:()=>oc,DocumentUri:()=>Ea,EOL:()=>Ev,FoldingRange:()=>Na,FoldingRangeKind:()=>La,FormattingOptions:()=>fc,Hover:()=>Qa,InlayHint:()=>xc,InlayHintKind:()=>ji,InlayHintLabelPart:()=>Fi,InlineCompletionContext:()=>Pc,InlineCompletionItem:()=>_c,InlineCompletionList:()=>Sc,InlineCompletionTriggerKind:()=>wc,InlineValueContext:()=>Dc,InlineValueEvaluatableExpression:()=>bc,InlineValueText:()=>yc,InlineValueVariableLookup:()=>vc,InsertReplaceEdit:()=>Va,InsertTextFormat:()=>Ha,InsertTextMode:()=>Ga,Location:()=>fr,LocationLink:()=>$a,MarkedString:()=>mr,MarkupContent:()=>wn,MarkupKind:()=>Jt,OptionalVersionedTextDocumentIdentifier:()=>hr,ParameterInformation:()=>Za,Position:()=>We,Range:()=>pe,RenameFile:()=>_n,SelectedCompletionInfo:()=>Cc,SelectionRange:()=>pc,SemanticTokenModifiers:()=>mc,SemanticTokenTypes:()=>hc,SemanticTokens:()=>gc,SignatureInformation:()=>Ka,StringValue:()=>Rc,SymbolInformation:()=>ic,SymbolKind:()=>nc,SymbolTag:()=>rc,TextDocument:()=>Ec,TextDocumentEdit:()=>pr,TextDocumentIdentifier:()=>Fa,TextDocumentItem:()=>Ba,TextEdit:()=>ut,URI:()=>Li,VersionedTextDocumentIdentifier:()=>za,WorkspaceChange:()=>ja,WorkspaceEdit:()=>Ii,WorkspaceFolder:()=>Tc,WorkspaceSymbol:()=>sc,integer:()=>qa,uinteger:()=>lr});var Ea,Li,qa,lr,We,pe,fr,$a,Ni,Oa,Ma,La,Na,ki,ka,Ia,Aa,dr,Yt,ut,Xt,Se,Dt,pr,Rn,_n,Sn,Ii,xn,Ai,ja,Fa,za,hr,Ba,Jt,wn,Ua,Ha,Wa,Va,Ga,Xa,Ya,Ja,mr,Qa,Za,Ka,ec,tc,nc,rc,ic,sc,oc,ac,gr,cc,uc,lc,fc,dc,pc,hc,mc,gc,yc,vc,bc,Dc,ji,Fi,xc,Rc,_c,Sc,wc,Cc,Pc,Tc,Ev,Ec,qc,D,yr=tv(()=>{"use strict";(function(n){function t(e){return typeof e=="string"}n.is=t})(Ea||(Ea={}));(function(n){function t(e){return typeof e=="string"}n.is=t})(Li||(Li={}));(function(n){n.MIN_VALUE=-2147483648,n.MAX_VALUE=2147483647;function t(e){return typeof e=="number"&&n.MIN_VALUE<=e&&e<=n.MAX_VALUE}n.is=t})(qa||(qa={}));(function(n){n.MIN_VALUE=0,n.MAX_VALUE=2147483647;function t(e){return typeof e=="number"&&n.MIN_VALUE<=e&&e<=n.MAX_VALUE}n.is=t})(lr||(lr={}));(function(n){function t(r,i){return r===Number.MAX_VALUE&&(r=lr.MAX_VALUE),i===Number.MAX_VALUE&&(i=lr.MAX_VALUE),{line:r,character:i}}n.create=t;function e(r){let i=r;return D.objectLiteral(i)&&D.uinteger(i.line)&&D.uinteger(i.character)}n.is=e})(We||(We={}));(function(n){function t(r,i,s,a){if(D.uinteger(r)&&D.uinteger(i)&&D.uinteger(s)&&D.uinteger(a))return{start:We.create(r,i),end:We.create(s,a)};if(We.is(r)&&We.is(i))return{start:r,end:i};throw new Error(`Range#create called with invalid arguments[${r}, ${i}, ${s}, ${a}]`)}n.create=t;function e(r){let i=r;return D.objectLiteral(i)&&We.is(i.start)&&We.is(i.end)}n.is=e})(pe||(pe={}));(function(n){function t(r,i){return{uri:r,range:i}}n.create=t;function e(r){let i=r;return D.objectLiteral(i)&&pe.is(i.range)&&(D.string(i.uri)||D.undefined(i.uri))}n.is=e})(fr||(fr={}));(function(n){function t(r,i,s,a){return{targetUri:r,targetRange:i,targetSelectionRange:s,originSelectionRange:a}}n.create=t;function e(r){let i=r;return D.objectLiteral(i)&&pe.is(i.targetRange)&&D.string(i.targetUri)&&pe.is(i.targetSelectionRange)&&(pe.is(i.originSelectionRange)||D.undefined(i.originSelectionRange))}n.is=e})($a||($a={}));(function(n){function t(r,i,s,a){return{red:r,green:i,blue:s,alpha:a}}n.create=t;function e(r){let i=r;return D.objectLiteral(i)&&D.numberRange(i.red,0,1)&&D.numberRange(i.green,0,1)&&D.numberRange(i.blue,0,1)&&D.numberRange(i.alpha,0,1)}n.is=e})(Ni||(Ni={}));(function(n){function t(r,i){return{range:r,color:i}}n.create=t;function e(r){let i=r;return D.objectLiteral(i)&&pe.is(i.range)&&Ni.is(i.color)}n.is=e})(Oa||(Oa={}));(function(n){function t(r,i,s){return{label:r,textEdit:i,additionalTextEdits:s}}n.create=t;function e(r){let i=r;return D.objectLiteral(i)&&D.string(i.label)&&(D.undefined(i.textEdit)||ut.is(i))&&(D.undefined(i.additionalTextEdits)||D.typedArray(i.additionalTextEdits,ut.is))}n.is=e})(Ma||(Ma={}));(function(n){n.Comment="comment",n.Imports="imports",n.Region="region"})(La||(La={}));(function(n){function t(r,i,s,a,l,f){let h={startLine:r,endLine:i};return D.defined(s)&&(h.startCharacter=s),D.defined(a)&&(h.endCharacter=a),D.defined(l)&&(h.kind=l),D.defined(f)&&(h.collapsedText=f),h}n.create=t;function e(r){let i=r;return D.objectLiteral(i)&&D.uinteger(i.startLine)&&D.uinteger(i.startLine)&&(D.undefined(i.startCharacter)||D.uinteger(i.startCharacter))&&(D.undefined(i.endCharacter)||D.uinteger(i.endCharacter))&&(D.undefined(i.kind)||D.string(i.kind))}n.is=e})(Na||(Na={}));(function(n){function t(r,i){return{location:r,message:i}}n.create=t;function e(r){let i=r;return D.defined(i)&&fr.is(i.location)&&D.string(i.message)}n.is=e})(ki||(ki={}));(function(n){n.Error=1,n.Warning=2,n.Information=3,n.Hint=4})(ka||(ka={}));(function(n){n.Unnecessary=1,n.Deprecated=2})(Ia||(Ia={}));(function(n){function t(e){let r=e;return D.objectLiteral(r)&&D.string(r.href)}n.is=t})(Aa||(Aa={}));(function(n){function t(r,i,s,a,l,f){let h={range:r,message:i};return D.defined(s)&&(h.severity=s),D.defined(a)&&(h.code=a),D.defined(l)&&(h.source=l),D.defined(f)&&(h.relatedInformation=f),h}n.create=t;function e(r){var i;let s=r;return D.defined(s)&&pe.is(s.range)&&D.string(s.message)&&(D.number(s.severity)||D.undefined(s.severity))&&(D.integer(s.code)||D.string(s.code)||D.undefined(s.code))&&(D.undefined(s.codeDescription)||D.string((i=s.codeDescription)===null||i===void 0?void 0:i.href))&&(D.string(s.source)||D.undefined(s.source))&&(D.undefined(s.relatedInformation)||D.typedArray(s.relatedInformation,ki.is))}n.is=e})(dr||(dr={}));(function(n){function t(r,i,...s){let a={title:r,command:i};return D.defined(s)&&s.length>0&&(a.arguments=s),a}n.create=t;function e(r){let i=r;return D.defined(i)&&D.string(i.title)&&D.string(i.command)}n.is=e})(Yt||(Yt={}));(function(n){function t(s,a){return{range:s,newText:a}}n.replace=t;function e(s,a){return{range:{start:s,end:s},newText:a}}n.insert=e;function r(s){return{range:s,newText:""}}n.del=r;function i(s){let a=s;return D.objectLiteral(a)&&D.string(a.newText)&&pe.is(a.range)}n.is=i})(ut||(ut={}));(function(n){function t(r,i,s){let a={label:r};return i!==void 0&&(a.needsConfirmation=i),s!==void 0&&(a.description=s),a}n.create=t;function e(r){let i=r;return D.objectLiteral(i)&&D.string(i.label)&&(D.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(D.string(i.description)||i.description===void 0)}n.is=e})(Xt||(Xt={}));(function(n){function t(e){let r=e;return D.string(r)}n.is=t})(Se||(Se={}));(function(n){function t(s,a,l){return{range:s,newText:a,annotationId:l}}n.replace=t;function e(s,a,l){return{range:{start:s,end:s},newText:a,annotationId:l}}n.insert=e;function r(s,a){return{range:s,newText:"",annotationId:a}}n.del=r;function i(s){let a=s;return ut.is(a)&&(Xt.is(a.annotationId)||Se.is(a.annotationId))}n.is=i})(Dt||(Dt={}));(function(n){function t(r,i){return{textDocument:r,edits:i}}n.create=t;function e(r){let i=r;return D.defined(i)&&hr.is(i.textDocument)&&Array.isArray(i.edits)}n.is=e})(pr||(pr={}));(function(n){function t(r,i,s){let a={kind:"create",uri:r};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(a.options=i),s!==void 0&&(a.annotationId=s),a}n.create=t;function e(r){let i=r;return i&&i.kind==="create"&&D.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||D.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||D.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Se.is(i.annotationId))}n.is=e})(Rn||(Rn={}));(function(n){function t(r,i,s,a){let l={kind:"rename",oldUri:r,newUri:i};return s!==void 0&&(s.overwrite!==void 0||s.ignoreIfExists!==void 0)&&(l.options=s),a!==void 0&&(l.annotationId=a),l}n.create=t;function e(r){let i=r;return i&&i.kind==="rename"&&D.string(i.oldUri)&&D.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||D.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||D.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Se.is(i.annotationId))}n.is=e})(_n||(_n={}));(function(n){function t(r,i,s){let a={kind:"delete",uri:r};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==void 0)&&(a.options=i),s!==void 0&&(a.annotationId=s),a}n.create=t;function e(r){let i=r;return i&&i.kind==="delete"&&D.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||D.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||D.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||Se.is(i.annotationId))}n.is=e})(Sn||(Sn={}));(function(n){function t(e){let r=e;return r&&(r.changes!==void 0||r.documentChanges!==void 0)&&(r.documentChanges===void 0||r.documentChanges.every(i=>D.string(i.kind)?Rn.is(i)||_n.is(i)||Sn.is(i):pr.is(i)))}n.is=t})(Ii||(Ii={}));xn=class{constructor(t,e){this.edits=t,this.changeAnnotations=e}insert(t,e,r){let i,s;if(r===void 0?i=ut.insert(t,e):Se.is(r)?(s=r,i=Dt.insert(t,e,r)):(this.assertChangeAnnotations(this.changeAnnotations),s=this.changeAnnotations.manage(r),i=Dt.insert(t,e,s)),this.edits.push(i),s!==void 0)return s}replace(t,e,r){let i,s;if(r===void 0?i=ut.replace(t,e):Se.is(r)?(s=r,i=Dt.replace(t,e,r)):(this.assertChangeAnnotations(this.changeAnnotations),s=this.changeAnnotations.manage(r),i=Dt.replace(t,e,s)),this.edits.push(i),s!==void 0)return s}delete(t,e){let r,i;if(e===void 0?r=ut.del(t):Se.is(e)?(i=e,r=Dt.del(t,e)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(e),r=Dt.del(t,i)),this.edits.push(r),i!==void 0)return i}add(t){this.edits.push(t)}all(){return this.edits}clear(){this.edits.splice(0,this.edits.length)}assertChangeAnnotations(t){if(t===void 0)throw new Error("Text edit change is not configured to manage change annotations.")}},Ai=class{constructor(t){this._annotations=t===void 0?Object.create(null):t,this._counter=0,this._size=0}all(){return this._annotations}get size(){return this._size}manage(t,e){let r;if(Se.is(t)?r=t:(r=this.nextId(),e=t),this._annotations[r]!==void 0)throw new Error(`Id ${r} is already in use.`);if(e===void 0)throw new Error(`No annotation provided for id ${r}`);return this._annotations[r]=e,this._size++,r}nextId(){return this._counter++,this._counter.toString()}},ja=class{constructor(t){this._textEditChanges=Object.create(null),t!==void 0?(this._workspaceEdit=t,t.documentChanges?(this._changeAnnotations=new Ai(t.changeAnnotations),t.changeAnnotations=this._changeAnnotations.all(),t.documentChanges.forEach(e=>{if(pr.is(e)){let r=new xn(e.edits,this._changeAnnotations);this._textEditChanges[e.textDocument.uri]=r}})):t.changes&&Object.keys(t.changes).forEach(e=>{let r=new xn(t.changes[e]);this._textEditChanges[e]=r})):this._workspaceEdit={}}get edit(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit}getTextEditChange(t){if(hr.is(t)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let e={uri:t.uri,version:t.version},r=this._textEditChanges[e.uri];if(!r){let i=[],s={textDocument:e,edits:i};this._workspaceEdit.documentChanges.push(s),r=new xn(i,this._changeAnnotations),this._textEditChanges[e.uri]=r}return r}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");let e=this._textEditChanges[t];if(!e){let r=[];this._workspaceEdit.changes[t]=r,e=new xn(r),this._textEditChanges[t]=e}return e}}initDocumentChanges(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new Ai,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())}initChanges(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))}createFile(t,e,r){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let i;Xt.is(e)||Se.is(e)?i=e:r=e;let s,a;if(i===void 0?s=Rn.create(t,r):(a=Se.is(i)?i:this._changeAnnotations.manage(i),s=Rn.create(t,r,a)),this._workspaceEdit.documentChanges.push(s),a!==void 0)return a}renameFile(t,e,r,i){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let s;Xt.is(r)||Se.is(r)?s=r:i=r;let a,l;if(s===void 0?a=_n.create(t,e,i):(l=Se.is(s)?s:this._changeAnnotations.manage(s),a=_n.create(t,e,i,l)),this._workspaceEdit.documentChanges.push(a),l!==void 0)return l}deleteFile(t,e,r){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let i;Xt.is(e)||Se.is(e)?i=e:r=e;let s,a;if(i===void 0?s=Sn.create(t,r):(a=Se.is(i)?i:this._changeAnnotations.manage(i),s=Sn.create(t,r,a)),this._workspaceEdit.documentChanges.push(s),a!==void 0)return a}};(function(n){function t(r){return{uri:r}}n.create=t;function e(r){let i=r;return D.defined(i)&&D.string(i.uri)}n.is=e})(Fa||(Fa={}));(function(n){function t(r,i){return{uri:r,version:i}}n.create=t;function e(r){let i=r;return D.defined(i)&&D.string(i.uri)&&D.integer(i.version)}n.is=e})(za||(za={}));(function(n){function t(r,i){return{uri:r,version:i}}n.create=t;function e(r){let i=r;return D.defined(i)&&D.string(i.uri)&&(i.version===null||D.integer(i.version))}n.is=e})(hr||(hr={}));(function(n){function t(r,i,s,a){return{uri:r,languageId:i,version:s,text:a}}n.create=t;function e(r){let i=r;return D.defined(i)&&D.string(i.uri)&&D.string(i.languageId)&&D.integer(i.version)&&D.string(i.text)}n.is=e})(Ba||(Ba={}));(function(n){n.PlainText="plaintext",n.Markdown="markdown";function t(e){let r=e;return r===n.PlainText||r===n.Markdown}n.is=t})(Jt||(Jt={}));(function(n){function t(e){let r=e;return D.objectLiteral(e)&&Jt.is(r.kind)&&D.string(r.value)}n.is=t})(wn||(wn={}));(function(n){n.Text=1,n.Method=2,n.Function=3,n.Constructor=4,n.Field=5,n.Variable=6,n.Class=7,n.Interface=8,n.Module=9,n.Property=10,n.Unit=11,n.Value=12,n.Enum=13,n.Keyword=14,n.Snippet=15,n.Color=16,n.File=17,n.Reference=18,n.Folder=19,n.EnumMember=20,n.Constant=21,n.Struct=22,n.Event=23,n.Operator=24,n.TypeParameter=25})(Ua||(Ua={}));(function(n){n.PlainText=1,n.Snippet=2})(Ha||(Ha={}));(function(n){n.Deprecated=1})(Wa||(Wa={}));(function(n){function t(r,i,s){return{newText:r,insert:i,replace:s}}n.create=t;function e(r){let i=r;return i&&D.string(i.newText)&&pe.is(i.insert)&&pe.is(i.replace)}n.is=e})(Va||(Va={}));(function(n){n.asIs=1,n.adjustIndentation=2})(Ga||(Ga={}));(function(n){function t(e){let r=e;return r&&(D.string(r.detail)||r.detail===void 0)&&(D.string(r.description)||r.description===void 0)}n.is=t})(Xa||(Xa={}));(function(n){function t(e){return{label:e}}n.create=t})(Ya||(Ya={}));(function(n){function t(e,r){return{items:e||[],isIncomplete:!!r}}n.create=t})(Ja||(Ja={}));(function(n){function t(r){return r.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}n.fromPlainText=t;function e(r){let i=r;return D.string(i)||D.objectLiteral(i)&&D.string(i.language)&&D.string(i.value)}n.is=e})(mr||(mr={}));(function(n){function t(e){let r=e;return!!r&&D.objectLiteral(r)&&(wn.is(r.contents)||mr.is(r.contents)||D.typedArray(r.contents,mr.is))&&(e.range===void 0||pe.is(e.range))}n.is=t})(Qa||(Qa={}));(function(n){function t(e,r){return r?{label:e,documentation:r}:{label:e}}n.create=t})(Za||(Za={}));(function(n){function t(e,r,...i){let s={label:e};return D.defined(r)&&(s.documentation=r),D.defined(i)?s.parameters=i:s.parameters=[],s}n.create=t})(Ka||(Ka={}));(function(n){n.Text=1,n.Read=2,n.Write=3})(ec||(ec={}));(function(n){function t(e,r){let i={range:e};return D.number(r)&&(i.kind=r),i}n.create=t})(tc||(tc={}));(function(n){n.File=1,n.Module=2,n.Namespace=3,n.Package=4,n.Class=5,n.Method=6,n.Property=7,n.Field=8,n.Constructor=9,n.Enum=10,n.Interface=11,n.Function=12,n.Variable=13,n.Constant=14,n.String=15,n.Number=16,n.Boolean=17,n.Array=18,n.Object=19,n.Key=20,n.Null=21,n.EnumMember=22,n.Struct=23,n.Event=24,n.Operator=25,n.TypeParameter=26})(nc||(nc={}));(function(n){n.Deprecated=1})(rc||(rc={}));(function(n){function t(e,r,i,s,a){let l={name:e,kind:r,location:{uri:s,range:i}};return a&&(l.containerName=a),l}n.create=t})(ic||(ic={}));(function(n){function t(e,r,i,s){return s!==void 0?{name:e,kind:r,location:{uri:i,range:s}}:{name:e,kind:r,location:{uri:i}}}n.create=t})(sc||(sc={}));(function(n){function t(r,i,s,a,l,f){let h={name:r,detail:i,kind:s,range:a,selectionRange:l};return f!==void 0&&(h.children=f),h}n.create=t;function e(r){let i=r;return i&&D.string(i.name)&&D.number(i.kind)&&pe.is(i.range)&&pe.is(i.selectionRange)&&(i.detail===void 0||D.string(i.detail))&&(i.deprecated===void 0||D.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}n.is=e})(oc||(oc={}));(function(n){n.Empty="",n.QuickFix="quickfix",n.Refactor="refactor",n.RefactorExtract="refactor.extract",n.RefactorInline="refactor.inline",n.RefactorRewrite="refactor.rewrite",n.Source="source",n.SourceOrganizeImports="source.organizeImports",n.SourceFixAll="source.fixAll"})(ac||(ac={}));(function(n){n.Invoked=1,n.Automatic=2})(gr||(gr={}));(function(n){function t(r,i,s){let a={diagnostics:r};return i!=null&&(a.only=i),s!=null&&(a.triggerKind=s),a}n.create=t;function e(r){let i=r;return D.defined(i)&&D.typedArray(i.diagnostics,dr.is)&&(i.only===void 0||D.typedArray(i.only,D.string))&&(i.triggerKind===void 0||i.triggerKind===gr.Invoked||i.triggerKind===gr.Automatic)}n.is=e})(cc||(cc={}));(function(n){function t(r,i,s){let a={title:r},l=!0;return typeof i=="string"?(l=!1,a.kind=i):Yt.is(i)?a.command=i:a.edit=i,l&&s!==void 0&&(a.kind=s),a}n.create=t;function e(r){let i=r;return i&&D.string(i.title)&&(i.diagnostics===void 0||D.typedArray(i.diagnostics,dr.is))&&(i.kind===void 0||D.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||Yt.is(i.command))&&(i.isPreferred===void 0||D.boolean(i.isPreferred))&&(i.edit===void 0||Ii.is(i.edit))}n.is=e})(uc||(uc={}));(function(n){function t(r,i){let s={range:r};return D.defined(i)&&(s.data=i),s}n.create=t;function e(r){let i=r;return D.defined(i)&&pe.is(i.range)&&(D.undefined(i.command)||Yt.is(i.command))}n.is=e})(lc||(lc={}));(function(n){function t(r,i){return{tabSize:r,insertSpaces:i}}n.create=t;function e(r){let i=r;return D.defined(i)&&D.uinteger(i.tabSize)&&D.boolean(i.insertSpaces)}n.is=e})(fc||(fc={}));(function(n){function t(r,i,s){return{range:r,target:i,data:s}}n.create=t;function e(r){let i=r;return D.defined(i)&&pe.is(i.range)&&(D.undefined(i.target)||D.string(i.target))}n.is=e})(dc||(dc={}));(function(n){function t(r,i){return{range:r,parent:i}}n.create=t;function e(r){let i=r;return D.objectLiteral(i)&&pe.is(i.range)&&(i.parent===void 0||n.is(i.parent))}n.is=e})(pc||(pc={}));(function(n){n.namespace="namespace",n.type="type",n.class="class",n.enum="enum",n.interface="interface",n.struct="struct",n.typeParameter="typeParameter",n.parameter="parameter",n.variable="variable",n.property="property",n.enumMember="enumMember",n.event="event",n.function="function",n.method="method",n.macro="macro",n.keyword="keyword",n.modifier="modifier",n.comment="comment",n.string="string",n.number="number",n.regexp="regexp",n.operator="operator",n.decorator="decorator"})(hc||(hc={}));(function(n){n.declaration="declaration",n.definition="definition",n.readonly="readonly",n.static="static",n.deprecated="deprecated",n.abstract="abstract",n.async="async",n.modification="modification",n.documentation="documentation",n.defaultLibrary="defaultLibrary"})(mc||(mc={}));(function(n){function t(e){let r=e;return D.objectLiteral(r)&&(r.resultId===void 0||typeof r.resultId=="string")&&Array.isArray(r.data)&&(r.data.length===0||typeof r.data[0]=="number")}n.is=t})(gc||(gc={}));(function(n){function t(r,i){return{range:r,text:i}}n.create=t;function e(r){let i=r;return i!=null&&pe.is(i.range)&&D.string(i.text)}n.is=e})(yc||(yc={}));(function(n){function t(r,i,s){return{range:r,variableName:i,caseSensitiveLookup:s}}n.create=t;function e(r){let i=r;return i!=null&&pe.is(i.range)&&D.boolean(i.caseSensitiveLookup)&&(D.string(i.variableName)||i.variableName===void 0)}n.is=e})(vc||(vc={}));(function(n){function t(r,i){return{range:r,expression:i}}n.create=t;function e(r){let i=r;return i!=null&&pe.is(i.range)&&(D.string(i.expression)||i.expression===void 0)}n.is=e})(bc||(bc={}));(function(n){function t(r,i){return{frameId:r,stoppedLocation:i}}n.create=t;function e(r){let i=r;return D.defined(i)&&pe.is(r.stoppedLocation)}n.is=e})(Dc||(Dc={}));(function(n){n.Type=1,n.Parameter=2;function t(e){return e===1||e===2}n.is=t})(ji||(ji={}));(function(n){function t(r){return{value:r}}n.create=t;function e(r){let i=r;return D.objectLiteral(i)&&(i.tooltip===void 0||D.string(i.tooltip)||wn.is(i.tooltip))&&(i.location===void 0||fr.is(i.location))&&(i.command===void 0||Yt.is(i.command))}n.is=e})(Fi||(Fi={}));(function(n){function t(r,i,s){let a={position:r,label:i};return s!==void 0&&(a.kind=s),a}n.create=t;function e(r){let i=r;return D.objectLiteral(i)&&We.is(i.position)&&(D.string(i.label)||D.typedArray(i.label,Fi.is))&&(i.kind===void 0||ji.is(i.kind))&&i.textEdits===void 0||D.typedArray(i.textEdits,ut.is)&&(i.tooltip===void 0||D.string(i.tooltip)||wn.is(i.tooltip))&&(i.paddingLeft===void 0||D.boolean(i.paddingLeft))&&(i.paddingRight===void 0||D.boolean(i.paddingRight))}n.is=e})(xc||(xc={}));(function(n){function t(e){return{kind:"snippet",value:e}}n.createSnippet=t})(Rc||(Rc={}));(function(n){function t(e,r,i,s){return{insertText:e,filterText:r,range:i,command:s}}n.create=t})(_c||(_c={}));(function(n){function t(e){return{items:e}}n.create=t})(Sc||(Sc={}));(function(n){n.Invoked=0,n.Automatic=1})(wc||(wc={}));(function(n){function t(e,r){return{range:e,text:r}}n.create=t})(Cc||(Cc={}));(function(n){function t(e,r){return{triggerKind:e,selectedCompletionInfo:r}}n.create=t})(Pc||(Pc={}));(function(n){function t(e){let r=e;return D.objectLiteral(r)&&Li.is(r.uri)&&D.string(r.name)}n.is=t})(Tc||(Tc={}));Ev=[`
`,`\r
`,"\r"];(function(n){function t(s,a,l,f){return new qc(s,a,l,f)}n.create=t;function e(s){let a=s;return!!(D.defined(a)&&D.string(a.uri)&&(D.undefined(a.languageId)||D.string(a.languageId))&&D.uinteger(a.lineCount)&&D.func(a.getText)&&D.func(a.positionAt)&&D.func(a.offsetAt))}n.is=e;function r(s,a){let l=s.getText(),f=i(a,(b,C)=>{let S=b.range.start.line-C.range.start.line;return S===0?b.range.start.character-C.range.start.character:S}),h=l.length;for(let b=f.length-1;b>=0;b--){let C=f[b],S=s.offsetAt(C.range.start),T=s.offsetAt(C.range.end);if(T<=h)l=l.substring(0,S)+C.newText+l.substring(T,l.length);else throw new Error("Overlapping edit");h=S}return l}n.applyEdits=r;function i(s,a){if(s.length<=1)return s;let l=s.length/2|0,f=s.slice(0,l),h=s.slice(l);i(f,a),i(h,a);let b=0,C=0,S=0;for(;b<f.length&&C<h.length;)a(f[b],h[C])<=0?s[S++]=f[b++]:s[S++]=h[C++];for(;b<f.length;)s[S++]=f[b++];for(;C<h.length;)s[S++]=h[C++];return s}})(Ec||(Ec={}));qc=class{constructor(t,e,r,i){this._uri=t,this._languageId=e,this._version=r,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(t){if(t){let e=this.offsetAt(t.start),r=this.offsetAt(t.end);return this._content.substring(e,r)}return this._content}update(t,e){this._content=t.text,this._version=e,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let t=[],e=this._content,r=!0;for(let i=0;i<e.length;i++){r&&(t.push(i),r=!1);let s=e.charAt(i);r=s==="\r"||s===`
`,s==="\r"&&i+1<e.length&&e.charAt(i+1)===`
`&&i++}r&&e.length>0&&t.push(e.length),this._lineOffsets=t}return this._lineOffsets}positionAt(t){t=Math.max(Math.min(t,this._content.length),0);let e=this.getLineOffsets(),r=0,i=e.length;if(i===0)return We.create(0,t);for(;r<i;){let a=Math.floor((r+i)/2);e[a]>t?i=a:r=a+1}let s=r-1;return We.create(s,t-e[s])}offsetAt(t){let e=this.getLineOffsets();if(t.line>=e.length)return this._content.length;if(t.line<0)return 0;let r=e[t.line],i=t.line+1<e.length?e[t.line+1]:this._content.length;return Math.max(Math.min(r+t.character,i),r)}get lineCount(){return this.getLineOffsets().length}};(function(n){let t=Object.prototype.toString;function e(T){return typeof T<"u"}n.defined=e;function r(T){return typeof T>"u"}n.undefined=r;function i(T){return T===!0||T===!1}n.boolean=i;function s(T){return t.call(T)==="[object String]"}n.string=s;function a(T){return t.call(T)==="[object Number]"}n.number=a;function l(T,z,Y){return t.call(T)==="[object Number]"&&z<=T&&T<=Y}n.numberRange=l;function f(T){return t.call(T)==="[object Number]"&&-2147483648<=T&&T<=2147483647}n.integer=f;function h(T){return t.call(T)==="[object Number]"&&0<=T&&T<=2147483647}n.uinteger=h;function b(T){return t.call(T)==="[object Function]"}n.func=b;function C(T){return T!==null&&typeof T=="object"}n.objectLiteral=C;function S(T,z){return Array.isArray(T)&&T.every(z)}n.typedArray=S})(D||(D={}))});var ue=N(Oe=>{"use strict";Object.defineProperty(Oe,"__esModule",{value:!0});Oe.ProtocolNotificationType=Oe.ProtocolNotificationType0=Oe.ProtocolRequestType=Oe.ProtocolRequestType0=Oe.RegistrationType=Oe.MessageDirection=void 0;var Cn=Gt(),Fl;(function(n){n.clientToServer="clientToServer",n.serverToClient="serverToClient",n.both="both"})(Fl||(Oe.MessageDirection=Fl={}));var $c=class{constructor(t){this.method=t}};Oe.RegistrationType=$c;var Oc=class extends Cn.RequestType0{constructor(t){super(t)}};Oe.ProtocolRequestType0=Oc;var Mc=class extends Cn.RequestType{constructor(t){super(t,Cn.ParameterStructures.byName)}};Oe.ProtocolRequestType=Mc;var Lc=class extends Cn.NotificationType0{constructor(t){super(t)}};Oe.ProtocolNotificationType0=Lc;var Nc=class extends Cn.NotificationType{constructor(t){super(t,Cn.ParameterStructures.byName)}};Oe.ProtocolNotificationType=Nc});var Bi=N(be=>{"use strict";Object.defineProperty(be,"__esModule",{value:!0});be.objectLiteral=be.typedArray=be.stringArray=be.array=be.func=be.error=be.number=be.string=be.boolean=void 0;function qv(n){return n===!0||n===!1}be.boolean=qv;function zl(n){return typeof n=="string"||n instanceof String}be.string=zl;function $v(n){return typeof n=="number"||n instanceof Number}be.number=$v;function Ov(n){return n instanceof Error}be.error=Ov;function Mv(n){return typeof n=="function"}be.func=Mv;function Bl(n){return Array.isArray(n)}be.array=Bl;function Lv(n){return Bl(n)&&n.every(t=>zl(t))}be.stringArray=Lv;function Nv(n,t){return Array.isArray(n)&&n.every(t)}be.typedArray=Nv;function kv(n){return n!==null&&typeof n=="object"}be.objectLiteral=kv});var Wl=N(Ui=>{"use strict";Object.defineProperty(Ui,"__esModule",{value:!0});Ui.ImplementationRequest=void 0;var Ul=ue(),Hl;(function(n){n.method="textDocument/implementation",n.messageDirection=Ul.MessageDirection.clientToServer,n.type=new Ul.ProtocolRequestType(n.method)})(Hl||(Ui.ImplementationRequest=Hl={}))});var Xl=N(Hi=>{"use strict";Object.defineProperty(Hi,"__esModule",{value:!0});Hi.TypeDefinitionRequest=void 0;var Vl=ue(),Gl;(function(n){n.method="textDocument/typeDefinition",n.messageDirection=Vl.MessageDirection.clientToServer,n.type=new Vl.ProtocolRequestType(n.method)})(Gl||(Hi.TypeDefinitionRequest=Gl={}))});var Ql=N(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});Pn.DidChangeWorkspaceFoldersNotification=Pn.WorkspaceFoldersRequest=void 0;var Wi=ue(),Yl;(function(n){n.method="workspace/workspaceFolders",n.messageDirection=Wi.MessageDirection.serverToClient,n.type=new Wi.ProtocolRequestType0(n.method)})(Yl||(Pn.WorkspaceFoldersRequest=Yl={}));var Jl;(function(n){n.method="workspace/didChangeWorkspaceFolders",n.messageDirection=Wi.MessageDirection.clientToServer,n.type=new Wi.ProtocolNotificationType(n.method)})(Jl||(Pn.DidChangeWorkspaceFoldersNotification=Jl={}))});var ef=N(Vi=>{"use strict";Object.defineProperty(Vi,"__esModule",{value:!0});Vi.ConfigurationRequest=void 0;var Zl=ue(),Kl;(function(n){n.method="workspace/configuration",n.messageDirection=Zl.MessageDirection.serverToClient,n.type=new Zl.ProtocolRequestType(n.method)})(Kl||(Vi.ConfigurationRequest=Kl={}))});var rf=N(Tn=>{"use strict";Object.defineProperty(Tn,"__esModule",{value:!0});Tn.ColorPresentationRequest=Tn.DocumentColorRequest=void 0;var Gi=ue(),tf;(function(n){n.method="textDocument/documentColor",n.messageDirection=Gi.MessageDirection.clientToServer,n.type=new Gi.ProtocolRequestType(n.method)})(tf||(Tn.DocumentColorRequest=tf={}));var nf;(function(n){n.method="textDocument/colorPresentation",n.messageDirection=Gi.MessageDirection.clientToServer,n.type=new Gi.ProtocolRequestType(n.method)})(nf||(Tn.ColorPresentationRequest=nf={}))});var af=N(En=>{"use strict";Object.defineProperty(En,"__esModule",{value:!0});En.FoldingRangeRefreshRequest=En.FoldingRangeRequest=void 0;var Xi=ue(),sf;(function(n){n.method="textDocument/foldingRange",n.messageDirection=Xi.MessageDirection.clientToServer,n.type=new Xi.ProtocolRequestType(n.method)})(sf||(En.FoldingRangeRequest=sf={}));var of;(function(n){n.method="workspace/foldingRange/refresh",n.messageDirection=Xi.MessageDirection.serverToClient,n.type=new Xi.ProtocolRequestType0(n.method)})(of||(En.FoldingRangeRefreshRequest=of={}))});var lf=N(Yi=>{"use strict";Object.defineProperty(Yi,"__esModule",{value:!0});Yi.DeclarationRequest=void 0;var cf=ue(),uf;(function(n){n.method="textDocument/declaration",n.messageDirection=cf.MessageDirection.clientToServer,n.type=new cf.ProtocolRequestType(n.method)})(uf||(Yi.DeclarationRequest=uf={}))});var pf=N(Ji=>{"use strict";Object.defineProperty(Ji,"__esModule",{value:!0});Ji.SelectionRangeRequest=void 0;var ff=ue(),df;(function(n){n.method="textDocument/selectionRange",n.messageDirection=ff.MessageDirection.clientToServer,n.type=new ff.ProtocolRequestType(n.method)})(df||(Ji.SelectionRangeRequest=df={}))});var yf=N(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.WorkDoneProgressCancelNotification=Mt.WorkDoneProgressCreateRequest=Mt.WorkDoneProgress=void 0;var Iv=Gt(),Qi=ue(),hf;(function(n){n.type=new Iv.ProgressType;function t(e){return e===n.type}n.is=t})(hf||(Mt.WorkDoneProgress=hf={}));var mf;(function(n){n.method="window/workDoneProgress/create",n.messageDirection=Qi.MessageDirection.serverToClient,n.type=new Qi.ProtocolRequestType(n.method)})(mf||(Mt.WorkDoneProgressCreateRequest=mf={}));var gf;(function(n){n.method="window/workDoneProgress/cancel",n.messageDirection=Qi.MessageDirection.clientToServer,n.type=new Qi.ProtocolNotificationType(n.method)})(gf||(Mt.WorkDoneProgressCancelNotification=gf={}))});var xf=N(Lt=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.CallHierarchyOutgoingCallsRequest=Lt.CallHierarchyIncomingCallsRequest=Lt.CallHierarchyPrepareRequest=void 0;var qn=ue(),vf;(function(n){n.method="textDocument/prepareCallHierarchy",n.messageDirection=qn.MessageDirection.clientToServer,n.type=new qn.ProtocolRequestType(n.method)})(vf||(Lt.CallHierarchyPrepareRequest=vf={}));var bf;(function(n){n.method="callHierarchy/incomingCalls",n.messageDirection=qn.MessageDirection.clientToServer,n.type=new qn.ProtocolRequestType(n.method)})(bf||(Lt.CallHierarchyIncomingCallsRequest=bf={}));var Df;(function(n){n.method="callHierarchy/outgoingCalls",n.messageDirection=qn.MessageDirection.clientToServer,n.type=new qn.ProtocolRequestType(n.method)})(Df||(Lt.CallHierarchyOutgoingCallsRequest=Df={}))});var Pf=N(Me=>{"use strict";Object.defineProperty(Me,"__esModule",{value:!0});Me.SemanticTokensRefreshRequest=Me.SemanticTokensRangeRequest=Me.SemanticTokensDeltaRequest=Me.SemanticTokensRequest=Me.SemanticTokensRegistrationType=Me.TokenFormat=void 0;var xt=ue(),Rf;(function(n){n.Relative="relative"})(Rf||(Me.TokenFormat=Rf={}));var vr;(function(n){n.method="textDocument/semanticTokens",n.type=new xt.RegistrationType(n.method)})(vr||(Me.SemanticTokensRegistrationType=vr={}));var _f;(function(n){n.method="textDocument/semanticTokens/full",n.messageDirection=xt.MessageDirection.clientToServer,n.type=new xt.ProtocolRequestType(n.method),n.registrationMethod=vr.method})(_f||(Me.SemanticTokensRequest=_f={}));var Sf;(function(n){n.method="textDocument/semanticTokens/full/delta",n.messageDirection=xt.MessageDirection.clientToServer,n.type=new xt.ProtocolRequestType(n.method),n.registrationMethod=vr.method})(Sf||(Me.SemanticTokensDeltaRequest=Sf={}));var wf;(function(n){n.method="textDocument/semanticTokens/range",n.messageDirection=xt.MessageDirection.clientToServer,n.type=new xt.ProtocolRequestType(n.method),n.registrationMethod=vr.method})(wf||(Me.SemanticTokensRangeRequest=wf={}));var Cf;(function(n){n.method="workspace/semanticTokens/refresh",n.messageDirection=xt.MessageDirection.serverToClient,n.type=new xt.ProtocolRequestType0(n.method)})(Cf||(Me.SemanticTokensRefreshRequest=Cf={}))});var qf=N(Zi=>{"use strict";Object.defineProperty(Zi,"__esModule",{value:!0});Zi.ShowDocumentRequest=void 0;var Tf=ue(),Ef;(function(n){n.method="window/showDocument",n.messageDirection=Tf.MessageDirection.serverToClient,n.type=new Tf.ProtocolRequestType(n.method)})(Ef||(Zi.ShowDocumentRequest=Ef={}))});var Mf=N(Ki=>{"use strict";Object.defineProperty(Ki,"__esModule",{value:!0});Ki.LinkedEditingRangeRequest=void 0;var $f=ue(),Of;(function(n){n.method="textDocument/linkedEditingRange",n.messageDirection=$f.MessageDirection.clientToServer,n.type=new $f.ProtocolRequestType(n.method)})(Of||(Ki.LinkedEditingRangeRequest=Of={}))});var zf=N(Pe=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.WillDeleteFilesRequest=Pe.DidDeleteFilesNotification=Pe.DidRenameFilesNotification=Pe.WillRenameFilesRequest=Pe.DidCreateFilesNotification=Pe.WillCreateFilesRequest=Pe.FileOperationPatternKind=void 0;var Ve=ue(),Lf;(function(n){n.file="file",n.folder="folder"})(Lf||(Pe.FileOperationPatternKind=Lf={}));var Nf;(function(n){n.method="workspace/willCreateFiles",n.messageDirection=Ve.MessageDirection.clientToServer,n.type=new Ve.ProtocolRequestType(n.method)})(Nf||(Pe.WillCreateFilesRequest=Nf={}));var kf;(function(n){n.method="workspace/didCreateFiles",n.messageDirection=Ve.MessageDirection.clientToServer,n.type=new Ve.ProtocolNotificationType(n.method)})(kf||(Pe.DidCreateFilesNotification=kf={}));var If;(function(n){n.method="workspace/willRenameFiles",n.messageDirection=Ve.MessageDirection.clientToServer,n.type=new Ve.ProtocolRequestType(n.method)})(If||(Pe.WillRenameFilesRequest=If={}));var Af;(function(n){n.method="workspace/didRenameFiles",n.messageDirection=Ve.MessageDirection.clientToServer,n.type=new Ve.ProtocolNotificationType(n.method)})(Af||(Pe.DidRenameFilesNotification=Af={}));var jf;(function(n){n.method="workspace/didDeleteFiles",n.messageDirection=Ve.MessageDirection.clientToServer,n.type=new Ve.ProtocolNotificationType(n.method)})(jf||(Pe.DidDeleteFilesNotification=jf={}));var Ff;(function(n){n.method="workspace/willDeleteFiles",n.messageDirection=Ve.MessageDirection.clientToServer,n.type=new Ve.ProtocolRequestType(n.method)})(Ff||(Pe.WillDeleteFilesRequest=Ff={}))});var Vf=N(Nt=>{"use strict";Object.defineProperty(Nt,"__esModule",{value:!0});Nt.MonikerRequest=Nt.MonikerKind=Nt.UniquenessLevel=void 0;var Bf=ue(),Uf;(function(n){n.document="document",n.project="project",n.group="group",n.scheme="scheme",n.global="global"})(Uf||(Nt.UniquenessLevel=Uf={}));var Hf;(function(n){n.$import="import",n.$export="export",n.local="local"})(Hf||(Nt.MonikerKind=Hf={}));var Wf;(function(n){n.method="textDocument/moniker",n.messageDirection=Bf.MessageDirection.clientToServer,n.type=new Bf.ProtocolRequestType(n.method)})(Wf||(Nt.MonikerRequest=Wf={}))});var Jf=N(kt=>{"use strict";Object.defineProperty(kt,"__esModule",{value:!0});kt.TypeHierarchySubtypesRequest=kt.TypeHierarchySupertypesRequest=kt.TypeHierarchyPrepareRequest=void 0;var $n=ue(),Gf;(function(n){n.method="textDocument/prepareTypeHierarchy",n.messageDirection=$n.MessageDirection.clientToServer,n.type=new $n.ProtocolRequestType(n.method)})(Gf||(kt.TypeHierarchyPrepareRequest=Gf={}));var Xf;(function(n){n.method="typeHierarchy/supertypes",n.messageDirection=$n.MessageDirection.clientToServer,n.type=new $n.ProtocolRequestType(n.method)})(Xf||(kt.TypeHierarchySupertypesRequest=Xf={}));var Yf;(function(n){n.method="typeHierarchy/subtypes",n.messageDirection=$n.MessageDirection.clientToServer,n.type=new $n.ProtocolRequestType(n.method)})(Yf||(kt.TypeHierarchySubtypesRequest=Yf={}))});var Kf=N(On=>{"use strict";Object.defineProperty(On,"__esModule",{value:!0});On.InlineValueRefreshRequest=On.InlineValueRequest=void 0;var es=ue(),Qf;(function(n){n.method="textDocument/inlineValue",n.messageDirection=es.MessageDirection.clientToServer,n.type=new es.ProtocolRequestType(n.method)})(Qf||(On.InlineValueRequest=Qf={}));var Zf;(function(n){n.method="workspace/inlineValue/refresh",n.messageDirection=es.MessageDirection.serverToClient,n.type=new es.ProtocolRequestType0(n.method)})(Zf||(On.InlineValueRefreshRequest=Zf={}))});var rd=N(It=>{"use strict";Object.defineProperty(It,"__esModule",{value:!0});It.InlayHintRefreshRequest=It.InlayHintResolveRequest=It.InlayHintRequest=void 0;var Mn=ue(),ed;(function(n){n.method="textDocument/inlayHint",n.messageDirection=Mn.MessageDirection.clientToServer,n.type=new Mn.ProtocolRequestType(n.method)})(ed||(It.InlayHintRequest=ed={}));var td;(function(n){n.method="inlayHint/resolve",n.messageDirection=Mn.MessageDirection.clientToServer,n.type=new Mn.ProtocolRequestType(n.method)})(td||(It.InlayHintResolveRequest=td={}));var nd;(function(n){n.method="workspace/inlayHint/refresh",n.messageDirection=Mn.MessageDirection.serverToClient,n.type=new Mn.ProtocolRequestType0(n.method)})(nd||(It.InlayHintRefreshRequest=nd={}))});var ld=N(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.DiagnosticRefreshRequest=Ge.WorkspaceDiagnosticRequest=Ge.DocumentDiagnosticRequest=Ge.DocumentDiagnosticReportKind=Ge.DiagnosticServerCancellationData=void 0;var ud=Gt(),Av=Bi(),Ln=ue(),id;(function(n){function t(e){let r=e;return r&&Av.boolean(r.retriggerRequest)}n.is=t})(id||(Ge.DiagnosticServerCancellationData=id={}));var sd;(function(n){n.Full="full",n.Unchanged="unchanged"})(sd||(Ge.DocumentDiagnosticReportKind=sd={}));var od;(function(n){n.method="textDocument/diagnostic",n.messageDirection=Ln.MessageDirection.clientToServer,n.type=new Ln.ProtocolRequestType(n.method),n.partialResult=new ud.ProgressType})(od||(Ge.DocumentDiagnosticRequest=od={}));var ad;(function(n){n.method="workspace/diagnostic",n.messageDirection=Ln.MessageDirection.clientToServer,n.type=new Ln.ProtocolRequestType(n.method),n.partialResult=new ud.ProgressType})(ad||(Ge.WorkspaceDiagnosticRequest=ad={}));var cd;(function(n){n.method="workspace/diagnostic/refresh",n.messageDirection=Ln.MessageDirection.serverToClient,n.type=new Ln.ProtocolRequestType0(n.method)})(cd||(Ge.DiagnosticRefreshRequest=cd={}))});var yd=N(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.DidCloseNotebookDocumentNotification=he.DidSaveNotebookDocumentNotification=he.DidChangeNotebookDocumentNotification=he.NotebookCellArrayChange=he.DidOpenNotebookDocumentNotification=he.NotebookDocumentSyncRegistrationType=he.NotebookDocument=he.NotebookCell=he.ExecutionSummary=he.NotebookCellKind=void 0;var br=(yr(),bo(zi)),nt=Bi(),lt=ue(),kc;(function(n){n.Markup=1,n.Code=2;function t(e){return e===1||e===2}n.is=t})(kc||(he.NotebookCellKind=kc={}));var Ic;(function(n){function t(i,s){let a={executionOrder:i};return(s===!0||s===!1)&&(a.success=s),a}n.create=t;function e(i){let s=i;return nt.objectLiteral(s)&&br.uinteger.is(s.executionOrder)&&(s.success===void 0||nt.boolean(s.success))}n.is=e;function r(i,s){return i===s?!0:i==null||s===null||s===void 0?!1:i.executionOrder===s.executionOrder&&i.success===s.success}n.equals=r})(Ic||(he.ExecutionSummary=Ic={}));var ts;(function(n){function t(s,a){return{kind:s,document:a}}n.create=t;function e(s){let a=s;return nt.objectLiteral(a)&&kc.is(a.kind)&&br.DocumentUri.is(a.document)&&(a.metadata===void 0||nt.objectLiteral(a.metadata))}n.is=e;function r(s,a){let l=new Set;return s.document!==a.document&&l.add("document"),s.kind!==a.kind&&l.add("kind"),s.executionSummary!==a.executionSummary&&l.add("executionSummary"),(s.metadata!==void 0||a.metadata!==void 0)&&!i(s.metadata,a.metadata)&&l.add("metadata"),(s.executionSummary!==void 0||a.executionSummary!==void 0)&&!Ic.equals(s.executionSummary,a.executionSummary)&&l.add("executionSummary"),l}n.diff=r;function i(s,a){if(s===a)return!0;if(s==null||a===null||a===void 0||typeof s!=typeof a||typeof s!="object")return!1;let l=Array.isArray(s),f=Array.isArray(a);if(l!==f)return!1;if(l&&f){if(s.length!==a.length)return!1;for(let h=0;h<s.length;h++)if(!i(s[h],a[h]))return!1}if(nt.objectLiteral(s)&&nt.objectLiteral(a)){let h=Object.keys(s),b=Object.keys(a);if(h.length!==b.length||(h.sort(),b.sort(),!i(h,b)))return!1;for(let C=0;C<h.length;C++){let S=h[C];if(!i(s[S],a[S]))return!1}}return!0}})(ts||(he.NotebookCell=ts={}));var fd;(function(n){function t(r,i,s,a){return{uri:r,notebookType:i,version:s,cells:a}}n.create=t;function e(r){let i=r;return nt.objectLiteral(i)&&nt.string(i.uri)&&br.integer.is(i.version)&&nt.typedArray(i.cells,ts.is)}n.is=e})(fd||(he.NotebookDocument=fd={}));var Nn;(function(n){n.method="notebookDocument/sync",n.messageDirection=lt.MessageDirection.clientToServer,n.type=new lt.RegistrationType(n.method)})(Nn||(he.NotebookDocumentSyncRegistrationType=Nn={}));var dd;(function(n){n.method="notebookDocument/didOpen",n.messageDirection=lt.MessageDirection.clientToServer,n.type=new lt.ProtocolNotificationType(n.method),n.registrationMethod=Nn.method})(dd||(he.DidOpenNotebookDocumentNotification=dd={}));var pd;(function(n){function t(r){let i=r;return nt.objectLiteral(i)&&br.uinteger.is(i.start)&&br.uinteger.is(i.deleteCount)&&(i.cells===void 0||nt.typedArray(i.cells,ts.is))}n.is=t;function e(r,i,s){let a={start:r,deleteCount:i};return s!==void 0&&(a.cells=s),a}n.create=e})(pd||(he.NotebookCellArrayChange=pd={}));var hd;(function(n){n.method="notebookDocument/didChange",n.messageDirection=lt.MessageDirection.clientToServer,n.type=new lt.ProtocolNotificationType(n.method),n.registrationMethod=Nn.method})(hd||(he.DidChangeNotebookDocumentNotification=hd={}));var md;(function(n){n.method="notebookDocument/didSave",n.messageDirection=lt.MessageDirection.clientToServer,n.type=new lt.ProtocolNotificationType(n.method),n.registrationMethod=Nn.method})(md||(he.DidSaveNotebookDocumentNotification=md={}));var gd;(function(n){n.method="notebookDocument/didClose",n.messageDirection=lt.MessageDirection.clientToServer,n.type=new lt.ProtocolNotificationType(n.method),n.registrationMethod=Nn.method})(gd||(he.DidCloseNotebookDocumentNotification=gd={}))});var Dd=N(ns=>{"use strict";Object.defineProperty(ns,"__esModule",{value:!0});ns.InlineCompletionRequest=void 0;var vd=ue(),bd;(function(n){n.method="textDocument/inlineCompletion",n.messageDirection=vd.MessageDirection.clientToServer,n.type=new vd.ProtocolRequestType(n.method)})(bd||(ns.InlineCompletionRequest=bd={}))});var Mp=N(m=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});m.WorkspaceSymbolRequest=m.CodeActionResolveRequest=m.CodeActionRequest=m.DocumentSymbolRequest=m.DocumentHighlightRequest=m.ReferencesRequest=m.DefinitionRequest=m.SignatureHelpRequest=m.SignatureHelpTriggerKind=m.HoverRequest=m.CompletionResolveRequest=m.CompletionRequest=m.CompletionTriggerKind=m.PublishDiagnosticsNotification=m.WatchKind=m.RelativePattern=m.FileChangeType=m.DidChangeWatchedFilesNotification=m.WillSaveTextDocumentWaitUntilRequest=m.WillSaveTextDocumentNotification=m.TextDocumentSaveReason=m.DidSaveTextDocumentNotification=m.DidCloseTextDocumentNotification=m.DidChangeTextDocumentNotification=m.TextDocumentContentChangeEvent=m.DidOpenTextDocumentNotification=m.TextDocumentSyncKind=m.TelemetryEventNotification=m.LogMessageNotification=m.ShowMessageRequest=m.ShowMessageNotification=m.MessageType=m.DidChangeConfigurationNotification=m.ExitNotification=m.ShutdownRequest=m.InitializedNotification=m.InitializeErrorCodes=m.InitializeRequest=m.WorkDoneProgressOptions=m.TextDocumentRegistrationOptions=m.StaticRegistrationOptions=m.PositionEncodingKind=m.FailureHandlingKind=m.ResourceOperationKind=m.UnregistrationRequest=m.RegistrationRequest=m.DocumentSelector=m.NotebookCellTextDocumentFilter=m.NotebookDocumentFilter=m.TextDocumentFilter=void 0;m.MonikerRequest=m.MonikerKind=m.UniquenessLevel=m.WillDeleteFilesRequest=m.DidDeleteFilesNotification=m.WillRenameFilesRequest=m.DidRenameFilesNotification=m.WillCreateFilesRequest=m.DidCreateFilesNotification=m.FileOperationPatternKind=m.LinkedEditingRangeRequest=m.ShowDocumentRequest=m.SemanticTokensRegistrationType=m.SemanticTokensRefreshRequest=m.SemanticTokensRangeRequest=m.SemanticTokensDeltaRequest=m.SemanticTokensRequest=m.TokenFormat=m.CallHierarchyPrepareRequest=m.CallHierarchyOutgoingCallsRequest=m.CallHierarchyIncomingCallsRequest=m.WorkDoneProgressCancelNotification=m.WorkDoneProgressCreateRequest=m.WorkDoneProgress=m.SelectionRangeRequest=m.DeclarationRequest=m.FoldingRangeRefreshRequest=m.FoldingRangeRequest=m.ColorPresentationRequest=m.DocumentColorRequest=m.ConfigurationRequest=m.DidChangeWorkspaceFoldersNotification=m.WorkspaceFoldersRequest=m.TypeDefinitionRequest=m.ImplementationRequest=m.ApplyWorkspaceEditRequest=m.ExecuteCommandRequest=m.PrepareRenameRequest=m.RenameRequest=m.PrepareSupportDefaultBehavior=m.DocumentOnTypeFormattingRequest=m.DocumentRangesFormattingRequest=m.DocumentRangeFormattingRequest=m.DocumentFormattingRequest=m.DocumentLinkResolveRequest=m.DocumentLinkRequest=m.CodeLensRefreshRequest=m.CodeLensResolveRequest=m.CodeLensRequest=m.WorkspaceSymbolResolveRequest=void 0;m.InlineCompletionRequest=m.DidCloseNotebookDocumentNotification=m.DidSaveNotebookDocumentNotification=m.DidChangeNotebookDocumentNotification=m.NotebookCellArrayChange=m.DidOpenNotebookDocumentNotification=m.NotebookDocumentSyncRegistrationType=m.NotebookDocument=m.NotebookCell=m.ExecutionSummary=m.NotebookCellKind=m.DiagnosticRefreshRequest=m.WorkspaceDiagnosticRequest=m.DocumentDiagnosticRequest=m.DocumentDiagnosticReportKind=m.DiagnosticServerCancellationData=m.InlayHintRefreshRequest=m.InlayHintResolveRequest=m.InlayHintRequest=m.InlineValueRefreshRequest=m.InlineValueRequest=m.TypeHierarchySupertypesRequest=m.TypeHierarchySubtypesRequest=m.TypeHierarchyPrepareRequest=void 0;var q=ue(),xd=(yr(),bo(zi)),xe=Bi(),jv=Wl();Object.defineProperty(m,"ImplementationRequest",{enumerable:!0,get:function(){return jv.ImplementationRequest}});var Fv=Xl();Object.defineProperty(m,"TypeDefinitionRequest",{enumerable:!0,get:function(){return Fv.TypeDefinitionRequest}});var Ep=Ql();Object.defineProperty(m,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return Ep.WorkspaceFoldersRequest}});Object.defineProperty(m,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return Ep.DidChangeWorkspaceFoldersNotification}});var zv=ef();Object.defineProperty(m,"ConfigurationRequest",{enumerable:!0,get:function(){return zv.ConfigurationRequest}});var qp=rf();Object.defineProperty(m,"DocumentColorRequest",{enumerable:!0,get:function(){return qp.DocumentColorRequest}});Object.defineProperty(m,"ColorPresentationRequest",{enumerable:!0,get:function(){return qp.ColorPresentationRequest}});var $p=af();Object.defineProperty(m,"FoldingRangeRequest",{enumerable:!0,get:function(){return $p.FoldingRangeRequest}});Object.defineProperty(m,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return $p.FoldingRangeRefreshRequest}});var Bv=lf();Object.defineProperty(m,"DeclarationRequest",{enumerable:!0,get:function(){return Bv.DeclarationRequest}});var Uv=pf();Object.defineProperty(m,"SelectionRangeRequest",{enumerable:!0,get:function(){return Uv.SelectionRangeRequest}});var Bc=yf();Object.defineProperty(m,"WorkDoneProgress",{enumerable:!0,get:function(){return Bc.WorkDoneProgress}});Object.defineProperty(m,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return Bc.WorkDoneProgressCreateRequest}});Object.defineProperty(m,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return Bc.WorkDoneProgressCancelNotification}});var Uc=xf();Object.defineProperty(m,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return Uc.CallHierarchyIncomingCallsRequest}});Object.defineProperty(m,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return Uc.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(m,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return Uc.CallHierarchyPrepareRequest}});var kn=Pf();Object.defineProperty(m,"TokenFormat",{enumerable:!0,get:function(){return kn.TokenFormat}});Object.defineProperty(m,"SemanticTokensRequest",{enumerable:!0,get:function(){return kn.SemanticTokensRequest}});Object.defineProperty(m,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return kn.SemanticTokensDeltaRequest}});Object.defineProperty(m,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return kn.SemanticTokensRangeRequest}});Object.defineProperty(m,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return kn.SemanticTokensRefreshRequest}});Object.defineProperty(m,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return kn.SemanticTokensRegistrationType}});var Hv=qf();Object.defineProperty(m,"ShowDocumentRequest",{enumerable:!0,get:function(){return Hv.ShowDocumentRequest}});var Wv=Mf();Object.defineProperty(m,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return Wv.LinkedEditingRangeRequest}});var Qt=zf();Object.defineProperty(m,"FileOperationPatternKind",{enumerable:!0,get:function(){return Qt.FileOperationPatternKind}});Object.defineProperty(m,"DidCreateFilesNotification",{enumerable:!0,get:function(){return Qt.DidCreateFilesNotification}});Object.defineProperty(m,"WillCreateFilesRequest",{enumerable:!0,get:function(){return Qt.WillCreateFilesRequest}});Object.defineProperty(m,"DidRenameFilesNotification",{enumerable:!0,get:function(){return Qt.DidRenameFilesNotification}});Object.defineProperty(m,"WillRenameFilesRequest",{enumerable:!0,get:function(){return Qt.WillRenameFilesRequest}});Object.defineProperty(m,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return Qt.DidDeleteFilesNotification}});Object.defineProperty(m,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return Qt.WillDeleteFilesRequest}});var Hc=Vf();Object.defineProperty(m,"UniquenessLevel",{enumerable:!0,get:function(){return Hc.UniquenessLevel}});Object.defineProperty(m,"MonikerKind",{enumerable:!0,get:function(){return Hc.MonikerKind}});Object.defineProperty(m,"MonikerRequest",{enumerable:!0,get:function(){return Hc.MonikerRequest}});var Wc=Jf();Object.defineProperty(m,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return Wc.TypeHierarchyPrepareRequest}});Object.defineProperty(m,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return Wc.TypeHierarchySubtypesRequest}});Object.defineProperty(m,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return Wc.TypeHierarchySupertypesRequest}});var Op=Kf();Object.defineProperty(m,"InlineValueRequest",{enumerable:!0,get:function(){return Op.InlineValueRequest}});Object.defineProperty(m,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return Op.InlineValueRefreshRequest}});var Vc=rd();Object.defineProperty(m,"InlayHintRequest",{enumerable:!0,get:function(){return Vc.InlayHintRequest}});Object.defineProperty(m,"InlayHintResolveRequest",{enumerable:!0,get:function(){return Vc.InlayHintResolveRequest}});Object.defineProperty(m,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return Vc.InlayHintRefreshRequest}});var Dr=ld();Object.defineProperty(m,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return Dr.DiagnosticServerCancellationData}});Object.defineProperty(m,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return Dr.DocumentDiagnosticReportKind}});Object.defineProperty(m,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return Dr.DocumentDiagnosticRequest}});Object.defineProperty(m,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return Dr.WorkspaceDiagnosticRequest}});Object.defineProperty(m,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return Dr.DiagnosticRefreshRequest}});var ft=yd();Object.defineProperty(m,"NotebookCellKind",{enumerable:!0,get:function(){return ft.NotebookCellKind}});Object.defineProperty(m,"ExecutionSummary",{enumerable:!0,get:function(){return ft.ExecutionSummary}});Object.defineProperty(m,"NotebookCell",{enumerable:!0,get:function(){return ft.NotebookCell}});Object.defineProperty(m,"NotebookDocument",{enumerable:!0,get:function(){return ft.NotebookDocument}});Object.defineProperty(m,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return ft.NotebookDocumentSyncRegistrationType}});Object.defineProperty(m,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return ft.DidOpenNotebookDocumentNotification}});Object.defineProperty(m,"NotebookCellArrayChange",{enumerable:!0,get:function(){return ft.NotebookCellArrayChange}});Object.defineProperty(m,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return ft.DidChangeNotebookDocumentNotification}});Object.defineProperty(m,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return ft.DidSaveNotebookDocumentNotification}});Object.defineProperty(m,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return ft.DidCloseNotebookDocumentNotification}});var Vv=Dd();Object.defineProperty(m,"InlineCompletionRequest",{enumerable:!0,get:function(){return Vv.InlineCompletionRequest}});var Ac;(function(n){function t(e){let r=e;return xe.string(r)||xe.string(r.language)||xe.string(r.scheme)||xe.string(r.pattern)}n.is=t})(Ac||(m.TextDocumentFilter=Ac={}));var jc;(function(n){function t(e){let r=e;return xe.objectLiteral(r)&&(xe.string(r.notebookType)||xe.string(r.scheme)||xe.string(r.pattern))}n.is=t})(jc||(m.NotebookDocumentFilter=jc={}));var Fc;(function(n){function t(e){let r=e;return xe.objectLiteral(r)&&(xe.string(r.notebook)||jc.is(r.notebook))&&(r.language===void 0||xe.string(r.language))}n.is=t})(Fc||(m.NotebookCellTextDocumentFilter=Fc={}));var zc;(function(n){function t(e){if(!Array.isArray(e))return!1;for(let r of e)if(!xe.string(r)&&!Ac.is(r)&&!Fc.is(r))return!1;return!0}n.is=t})(zc||(m.DocumentSelector=zc={}));var Rd;(function(n){n.method="client/registerCapability",n.messageDirection=q.MessageDirection.serverToClient,n.type=new q.ProtocolRequestType(n.method)})(Rd||(m.RegistrationRequest=Rd={}));var _d;(function(n){n.method="client/unregisterCapability",n.messageDirection=q.MessageDirection.serverToClient,n.type=new q.ProtocolRequestType(n.method)})(_d||(m.UnregistrationRequest=_d={}));var Sd;(function(n){n.Create="create",n.Rename="rename",n.Delete="delete"})(Sd||(m.ResourceOperationKind=Sd={}));var wd;(function(n){n.Abort="abort",n.Transactional="transactional",n.TextOnlyTransactional="textOnlyTransactional",n.Undo="undo"})(wd||(m.FailureHandlingKind=wd={}));var Cd;(function(n){n.UTF8="utf-8",n.UTF16="utf-16",n.UTF32="utf-32"})(Cd||(m.PositionEncodingKind=Cd={}));var Pd;(function(n){function t(e){let r=e;return r&&xe.string(r.id)&&r.id.length>0}n.hasId=t})(Pd||(m.StaticRegistrationOptions=Pd={}));var Td;(function(n){function t(e){let r=e;return r&&(r.documentSelector===null||zc.is(r.documentSelector))}n.is=t})(Td||(m.TextDocumentRegistrationOptions=Td={}));var Ed;(function(n){function t(r){let i=r;return xe.objectLiteral(i)&&(i.workDoneProgress===void 0||xe.boolean(i.workDoneProgress))}n.is=t;function e(r){let i=r;return i&&xe.boolean(i.workDoneProgress)}n.hasWorkDoneProgress=e})(Ed||(m.WorkDoneProgressOptions=Ed={}));var qd;(function(n){n.method="initialize",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(qd||(m.InitializeRequest=qd={}));var $d;(function(n){n.unknownProtocolVersion=1})($d||(m.InitializeErrorCodes=$d={}));var Od;(function(n){n.method="initialized",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolNotificationType(n.method)})(Od||(m.InitializedNotification=Od={}));var Md;(function(n){n.method="shutdown",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType0(n.method)})(Md||(m.ShutdownRequest=Md={}));var Ld;(function(n){n.method="exit",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolNotificationType0(n.method)})(Ld||(m.ExitNotification=Ld={}));var Nd;(function(n){n.method="workspace/didChangeConfiguration",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolNotificationType(n.method)})(Nd||(m.DidChangeConfigurationNotification=Nd={}));var kd;(function(n){n.Error=1,n.Warning=2,n.Info=3,n.Log=4,n.Debug=5})(kd||(m.MessageType=kd={}));var Id;(function(n){n.method="window/showMessage",n.messageDirection=q.MessageDirection.serverToClient,n.type=new q.ProtocolNotificationType(n.method)})(Id||(m.ShowMessageNotification=Id={}));var Ad;(function(n){n.method="window/showMessageRequest",n.messageDirection=q.MessageDirection.serverToClient,n.type=new q.ProtocolRequestType(n.method)})(Ad||(m.ShowMessageRequest=Ad={}));var jd;(function(n){n.method="window/logMessage",n.messageDirection=q.MessageDirection.serverToClient,n.type=new q.ProtocolNotificationType(n.method)})(jd||(m.LogMessageNotification=jd={}));var Fd;(function(n){n.method="telemetry/event",n.messageDirection=q.MessageDirection.serverToClient,n.type=new q.ProtocolNotificationType(n.method)})(Fd||(m.TelemetryEventNotification=Fd={}));var zd;(function(n){n.None=0,n.Full=1,n.Incremental=2})(zd||(m.TextDocumentSyncKind=zd={}));var Bd;(function(n){n.method="textDocument/didOpen",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolNotificationType(n.method)})(Bd||(m.DidOpenTextDocumentNotification=Bd={}));var Ud;(function(n){function t(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}n.isIncremental=t;function e(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}n.isFull=e})(Ud||(m.TextDocumentContentChangeEvent=Ud={}));var Hd;(function(n){n.method="textDocument/didChange",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolNotificationType(n.method)})(Hd||(m.DidChangeTextDocumentNotification=Hd={}));var Wd;(function(n){n.method="textDocument/didClose",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolNotificationType(n.method)})(Wd||(m.DidCloseTextDocumentNotification=Wd={}));var Vd;(function(n){n.method="textDocument/didSave",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolNotificationType(n.method)})(Vd||(m.DidSaveTextDocumentNotification=Vd={}));var Gd;(function(n){n.Manual=1,n.AfterDelay=2,n.FocusOut=3})(Gd||(m.TextDocumentSaveReason=Gd={}));var Xd;(function(n){n.method="textDocument/willSave",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolNotificationType(n.method)})(Xd||(m.WillSaveTextDocumentNotification=Xd={}));var Yd;(function(n){n.method="textDocument/willSaveWaitUntil",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(Yd||(m.WillSaveTextDocumentWaitUntilRequest=Yd={}));var Jd;(function(n){n.method="workspace/didChangeWatchedFiles",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolNotificationType(n.method)})(Jd||(m.DidChangeWatchedFilesNotification=Jd={}));var Qd;(function(n){n.Created=1,n.Changed=2,n.Deleted=3})(Qd||(m.FileChangeType=Qd={}));var Zd;(function(n){function t(e){let r=e;return xe.objectLiteral(r)&&(xd.URI.is(r.baseUri)||xd.WorkspaceFolder.is(r.baseUri))&&xe.string(r.pattern)}n.is=t})(Zd||(m.RelativePattern=Zd={}));var Kd;(function(n){n.Create=1,n.Change=2,n.Delete=4})(Kd||(m.WatchKind=Kd={}));var ep;(function(n){n.method="textDocument/publishDiagnostics",n.messageDirection=q.MessageDirection.serverToClient,n.type=new q.ProtocolNotificationType(n.method)})(ep||(m.PublishDiagnosticsNotification=ep={}));var tp;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.TriggerForIncompleteCompletions=3})(tp||(m.CompletionTriggerKind=tp={}));var np;(function(n){n.method="textDocument/completion",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(np||(m.CompletionRequest=np={}));var rp;(function(n){n.method="completionItem/resolve",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(rp||(m.CompletionResolveRequest=rp={}));var ip;(function(n){n.method="textDocument/hover",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(ip||(m.HoverRequest=ip={}));var sp;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.ContentChange=3})(sp||(m.SignatureHelpTriggerKind=sp={}));var op;(function(n){n.method="textDocument/signatureHelp",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(op||(m.SignatureHelpRequest=op={}));var ap;(function(n){n.method="textDocument/definition",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(ap||(m.DefinitionRequest=ap={}));var cp;(function(n){n.method="textDocument/references",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(cp||(m.ReferencesRequest=cp={}));var up;(function(n){n.method="textDocument/documentHighlight",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(up||(m.DocumentHighlightRequest=up={}));var lp;(function(n){n.method="textDocument/documentSymbol",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(lp||(m.DocumentSymbolRequest=lp={}));var fp;(function(n){n.method="textDocument/codeAction",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(fp||(m.CodeActionRequest=fp={}));var dp;(function(n){n.method="codeAction/resolve",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(dp||(m.CodeActionResolveRequest=dp={}));var pp;(function(n){n.method="workspace/symbol",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(pp||(m.WorkspaceSymbolRequest=pp={}));var hp;(function(n){n.method="workspaceSymbol/resolve",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(hp||(m.WorkspaceSymbolResolveRequest=hp={}));var mp;(function(n){n.method="textDocument/codeLens",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(mp||(m.CodeLensRequest=mp={}));var gp;(function(n){n.method="codeLens/resolve",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(gp||(m.CodeLensResolveRequest=gp={}));var yp;(function(n){n.method="workspace/codeLens/refresh",n.messageDirection=q.MessageDirection.serverToClient,n.type=new q.ProtocolRequestType0(n.method)})(yp||(m.CodeLensRefreshRequest=yp={}));var vp;(function(n){n.method="textDocument/documentLink",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(vp||(m.DocumentLinkRequest=vp={}));var bp;(function(n){n.method="documentLink/resolve",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(bp||(m.DocumentLinkResolveRequest=bp={}));var Dp;(function(n){n.method="textDocument/formatting",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(Dp||(m.DocumentFormattingRequest=Dp={}));var xp;(function(n){n.method="textDocument/rangeFormatting",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(xp||(m.DocumentRangeFormattingRequest=xp={}));var Rp;(function(n){n.method="textDocument/rangesFormatting",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(Rp||(m.DocumentRangesFormattingRequest=Rp={}));var _p;(function(n){n.method="textDocument/onTypeFormatting",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(_p||(m.DocumentOnTypeFormattingRequest=_p={}));var Sp;(function(n){n.Identifier=1})(Sp||(m.PrepareSupportDefaultBehavior=Sp={}));var wp;(function(n){n.method="textDocument/rename",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(wp||(m.RenameRequest=wp={}));var Cp;(function(n){n.method="textDocument/prepareRename",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(Cp||(m.PrepareRenameRequest=Cp={}));var Pp;(function(n){n.method="workspace/executeCommand",n.messageDirection=q.MessageDirection.clientToServer,n.type=new q.ProtocolRequestType(n.method)})(Pp||(m.ExecuteCommandRequest=Pp={}));var Tp;(function(n){n.method="workspace/applyEdit",n.messageDirection=q.MessageDirection.serverToClient,n.type=new q.ProtocolRequestType("workspace/applyEdit")})(Tp||(m.ApplyWorkspaceEditRequest=Tp={}))});var Np=N(rs=>{"use strict";Object.defineProperty(rs,"__esModule",{value:!0});rs.createProtocolConnection=void 0;var Lp=Gt();function Gv(n,t,e,r){return Lp.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,Lp.createMessageConnection)(n,t,e,r)}rs.createProtocolConnection=Gv});var Ip=N(Le=>{"use strict";var Xv=Le&&Le.__createBinding||(Object.create?(function(n,t,e,r){r===void 0&&(r=e);var i=Object.getOwnPropertyDescriptor(t,e);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(n,r,i)}):(function(n,t,e,r){r===void 0&&(r=e),n[r]=t[e]})),is=Le&&Le.__exportStar||function(n,t){for(var e in n)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&Xv(t,n,e)};Object.defineProperty(Le,"__esModule",{value:!0});Le.LSPErrorCodes=Le.createProtocolConnection=void 0;is(Gt(),Le);is((yr(),bo(zi)),Le);is(ue(),Le);is(Mp(),Le);var Yv=Np();Object.defineProperty(Le,"createProtocolConnection",{enumerable:!0,get:function(){return Yv.createProtocolConnection}});var kp;(function(n){n.lspReservedErrorRangeStart=-32899,n.RequestFailed=-32803,n.ServerCancelled=-32802,n.ContentModified=-32801,n.RequestCancelled=-32800,n.lspReservedErrorRangeEnd=-32800})(kp||(Le.LSPErrorCodes=kp={}))});var ye=N(dt=>{"use strict";var Jv=dt&&dt.__createBinding||(Object.create?(function(n,t,e,r){r===void 0&&(r=e);var i=Object.getOwnPropertyDescriptor(t,e);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(n,r,i)}):(function(n,t,e,r){r===void 0&&(r=e),n[r]=t[e]})),Ap=dt&&dt.__exportStar||function(n,t){for(var e in n)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&Jv(t,n,e)};Object.defineProperty(dt,"__esModule",{value:!0});dt.createProtocolConnection=void 0;var Qv=Ta();Ap(Ta(),dt);Ap(Ip(),dt);function Zv(n,t,e,r){return(0,Qv.createMessageConnection)(n,t,e,r)}dt.createProtocolConnection=Zv});var Xc=N(At=>{"use strict";Object.defineProperty(At,"__esModule",{value:!0});At.SemanticTokensBuilder=At.SemanticTokensDiff=At.SemanticTokensFeature=void 0;var ss=ye(),Kv=n=>class extends n{get semanticTokens(){return{refresh:()=>this.connection.sendRequest(ss.SemanticTokensRefreshRequest.type),on:t=>{let e=ss.SemanticTokensRequest.type;return this.connection.onRequest(e,(r,i)=>t(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(e,r)))},onDelta:t=>{let e=ss.SemanticTokensDeltaRequest.type;return this.connection.onRequest(e,(r,i)=>t(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(e,r)))},onRange:t=>{let e=ss.SemanticTokensRangeRequest.type;return this.connection.onRequest(e,(r,i)=>t(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(e,r)))}}}};At.SemanticTokensFeature=Kv;var os=class{constructor(t,e){this.originalSequence=t,this.modifiedSequence=e}computeDiff(){let t=this.originalSequence.length,e=this.modifiedSequence.length,r=0;for(;r<e&&r<t&&this.originalSequence[r]===this.modifiedSequence[r];)r++;if(r<e&&r<t){let i=t-1,s=e-1;for(;i>=r&&s>=r&&this.originalSequence[i]===this.modifiedSequence[s];)i--,s--;(i<r||s<r)&&(i++,s++);let a=i-r+1,l=this.modifiedSequence.slice(r,s+1);return l.length===1&&l[0]===this.originalSequence[i]?[{start:r,deleteCount:a-1}]:[{start:r,deleteCount:a,data:l}]}else return r<e?[{start:r,deleteCount:0,data:this.modifiedSequence.slice(r)}]:r<t?[{start:r,deleteCount:t-r}]:[]}};At.SemanticTokensDiff=os;var Gc=class{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(t,e,r,i,s){let a=t,l=e;this._dataLen>0&&(a-=this._prevLine,a===0&&(l-=this._prevChar)),this._data[this._dataLen++]=a,this._data[this._dataLen++]=l,this._data[this._dataLen++]=r,this._data[this._dataLen++]=i,this._data[this._dataLen++]=s,this._prevLine=t,this._prevChar=e}get id(){return this._id.toString()}previousResult(t){this.id===t&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return this._prevData!==void 0}buildEdits(){return this._prevData!==void 0?{resultId:this.id,edits:new os(this._prevData,this._data).computeDiff()}:this.build()}};At.SemanticTokensBuilder=Gc});var jp=N(as=>{"use strict";Object.defineProperty(as,"__esModule",{value:!0});as.InlineCompletionFeature=void 0;var eb=ye(),tb=n=>class extends n{get inlineCompletion(){return{on:t=>this.connection.onRequest(eb.InlineCompletionRequest.type,(e,r)=>t(e,r,this.attachWorkDoneProgress(e)))}}};as.InlineCompletionFeature=tb});var Jc=N(cs=>{"use strict";Object.defineProperty(cs,"__esModule",{value:!0});cs.TextDocuments=void 0;var Zt=ye(),Yc=class{constructor(t){this._configuration=t,this._syncedDocuments=new Map,this._onDidChangeContent=new Zt.Emitter,this._onDidOpen=new Zt.Emitter,this._onDidClose=new Zt.Emitter,this._onDidSave=new Zt.Emitter,this._onWillSave=new Zt.Emitter}get onDidOpen(){return this._onDidOpen.event}get onDidChangeContent(){return this._onDidChangeContent.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(t){this._willSaveWaitUntil=t}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(t){return this._syncedDocuments.get(t)}all(){return Array.from(this._syncedDocuments.values())}keys(){return Array.from(this._syncedDocuments.keys())}listen(t){t.__textDocumentSync=Zt.TextDocumentSyncKind.Incremental;let e=[];return e.push(t.onDidOpenTextDocument(r=>{let i=r.textDocument,s=this._configuration.create(i.uri,i.languageId,i.version,i.text);this._syncedDocuments.set(i.uri,s);let a=Object.freeze({document:s});this._onDidOpen.fire(a),this._onDidChangeContent.fire(a)})),e.push(t.onDidChangeTextDocument(r=>{let i=r.textDocument,s=r.contentChanges;if(s.length===0)return;let{version:a}=i;if(a==null)throw new Error(`Received document change event for ${i.uri} without valid version identifier`);let l=this._syncedDocuments.get(i.uri);l!==void 0&&(l=this._configuration.update(l,s,a),this._syncedDocuments.set(i.uri,l),this._onDidChangeContent.fire(Object.freeze({document:l})))})),e.push(t.onDidCloseTextDocument(r=>{let i=this._syncedDocuments.get(r.textDocument.uri);i!==void 0&&(this._syncedDocuments.delete(r.textDocument.uri),this._onDidClose.fire(Object.freeze({document:i})))})),e.push(t.onWillSaveTextDocument(r=>{let i=this._syncedDocuments.get(r.textDocument.uri);i!==void 0&&this._onWillSave.fire(Object.freeze({document:i,reason:r.reason}))})),e.push(t.onWillSaveTextDocumentWaitUntil((r,i)=>{let s=this._syncedDocuments.get(r.textDocument.uri);return s!==void 0&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:s,reason:r.reason}),i):[]})),e.push(t.onDidSaveTextDocument(r=>{let i=this._syncedDocuments.get(r.textDocument.uri);i!==void 0&&this._onDidSave.fire(Object.freeze({document:i}))})),Zt.Disposable.create(()=>{e.forEach(r=>r.dispose())})}};cs.TextDocuments=Yc});var Zc=N(In=>{"use strict";Object.defineProperty(In,"__esModule",{value:!0});In.NotebookDocuments=In.NotebookSyncFeature=void 0;var Xe=ye(),Fp=Jc(),nb=n=>class extends n{get synchronization(){return{onDidOpenNotebookDocument:t=>this.connection.onNotification(Xe.DidOpenNotebookDocumentNotification.type,e=>{t(e)}),onDidChangeNotebookDocument:t=>this.connection.onNotification(Xe.DidChangeNotebookDocumentNotification.type,e=>{t(e)}),onDidSaveNotebookDocument:t=>this.connection.onNotification(Xe.DidSaveNotebookDocumentNotification.type,e=>{t(e)}),onDidCloseNotebookDocument:t=>this.connection.onNotification(Xe.DidCloseNotebookDocumentNotification.type,e=>{t(e)})}}};In.NotebookSyncFeature=nb;var us=class n{onDidOpenTextDocument(t){return this.openHandler=t,Xe.Disposable.create(()=>{this.openHandler=void 0})}openTextDocument(t){this.openHandler&&this.openHandler(t)}onDidChangeTextDocument(t){return this.changeHandler=t,Xe.Disposable.create(()=>{this.changeHandler=t})}changeTextDocument(t){this.changeHandler&&this.changeHandler(t)}onDidCloseTextDocument(t){return this.closeHandler=t,Xe.Disposable.create(()=>{this.closeHandler=void 0})}closeTextDocument(t){this.closeHandler&&this.closeHandler(t)}onWillSaveTextDocument(){return n.NULL_DISPOSE}onWillSaveTextDocumentWaitUntil(){return n.NULL_DISPOSE}onDidSaveTextDocument(){return n.NULL_DISPOSE}};us.NULL_DISPOSE=Object.freeze({dispose:()=>{}});var Qc=class{constructor(t){t instanceof Fp.TextDocuments?this._cellTextDocuments=t:this._cellTextDocuments=new Fp.TextDocuments(t),this.notebookDocuments=new Map,this.notebookCellMap=new Map,this._onDidOpen=new Xe.Emitter,this._onDidChange=new Xe.Emitter,this._onDidSave=new Xe.Emitter,this._onDidClose=new Xe.Emitter}get cellTextDocuments(){return this._cellTextDocuments}getCellTextDocument(t){return this._cellTextDocuments.get(t.document)}getNotebookDocument(t){return this.notebookDocuments.get(t)}getNotebookCell(t){let e=this.notebookCellMap.get(t);return e&&e[0]}findNotebookDocumentForCell(t){let e=typeof t=="string"?t:t.document,r=this.notebookCellMap.get(e);return r&&r[1]}get onDidOpen(){return this._onDidOpen.event}get onDidSave(){return this._onDidSave.event}get onDidChange(){return this._onDidChange.event}get onDidClose(){return this._onDidClose.event}listen(t){let e=new us,r=[];return r.push(this.cellTextDocuments.listen(e)),r.push(t.notebooks.synchronization.onDidOpenNotebookDocument(i=>{this.notebookDocuments.set(i.notebookDocument.uri,i.notebookDocument);for(let s of i.cellTextDocuments)e.openTextDocument({textDocument:s});this.updateCellMap(i.notebookDocument),this._onDidOpen.fire(i.notebookDocument)})),r.push(t.notebooks.synchronization.onDidChangeNotebookDocument(i=>{let s=this.notebookDocuments.get(i.notebookDocument.uri);if(s===void 0)return;s.version=i.notebookDocument.version;let a=s.metadata,l=!1,f=i.change;f.metadata!==void 0&&(l=!0,s.metadata=f.metadata);let h=[],b=[],C=[],S=[];if(f.cells!==void 0){let G=f.cells;if(G.structure!==void 0){let R=G.structure.array;if(s.cells.splice(R.start,R.deleteCount,...R.cells!==void 0?R.cells:[]),G.structure.didOpen!==void 0)for(let x of G.structure.didOpen)e.openTextDocument({textDocument:x}),h.push(x.uri);if(G.structure.didClose)for(let x of G.structure.didClose)e.closeTextDocument({textDocument:x}),b.push(x.uri)}if(G.data!==void 0){let R=new Map(G.data.map(x=>[x.document,x]));for(let x=0;x<=s.cells.length;x++){let O=R.get(s.cells[x].document);if(O!==void 0){let Z=s.cells.splice(x,1,O);if(C.push({old:Z[0],new:O}),R.delete(O.document),R.size===0)break}}}if(G.textContent!==void 0)for(let R of G.textContent)e.changeTextDocument({textDocument:R.document,contentChanges:R.changes}),S.push(R.document.uri)}this.updateCellMap(s);let T={notebookDocument:s};l&&(T.metadata={old:a,new:s.metadata});let z=[];for(let G of h)z.push(this.getNotebookCell(G));let Y=[];for(let G of b)Y.push(this.getNotebookCell(G));let ne=[];for(let G of S)ne.push(this.getNotebookCell(G));(z.length>0||Y.length>0||C.length>0||ne.length>0)&&(T.cells={added:z,removed:Y,changed:{data:C,textContent:ne}}),(T.metadata!==void 0||T.cells!==void 0)&&this._onDidChange.fire(T)})),r.push(t.notebooks.synchronization.onDidSaveNotebookDocument(i=>{let s=this.notebookDocuments.get(i.notebookDocument.uri);s!==void 0&&this._onDidSave.fire(s)})),r.push(t.notebooks.synchronization.onDidCloseNotebookDocument(i=>{let s=this.notebookDocuments.get(i.notebookDocument.uri);if(s!==void 0){this._onDidClose.fire(s);for(let a of i.cellTextDocuments)e.closeTextDocument({textDocument:a});this.notebookDocuments.delete(i.notebookDocument.uri);for(let a of s.cells)this.notebookCellMap.delete(a.document)}})),Xe.Disposable.create(()=>{r.forEach(i=>i.dispose())})}updateCellMap(t){for(let e of t.cells)this.notebookCellMap.set(e.document,[e,t])}};In.NotebookDocuments=Qc});var Kc=N(De=>{"use strict";Object.defineProperty(De,"__esModule",{value:!0});De.thenable=De.typedArray=De.stringArray=De.array=De.func=De.error=De.number=De.string=De.boolean=void 0;function rb(n){return n===!0||n===!1}De.boolean=rb;function zp(n){return typeof n=="string"||n instanceof String}De.string=zp;function ib(n){return typeof n=="number"||n instanceof Number}De.number=ib;function sb(n){return n instanceof Error}De.error=sb;function Bp(n){return typeof n=="function"}De.func=Bp;function Up(n){return Array.isArray(n)}De.array=Up;function ob(n){return Up(n)&&n.every(t=>zp(t))}De.stringArray=ob;function ab(n,t){return Array.isArray(n)&&n.every(t)}De.typedArray=ab;function cb(n){return n&&Bp(n.then)}De.thenable=cb});var eu=N(Ye=>{"use strict";Object.defineProperty(Ye,"__esModule",{value:!0});Ye.generateUuid=Ye.parse=Ye.isUUID=Ye.v4=Ye.empty=void 0;var xr=class{constructor(t){this._value=t}asHex(){return this._value}equals(t){return this.asHex()===t.asHex()}},Rr=class n extends xr{static _oneOf(t){return t[Math.floor(t.length*Math.random())]}static _randomHex(){return n._oneOf(n._chars)}constructor(){super([n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),"-",n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),"-","4",n._randomHex(),n._randomHex(),n._randomHex(),"-",n._oneOf(n._timeHighBits),n._randomHex(),n._randomHex(),n._randomHex(),"-",n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex(),n._randomHex()].join(""))}};Rr._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];Rr._timeHighBits=["8","9","a","b"];Ye.empty=new xr("00000000-0000-0000-0000-000000000000");function Hp(){return new Rr}Ye.v4=Hp;var ub=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Wp(n){return ub.test(n)}Ye.isUUID=Wp;function lb(n){if(!Wp(n))throw new Error("invalid uuid");return new xr(n)}Ye.parse=lb;function fb(){return Hp().asHex()}Ye.generateUuid=fb});var Vp=N(Ft=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.attachPartialResult=Ft.ProgressFeature=Ft.attachWorkDone=void 0;var jt=ye(),db=eu(),Kt=class n{constructor(t,e){this._connection=t,this._token=e,n.Instances.set(this._token,this)}begin(t,e,r,i){let s={kind:"begin",title:t,percentage:e,message:r,cancellable:i};this._connection.sendProgress(jt.WorkDoneProgress.type,this._token,s)}report(t,e){let r={kind:"report"};typeof t=="number"?(r.percentage=t,e!==void 0&&(r.message=e)):r.message=t,this._connection.sendProgress(jt.WorkDoneProgress.type,this._token,r)}done(){n.Instances.delete(this._token),this._connection.sendProgress(jt.WorkDoneProgress.type,this._token,{kind:"end"})}};Kt.Instances=new Map;var ls=class extends Kt{constructor(t,e){super(t,e),this._source=new jt.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}},_r=class{constructor(){}begin(){}report(){}done(){}},fs=class extends _r{constructor(){super(),this._source=new jt.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}};function pb(n,t){if(t===void 0||t.workDoneToken===void 0)return new _r;let e=t.workDoneToken;return delete t.workDoneToken,new Kt(n,e)}Ft.attachWorkDone=pb;var hb=n=>class extends n{constructor(){super(),this._progressSupported=!1}initialize(t){super.initialize(t),t?.window?.workDoneProgress===!0&&(this._progressSupported=!0,this.connection.onNotification(jt.WorkDoneProgressCancelNotification.type,e=>{let r=Kt.Instances.get(e.token);(r instanceof ls||r instanceof fs)&&r.cancel()}))}attachWorkDoneProgress(t){return t===void 0?new _r:new Kt(this.connection,t)}createWorkDoneProgress(){if(this._progressSupported){let t=(0,db.generateUuid)();return this.connection.sendRequest(jt.WorkDoneProgressCreateRequest.type,{token:t}).then(()=>new ls(this.connection,t))}else return Promise.resolve(new fs)}};Ft.ProgressFeature=hb;var tu;(function(n){n.type=new jt.ProgressType})(tu||(tu={}));var nu=class{constructor(t,e){this._connection=t,this._token=e}report(t){this._connection.sendProgress(tu.type,this._token,t)}};function mb(n,t){if(t===void 0||t.partialResultToken===void 0)return;let e=t.partialResultToken;return delete t.partialResultToken,new nu(n,e)}Ft.attachPartialResult=mb});var Gp=N(ds=>{"use strict";Object.defineProperty(ds,"__esModule",{value:!0});ds.ConfigurationFeature=void 0;var gb=ye(),yb=Kc(),vb=n=>class extends n{getConfiguration(t){return t?yb.string(t)?this._getConfiguration({section:t}):this._getConfiguration(t):this._getConfiguration({})}_getConfiguration(t){let e={items:Array.isArray(t)?t:[t]};return this.connection.sendRequest(gb.ConfigurationRequest.type,e).then(r=>Array.isArray(r)?Array.isArray(t)?r:r[0]:Array.isArray(t)?[]:null)}};ds.ConfigurationFeature=vb});var Xp=N(hs=>{"use strict";Object.defineProperty(hs,"__esModule",{value:!0});hs.WorkspaceFoldersFeature=void 0;var ps=ye(),bb=n=>class extends n{constructor(){super(),this._notificationIsAutoRegistered=!1}initialize(t){super.initialize(t);let e=t.workspace;e&&e.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new ps.Emitter,this.connection.onNotification(ps.DidChangeWorkspaceFoldersNotification.type,r=>{this._onDidChangeWorkspaceFolders.fire(r.event)}))}fillServerCapabilities(t){super.fillServerCapabilities(t);let e=t.workspace?.workspaceFolders?.changeNotifications;this._notificationIsAutoRegistered=e===!0||typeof e=="string"}getWorkspaceFolders(){return this.connection.sendRequest(ps.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return!this._notificationIsAutoRegistered&&!this._unregistration&&(this._unregistration=this.connection.client.register(ps.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}};hs.WorkspaceFoldersFeature=bb});var Yp=N(ms=>{"use strict";Object.defineProperty(ms,"__esModule",{value:!0});ms.CallHierarchyFeature=void 0;var ru=ye(),Db=n=>class extends n{get callHierarchy(){return{onPrepare:t=>this.connection.onRequest(ru.CallHierarchyPrepareRequest.type,(e,r)=>t(e,r,this.attachWorkDoneProgress(e),void 0)),onIncomingCalls:t=>{let e=ru.CallHierarchyIncomingCallsRequest.type;return this.connection.onRequest(e,(r,i)=>t(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(e,r)))},onOutgoingCalls:t=>{let e=ru.CallHierarchyOutgoingCallsRequest.type;return this.connection.onRequest(e,(r,i)=>t(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(e,r)))}}}};ms.CallHierarchyFeature=Db});var Jp=N(gs=>{"use strict";Object.defineProperty(gs,"__esModule",{value:!0});gs.ShowDocumentFeature=void 0;var xb=ye(),Rb=n=>class extends n{showDocument(t){return this.connection.sendRequest(xb.ShowDocumentRequest.type,t)}};gs.ShowDocumentFeature=Rb});var Qp=N(ys=>{"use strict";Object.defineProperty(ys,"__esModule",{value:!0});ys.FileOperationsFeature=void 0;var An=ye(),_b=n=>class extends n{onDidCreateFiles(t){return this.connection.onNotification(An.DidCreateFilesNotification.type,e=>{t(e)})}onDidRenameFiles(t){return this.connection.onNotification(An.DidRenameFilesNotification.type,e=>{t(e)})}onDidDeleteFiles(t){return this.connection.onNotification(An.DidDeleteFilesNotification.type,e=>{t(e)})}onWillCreateFiles(t){return this.connection.onRequest(An.WillCreateFilesRequest.type,(e,r)=>t(e,r))}onWillRenameFiles(t){return this.connection.onRequest(An.WillRenameFilesRequest.type,(e,r)=>t(e,r))}onWillDeleteFiles(t){return this.connection.onRequest(An.WillDeleteFilesRequest.type,(e,r)=>t(e,r))}};ys.FileOperationsFeature=_b});var Zp=N(vs=>{"use strict";Object.defineProperty(vs,"__esModule",{value:!0});vs.LinkedEditingRangeFeature=void 0;var Sb=ye(),wb=n=>class extends n{onLinkedEditingRange(t){return this.connection.onRequest(Sb.LinkedEditingRangeRequest.type,(e,r)=>t(e,r,this.attachWorkDoneProgress(e),void 0))}};vs.LinkedEditingRangeFeature=wb});var Kp=N(bs=>{"use strict";Object.defineProperty(bs,"__esModule",{value:!0});bs.TypeHierarchyFeature=void 0;var iu=ye(),Cb=n=>class extends n{get typeHierarchy(){return{onPrepare:t=>this.connection.onRequest(iu.TypeHierarchyPrepareRequest.type,(e,r)=>t(e,r,this.attachWorkDoneProgress(e),void 0)),onSupertypes:t=>{let e=iu.TypeHierarchySupertypesRequest.type;return this.connection.onRequest(e,(r,i)=>t(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(e,r)))},onSubtypes:t=>{let e=iu.TypeHierarchySubtypesRequest.type;return this.connection.onRequest(e,(r,i)=>t(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(e,r)))}}}};bs.TypeHierarchyFeature=Cb});var th=N(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});Ds.InlineValueFeature=void 0;var eh=ye(),Pb=n=>class extends n{get inlineValue(){return{refresh:()=>this.connection.sendRequest(eh.InlineValueRefreshRequest.type),on:t=>this.connection.onRequest(eh.InlineValueRequest.type,(e,r)=>t(e,r,this.attachWorkDoneProgress(e)))}}};Ds.InlineValueFeature=Pb});var rh=N(xs=>{"use strict";Object.defineProperty(xs,"__esModule",{value:!0});xs.FoldingRangeFeature=void 0;var nh=ye(),Tb=n=>class extends n{get foldingRange(){return{refresh:()=>this.connection.sendRequest(nh.FoldingRangeRefreshRequest.type),on:t=>{let e=nh.FoldingRangeRequest.type;return this.connection.onRequest(e,(r,i)=>t(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(e,r)))}}}};xs.FoldingRangeFeature=Tb});var ih=N(Rs=>{"use strict";Object.defineProperty(Rs,"__esModule",{value:!0});Rs.InlayHintFeature=void 0;var su=ye(),Eb=n=>class extends n{get inlayHint(){return{refresh:()=>this.connection.sendRequest(su.InlayHintRefreshRequest.type),on:t=>this.connection.onRequest(su.InlayHintRequest.type,(e,r)=>t(e,r,this.attachWorkDoneProgress(e))),resolve:t=>this.connection.onRequest(su.InlayHintResolveRequest.type,(e,r)=>t(e,r))}}};Rs.InlayHintFeature=Eb});var sh=N(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});_s.DiagnosticFeature=void 0;var Sr=ye(),qb=n=>class extends n{get diagnostics(){return{refresh:()=>this.connection.sendRequest(Sr.DiagnosticRefreshRequest.type),on:t=>this.connection.onRequest(Sr.DocumentDiagnosticRequest.type,(e,r)=>t(e,r,this.attachWorkDoneProgress(e),this.attachPartialResultProgress(Sr.DocumentDiagnosticRequest.partialResult,e))),onWorkspace:t=>this.connection.onRequest(Sr.WorkspaceDiagnosticRequest.type,(e,r)=>t(e,r,this.attachWorkDoneProgress(e),this.attachPartialResultProgress(Sr.WorkspaceDiagnosticRequest.partialResult,e)))}}};_s.DiagnosticFeature=qb});var oh=N(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});Ss.MonikerFeature=void 0;var $b=ye(),Ob=n=>class extends n{get moniker(){return{on:t=>{let e=$b.MonikerRequest.type;return this.connection.onRequest(e,(r,i)=>t(r,i,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(e,r)))}}}};Ss.MonikerFeature=Ob});var xh=N(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});K.createConnection=K.combineFeatures=K.combineNotebooksFeatures=K.combineLanguagesFeatures=K.combineWorkspaceFeatures=K.combineWindowFeatures=K.combineClientFeatures=K.combineTracerFeatures=K.combineTelemetryFeatures=K.combineConsoleFeatures=K._NotebooksImpl=K._LanguagesImpl=K.BulkUnregistration=K.BulkRegistration=K.ErrorMessageTracker=void 0;var L=ye(),Je=Kc(),au=eu(),H=Vp(),Mb=Gp(),Lb=Xp(),Nb=Yp(),kb=Xc(),Ib=Jp(),Ab=Qp(),jb=Zp(),Fb=Kp(),zb=th(),Bb=rh(),Ub=ih(),Hb=sh(),Wb=Zc(),Vb=oh();function ou(n){if(n!==null)return n}var cu=class{constructor(){this._messages=Object.create(null)}add(t){let e=this._messages[t];e||(e=0),e++,this._messages[t]=e}sendErrors(t){Object.keys(this._messages).forEach(e=>{t.window.showErrorMessage(e)})}};K.ErrorMessageTracker=cu;var ws=class{constructor(){}rawAttach(t){this._rawConnection=t}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(t){}initialize(t){}error(t){this.send(L.MessageType.Error,t)}warn(t){this.send(L.MessageType.Warning,t)}info(t){this.send(L.MessageType.Info,t)}log(t){this.send(L.MessageType.Log,t)}debug(t){this.send(L.MessageType.Debug,t)}send(t,e){this._rawConnection&&this._rawConnection.sendNotification(L.LogMessageNotification.type,{type:t,message:e}).catch(()=>{(0,L.RAL)().console.error("Sending log message failed")})}},uu=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}showErrorMessage(t,...e){let r={type:L.MessageType.Error,message:t,actions:e};return this.connection.sendRequest(L.ShowMessageRequest.type,r).then(ou)}showWarningMessage(t,...e){let r={type:L.MessageType.Warning,message:t,actions:e};return this.connection.sendRequest(L.ShowMessageRequest.type,r).then(ou)}showInformationMessage(t,...e){let r={type:L.MessageType.Info,message:t,actions:e};return this.connection.sendRequest(L.ShowMessageRequest.type,r).then(ou)}},ah=(0,Ib.ShowDocumentFeature)((0,H.ProgressFeature)(uu)),ch;(function(n){function t(){return new Cs}n.create=t})(ch||(K.BulkRegistration=ch={}));var Cs=class{constructor(){this._registrations=[],this._registered=new Set}add(t,e){let r=Je.string(t)?t:t.method;if(this._registered.has(r))throw new Error(`${r} is already added to this registration`);let i=au.generateUuid();this._registrations.push({id:i,method:r,registerOptions:e||{}}),this._registered.add(r)}asRegistrationParams(){return{registrations:this._registrations}}},uh;(function(n){function t(){return new wr(void 0,[])}n.create=t})(uh||(K.BulkUnregistration=uh={}));var wr=class{constructor(t,e){this._connection=t,this._unregistrations=new Map,e.forEach(r=>{this._unregistrations.set(r.method,r)})}get isAttached(){return!!this._connection}attach(t){this._connection=t}add(t){this._unregistrations.set(t.method,t)}dispose(){let t=[];for(let r of this._unregistrations.values())t.push(r);let e={unregisterations:t};this._connection.sendRequest(L.UnregistrationRequest.type,e).catch(()=>{this._connection.console.info("Bulk unregistration failed.")})}disposeSingle(t){let e=Je.string(t)?t:t.method,r=this._unregistrations.get(e);if(!r)return!1;let i={unregisterations:[r]};return this._connection.sendRequest(L.UnregistrationRequest.type,i).then(()=>{this._unregistrations.delete(e)},s=>{this._connection.console.info(`Un-registering request handler for ${r.id} failed.`)}),!0}},Ps=class{attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}register(t,e,r){return t instanceof Cs?this.registerMany(t):t instanceof wr?this.registerSingle1(t,e,r):this.registerSingle2(t,e)}registerSingle1(t,e,r){let i=Je.string(e)?e:e.method,s=au.generateUuid(),a={registrations:[{id:s,method:i,registerOptions:r||{}}]};return t.isAttached||t.attach(this.connection),this.connection.sendRequest(L.RegistrationRequest.type,a).then(l=>(t.add({id:s,method:i}),t),l=>(this.connection.console.info(`Registering request handler for ${i} failed.`),Promise.reject(l)))}registerSingle2(t,e){let r=Je.string(t)?t:t.method,i=au.generateUuid(),s={registrations:[{id:i,method:r,registerOptions:e||{}}]};return this.connection.sendRequest(L.RegistrationRequest.type,s).then(a=>L.Disposable.create(()=>{this.unregisterSingle(i,r).catch(()=>{this.connection.console.info(`Un-registering capability with id ${i} failed.`)})}),a=>(this.connection.console.info(`Registering request handler for ${r} failed.`),Promise.reject(a)))}unregisterSingle(t,e){let r={unregisterations:[{id:t,method:e}]};return this.connection.sendRequest(L.UnregistrationRequest.type,r).catch(()=>{this.connection.console.info(`Un-registering request handler for ${t} failed.`)})}registerMany(t){let e=t.asRegistrationParams();return this.connection.sendRequest(L.RegistrationRequest.type,e).then(()=>new wr(this._connection,e.registrations.map(r=>({id:r.id,method:r.method}))),r=>(this.connection.console.info("Bulk registration failed."),Promise.reject(r)))}},lu=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}applyEdit(t){function e(i){return i&&!!i.edit}let r=e(t)?t:{edit:t};return this.connection.sendRequest(L.ApplyWorkspaceEditRequest.type,r)}},lh=(0,Ab.FileOperationsFeature)((0,Lb.WorkspaceFoldersFeature)((0,Mb.ConfigurationFeature)(lu))),Ts=class{constructor(){this._trace=L.Trace.Off}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}set trace(t){this._trace=t}log(t,e){this._trace!==L.Trace.Off&&this.connection.sendNotification(L.LogTraceNotification.type,{message:t,verbose:this._trace===L.Trace.Verbose?e:void 0}).catch(()=>{})}},Es=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}logEvent(t){this.connection.sendNotification(L.TelemetryEventNotification.type,t).catch(()=>{this.connection.console.log("Sending TelemetryEventNotification failed")})}},qs=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}attachWorkDoneProgress(t){return(0,H.attachWorkDone)(this.connection,t)}attachPartialResultProgress(t,e){return(0,H.attachPartialResult)(this.connection,e)}};K._LanguagesImpl=qs;var fh=(0,Bb.FoldingRangeFeature)((0,Vb.MonikerFeature)((0,Hb.DiagnosticFeature)((0,Ub.InlayHintFeature)((0,zb.InlineValueFeature)((0,Fb.TypeHierarchyFeature)((0,jb.LinkedEditingRangeFeature)((0,kb.SemanticTokensFeature)((0,Nb.CallHierarchyFeature)(qs))))))))),$s=class{constructor(){}attach(t){this._connection=t}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(t){}fillServerCapabilities(t){}attachWorkDoneProgress(t){return(0,H.attachWorkDone)(this.connection,t)}attachPartialResultProgress(t,e){return(0,H.attachPartialResult)(this.connection,e)}};K._NotebooksImpl=$s;var dh=(0,Wb.NotebookSyncFeature)($s);function ph(n,t){return function(e){return t(n(e))}}K.combineConsoleFeatures=ph;function hh(n,t){return function(e){return t(n(e))}}K.combineTelemetryFeatures=hh;function mh(n,t){return function(e){return t(n(e))}}K.combineTracerFeatures=mh;function gh(n,t){return function(e){return t(n(e))}}K.combineClientFeatures=gh;function yh(n,t){return function(e){return t(n(e))}}K.combineWindowFeatures=yh;function vh(n,t){return function(e){return t(n(e))}}K.combineWorkspaceFeatures=vh;function bh(n,t){return function(e){return t(n(e))}}K.combineLanguagesFeatures=bh;function Dh(n,t){return function(e){return t(n(e))}}K.combineNotebooksFeatures=Dh;function Gb(n,t){function e(i,s,a){return i&&s?a(i,s):i||s}return{__brand:"features",console:e(n.console,t.console,ph),tracer:e(n.tracer,t.tracer,mh),telemetry:e(n.telemetry,t.telemetry,hh),client:e(n.client,t.client,gh),window:e(n.window,t.window,yh),workspace:e(n.workspace,t.workspace,vh),languages:e(n.languages,t.languages,bh),notebooks:e(n.notebooks,t.notebooks,Dh)}}K.combineFeatures=Gb;function Xb(n,t,e){let r=e&&e.console?new(e.console(ws)):new ws,i=n(r);r.rawAttach(i);let s=e&&e.tracer?new(e.tracer(Ts)):new Ts,a=e&&e.telemetry?new(e.telemetry(Es)):new Es,l=e&&e.client?new(e.client(Ps)):new Ps,f=e&&e.window?new(e.window(ah)):new ah,h=e&&e.workspace?new(e.workspace(lh)):new lh,b=e&&e.languages?new(e.languages(fh)):new fh,C=e&&e.notebooks?new(e.notebooks(dh)):new dh,S=[r,s,a,l,f,h,b,C];function T(R){return R instanceof Promise?R:Je.thenable(R)?new Promise((x,O)=>{R.then(Z=>x(Z),Z=>O(Z))}):Promise.resolve(R)}let z,Y,ne,G={listen:()=>i.listen(),sendRequest:(R,...x)=>i.sendRequest(Je.string(R)?R:R.method,...x),onRequest:(R,x)=>i.onRequest(R,x),sendNotification:(R,x)=>{let O=Je.string(R)?R:R.method;return i.sendNotification(O,x)},onNotification:(R,x)=>i.onNotification(R,x),onProgress:i.onProgress,sendProgress:i.sendProgress,onInitialize:R=>(Y=R,{dispose:()=>{Y=void 0}}),onInitialized:R=>i.onNotification(L.InitializedNotification.type,R),onShutdown:R=>(z=R,{dispose:()=>{z=void 0}}),onExit:R=>(ne=R,{dispose:()=>{ne=void 0}}),get console(){return r},get telemetry(){return a},get tracer(){return s},get client(){return l},get window(){return f},get workspace(){return h},get languages(){return b},get notebooks(){return C},onDidChangeConfiguration:R=>i.onNotification(L.DidChangeConfigurationNotification.type,R),onDidChangeWatchedFiles:R=>i.onNotification(L.DidChangeWatchedFilesNotification.type,R),__textDocumentSync:void 0,onDidOpenTextDocument:R=>i.onNotification(L.DidOpenTextDocumentNotification.type,R),onDidChangeTextDocument:R=>i.onNotification(L.DidChangeTextDocumentNotification.type,R),onDidCloseTextDocument:R=>i.onNotification(L.DidCloseTextDocumentNotification.type,R),onWillSaveTextDocument:R=>i.onNotification(L.WillSaveTextDocumentNotification.type,R),onWillSaveTextDocumentWaitUntil:R=>i.onRequest(L.WillSaveTextDocumentWaitUntilRequest.type,R),onDidSaveTextDocument:R=>i.onNotification(L.DidSaveTextDocumentNotification.type,R),sendDiagnostics:R=>i.sendNotification(L.PublishDiagnosticsNotification.type,R),onHover:R=>i.onRequest(L.HoverRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),void 0)),onCompletion:R=>i.onRequest(L.CompletionRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),(0,H.attachPartialResult)(i,x))),onCompletionResolve:R=>i.onRequest(L.CompletionResolveRequest.type,R),onSignatureHelp:R=>i.onRequest(L.SignatureHelpRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),void 0)),onDeclaration:R=>i.onRequest(L.DeclarationRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),(0,H.attachPartialResult)(i,x))),onDefinition:R=>i.onRequest(L.DefinitionRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),(0,H.attachPartialResult)(i,x))),onTypeDefinition:R=>i.onRequest(L.TypeDefinitionRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),(0,H.attachPartialResult)(i,x))),onImplementation:R=>i.onRequest(L.ImplementationRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),(0,H.attachPartialResult)(i,x))),onReferences:R=>i.onRequest(L.ReferencesRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),(0,H.attachPartialResult)(i,x))),onDocumentHighlight:R=>i.onRequest(L.DocumentHighlightRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),(0,H.attachPartialResult)(i,x))),onDocumentSymbol:R=>i.onRequest(L.DocumentSymbolRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),(0,H.attachPartialResult)(i,x))),onWorkspaceSymbol:R=>i.onRequest(L.WorkspaceSymbolRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),(0,H.attachPartialResult)(i,x))),onWorkspaceSymbolResolve:R=>i.onRequest(L.WorkspaceSymbolResolveRequest.type,R),onCodeAction:R=>i.onRequest(L.CodeActionRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),(0,H.attachPartialResult)(i,x))),onCodeActionResolve:R=>i.onRequest(L.CodeActionResolveRequest.type,(x,O)=>R(x,O)),onCodeLens:R=>i.onRequest(L.CodeLensRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),(0,H.attachPartialResult)(i,x))),onCodeLensResolve:R=>i.onRequest(L.CodeLensResolveRequest.type,(x,O)=>R(x,O)),onDocumentFormatting:R=>i.onRequest(L.DocumentFormattingRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),void 0)),onDocumentRangeFormatting:R=>i.onRequest(L.DocumentRangeFormattingRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),void 0)),onDocumentOnTypeFormatting:R=>i.onRequest(L.DocumentOnTypeFormattingRequest.type,(x,O)=>R(x,O)),onRenameRequest:R=>i.onRequest(L.RenameRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),void 0)),onPrepareRename:R=>i.onRequest(L.PrepareRenameRequest.type,(x,O)=>R(x,O)),onDocumentLinks:R=>i.onRequest(L.DocumentLinkRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),(0,H.attachPartialResult)(i,x))),onDocumentLinkResolve:R=>i.onRequest(L.DocumentLinkResolveRequest.type,(x,O)=>R(x,O)),onDocumentColor:R=>i.onRequest(L.DocumentColorRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),(0,H.attachPartialResult)(i,x))),onColorPresentation:R=>i.onRequest(L.ColorPresentationRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),(0,H.attachPartialResult)(i,x))),onFoldingRanges:R=>i.onRequest(L.FoldingRangeRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),(0,H.attachPartialResult)(i,x))),onSelectionRanges:R=>i.onRequest(L.SelectionRangeRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),(0,H.attachPartialResult)(i,x))),onExecuteCommand:R=>i.onRequest(L.ExecuteCommandRequest.type,(x,O)=>R(x,O,(0,H.attachWorkDone)(i,x),void 0)),dispose:()=>i.dispose()};for(let R of S)R.attach(G);return i.onRequest(L.InitializeRequest.type,R=>{t.initialize(R),Je.string(R.trace)&&(s.trace=L.Trace.fromString(R.trace));for(let x of S)x.initialize(R.capabilities);if(Y){let x=Y(R,new L.CancellationTokenSource().token,(0,H.attachWorkDone)(i,R),void 0);return T(x).then(O=>{if(O instanceof L.ResponseError)return O;let Z=O;Z||(Z={capabilities:{}});let me=Z.capabilities;me||(me={},Z.capabilities=me),me.textDocumentSync===void 0||me.textDocumentSync===null?me.textDocumentSync=Je.number(G.__textDocumentSync)?G.__textDocumentSync:L.TextDocumentSyncKind.None:!Je.number(me.textDocumentSync)&&!Je.number(me.textDocumentSync.change)&&(me.textDocumentSync.change=Je.number(G.__textDocumentSync)?G.__textDocumentSync:L.TextDocumentSyncKind.None);for(let Ht of S)Ht.fillServerCapabilities(me);return Z})}else{let x={capabilities:{textDocumentSync:L.TextDocumentSyncKind.None}};for(let O of S)O.fillServerCapabilities(x.capabilities);return x}}),i.onRequest(L.ShutdownRequest.type,()=>{if(t.shutdownReceived=!0,z)return z(new L.CancellationTokenSource().token)}),i.onNotification(L.ExitNotification.type,()=>{try{ne&&ne()}finally{t.shutdownReceived?t.exit(0):t.exit(1)}}),i.onNotification(L.SetTraceNotification.type,R=>{s.trace=L.Trace.fromString(R.value)}),G}K.createConnection=Xb});var fu=N(Te=>{"use strict";var Yb=Te&&Te.__createBinding||(Object.create?(function(n,t,e,r){r===void 0&&(r=e);var i=Object.getOwnPropertyDescriptor(t,e);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(n,r,i)}):(function(n,t,e,r){r===void 0&&(r=e),n[r]=t[e]})),_h=Te&&Te.__exportStar||function(n,t){for(var e in n)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&Yb(t,n,e)};Object.defineProperty(Te,"__esModule",{value:!0});Te.ProposedFeatures=Te.NotebookDocuments=Te.TextDocuments=Te.SemanticTokensBuilder=void 0;var Jb=Xc();Object.defineProperty(Te,"SemanticTokensBuilder",{enumerable:!0,get:function(){return Jb.SemanticTokensBuilder}});var Qb=jp();_h(ye(),Te);var Zb=Jc();Object.defineProperty(Te,"TextDocuments",{enumerable:!0,get:function(){return Zb.TextDocuments}});var Kb=Zc();Object.defineProperty(Te,"NotebookDocuments",{enumerable:!0,get:function(){return Kb.NotebookDocuments}});_h(xh(),Te);var Rh;(function(n){n.all={__brand:"features",languages:Qb.InlineCompletionFeature}})(Rh||(Te.ProposedFeatures=Rh={}))});var wh=N((Ax,Sh)=>{"use strict";Sh.exports=ye()});var ht=N(pt=>{"use strict";var e0=pt&&pt.__createBinding||(Object.create?(function(n,t,e,r){r===void 0&&(r=e);var i=Object.getOwnPropertyDescriptor(t,e);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(n,r,i)}):(function(n,t,e,r){r===void 0&&(r=e),n[r]=t[e]})),Ph=pt&&pt.__exportStar||function(n,t){for(var e in n)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&e0(t,n,e)};Object.defineProperty(pt,"__esModule",{value:!0});pt.createConnection=void 0;var Os=fu();Ph(wh(),pt);Ph(fu(),pt);var Ch=!1,t0={initialize:n=>{},get shutdownReceived(){return Ch},set shutdownReceived(n){Ch=n},exit:n=>{}};function n0(n,t,e,r){let i,s,a,l;n!==void 0&&n.__brand==="features"&&(i=n,n=t,t=e,e=r),Os.ConnectionStrategy.is(n)||Os.ConnectionOptions.is(n)?l=n:(s=n,a=t,l=e);let f=h=>(0,Os.createProtocolConnection)(s,a,h,l);return(0,Os.createConnection)(f,t0,i)}pt.createConnection=n0});var Eh=N((Fx,Th)=>{"use strict";Th.exports=ht()});var gu=N(Hn=>{"use strict";Object.defineProperty(Hn,"__esModule",{value:!0});Hn.hammingWeight4=Hn.hammingWeight=void 0;function y0(n){return n-=n>>>1&1431655765,n=(n&858993459)+(n>>>2&858993459),(n+(n>>>4)&252645135)*16843009>>>24}Hn.hammingWeight=y0;function v0(n,t,e,r){return n-=n>>>1&1431655765,t-=t>>>1&1431655765,e-=e>>>1&1431655765,r-=r>>>1&1431655765,n=(n&858993459)+(n>>>2&858993459),t=(t&858993459)+(t>>>2&858993459),e=(e&858993459)+(e>>>2&858993459),r=(r&858993459)+(r>>>2&858993459),n=n+(n>>>4)&252645135,t=t+(t>>>4)&252645135,e=e+(e>>>4)&252645135,r=r+(r>>>4)&252645135,(n+t+e+r)*16843009>>>24}Hn.hammingWeight4=v0});var um=N(Wn=>{"use strict";var b0=Wn&&Wn.__values||function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Wn,"__esModule",{value:!0});Wn.SparseTypedFastBitSet=void 0;var Ne=gu(),X;(function(n){n[n.ARRAY=0]="ARRAY",n[n.BITSET=1]="BITSET",n[n.MIXED=2]="MIXED"})(X||(X={}));function D0(n){return n?n[Symbol.iterator]!==void 0:!1}var x0=(function(){function n(t,e){var r,i;if(e===void 0&&(e=new Uint32Array(8)),this.data=e,this.arraySize=0,D0(t))try{for(var s=b0(t),a=s.next();!a.done;a=s.next()){var l=a.value;this.add(l)}}catch(f){r={error:f}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}}return Object.defineProperty(n.prototype,"words",{get:function(){return this.arraySize!==-1&&(this.data=this.toBitset(),this.arraySize=-1),this.data},enumerable:!1,configurable:!0}),n.prototype.toBitset=function(){for(var t=this.data,e=t[0]+32>>>5,r=new Uint32Array(e<<1),i=0;i<this.arraySize;i++){var s=t[i];r[s>>>5]|=1<<s}return r},n.prototype.add=function(t){var e=this.resize(t);if(e===X.ARRAY){var r=this.data;if(this.arraySize===0){r[this.arraySize++]=t;return}var i=r.indexOf(t);if(i===-1||i>=this.arraySize){var s=r[0];t>s?(r[0]=t,r[this.arraySize++]=s):r[this.arraySize++]=t}}else this.data[t>>>5]|=1<<t},n.prototype.flip=function(t){var e=this.resize(t);if(e===X.ARRAY){var r=this.data,i=r.indexOf(t);if(i===-1)this.arraySize>0&&t>r[0]?(r[this.arraySize++]=r[0],r[0]=t):r[this.arraySize++]=t;else if(i===0&&this.arraySize>1){for(var s=r[1],a=1,l=2;l<this.arraySize;l++)r[l]>s&&(s=r[l],a=l);r[0]=r[a],r[a]=r[--this.arraySize]}else r[i]=r[--this.arraySize]}else this.data[t>>>5]^=1<<t},n.prototype.clear=function(){this.arraySize=0,this.data=new Uint32Array(8)},n.prototype.remove=function(t){var e=this.resize(t);if(e===X.ARRAY){var r=this.data,i=r.indexOf(t);if(i!==-1&&i<this.arraySize)if(i==this.arraySize-1)this.arraySize--;else if(i===0&&this.arraySize>1){for(var s=r[1],a=1,l=2;l<this.arraySize;l++)r[l]>s&&(s=r[l],a=l);r[0]=r[a],r[a]=r[--this.arraySize]}else r[i]=r[--this.arraySize]}else this.data[t>>>5]&=~(1<<t)},n.prototype.addRange=function(t,e){if(!(t>=e)){var r=this.resize(e,e-t-1);if(r===X.ARRAY){var i=this.data,s=e---1;if(this.arraySize===0)i[this.arraySize++]=s;else{var a=i.indexOf(s);if(a===-1||a>=this.arraySize){var l=i[0];s>l?(i[0]=s,i[this.arraySize++]=l):i[this.arraySize++]=s}}for(;t<e;t++){var a=i.indexOf(t);(a===-1||a>=this.arraySize)&&(i[this.arraySize++]=t)}}else{var f=this.data,h=t>>5,b=e-1>>5;if(h===b){f[h]|=-1<<t&-1>>>-e;return}f[h]|=-1<<t,f.fill(-1,h+1,b),f[b]|=-1>>>-e}}},n.prototype.removeRange=function(t,e){if(!(t>=e))if(this.arraySize!==-1){for(var r=this.data,i=!1,s=0;s<this.arraySize;s++)r[s]>=t&&r[s]<e&&(s===0&&(i=!0),r[s--]=r[--this.arraySize]);if(i&&this.arraySize>1){for(var a=r[0],l=0,s=1;s<this.arraySize;s++)r[s]>a&&(a=r[s],l=s);var f=r[0];r[0]=r[l],r[l]=f}}else{var h=this.data;t=Math.min(t,(h.length<<5)-1),e=Math.min(e,(h.length<<5)-1);var b=t>>5,C=e-1>>5;if(b===C){h[b]&=~(-1<<t&-1>>>-e);return}h[b]&=~(-1<<t),h.fill(0,b+1,C),h[C]&=~(-1>>>-e)}},n.prototype.isEmpty=function(){if(this.arraySize===0)return!0;if(this.arraySize>0)return!1;for(var t=this.data,e=t.length,r=0;r<e;r++)if(t[r]!==0)return!1;return!0},n.prototype.has=function(t){if(this.arraySize===-1)return(this.data[t>>>5]&1<<t)!==0;var e=this.data.indexOf(t);return e!==-1&&e<this.arraySize},n.prototype.checkedAdd=function(t){var e=this.resize(t);if(e===X.ARRAY){var r=this.data;if(this.arraySize===0)return r[this.arraySize++]=t,1;var i=r.indexOf(t);if(i===-1||i>=this.arraySize){var s=r[0];return t>s?(r[0]=t,r[this.arraySize++]=s):r[this.arraySize++]=t,1}return 0}else{var a=this.data,l=a[t>>>5],f=l|1<<t;return a[t>>>5]=f,(f^l)>>>t}},n.prototype.trim=function(){var t=this.size();if(this.arraySize===-1){for(var e=this.data,r=e.length;r>0&&e[r-1]===0;)r--;if(t<r){for(var i=new Uint32Array(t),s=0,a=e.length,l=0;l<a;++l)for(var f=e[l];f!=0;){var h=f&-f;i[s++]=(l<<5)+(0,Ne.hammingWeight)(h-1|0),f^=h}var b=i[0];i[0]=i[t-1],i[t-1]=b,this.data=i,this.arraySize=t}else this.data=e.slice(0,r)}else if(this.arraySize>0&&this.data[0]>>>5<t){for(var C=this.data[0]+32>>>5,S=new Uint32Array(C),T=0;T<this.arraySize;T++){var z=this.data[T];S[z>>>5]|=1<<z}this.data=S,this.arraySize=-1}else this.data=this.data.slice(0,this.arraySize)},n.prototype.resize=function(t,e){if(e===void 0&&(e=0),this.arraySize===-1){var r=this.data;if(r.length<<5>t)return X.BITSET;var i=t+32>>>5,s=new Uint32Array(i<<1);return s.set(r),this.data=s,X.BITSET}else{var a=this.data;if(this.arraySize+e<a.length)return X.ARRAY;if(a.length+e<256){var l=new Uint32Array(a.length+e<<1);return l.set(a),this.data=l,X.ARRAY}else{var i=Math.max(a[0],t)+32>>>5;if(i>a.length+e&&a.length+e<<1<1024){var l=new Uint32Array(a.length+e<<1);return l.set(a),this.data=l,X.ARRAY}else{for(var s=new Uint32Array(i<<1),f=0;f<this.arraySize;f++){var h=a[f];s[h>>>5]|=1<<h}return this.arraySize=-1,this.data=s,X.BITSET}}}},n.prototype.size=function(){if(this.arraySize===-1){for(var t=this.data,e=0,r=t.length,i=0;i+4<r;i+=4)e+=(0,Ne.hammingWeight4)(t[i]|0,t[i+1]|0,t[i+2]|0,t[i+3]|0);for(;i<r;++i)e+=(0,Ne.hammingWeight)(t[i]|0);return e}else return this.arraySize},n.prototype.array=function(){if(this.arraySize===-1){for(var t=this.data,e=new Array(this.size()),r=0,i=t.length,s=0;s<i;++s)for(var a=t[s];a!=0;){var l=a&-a;e[r++]=(s<<5)+(0,Ne.hammingWeight)(l-1|0),a^=l}return e}else{for(var f=this.data,e=new Array(this.arraySize),h=0;h<this.arraySize;h++)e[h]=f[h];return e}},n.prototype.forEach=function(t){if(this.arraySize===-1)for(var e=this.data,r=e.length,i=0;i<r;++i)for(var s=e[i];s!=0;){var a=s&-s;t((i<<5)+(0,Ne.hammingWeight)(a-1)|0),s^=a}else for(var l=this.data,f=0;f<this.arraySize;f++){var h=l[f];t(h),h!==l[f]&&f--}},n.prototype[Symbol.iterator]=function(){var t,e;if(this.arraySize===-1){var r=this.data,i=r.length,s=0,a=r[s];return t={},t[Symbol.iterator]=function(){return this},t.next=function(){for(;s<i;)if(a!==0){var b=a&-a,C=(s<<5)+(0,Ne.hammingWeight)(b-1|0);return a^=b,{done:!1,value:C}}else s++,s<i&&(a=r[s]);return{done:!0,value:void 0}},t}else{var l=this.data,f=this.arraySize,h=0;return e={},e[Symbol.iterator]=function(){return this},e.next=function(){if(h<f){var b=l[h],C={done:!1,value:b};return b!==l[h]&&h--,h++,C}else return{done:!0,value:void 0}},e}},n.prototype.clone=function(){var t=new n(void 0,new Uint32Array(this.data));return t.arraySize=this.arraySize,t},n.prototype.intersects=function(t){var e=n.order(this,t);switch(e.type){case X.BITSET:{for(var r=e.first.words,i=e.second.words,s=Math.min(r.length,i.length),a=0;a<s;++a)if((r[a]&i[a])!==0)return!0;return!1}case X.MIXED:case X.ARRAY:{for(var l=0;l<e.first.arraySize;l++)if(e.second.has(e.first.data[l]))return!0;return!1}}},n.prototype.intersection=function(t){if(this.arraySize===-1)if(!(t instanceof n)||t.arraySize===-1){for(var e=this.data,r=t.words,i=Math.min(e.length,r.length),s=0;s+7<i;s+=8)e[s]&=r[s],e[s+1]&=r[s+1],e[s+2]&=r[s+2],e[s+3]&=r[s+3],e[s+4]&=r[s+4],e[s+5]&=r[s+5],e[s+6]&=r[s+6],e[s+7]&=r[s+7];for(;s<i;++s)e[s]&=r[s];var a=e.length;for(s=i;s<a;++s)e[s]=0;return this}else{for(var l=new Uint32Array(t.data.length),f=t.data,h=0,b=0;b<t.arraySize;b++){var C=f[b];this.has(C)&&(h>0&&C>l[0]?(l[h++]=l[0],l[0]=C):l[h++]=C)}return this.data=l,this.arraySize=h,this}else{for(var S=this.data,b=0;b<this.arraySize;b++){var T=S[b];t.has(T)?b>0&&T>S[0]&&(S[b]=S[0],S[0]=T):S[b--]=S[--this.arraySize]}return this}},n.prototype.intersection_size=function(t){var e=n.order(this,t);switch(e.type){case X.BITSET:{for(var r=e.first.words,i=e.second.words,s=Math.min(r.length,i.length),a=0,l=0;l<s;++l)a+=(0,Ne.hammingWeight)(r[l]&i[l]);return a}case X.MIXED:case X.ARRAY:{for(var a=0,f=e.first.data,h=0;h<e.first.arraySize;h++)e.second.has(f[h])&&a++;return a}}},n.prototype.new_intersection=function(t){var e=n.order(this,t);switch(e.type){case X.BITSET:{for(var r=e.first.words,i=e.second.words,s=Math.min(r.length,i.length),a=new Uint32Array(s),l=0;l+7<s;l+=8)a[l]=r[l]&i[l],a[l+1]=r[l+1]&i[l+1],a[l+2]=r[l+2]&i[l+2],a[l+3]=r[l+3]&i[l+3],a[l+4]=r[l+4]&i[l+4],a[l+5]=r[l+5]&i[l+5],a[l+6]=r[l+6]&i[l+6],a[l+7]=r[l+7]&i[l+7];for(;l<s;++l)a[l]=r[l]&i[l];var f=new n(void 0,a);return f.arraySize=-1,f}case X.MIXED:case X.ARRAY:{for(var h=new Uint32Array(e.first.data.length),b=0,C=e.first.data,S=0;S<e.first.arraySize;S++){var T=C[S];e.second.has(T)&&(b>0&&T>h[0]?(h[b++]=h[0],h[0]=T):h[b++]=T)}var f=new n(void 0,h);return f.arraySize=b,f}}},n.prototype.equals=function(t){if(this===t)return!0;var e=n.order(this,t);switch(e.type){case X.BITSET:{for(var r=this.words,i=t.words,s=Math.min(r.length,i.length),a=0;a<s;++a)if(r[a]!=i[a])return!1;if(r.length<i.length){for(var l=i.length,a=r.length;a<l;++a)if(i[a]!=0)return!1}else if(i.length<r.length){for(var l=r.length,a=i.length;a<l;++a)if(r[a]!=0)return!1}return!0}case X.ARRAY:case X.MIXED:{if(e.first.size()!==e.second.size())return!1;for(var f=e.first.data,h=0;h<e.first.arraySize;h++)if(!e.second.has(f[h]))return!1;return!0}}},n.prototype.difference=function(t){if(this.arraySize===-1)if(!(t instanceof n)||t.arraySize===-1){for(var e=this.words,r=t.words,i=Math.min(e.length,r.length),s=0;s+7<i;s+=8)e[s]&=~r[s],e[s+1]&=~r[s+1],e[s+2]&=~r[s+2],e[s+3]&=~r[s+3],e[s+4]&=~r[s+4],e[s+5]&=~r[s+5],e[s+6]&=~r[s+6],e[s+7]&=~r[s+7];for(;s<i;++s)e[s]&=~r[s];return this}else{for(var a=t.data,l=0;l<t.arraySize;l++){var f=a[l];this.has(f)&&this.remove(f)}return this}else{for(var h=this.data,b=!1,l=0;l<this.arraySize;l++)t.has(h[l])&&(l===0&&(b=!0),h[l--]=h[--this.arraySize]);if(b&&this.arraySize>1){for(var C=h[0],S=0,l=1;l<this.arraySize;l++)h[l]>C&&(C=h[l],S=l);var T=h[0];h[0]=h[S],h[S]=T}return this}},n.prototype.difference2=function(t){if(this.arraySize===-1||!(t instanceof n)){var e=this.words,r=Math.min(e.length,t.words.length);t.resize((e.length<<5)-1);for(var i=t.words,s=0;s+7<r;s+=8)i[s]=e[s]&~i[s],i[s+1]=e[s+1]&~i[s+1],i[s+2]=e[s+2]&~i[s+2],i[s+3]=e[s+3]&~i[s+3],i[s+4]=e[s+4]&~i[s+4],i[s+5]=e[s+5]&~i[s+5],i[s+6]=e[s+6]&~i[s+6],i[s+7]=e[s+7]&~i[s+7];for(;s<r;++s)i[s]=e[s]&~i[s];for(;s<e.length;++s)i[s]=e[s];return i.fill(0,s),t}else{for(var a=new Uint32Array(this.data),l=this.arraySize,f=!1,h=0;h<l;h++)t.has(a[h])&&(h===0&&(f=!0),a[h--]=a[--l]);if(f&&l>1){for(var b=a[0],C=0,h=1;h<l;h++)a[h]>b&&(b=a[h],C=h);var S=a[0];a[0]=a[C],a[C]=S}return t.data=a,t.arraySize=l,t}},n.prototype.new_difference=function(t){return this.clone().difference(t)},n.prototype.difference_size=function(t){if(this.arraySize===-1)if(!(t instanceof n)||t.arraySize===-1){for(var e=this.words,r=t.words,i=Math.min(e.length,r.length),s=0,a=0;a<i;++a)s+=(0,Ne.hammingWeight)(e[a]&~r[a]);for(var l=e.length;a<l;++a)s+=(0,Ne.hammingWeight)(e[a]);return s}else{for(var s=this.size(),f=t.data,h=0;h<t.arraySize;h++){var b=f[h];this.has(b)&&s--}return s}else{for(var s=this.arraySize,C=this.data,h=0;h<this.arraySize;h++)t.has(C[h])&&s--;return s}},n.prototype.change=function(t){if(this.arraySize===-1)if(!(t instanceof n)||t.arraySize===-1){var e=t.words,r=Math.min(this.words.length,e.length);this.resize((e.length<<5)-1);for(var i=this.words,s=0;s+7<r;s+=8)i[s]^=e[s],i[s+1]^=e[s+1],i[s+2]^=e[s+2],i[s+3]^=e[s+3],i[s+4]^=e[s+4],i[s+5]^=e[s+5],i[s+6]^=e[s+6],i[s+7]^=e[s+7];for(;s<r;++s)i[s]^=e[s];for(;s<e.length;++s)i[s]=e[s];return this}else if(t.arraySize>0){var a=t.data;this.resize(a[0]);for(var i=this.words,l=0;l<t.arraySize;l++){var f=a[l];(i[f>>>5]&1<<f)!==0?i[f>>>5]&=~(1<<f):i[f>>>5]|=1<<f}return this}else return this;else{if(!(t instanceof n)||t.arraySize===-1){var i=new Uint32Array(Math.max(t.words.length,this.arraySize>0?this.data[0]<<37:0));i.set(t.words);for(var h=this.data,l=0;l<this.arraySize;l++){var f=h[l];(i[f>>>5]&1<<f)!==0?i[f>>>5]&=~(1<<f):i[f>>>5]|=1<<f}this.data=i,this.arraySize=-1}else for(var a=t.data,l=0;l<t.arraySize;l++){var f=a[l];this.has(f)?this.remove(f):this.add(f)}return this}},n.prototype.new_change=function(t){var e=n.order(this,t);switch(e.type){case X.BITSET:{var r=this.words,i=t.words,s=Math.max(r.length,i.length),a=new n(void 0,new Uint32Array(s));a.arraySize=-1;for(var l=Math.min(r.length,i.length),f=0;f+7<l;f+=8)a.words[f]=r[f]^i[f],a.words[f+1]=r[f+1]^i[f+1],a.words[f+2]=r[f+2]^i[f+2],a.words[f+3]=r[f+3]^i[f+3],a.words[f+4]=r[f+4]^i[f+4],a.words[f+5]=r[f+5]^i[f+5],a.words[f+6]=r[f+6]^i[f+6],a.words[f+7]=r[f+7]^i[f+7];for(;f<l;++f)a.words[f]=r[f]^i[f];var h=r.length;for(f=l;f<h;++f)a.words[f]=r[f];var b=i.length;for(f=l;f<b;++f)a.words[f]=i[f];return a}case X.MIXED:{var r=new Uint32Array(Math.max(e.second.words.length,e.first.arraySize>0?e.first.data[0]+32<<5:0));r.set(e.second.words);for(var C=e.first.data,S=0;S<e.first.arraySize;S++){var T=C[S];(r[T>>>5]&1<<T)!==0?r[T>>>5]&=~(1<<T):r[T>>>5]|=1<<T}var a=new n(void 0,r);return a.arraySize=-1,a}case X.ARRAY:{var z=new Uint32Array(e.first.data.length+e.second.data.length);z.set(e.second.data);for(var Y=e.second.arraySize,C=e.first.data,S=0;S<e.first.arraySize;S++){var T=C[S],ne=z.indexOf(T);ne!==-1&&ne<Y?z[ne]=z[--Y]:z[Y++]=T}if(Y>1){for(var G=z[0],R=0,S=1;S<Y;S++)z[S]>G&&(G=z[S],R=S);var x=z[0];z[0]=z[R],z[R]=x}var a=new n(void 0,z);return a.arraySize=Y,a}}},n.prototype.change_size=function(t){var e=n.order(this,t);switch(e.type){case X.BITSET:{for(var r=this.words,i=t.words,s=Math.min(r.length,i.length),a=0,l=0;l<s;++l)a+=(0,Ne.hammingWeight)(r[l]^i[l]);for(var f=r.length>i.length?this:t,h=f.words.length;l<h;++l)a+=(0,Ne.hammingWeight)(f.words[l]);return a}case X.MIXED:{for(var b=e.first.data,a=e.second.size(),C=0;C<e.first.arraySize;C++){var S=b[C];e.second.has(S)?a--:a++}return a}case X.ARRAY:{for(var a=e.second.arraySize,b=e.first.data,C=0;C<e.first.arraySize;C++){var S=b[C];e.second.has(S)?a--:a++}return a}}},n.prototype.toString=function(){return"{"+this.array().join(",")+"}"},n.prototype.union=function(t){if(!(t instanceof n)||t.arraySize===-1){this.arraySize!==-1&&(this.data=this.toBitset(),this.arraySize=-1);for(var e=this.data,r=t.words,i=Math.min(e.length,r.length),s=0;s+7<i;s+=8)e[s]|=r[s],e[s+1]|=r[s+1],e[s+2]|=r[s+2],e[s+3]|=r[s+3],e[s+4]|=r[s+4],e[s+5]|=r[s+5],e[s+6]|=r[s+6],e[s+7]|=r[s+7];for(;s<i;++s)e[s]|=r[s];if(e.length<r.length){this.resize((r.length<<5)-1),e=this.data;var a=r.length;for(s=i;s<a;++s)e[s]=r[s]}return this}else{for(var l=t.data,f=0;f<t.arraySize;f++){var h=l[f];this.add(h)}return this}},n.prototype.new_union=function(t){if(!(t instanceof n)||t.arraySize===-1){var e=this.data;this.arraySize!==-1&&(e=this.toBitset());var r=t.words,i=Math.max(e.length,r.length),s=new n(void 0,new Uint32Array(i));s.arraySize=-1;for(var a=Math.min(e.length,r.length),l=0;l<a;++l)s.words[l]=e[l]|r[l];for(var f=e.length,l=a;l<f;++l)s.words[l]=e[l];for(var h=r.length,l=a;l<h;++l)s.words[l]=r[l];return s}else{for(var s=this.clone(),b=t.data,C=0;C<t.arraySize;C++){var S=b[C];s.add(S)}return s}},n.prototype.union_size=function(t){var e=n.order(this,t);switch(e.type){case X.BITSET:{for(var r=e.first.words,i=e.second.words,s=Math.min(r.length,i.length),a=0,l=0;l<s;++l)a+=(0,Ne.hammingWeight)(r[l]|i[l]);if(r.length<i.length)for(var f=i.length,l=r.length;l<f;++l)a+=(0,Ne.hammingWeight)(i[l]|0);else for(var f=r.length,l=i.length;l<f;++l)a+=(0,Ne.hammingWeight)(r[l]|0);return a}case X.ARRAY:case X.MIXED:{for(var a=e.second.size(),h=e.first.data,b=0;b<e.first.arraySize;b++)e.second.has(h[b])||a++;return a}}},n.order=function(t,e){return!(t instanceof n)||t.arraySize===-1?!(e instanceof n)||e.arraySize===-1?{first:t,second:e,type:X.BITSET}:{first:e,second:t,type:X.MIXED}:!(e instanceof n)||e.arraySize===-1?{first:t,second:e,type:X.MIXED}:e.arraySize>t.arraySize?{first:t,second:e,type:X.ARRAY}:{first:e,second:t,type:X.ARRAY}},n})();Wn.SparseTypedFastBitSet=x0});var lm=N(Vn=>{"use strict";var R0=Vn&&Vn.__values||function(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Vn,"__esModule",{value:!0});Vn.TypedFastBitSet=void 0;var je=gu();function _0(n){return n?n[Symbol.iterator]!==void 0:!1}var S0=(function(){function n(t,e){var r,i;if(e===void 0&&(e=new Uint32Array(8)),this.words=e,_0(t))try{for(var s=R0(t),a=s.next();!a.done;a=s.next()){var l=a.value;this.add(l)}}catch(f){r={error:f}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}}return n.fromWords=function(t){return new n(void 0,t)},n.prototype.add=function(t){this.resize(t),this.words[t>>>5]|=1<<t},n.prototype.flip=function(t){this.resize(t),this.words[t>>>5]^=1<<t},n.prototype.clear=function(){this.words=new Uint32Array(8)},n.prototype.remove=function(t){this.resize(t),this.words[t>>>5]&=~(1<<t)},n.prototype.addRange=function(t,e){if(!(t>=e)){this.words.length<<5<=e&&this.resize(e);var r=this.words,i=t>>5,s=e-1>>5;if(i===s){r[i]|=-1<<t&-1>>>-e;return}r[i]|=-1<<t,r.fill(-1,i+1,s),r[s]|=-1>>>-e}},n.prototype.removeRange=function(t,e){var r=this.words;if(t=Math.min(t,(r.length<<5)-1),e=Math.min(e,(r.length<<5)-1),!(t>=e)){var i=t>>5,s=e-1>>5;if(i===s){r[i]&=~(-1<<t&-1>>>-e);return}r[i]&=~(-1<<t),r.fill(0,i+1,s),r[s]&=~(-1>>>-e)}},n.prototype.isEmpty=function(){for(var t=this.words,e=t.length,r=0;r<e;r++)if(t[r]!==0)return!1;return!0},n.prototype.has=function(t){return(this.words[t>>>5]&1<<t)!==0},n.prototype.hasAnyInRange=function(t,e){if(t>=e)return!1;var r=this.words;t=Math.min(t,(r.length<<5)-1),e=Math.min(e,(r.length<<5)-1);var i=t>>>5,s=e-1>>5;if(i===s)return(r[i]&(-1<<t&-1>>>-e))!==0;if((r[i]&-1<<t)!==0)return!0;for(var a=i+1;a<s-1;a++)if(r[a]!==0)return!0;return(r[s]&-1>>>-e)!==0},n.prototype.checkedAdd=function(t){var e=this.words;this.resize(t);var r=e[t>>>5],i=r|1<<t;return e[t>>>5]=i,(i^r)>>>t},n.prototype.trim=function(){for(var t=this.words,e=t.length;e>0&&t[e-1]===0;)e--;this.words=t.slice(0,e)},n.prototype.resize=function(t){var e=this.words;if(!(e.length<<5>t)){var r=t+32>>>5,i=new Uint32Array(r<<1);i.set(e),this.words=i}},n.prototype.size=function(){for(var t=this.words,e=0,r=t.length,i=0;i+4<r;i+=4)e+=(0,je.hammingWeight4)(t[i]|0,t[i+1]|0,t[i+2]|0,t[i+3]|0);for(;i<r;++i)e+=(0,je.hammingWeight)(t[i]|0);return e},n.prototype.array=function(){for(var t=this.words,e=new Array(this.size()),r=0,i=t.length,s=0;s<i;++s)for(var a=t[s];a!=0;){var l=a&-a;e[r++]=(s<<5)+(0,je.hammingWeight)(l-1|0),a^=l}return e},n.prototype.forEach=function(t){for(var e=this.words,r=e.length,i=0;i<r;++i)for(var s=e[i];s!=0;){var a=s&-s;t((i<<5)+(0,je.hammingWeight)(a-1)|0),s^=a}},n.prototype[Symbol.iterator]=function(){var t,e=this.words,r=e.length,i=0,s=e[i];return t={},t[Symbol.iterator]=function(){return this},t.next=function(){for(;i<r;)if(s!==0){var a=s&-s,l=(i<<5)+(0,je.hammingWeight)(a-1|0);return s^=a,{done:!1,value:l}}else i++,i<r&&(s=e[i]);return{done:!0,value:void 0}},t},n.prototype.clone=function(){return n.fromWords(new Uint32Array(this.words))},n.prototype.intersects=function(t){for(var e=this.words,r=t.words,i=Math.min(e.length,r.length),s=0;s<i;++s)if((e[s]&r[s])!==0)return!0;return!1},n.prototype.intersection=function(t){for(var e=this.words,r=t.words,i=Math.min(e.length,r.length),s=0;s+7<i;s+=8)e[s]&=r[s],e[s+1]&=r[s+1],e[s+2]&=r[s+2],e[s+3]&=r[s+3],e[s+4]&=r[s+4],e[s+5]&=r[s+5],e[s+6]&=r[s+6],e[s+7]&=r[s+7];for(;s<i;++s)e[s]&=r[s];var a=e.length;for(s=i;s<a;++s)e[s]=0;return this},n.prototype.intersection_size=function(t){for(var e=this.words,r=t.words,i=Math.min(e.length,r.length),s=0,a=0;a<i;++a)s+=(0,je.hammingWeight)(e[a]&r[a]);return s},n.prototype.new_intersection=function(t){for(var e=this.words,r=t.words,i=Math.min(e.length,r.length),s=new Uint32Array(i),a=0;a+7<i;a+=8)s[a]=e[a]&r[a],s[a+1]=e[a+1]&r[a+1],s[a+2]=e[a+2]&r[a+2],s[a+3]=e[a+3]&r[a+3],s[a+4]=e[a+4]&r[a+4],s[a+5]=e[a+5]&r[a+5],s[a+7]=e[a+7]&r[a+7],s[a+6]=e[a+6]&r[a+6];for(;a<i;++a)s[a]=e[a]&r[a];return new n(void 0,s)},n.prototype.equals=function(t){for(var e=this.words,r=t.words,i=Math.min(e.length,r.length),s=0;s<i;++s)if(e[s]!=r[s])return!1;if(e.length<r.length){for(var a=r.length,s=e.length;s<a;++s)if(r[s]!=0)return!1}else if(r.length<e.length){for(var a=e.length,s=r.length;s<a;++s)if(e[s]!=0)return!1}return!0},n.prototype.difference=function(t){for(var e=this.words,r=t.words,i=Math.min(e.length,r.length),s=0;s+7<i;s+=8)e[s]&=~r[s],e[s+1]&=~r[s+1],e[s+2]&=~r[s+2],e[s+3]&=~r[s+3],e[s+4]&=~r[s+4],e[s+5]&=~r[s+5],e[s+6]&=~r[s+6],e[s+7]&=~r[s+7];for(;s<i;++s)e[s]&=~r[s];return this},n.prototype.difference2=function(t){var e=Math.min(this.words.length,t.words.length);t.resize((this.words.length<<5)-1);for(var r=this.words,i=t.words,s=0;s+7<e;s+=8)i[s]=r[s]&~i[s],i[s+1]=r[s+1]&~i[s+1],i[s+2]=r[s+2]&~i[s+2],i[s+3]=r[s+3]&~i[s+3],i[s+4]=r[s+4]&~i[s+4],i[s+5]=r[s+5]&~i[s+5],i[s+6]=r[s+6]&~i[s+6],i[s+7]=r[s+7]&~i[s+7];for(;s<e;++s)i[s]=this.words[s]&~i[s];for(;s<this.words.length;++s)i[s]=this.words[s];return i.fill(0,s),t},n.prototype.new_difference=function(t){return this.clone().difference(t)},n.prototype.difference_size=function(t){for(var e=this.words,r=t.words,i=Math.min(e.length,r.length),s=0,a=0;a<i;++a)s+=(0,je.hammingWeight)(e[a]&~r[a]);for(var l=e.length;a<l;++a)s+=(0,je.hammingWeight)(e[a]);return s},n.prototype.change=function(t){var e=t.words,r=Math.min(this.words.length,e.length);this.resize((e.length<<5)-1);for(var i=this.words,s=0;s+7<r;s+=8)i[s]^=e[s],i[s+1]^=e[s+1],i[s+2]^=e[s+2],i[s+3]^=e[s+3],i[s+4]^=e[s+4],i[s+5]^=e[s+5],i[s+6]^=e[s+6],i[s+7]^=e[s+7];for(;s<r;++s)i[s]^=e[s];for(;s<e.length;++s)i[s]=e[s];return this},n.prototype.new_change=function(t){for(var e=this.words,r=t.words,i=Math.max(e.length,r.length),s=new Uint32Array(i),a=Math.min(e.length,r.length),l=0;l+7<a;l+=8)s[l]=e[l]^r[l],s[l+1]=e[l+1]^r[l+1],s[l+2]=e[l+2]^r[l+2],s[l+3]=e[l+3]^r[l+3],s[l+4]=e[l+4]^r[l+4],s[l+5]=e[l+5]^r[l+5],s[l+6]=e[l+6]^r[l+6],s[l+7]=e[l+7]^r[l+7];for(;l<a;++l)s[l]=e[l]^r[l];var f=e.length;for(l=a;l<f;++l)s[l]=e[l];var h=r.length;for(l=a;l<h;++l)s[l]=r[l];return new n(void 0,s)},n.prototype.change_size=function(t){for(var e=this.words,r=t.words,i=Math.min(e.length,r.length),s=0,a=0;a<i;++a)s+=(0,je.hammingWeight)(e[a]^r[a]);for(var l=e.length>r.length?this:t,f=l.words.length;a<f;++a)s+=(0,je.hammingWeight)(l.words[a]);return s},n.prototype.toString=function(){return"{"+this.array().join(",")+"}"},n.prototype.union=function(t){for(var e=this.words,r=t.words,i=Math.min(e.length,r.length),s=0;s+7<i;s+=8)e[s]|=r[s],e[s+1]|=r[s+1],e[s+2]|=r[s+2],e[s+3]|=r[s+3],e[s+4]|=r[s+4],e[s+5]|=r[s+5],e[s+6]|=r[s+6],e[s+7]|=r[s+7];for(;s<i;++s)e[s]|=r[s];if(e.length<r.length){this.resize((r.length<<5)-1),e=this.words;var a=r.length;for(s=i;s<a;++s)e[s]=r[s]}return this},n.prototype.new_union=function(t){for(var e=this.words,r=t.words,i=Math.max(e.length,r.length),s=new Uint32Array(i),a=Math.min(e.length,r.length),l=0;l<a;++l)s[l]=e[l]|r[l];for(var f=e.length,l=a;l<f;++l)s[l]=e[l];for(var h=r.length,l=a;l<h;++l)s[l]=r[l];return new n(void 0,s)},n.prototype.union_size=function(t){for(var e=this.words,r=t.words,i=Math.min(e.length,r.length),s=0,a=0;a<i;++a)s+=(0,je.hammingWeight)(e[a]|r[a]);if(e.length<r.length)for(var l=r.length,a=e.length;a<l;++a)s+=(0,je.hammingWeight)(r[a]|0);else for(var l=e.length,a=r.length;a<l;++a)s+=(0,je.hammingWeight)(e[a]|0);return s},n})();Vn.TypedFastBitSet=S0});var dm=N(Bt=>{"use strict";var w0=Bt&&Bt.__createBinding||(Object.create?(function(n,t,e,r){r===void 0&&(r=e);var i=Object.getOwnPropertyDescriptor(t,e);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(n,r,i)}):(function(n,t,e,r){r===void 0&&(r=e),n[r]=t[e]})),fm=Bt&&Bt.__exportStar||function(n,t){for(var e in n)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&w0(t,n,e)};Object.defineProperty(Bt,"__esModule",{value:!0});fm(um(),Bt);fm(lm(),Bt)});var Ut=at(Eh());var de=at(ht());var qh=n=>n.operation!==void 0,Ms={add:{title:"add",summary:"Arithmetic Add",class:"ALU",cycles:8,operation:"[dst] \u2190 [B] + [C]",syntax:["add [<dst:a|d>]"],description:["Adds the contents of register `b` and `c` placing the result in `dst` (a or d).","If dst is not specified then register a is assumed."],dest:{dr:!0,ar:!1,mIndirect:!1,imm:!1},flags:{z:"*",c:"*",s:"*"},procs:{rcasm:!0,"rcasm+div":!0}},and:{title:"and",class:"ALU",cycles:8,summary:"Logical And",operation:"[dst] \u2190 [B] . [C]",syntax:["and [<dst:a|d>]"],description:["Performs a bitwise AND on register `b` and `c` placing the result in `dst` (a or d).","If dst is not specified then register a is assumed."],dest:{dr:!0,ar:!1,mIndirect:!1,imm:!1},flags:{z:"*",c:"0",s:"*"},procs:{rcasm:!0,"rcasm+div":!0}},bcs:{title:"bcs",class:"GOTO",cycles:24,summary:"Branch Conditionally: Carry Set",operation:"If C THEN [PC] \u2190 (label)",syntax:["bcs <label>"],snippet:"bcs ${1:label}",description:["Jumps to label if C is set (last ALU operation resulted in a carry)."],flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!0,"rcasm+div":!0}},beq:{title:"beq",class:"GOTO",cycles:24,summary:"Branch Conditionally: Equal",operation:"If Z THEN [PC] \u2190 (label)",syntax:["beq <label>"],snippet:"beq ${1:label}",description:["Jumps to label if Z flag is set (last ALU operation result was 0)."],flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!0,"rcasm+div":!0}},ble:{title:"ble",class:"GOTO",cycles:24,summary:"Branch Conditionally: Less or Equal",operation:"If Z + S THEN [PC] \u2190 (label)",syntax:["ble <label>"],snippet:"ble ${1:label}",description:["Jumps to label if S or Z is set (last ALU operation resulted in a zero or negative value)."],flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!0,"rcasm+div":!0}},blt:{title:"blt",class:"GOTO",cycles:24,summary:"Branch Conditionally: Less Than",operation:"If S THEN [PC] \u2190 (label)",syntax:["blt <label>"],snippet:"blt ${1:label}",description:["Jumps to label if S is set (last ALU operation has most significant bit set / is negative).","Synonym of `bmi`."],flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!0,"rcasm+div":!0}},bmi:{title:"bmi",class:"GOTO",cycles:24,summary:"Branch Conditionally: Minus",operation:"If S THEN [PC] \u2190 (label))",syntax:["bmi <label>"],snippet:"bmi ${1:label}",description:["Jumps to label if S is set (last ALU operation has most significant bit set / is negative).","Synonym of `blt`."],flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!0,"rcasm+div":!0}},bne:{title:"bne",class:"GOTO",cycles:24,summary:"Branch Conditionally: Not Equal",operation:"If Z\u0305 THEN [PC] \u2190 (label)",syntax:["bne <label>"],snippet:"bne ${1:label}",description:["Jumps to label if Z is not set (last ALU operation result was not 0)."],flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!0,"rcasm+div":!0}},clr:{title:"clr",class:"MOV8",cycles:8,summary:"Register Clear",variant:"8-bit Register Clear",operation:"[dst] \u2190 0",syntax:["clr <dst:Dr>"],description:["Clears (sets to 0) general purpose 8-bit register dst.","This is the equivalent of `mov dst,dst`."],dest:{dr:!0,ar:!1,mIndirect:!1,imm:!1},flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!0,"rcasm+div":!0},variants:[{class:"MOV16",cycles:10,variant:"16-bit Register Clear",description:["Clears (sets to 0) 16-bit register xy.","This is the equivalent of `mov xy,xy`."],syntax:["clr xy"],dest:{dr:!1,ar:!0,mIndirect:!1,imm:!1},whenFirstParamIs:["xy"]}]},cmp:{title:"cmp",class:"ALU",cycles:8,summary:"Compare (Logic Xor)",operation:"[dst] \u2190 [B] - [C]",syntax:["cmp [<dst:a|d>]"],description:["Compares the values in register `b` and `c` setting condition flag Z (zero) if the values are the same.","Overwrites `dst` (a or d).","If dst is not specified then register a is assumed. Affects Z (zero) and S (sign) flags.","Synonym of `eor`."],dest:{dr:!0,ar:!1,mIndirect:!1,imm:!1},flags:{z:"*",c:"0",s:"*"},procs:{rcasm:!0,"rcasm+div":!0}},div:{title:"div",class:"INCXY",cycles:24,summary:"Unsigned Integer Division \u26A0\uFE0FEXPERIMENTAL\u26A0\uFE0F",operation:"[dst] \u2190 [B]/[C]",syntax:["div [<dst:a|d>]"],description:["Performs an integer division of register `b` by register `c` placing the quotient result in `dst` (a or d).","If dst is not specified then register a is assumed."],dest:{dr:!0,ar:!1,mIndirect:!1,imm:!1},flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!1,"rcasm+div":!0}},dvr:{title:"dvr",class:"INCXY",cycles:24,summary:"Remainder Division \u26A0\uFE0FEXPERIMENTAL\u26A0\uFE0F",operation:"[dst] \u2190 R / [C]",syntax:["dvr [<dst:a|d>]"],description:["Performs a further division of the last `div` or `mod` remainder by register `c` placing the quotient result in `dst` (a or d).","Register B should be set to 0. If dst is not specified then register a is assumed."],dest:{dr:!0,ar:!1,mIndirect:!1,imm:!1},flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!1,"rcasm+div":!0}},eor:{title:"eor",class:"ALU",cycles:8,summary:"Logical Exclusive-OR",operation:"[dst] \u2190 [B] \u2295 [C]",syntax:["eor [<dst:a|d>]"],description:["Performs a bitwise XOR (exlusive OR) on register `b` and `c` placing the result in `dst` (a or d).","If dst is not specified then register a is assumed.","Synonym of `cmp`."],dest:{dr:!0,ar:!1,mIndirect:!1,imm:!1},flags:{z:"*",c:"0",s:"*"},procs:{rcasm:!0,"rcasm+div":!0}},inc:{title:"inc",summary:"Arithmetic Increment",class:"ALU",cycles:8,operation:"[dst] \u2190 [B] + 1",syntax:["inc [<dst:a|d>]"],description:["Adds one to the contents of register `b` (register `c` is ignored) placing the result in `dst` (a or d).","If dst is not specified then register a is assumed."],dest:{dr:!0,ar:!1,mIndirect:!1,imm:!1},flags:{z:"*",c:"*",s:"*"},procs:{rcasm:!0,"rcasm+div":!0}},hlt:{title:"hlt",class:"MISC",cycles:10,summary:"Halt",operation:"HALT and [PC] \u2190 [PC] + 1",syntax:["hlt"],description:["Halts execution of the program."],flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!0,"rcasm+div":!0}},hlr:{title:"hlr",class:"MISC",cycles:10,summary:"Halt and Reload",operation:"HALT and [PC] \u2190 [AS]",syntax:["hlr"],description:["Halts execution of the program and sets the program counter to the value on the primary switches."],flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!0,"rcasm+div":!0}},ixy:{title:"ixy",summary:"XY Increment",class:"INCXY",cycles:14,operation:"[XY] \u2190 [XY] + 1",syntax:["ixy"],description:["Increments the 16-bit value in the `xy` register by 1."],flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!0,"rcasm+div":!0}},jmp:{title:"jmp",class:"GOTO",cycles:24,summary:"Unconditional Jump",operation:"[PC] \u2190 (label))",syntax:["jmp <label>"],snippet:"jmp ${1:label}",description:["Unconditionally jumps to `label` (via register j)."],flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!0,"rcasm+div":!0}},jsr:{title:"jsr",class:"GOTO",cycles:24,summary:"Jump to Subroutine",operation:"[XY] \u2190 [PC]; [PC] \u2190 (label)",syntax:["jsr <label>"],snippet:"jsr ${1:label}",description:["Saves the address of the next instruction into register `xy` and then unconditionally jumps to `label` (via register j).","Notionally behaves as a 'call subroutine' operation."],flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!0,"rcasm+div":!0}},ldi:{title:"ldi",class:"SETAB",cycles:8,summary:"Load Immediate",operation:"[dst] \u2190 value",syntax:["ldi <dst:a|b>,<value:-16..15>"],snippet:"ldi ${1:a},${2:0}",description:["Loads an 8-bit constant value into `dst` (register a or b).","The `value` must be between -16 and 15."],variant:"8-bit Load Immediate",variants:[{class:"GOTO",cycles:24,variant:"16-bit Load Immediate",description:["Loads a 16-bit constant value into `dst` (register m or j).","The `value` can be between 0x0000 and 0xFFFF."],syntax:["ldi <dst:m|j>,<value:0x0000..0xFFFF>","ldi <dst:m|j>,<label>"],whenFirstParamIs:["m","j"],src:{dr:!1,ar:!1,mIndirect:!1,imm:!0},dest:{dr:!1,ar:!0,mIndirect:!1,imm:!1}}],src:{dr:!1,ar:!1,mIndirect:!1,imm:!0},dest:{dr:!0,ar:!1,mIndirect:!1,imm:!1},flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!0,"rcasm+div":!0}},lds:{title:"lds",class:"MISC",cycles:10,summary:"Load Register from Switches",operation:"[dst] \u2190 [DS]",syntax:["lds <dst:a|d>"],snippet:"lds ${1:a}",description:["Loads register `dst` (a or d) from the front panel switches."],dest:{dr:!0,ar:!1,mIndirect:!1,imm:!1},flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!0,"rcasm+div":!0}},ldr:{title:"ldr",class:"LOAD",cycles:12,summary:"Load Register from Memory",operation:"[dst] \u2190 (M)",syntax:["ldr <dst:a-d>"],snippet:"ldr ${1:b}",description:["Loads register `dst` (a, b, c or d) with the byte in memory currently referenced by register `m`."],src:{dr:!1,ar:!1,mIndirect:!0,imm:!1},dest:{dr:!0,ar:!1,mIndirect:!1,imm:!1},flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!0,"rcasm+div":!0}},mod:{title:"mod",class:"INCXY",cycles:24,summary:"Unsigned Modulo Operation \u26A0\uFE0FEXPERIMENTAL\u26A0\uFE0F",operation:"[dst] \u2190 [B]%[C]",syntax:["mod <dst:a|d>"],description:["Performs an integer division of register `b` by register `c` placing the remainder result in `dst` (a or d).","If dst is not specified then register a is assumed."],dest:{dr:!0,ar:!1,mIndirect:!1,imm:!1},flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!1,"rcasm+div":!0}},mdr:{title:"mdr",class:"INCXY",cycles:24,summary:"Remainder Modulo \u26A0\uFE0FEXPERIMENTAL\u26A0\uFE0F",operation:"[dst] \u2190 R % [C]",syntax:["mdr <dst:a|d>"],description:["Performs a further modulo of the last `div` or `mod` remainder by register `c` placing the remainder result in `dst` (a or d).","Register B should be set to 0. If dst is not specified then register a is assumed."],dest:{dr:!0,ar:!1,mIndirect:!1,imm:!1},flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!1,"rcasm+div":!0}},mov:{title:"mov",class:"MOV8",cycles:8,summary:"Register to Register Copy",operation:"[dst] \u2190 [src]",syntax:["mov <dst:Dr>,<src:Dr>"],snippet:"mov ${1:b},${2:a}",description:["Copies a value from `src` to `dst` between any of the eight general purpose 8-bit registers.","If dst and src are the same then dst will be set to 0."],variant:"8-bit Register to Register Copy",variants:[{class:"MOV16",cycles:10,variant:"16-bit Register to Register Copy",description:["Copies a value between the 16-bit `src` registers (m, xy or j) and `dst` (xy or the program counter pc).","If dst and src are the same then dst will be set to 0."],syntax:["mov <dst:xy|pc>,<src:m|xy|j|as>"],whenFirstParamIs:["xy","pc"],src:{dr:!1,ar:!0,mIndirect:!1,imm:!1},dest:{dr:!1,ar:!0,mIndirect:!1,imm:!1}}],src:{dr:!0,ar:!1,mIndirect:!1,imm:!1},dest:{dr:!0,ar:!1,mIndirect:!1,imm:!1},flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!0,"rcasm+div":!0}},not:{title:"not",class:"ALU",cycles:8,summary:"Logical Complement",operation:"[dst] \u2190 ~[B]",syntax:["not [<dst:a|d>]"],description:["Performs a bitwise NOT on register `b` (register `c` is ignored) placing the result in `dst` (a or d).","If dst is not specified then register a is assumed."],dest:{dr:!0,ar:!1,mIndirect:!1,imm:!1},flags:{z:"*",c:"0",s:"*"},procs:{rcasm:!0,"rcasm+div":!0}},orr:{title:"orr",class:"ALU",cycles:8,summary:"Logical Inclusive-OR",operation:"[dst] \u2190 [B] + [C]",syntax:["orr <dst:a|d>"],description:["Performs a bitwise OR on register `b` and `c` placing the result in `dst` (a or d).","If dst is not specified then register a is assumed."],dest:{dr:!0,ar:!1,mIndirect:!1,imm:!1},flags:{z:"*",c:"0",s:"*"},procs:{rcasm:!0,"rcasm+div":!0}},rol:{title:"rol",class:"ALU",cycles:8,summary:"Rotate Left",operation:"[dst] \u2190 [B] rotated by 1",syntax:["rol <dst:a|d>"],description:["Performs a bitwise left-rotation on register `b` (register `c` is ignored) placing the result in `dst` (a or d).","If dst is not specified then register a is assumed.","Every bit shifts one place to the left with the left most bit rotated around to right."],dest:{dr:!0,ar:!1,mIndirect:!1,imm:!1},flags:{z:"*",c:"0",s:"*"},procs:{rcasm:!0,"rcasm+div":!0}},rts:{title:"rts",class:"MOV16",cycles:10,summary:"Return from Subroutine",operation:"[PC] \u2190 [XY]",syntax:["rts"],description:["Copies the value in register `xy` to the program counter `pc`.","Notionally behaves as a 'return' operation to a previous jsr call."],flags:{z:"-",c:"-",s:"-"},src:{dr:!1,ar:!0,mIndirect:!1,imm:!1},dest:{dr:!1,ar:!0,mIndirect:!1,imm:!1},procs:{rcasm:!0,"rcasm+div":!0}},str:{title:"str",class:"STORE",cycles:12,summary:"Store Register into Memory",operation:"(M) \u2190 [src]",syntax:["str <src:a-d>"],snippet:"str ${1:a}",description:["Stores register `src` (a, b, c or d) into the byte of memory currently referenced by register `m`."],src:{dr:!0,ar:!1,mIndirect:!1,imm:!1},dest:{dr:!1,ar:!1,mIndirect:!0,imm:!1},flags:{z:"-",c:"-",s:"-"},procs:{rcasm:!0,"rcasm+div":!0}}};var Ls={org:{title:"org",summary:"Define Output Location",syntax:["org <address>"],snippet:"org ${1:0x0000}",description:["Sets the current location of the assembler so that the next instruction will be placed at the given address.","An 8-bit constant may be used and will be assumed to be in the zero page (`0x00--`)."]},opc:{title:"opc",summary:"Define Opcode",syntax:["opc <opcode>"],snippet:"opc ${1:0x00}",description:["Writes the given 8-bit value directly into the assembled output.","Values may be any valid 8-bit constant.","Typically this directive is used to issue a direct opcode that has no current assembler equivalent.","Directly equivalent to `!byte <opcode>`."]},"!align":{title:"!align",summary:"Define Align",syntax:["!align <value:2|4|8|16|...>"],snippet:"!align ${1:8}",description:["Writes 8-bit zeros into the output until the current location is a multiple of the given value."]},"!byte":{title:"!byte",summary:"Define Byte Data",syntax:["!byte <value:0x00..0xFF>[,...]"],snippet:"!byte ${1:0x00}",description:["Writes the given 8-bit comma seperated values directly into the assembled output.","Values may be any valid 8-bit constant.","Where a label is provided the least significant byte of that address will be used.","Alternatively a string may be provided within double quotes which will be output as an UTF-8 byte per character."]},"!word":{title:"!word",summary:"Define Word Data",syntax:["!word <value:0x0000..0xFFFF>[,...]"],snippet:"!word ${1:0x0000}",description:["Writes the given 16-bit comma seperated values directly into the assembled output.","Values may be any valid 16-bit constant.","Where a label is provided the addess it references will be used.","Alternatively a string may be provided within double quotes which will be output as an UTF-16BE word per character."]},"!fill":{title:"!fill",summary:"Define Fill Space",syntax:["!fill <count:0..255>,<value:0x00..0xFF>"],snippet:"!fill ${1:8},${2:0x00}",description:["Writes the given 8-bit value <em>v</em> directly into the assembled output `n` times.","Values may be any valid 8-bit constant."]},"!for":{title:"!for",summary:"Define For Loop",syntax:["!for <variable> in <range>"],snippet:"!for ${1:i} in range(${2:5}) {\n        ${3:add}\n}",description:["Repeats the given code block, according to the given range, in the assembled output.","The variable `i` can be referenced from within the code block and increases per iteration of the `for` loop.","If a label preceeds the directive then any label within the code block can be referenced, by iteration number `i`, with a fully scoped label in the form `outer_label__i::inner_label`"]},range:{title:"range",summary:"Range Macro",syntax:["range ([<start>,]<end>)"],snippet:"range(${1:5})",description:["Defines a range for use with a `!for` directive.","The range can either be a single numeric value `n` giving a range of `0..n-1` or two values `s`,`e` giving a range on `s..e-1`."]},"!if":{title:"!if",summary:"Define Conditional Block",syntax:["!if (<condition>)"],snippet:"!if (${1:i == 0}) {\n        ${2:add}\n}",description:["Conditionally assembles the next code block.","The condition can be any expression that results in a 'truthy' or 'falsy' value.","Following the code block multiple optional `elif` (else if) directives may be added followed by one final optional `else` directive."]},elif:{title:"elif",summary:"Define Conditional Else-If Block",syntax:["elif (<condition>)"],snippet:"elif (${1:i == 0}) {\n        ${2:add}\n}",description:["Conditionally assembles the next code block.","The condition can be any expression that results in a 'truthy' or 'falsy' value.","Must follow an `if` or `elif` block and can be followed by multiple optional `elif` directives or by one final optional `else` directive."]},else:{title:"else",summary:"Define Conditional Else Block",syntax:["else"],snippet:`else {
        \${2:add}
}`,description:["Conditionally assembles the next code block if no preceeding `if` or `elif` block evaluated to true.","Must follow an `if` or `elif` block."]},"!let":{title:"!let",summary:"Define Variable",syntax:["!let <variable> = <value>"],snippet:"!let ${1:i} = ${2:0}",description:["Defines a variable that can be later referenced.","Values may be any valid 8-bit constant (either directly or resulting from an expression).","Where a label is provided the least significant byte of that address will be used.","Alternatively a string may be provided within double quotes which will be output as an UTF-8 byte per character."]},"!error":{title:"!error",summary:"Throw Assembly Error",syntax:["!error <message>"],snippet:'!if (${1:i == 0}) { !error "${2:Error message}" }',description:["Intentionally raises an error at assembly time.","Typically used within an `!if` directive to assert that a condition is met."]}};var en={a:{title:"a",summary:"A Register",size:8,canRead:!0,canWrite:!0,description:"General purpose 8-bit register."},b:{title:"b",summary:"B Register",size:8,canRead:!0,canWrite:!0,description:"General purpose 8-bit register. Directly feeds the ALU for all binary and unary operations."},c:{title:"c",summary:"C Register",size:8,canRead:!0,canWrite:!0,description:"General purpose 8-bit register. Directly feeds the ALU for all binary operations"},d:{title:"d",summary:"D Register",size:8,canRead:!0,canWrite:!0,description:"General purpose 8-bit register."},m1:{title:"m1",summary:"M1 Register",size:8,canRead:!0,canWrite:!0,description:"General purpose 8-bit register. Forms high byte of 16-bit M register."},m2:{title:"m2",summary:"M2 Register",size:8,canRead:!0,canWrite:!0,description:"General purpose 8-bit register. Forms low byte of 16-bit M register"},x:{title:"x",summary:"X Register",size:8,canRead:!0,canWrite:!0,description:"General purpose 8-bit register. Forms high byte of 16-bit XY register."},y:{title:"y",summary:"Y Register",size:8,canRead:!0,canWrite:!0,description:"General purpose 8-bit register. Forms low byte of 16-bit XY register."},m:{title:"m",summary:"M Register",size:16,canRead:!0,canWrite:!1,description:"16-bit read-only register. Formed from the 8-bit M1 and M2 registers. Typically used to reference a location in memory."},j:{title:"j",summary:"J Register",size:16,canRead:!0,canWrite:!1,description:"16-bit read-only register. Formed from the 8-bit J1 and J2 registers. Can only be loaded as part of a branching or load immediate instruction. Typically used for jumps and conditional branching."},xy:{title:"xy",summary:"XY Register",size:16,canRead:!0,canWrite:!0,description:"16-bit general purpose register. Formed from the 8-bit X and Y registers. Typically used to hold a return address, indexing a memory location or as a general 16-bit register. Can be incremented with the `ixy` instruction."},pc:{title:"pc",summary:"Program Counter",size:16,canRead:!0,canWrite:!0,description:"The program counter (a 16-bit read-only register). Points to the next instruction in memory to be performed. Loading a value in to this register effectively performs a jump."},as:{title:"as",summary:"Address Switches",size:16,canRead:!0,canWrite:!1,description:"16-bit read-only register formed from the 8-bit front panel switches. The upper 8-bits of this 'register' are always zero. Effectively this allows user input to be gated onto the address bus."},ds:{title:"ds",summary:"Data Switches",size:16,canRead:!0,canWrite:!1,description:"The current value set on the 8-bit front panel switches. Effectively this allows user input to be gated onto the data bus."}};var jn={...Ms,...Ls};var Ee=at(ht());var r0=/^(?<label>(\s*[^:\s;*=!]+:))?(\s*(((?<mnemonic1>\.?(nop|reset|rte|rtr|rts|trapv|illegal|clrfo|clrso|comment|einline|even|inline|list|mexit|nolist|nopage|odd|page|popsection|pushsection|rsreset|endif|endc|else|elseif|endm|endr|erem)))|((?<mnemonic>([^\s.,;*=]+|=))(\s*(?<operands>(?<op1>"([^"]*)"?|'([^']*)'?|<([^>]*)>?|[^\s;,]+)(?<op2>,\s*("([^"]*)"?|'([^']*)'?|<([^>]*)>?|[^\s;,]*))*))?)))?(\s*(?<comment>.+))?$/i;function Cr(n){let t={},e=r0.exec(n)?.groups;if(e){let r=0;if(e.label){let i=e.label.trim();for(;i.endsWith(":");)i=i.substring(0,i.length-1);let s=n.indexOf(i);r=s+i.length,t.label={start:s,end:r,value:i}}if(e.mnemonic||e.mnemonic1){let i=e.mnemonic||e.mnemonic1,s=r+n.substring(r).indexOf(i);r=s+i.length,t.mnemonic={start:s,end:r,value:i}}if(e.operands){let i=e.operands.split(/,\s*(?![^()<>]*[)>])/),s=[];for(let a of i){let l=a?r+n.substring(r).indexOf(a):r+1;r=l+a.length,s.push({start:l,end:r,value:a})}t.operands=s}if(e.comment&&e.comment.trim()){let i=e.comment,s=r+n.substring(r).indexOf(i);r=s+i.length,t.comment={start:s,end:r,value:i}}}return t}function $h({label:n,mnemonic:t,operands:e,comment:r},i){if(n&&Ns(n,i))return{component:n,type:0};if(t&&Ns(t,i))return{component:t,type:1};if(e)for(let s in e){let a=e[s];if(a&&Ns(a,i))return{component:a,type:2,index:Number(s)}}if(r&&Ns(r,i))return{component:r,type:3}}function Ns(n,t){return n.start<=t&&n.end>=t}function Oh(n){let t={label:n,operands:[]},e=0,[,r]=n.split(" ");if(r)for(let i of r.split(",")){let s=i.replace(/[[\]]/g,""),a=e+n.substring(e).indexOf(s);e=a+s.length,t.operands.push({start:a,end:e,value:s})}return t}function Mh(n,t){return n.line<t.line?!0:t.line<n.line?!1:n.character<=t.character}function du(n,t){return Mh(n.start,t)&&Mh(t,n.end)}function Nh(n){return n.selectionRange!==void 0}function kh(n,t,e){let r={definitions:new Map,references:new Map},i=(a,l)=>{let f=`${l}${a.name}`;if(r.definitions.has(f))return;let h=o0[a.type],b=Lh(a.node,n),C={name:f,type:h,location:{uri:n.uri,range:b},selectionRange:b},S=[],T=Ee.Range.create(Ee.Position.create(b.start.line,0),Ee.Position.create(b.start.line,Ee.uinteger.MAX_VALUE)),z=Cr(n.getText(T)??"");if(z&&z.comment)z.comment.value.trim().startsWith(";")&&S.unshift(z.comment.value);else if(T.start.line>0)for(let G=T.start.line-1;G>=0;G--){let R=Ee.Range.create(Ee.Position.create(G,0),Ee.Position.create(G,Ee.uinteger.MAX_VALUE)),x=Cr(n.getText(R)??"");if(x&&x.comment)x.comment.value.trim().startsWith(";")&&S.unshift(x.comment.value);else break}let Y="***",ne=S.map(G=>G.replace(/^[;*]\s?/,"").replace(/^\s*[*-=]{3,}\s*$/,"~~~").replace(/([*_{}[\]()#+-.!`])/g,"\\$1").replace(/^~~~$/,Y));for(;ne[0]===Y;)ne.shift();for(;ne[ne.length-1]===Y;)ne.pop();S.length&&(C.comment=ne.join(`
`)),r.definitions.set(f,C)},s=(a,l="")=>{a.syms.forEach(f=>i(f,l)),a.children.forEach(f=>s(f,`${l}${f.name}::`))};return s(e),t.accept(a=>{if(a.type==="SQRef"&&a.ref){let l=a.ref.path.map(b=>b.replace(/__\d+$/,"__n")),f=a.ref.absolute?l.join("::"):(a.ref.scope.name===""?"":a.ref.scope.name+"::")+l.join("::"),h=r.references.get(f);h||(h=[],r.references.set(f,h)),h.push({name:f,location:{uri:n.uri,range:Lh(a,n)}})}return!0}),r}function Fn(n,t){return s0(n,t)||i0(n,t)}function i0(n,t){for(let[,e]of n.references){let r=e.find(i=>du(i.location.range,t));if(r)return r}}function s0(n,t){for(let e of n.definitions.values())if(du(e.selectionRange,t))return e}async function ks(n,t,e,r=!1){let i=e.store.get(n);if(!i)return[];let s=[],a=Fn(i.symbols,t);if(!a)return[];let l=i.symbols.references.get(a.name);if(l&&s.push(...l),r){let f=i.symbols.definitions.get(a.name);f&&s.push(f)}return s}async function zn(n,t,e){let r=e.store.get(n);if(!r)return[];let i=Fn(r.symbols,t);if(!i)return[];let s=r.symbols.definitions.get(i.name);return s?[s]:[]}var o0={label:"label",var:"variable"},Ih={label:Ee.SymbolKind.Field,variable:Ee.SymbolKind.Variable};function Lh(n,t){return Ee.Range.create(t.positionAt(n.offset),t.positionAt(n.end))}yr();function Ah(n){return n.split(";")[0].replace(/\s+/g," ").trimEnd()}function jh(n){let t=n.toString(16),e=n.toString(2);return`${n} | 0x${t} | ${e}b`}function Is(n){let t="";if(qh(n)){let e=n.variants??[],r=e.length>0?"\u{1F130} ":"",i=["\u{1F131} "];if(t="\n```rcasm\n",t+=n.syntax.map(a=>r+a).join(`
`),e.forEach((a,l)=>{t+=`
`+a.syntax.map(f=>i[l]+f).join(`
`)}),t+=`
\`\`\`

---
`,t+=`${r}**${e.length>0?n.variant??n.summary:n.summary}**`,n.description&&n.description.forEach(a=>t+=`
${a}`),e.forEach((a,l)=>{t+=`

${i[l]}**${a.variant}**`,a.description&&a.description.forEach(f=>t+=`
${f}`)}),n.flags){let a=Object.values(n.flags).map(l=>l==="-"?"-":"`"+l+"`");t+=`

---

`,t+=`|   |   | Z | C | S |
`,t+=`|---|---|:-:|:-:|:-:|
`,t+=`| ${r}\`${n.class}\` \`${n.cycles}\` | &nbsp;&nbsp; | ${a.join(" | ")} |`,e.forEach((l,f)=>{t+=`
| ${i[f]}\`${l.class}\` \`${l.cycles}\` | &nbsp;&nbsp; | ${a.join(" | ")} |`})}let s=[19,34,8,8,8];if(n.src||n.dest){if(t+=`

---

`,t+=`|     |  | dr&nbsp;&nbsp; | ar&nbsp;&nbsp; | (m)&nbsp; | imm |
`,t+="|-----|--|----|----|-----|-----|",n.src){let a=e.length>0?Object.values(n.src).map(f=>f?" "+r:""):Object.values(n.src).map(f=>f?"  \u2713":"");e.forEach((f,h)=>{if(f.src){let b=Object.values(f.src).map(C=>C?" "+i[h]:"");a=a.map((C,S)=>C+b[S])}});let l=a.map(f=>f===""?" -":f).map((f,h)=>f.padEnd(s[h]," "));t+=`
| \`src\`  |&nbsp; &nbsp;|${l.join("|")}|`}if(n.dest){let a=e.length>0?Object.values(n.dest).map(f=>f?" "+r:""):Object.values(n.dest).map(f=>f?"  \u2713":"");e.forEach((f,h)=>{if(f.dest){let b=Object.values(f.dest).map(C=>C?" "+i[h]:"");a=a.map((C,S)=>C+b[S])}});let l=a.map(f=>f===""?" -":f).map((f,h)=>f.padEnd(s[h]," "));t+=`
| \`dst\` |&nbsp; &nbsp;|${l.join("|")}|`}}}else t="\n```rcasm\n",t+=n.syntax.join(`
`),t+=`
\`\`\`

---
`,t+=`**${n.summary}**`,n.description&&(t+=`
${n.description}`);return{kind:Jt.Markdown,value:t}}function As(n){let t="";switch(t+=`**${n.summary}**`,n.description&&(t+=`
${n.description}`),t+=`

---

`,t+=`| Size | Rd | Wr |
`,t+=`|------|:--:|:--:|
`,t+=`| \`${n.size}-bit\` | ${n.canRead?"  \u2713":""} | ${n.canWrite?"  \u2713":""} |`,t+="\n\n---\n```",n.title.toLowerCase()){case"m":case"m1":case"m2":t+=`
\u257B    \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u257B
\u2503\u25C0\u2501\u2501\u25B6\u2502  M1    \u2500\u2500\u256E  \u2502    \u2503
\u2503    \u251C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C M \u254C\u2524\u2501\u2501\u2501\u25B6\u2503
\u2503\u25C0\u2501\u2501\u25B6\u2502  M2    \u2500\u2500\u256F  \u2502    \u2503
\u2503    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2503
\u2516 Data   < Bus >   Addr \u251A`;break;case"xy":case"x":case"y":t+=`
\u257B    \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u257B
\u2503\u25C0\u2501\u2501\u25B6\u2502  X    \u2500\u2500\u256E   \u2502    \u2503
\u2503    \u251C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C XY \u254C\u2524\u25C0\u2501\u2501\u25B6\u2503
\u2503\u25C0\u2501\u2501\u25B6\u2502  Y    \u2500\u2500\u256F   \u2502    \u2503
\u2503    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2503
\u2516 Data   < Bus >   Addr \u251A`;break;case"j":case"j1":case"j2":t+=`
\u257B    \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u257B
\u2503\u2501\u2501\u2501\u25B6\u2502  J1    \u2500\u2500\u256E  \u2502    \u2503
\u2503    \u251C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C\u254C J \u254C\u2524\u2501\u2501\u2501\u25B6\u2503
\u2503\u2501\u2501\u2501\u25B6\u2502  J2    \u2500\u2500\u256F  \u2502    \u2503
\u2503    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2503
\u2516 Data   < Bus >   Addr \u251A`;break;case"b":case"c":t+=`
\u257B    \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510
\u2503\u25C0\u2501\u2501\u25B6\u2502  ${n.title.toUpperCase()}          \u2502\u2501\u2501\u2501\u25B6 ALU
\u2503    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518
\u2516 Data Bus`;break;default:t+=`
\u257B    \u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510
\u2503\u25C0\u2501\u2501\u25B6\u2502  ${n.title.toUpperCase()}          \u2502
\u2503    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518
\u2516 Data Bus`}return t+="\n```\n",{kind:Jt.Markdown,value:t}}var Pr=class{constructor(t){this.ctx=t;this.getCompletionRange=(t,e)=>de.Range.create(de.Position.create(t.line,e.start),de.Position.create(t.line,e.end));this.abcdRegs=["a","b","c","d"];this.dataRegs=[...this.abcdRegs,"m1","m2","x","y"];this.addrRegs=["m","xy","j"]}async onCompletion({position:t,textDocument:e}){let r=this.ctx.store.get(e.uri);if(!r)return[];let i=r.document.getText(de.Range.create(de.Position.create(t.line,0),t)),s=Cr(i??"");if(!s)return[];let a=$h(s,t.character),l=a?.component.value??"",f=a?.type,h=l.length>0&&l.toLowerCase()!==l;switch(a||(s.mnemonic&&t.character>s.mnemonic.end&&!s.comment&&!s.operands&&(f=2),s.mnemonic||(f=1)),f){case 1:return this.completeMnemonics(h,t,a?.component);case 2:{let b=s.mnemonic?.value.toLowerCase();if(!b)return[];let C=b&&jn[b];switch((C&&C.syntax.length?Oh(C.syntax[0]):null)?.operands[a?.index??0].value){case"<label>":return[];case"<src:Dr>":case"<dst:Dr>":return this.completeRegisters(h,this.dataRegs);case"<dst:a|b>":return this.completeRegisters(h,["a","b"]);case"<dst:a|d>":return this.completeRegisters(h,["a","d"]);case"<src:a-d>":case"<dst:a-d>":return this.completeRegisters(h,this.abcdRegs);case"<message>":return[];default:return this.completeOperands(h)}}default:return[]}}ucItems(t,e){return e?t.map(r=>({...r,label:r.label.toUpperCase()})):t}onCompletionResolve(t){if(t.data){let e=jn[t.label.toLowerCase()];if(e)t.documentation=Is(e);else{let r=en[t.label.toLowerCase()];r&&(t.documentation=As(r))}}return t}async completeMnemonics(t,e,r){let i=Object.values(Ms).filter(a=>this.ctx.config.processors.some(l=>a.procs[l])).map(a=>{let l=a.snippet??a.title,f={label:t?a.title.toUpperCase():a.title.toLowerCase(),labelDetails:{description:a.summary},kind:de.CompletionItemKind.Method,insertText:t?l.toUpperCase():l,insertTextFormat:a.snippet?de.InsertTextFormat.Snippet:de.InsertTextFormat.PlainText,data:!0};return r&&(f.textEdit=de.TextEdit.replace(this.getCompletionRange(e,r),f.insertText)),f}),s=Object.values(Ls).map(a=>{let l=a.snippet??a.title,f={label:t?a.title.toUpperCase():a.title.toLowerCase(),labelDetails:{description:a.summary},sortText:a.title.substring(1),kind:de.CompletionItemKind.Keyword,insertText:t?l.toUpperCase():l,insertTextFormat:a.snippet?de.InsertTextFormat.Snippet:de.InsertTextFormat.PlainText,data:!0};return r&&(f.textEdit=de.TextEdit.replace(this.getCompletionRange(e,r),f.insertText)),f});return[...i,...s]}completeDefinitions(t){return Array.from(t.values()).map(e=>{let r=e.name.replace(/^\./,"");return{label:e.name,kind:c0[e.type],filterText:r,insertText:r,detail:"("+e.type+")",documentation:e.comment&&{kind:de.MarkupKind.Markdown,value:e.comment}}})}async completeOperands(t){return[...await this.completeRegisters(t)]}async completeRegisters(t,e){return(e?e.map(i=>en[i]):Object.values(en)).map(i=>({label:t?i.title.toUpperCase():i.title.toLowerCase(),labelDetails:{description:i.summary},kind:de.CompletionItemKind.Keyword,data:!0}))}register(t){return t.onCompletion(this.onCompletion.bind(this)),t.onCompletionResolve(this.onCompletionResolve.bind(this)),{completionProvider:{triggerCharacters:["!"],resolveProvider:!0}}}},c0={label:de.CompletionItemKind.Field,variable:de.CompletionItemKind.Variable};var ym=at(ht());var js=class n{constructor(t,e,r,i){this._uri=t,this._languageId=e,this._version=r,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(t){if(t){let e=this.offsetAt(t.start),r=this.offsetAt(t.end);return this._content.substring(e,r)}return this._content}update(t,e){for(let r of t)if(n.isIncremental(r)){let i=Bh(r.range),s=this.offsetAt(i.start),a=this.offsetAt(i.end);this._content=this._content.substring(0,s)+r.text+this._content.substring(a,this._content.length);let l=Math.max(i.start.line,0),f=Math.max(i.end.line,0),h=this._lineOffsets,b=Fh(r.text,!1,s);if(f-l===b.length)for(let S=0,T=b.length;S<T;S++)h[S+l+1]=b[S];else b.length<1e4?h.splice(l+1,f-l,...b):this._lineOffsets=h=h.slice(0,l+1).concat(b,h.slice(f+1));let C=r.text.length-(a-s);if(C!==0)for(let S=l+1+b.length,T=h.length;S<T;S++)h[S]=h[S]+C}else if(n.isFull(r))this._content=r.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=e}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=Fh(this._content,!0)),this._lineOffsets}positionAt(t){t=Math.max(Math.min(t,this._content.length),0);let e=this.getLineOffsets(),r=0,i=e.length;if(i===0)return{line:0,character:t};for(;r<i;){let a=Math.floor((r+i)/2);e[a]>t?i=a:r=a+1}let s=r-1;return t=this.ensureBeforeEOL(t,e[s]),{line:s,character:t-e[s]}}offsetAt(t){let e=this.getLineOffsets();if(t.line>=e.length)return this._content.length;if(t.line<0)return 0;let r=e[t.line];if(t.character<=0)return r;let i=t.line+1<e.length?e[t.line+1]:this._content.length,s=Math.min(r+t.character,i);return this.ensureBeforeEOL(s,r)}ensureBeforeEOL(t,e){for(;t>e&&zh(this._content.charCodeAt(t-1));)t--;return t}get lineCount(){return this.getLineOffsets().length}static isIncremental(t){let e=t;return e!=null&&typeof e.text=="string"&&e.range!==void 0&&(e.rangeLength===void 0||typeof e.rangeLength=="number")}static isFull(t){let e=t;return e!=null&&typeof e.text=="string"&&e.range===void 0&&e.rangeLength===void 0}},Tr;(function(n){function t(i,s,a,l){return new js(i,s,a,l)}n.create=t;function e(i,s,a){if(i instanceof js)return i.update(s,a),i;throw new Error("TextDocument.update: document must be created by TextDocument.create")}n.update=e;function r(i,s){let a=i.getText(),l=pu(s.map(u0),(b,C)=>{let S=b.range.start.line-C.range.start.line;return S===0?b.range.start.character-C.range.start.character:S}),f=0,h=[];for(let b of l){let C=i.offsetAt(b.range.start);if(C<f)throw new Error("Overlapping edit");C>f&&h.push(a.substring(f,C)),b.newText.length&&h.push(b.newText),f=i.offsetAt(b.range.end)}return h.push(a.substr(f)),h.join("")}n.applyEdits=r})(Tr||(Tr={}));function pu(n,t){if(n.length<=1)return n;let e=n.length/2|0,r=n.slice(0,e),i=n.slice(e);pu(r,t),pu(i,t);let s=0,a=0,l=0;for(;s<r.length&&a<i.length;)t(r[s],i[a])<=0?n[l++]=r[s++]:n[l++]=i[a++];for(;s<r.length;)n[l++]=r[s++];for(;a<i.length;)n[l++]=i[a++];return n}function Fh(n,t,e=0){let r=t?[e]:[];for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);zh(s)&&(s===13&&i+1<n.length&&n.charCodeAt(i+1)===10&&i++,r.push(e+i+1))}return r}function zh(n){return n===13||n===10}function Bh(n){let t=n.start,e=n.end;return t.line>e.line||t.line===e.line&&t.character>e.character?{start:e,end:t}:n}function u0(n){let t=Bh(n.range);return t!==n.range?{newText:n.newText,range:t}:n}var wu=at(ht());function Uh(n,t){return{lines:n,loc:t}}function tn(n,t,e,r){return{label:n,stmt:t,scopedStmts:e,loc:r}}function Hh(n,t){return{name:n,loc:t}}function Wh(n,t){return{type:"setpc",pc:n,loc:t}}function Vh(n){return{type:"getcurpc",loc:n}}function Fs(n,t,e,r){return{type:"insn",mnemonic:n,p1:t,p2:e,loc:r}}var mt;(function(n){n[n.Byte=0]="Byte",n[n.Word=1]="Word"})(mt||(mt={}));function Gh(n,t,e){return{type:"data",values:t,dataSize:n,loc:e}}function Xh(n,t,e){return{type:"fill",numBytes:n,fillValue:t,loc:e}}function Yh(n,t){return{type:"align",alignBytes:n,loc:t}}function Jh(n,t,e){return{type:"if",cases:n,elseBranch:t!==null?t:[],loc:e}}function Qh(n,t){return{type:"error",error:n,loc:t}}function Zh(n,t,e,r){return{type:"for",index:n,list:t,body:e,loc:r}}function Kh(n,t,e){return{type:"let",name:n,value:t,loc:e}}function em(n,t,e){return{type:"callfunc",callee:n,args:t??[],loc:e}}function Bn(n,t,e){return{type:"literal",lit:n,ot:t,loc:e}}function tm(n,t){return{type:"register",value:n,loc:t}}function hu(n,t,e){return{type:"qualified-ident",path:n,absolute:t,loc:e}}function nm(n,t){return{type:"ident",name:n,loc:t}}function Er(n,t,e,r){return{type:"binary",op:n,left:t,right:e,loc:r}}var zt={a:0,d:1},zs={a:0,d:1},l0={a:0,d:1},f0={a:0,b:1},d0={m:0,j:1},mu={a:0,b:1,c:2,d:3,m1:4,m2:5,x:6,y:7},p0={xy:0,pc:1},h0={m:0,xy:1,j:2,as:3},m0={xy:1},im={a:0,b:1,c:2,d:3},W;(function(n){n[n.Direct=0]="Direct",n[n.Alu=1]="Alu",n[n.Clear=2]="Clear",n[n.Goto=3]="Goto",n[n.LodSw=4]="LodSw",n[n.LitOpc=5]="LitOpc",n[n.Move=6]="Move",n[n.Set=7]="Set",n[n.LoadStore=8]="LoadStore",n[n.Divide=9]="Divide"})(W||(W={}));var sm={add:{mt:W.Alu,ops:[{op:129,p1:{cs:zt,op:n=>n<<3},p2:null}]},inc:{mt:W.Alu,ops:[{op:130,p1:{cs:zt,op:n=>n<<3},p2:null}]},and:{mt:W.Alu,ops:[{op:131,p1:{cs:zt,op:n=>n<<3},p2:null}]},orr:{mt:W.Alu,ops:[{op:132,p1:{cs:zt,op:n=>n<<3},p2:null}]},eor:{mt:W.Alu,ops:[{op:133,p1:{cs:zt,op:n=>n<<3},p2:null}]},cmp:{mt:W.Alu,ops:[{op:133,p1:{cs:zt,op:n=>n<<3},p2:null}]},not:{mt:W.Alu,ops:[{op:134,p1:{cs:zt,op:n=>n<<3},p2:null}]},rol:{mt:W.Alu,ops:[{op:135,p1:{cs:zt,op:n=>n<<3},p2:null}]},mov:{mt:W.Move,ops:[{op:0,p1:{cs:mu,op:n=>n<<3},p2:{cs:mu,op:n=>n}},{op:160,p1:{cs:p0,op:n=>n<<2},p2:{cs:h0,op:n=>n}}]},clr:{mt:W.Clear,ops:[{op:0,p1:{cs:mu,op:n=>n<<3|n},p2:null},{op:160,p1:{cs:m0,op:n=>n},p2:null}]},rts:{mt:W.Direct,ops:[{op:165,p1:null,p2:null}]},ldr:{mt:W.LoadStore,ops:[{op:144,p1:{cs:im,op:n=>n},p2:null}]},str:{mt:W.LoadStore,ops:[{op:152,p1:{cs:im,op:n=>n},p2:null}]},ldi:{mt:W.Set,ops:[{op:64,p1:{cs:f0,op:n=>n<<5},p2:{cs:null,op:n=>n&31}},{op:192,p1:{cs:d0,op:n=>n<<5},p2:null}]},hlt:{mt:W.Direct,ops:[{op:174,p1:null,p2:null}]},hlr:{mt:W.Direct,ops:[{op:175,p1:null,p2:null}]},lds:{mt:W.LodSw,ops:[{op:172,p1:{cs:l0,op:n=>n},p2:null}]},ixy:{mt:W.Direct,ops:[{op:176,p1:null,p2:null}]},div:{mt:W.Divide,ops:[{op:184,p1:{cs:zs,op:n=>n},p2:null}]},mod:{mt:W.Divide,ops:[{op:186,p1:{cs:zs,op:n=>n},p2:null}]},dvr:{mt:W.Divide,ops:[{op:188,p1:{cs:zs,op:n=>n},p2:null}]},mdr:{mt:W.Divide,ops:[{op:190,p1:{cs:zs,op:n=>n},p2:null}]},jmp:{mt:W.Goto,ops:[{op:230,p1:null,p2:null}]},jsr:{mt:W.Goto,ops:[{op:231,p1:null,p2:null}]},bne:{mt:W.Goto,ops:[{op:226,p1:null,p2:null}]},beq:{mt:W.Goto,ops:[{op:228,p1:null,p2:null}]},bcs:{mt:W.Goto,ops:[{op:232,p1:null,p2:null}]},bmi:{mt:W.Goto,ops:[{op:240,p1:null,p2:null}]},blt:{mt:W.Goto,ops:[{op:240,p1:null,p2:null}]},ble:{mt:W.Goto,ops:[{op:244,p1:null,p2:null}]},opc:{mt:W.LitOpc,ops:[{op:0,p1:{cs:null,op:n=>n},p2:null}]}};function Ae(n){return n.toString(16).padStart(4,"0")}var Un=class{constructor(t,e,r,i){this.start=t,this.end=e,this.inferStart=r,this.id=i,this.blocks=[{start:t,binary:[]}],this.curBlock=this.blocks[0]}setCurrentPC(t){let e;if(this.inferStart&&this.blocks.length===1&&this.blocks[0].binary.length===0)this.start=t;else{let s=this.end!==void 0?`$${Ae(this.end)}`:"",a=`Segment address range: $${Ae(this.start)}-${s}`;t<this.start?e=`${a}.  Cannot set program counter to a lower address $${Ae(t)}.`:this.end!==void 0&&t>this.end?e=`${a}.  Trying to set program counter to $${Ae(t)} -- it is past segment end ${s}.`:this.blocks.length===1&&this.blocks[0].binary.length===0&&(this.start=t)}let r={start:t,binary:[]},i=this.blocks.push(r);return this.curBlock=this.blocks[i-1],e}empty(){return this.blocks.every(t=>t.binary.length===0)}currentPC(){return this.curBlock.start+this.curBlock.binary.length}emit(t){if(this.currentPC()<this.start||this.end!==void 0&&this.currentPC()>this.end){let e=this.end!==void 0?`$${Ae(this.end)}`:"",r=this.start!==void 0?`$${Ae(this.start)}`:"";return`Segment overflow at $${Ae(this.currentPC())}.  Segment address range: ${r}-${e}`}this.curBlock.binary.push(t)}formatRange(){let t=this.end!==void 0?`$${Ae(this.end)}`:"";return`${this.start!==void 0?`$${Ae(this.start)}`:""}-${t}`}overlaps(t){let e=this.start,r=t.start,i=this.end!==void 0?this.end:this.currentPC(),s=t.end!==void 0?t.end:t.currentPC();return e<r?r<=i:s>=e}};function om(n){let t=[];for(let[e,r]of n){let i=r.blocks.filter(s=>s.binary.length!==0).sort((s,a)=>s.start-a.start);if(i.length!==0){let s=new Un(r.start,r.end,r.inferStart,t.length-1);s.blocks=i,s.curBlock=i[i.length-1],t.push([e,s])}}return t}function am(n){let t=om(n);if(t.length===0)return{startPC:0,binary:Uint8Array.from([])};let[,e]=t[0],r=e.blocks[0],i=e.blocks[e.blocks.length-1],s=r.start,a=i.start+i.binary.length;for(let f=1;f<t.length;f++){let h=t[f][1],b=h.blocks[0].start,C=h.curBlock.start+h.curBlock.binary.length;s=Math.min(b,s),a=Math.max(C,a)}let l=new Uint8Array(a);for(let[,f]of t)for(let h of f.blocks)for(let b=0;b<h.binary.length;b++)l[h.start+b]=h.binary[b];return{startPC:s,binary:l.slice(s)}}function cm(n){return om(n).sort((e,r)=>e[1].start-r[1].start).map(([e,r])=>{let i=r.blocks.map(s=>({start:s.start,end:s.start+s.binary.length-1}));return{name:e,blocks:i}})}var yu=at(dm()),qr=class{constructor(){this.lineStack=[],this.pcToLocs={},this.insnBitset=new yu.TypedFastBitSet,this.dataBitset=new yu.TypedFastBitSet,this.dataLengths={}}startLine(t,e,r){let i={lineNo:t.start.line,segmentId:r.id,numBytes:0};this.lineStack.push({loc:i,pc:e,segmentId:r.id})}endLine(t,e){let r=this.lineStack.pop();if(!r)throw new Error("internal compiler error, mismatching start/end lines in debugInfo");let i=t-r.pc;if(i>0&&e.id===r.segmentId){let s={...r.loc,numBytes:i};this.pcToLocs[r.pc]===void 0?this.pcToLocs[r.pc]=[s]:this.pcToLocs[r.pc].push(s)}}markAsInstruction(t,e){for(let r=t;r<e;r++)this.insnBitset.add(r)}markAsData(t,e){for(let r=t;r<e;r++)this.dataBitset.add(r);this.dataLengths[t]={length:e-t}}info(){let t=this.insnBitset.clone(),e=l=>t.has(l),r=this.dataBitset.clone(),i=l=>r.has(l),s=Object.assign({},this.dataLengths),a=l=>s[l]?.length;return{pcToLocs:this.pcToLocs,isInstruction:e,isData:i,dataLength:a}}};var $r=class extends SyntaxError{constructor(t,e,r,i){super(t),this.expected=e,this.found=r,this.location=i,this.name="SyntaxError"}format(t){let e="Error: "+this.message;if(this.location){let r=null,i=t.find(f=>f.source===this.location.source);i&&(r=i.text.split(/\r\n|\n|\r/g));let s=this.location.start,a=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(s):s,l=this.location.source+":"+a.line+":"+a.column;if(r){let f=this.location.end,h="".padEnd(a.line.toString().length," "),b=r[s.line-1],S=(s.line===f.line?f.column:b.length+1)-s.column||1;e+=`
 --> `+l+`
`+h+` |
`+a.line+" | "+b+`
`+h+" | "+"".padEnd(s.column-1," ")+"".padEnd(S,"^")}else e+=`
 at `+l}return e}static buildMessage(t,e){function r(S){return S.codePointAt(0).toString(16).toUpperCase()}let i=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function s(S){return i?S.replace(i,T=>"\\u{"+r(T)+"}"):S}function a(S){return s(S.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,T=>"\\x0"+r(T)).replace(/[\x10-\x1F\x7F-\x9F]/g,T=>"\\x"+r(T)))}function l(S){return s(S.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,T=>"\\x0"+r(T)).replace(/[\x10-\x1F\x7F-\x9F]/g,T=>"\\x"+r(T)))}let f={literal(S){return'"'+a(S.text)+'"'},class(S){let T=S.parts.map(z=>Array.isArray(z)?l(z[0])+"-"+l(z[1]):l(z));return"["+(S.inverted?"^":"")+T.join("")+"]"+(S.unicode?"u":"")},any(){return"any character"},end(){return"end of input"},other(S){return S.description}};function h(S){return f[S.type](S)}function b(S){let T=S.map(h);if(T.sort(),T.length>0){let z=1;for(let Y=1;Y<T.length;Y++)T[Y-1]!==T[Y]&&(T[z]=T[Y],z++);T.length=z}switch(T.length){case 1:return T[0];case 2:return T[0]+" or "+T[1];default:return T.slice(0,-1).join(", ")+", or "+T[T.length-1]}}function C(S){return S?'"'+a(S)+'"':"end of input"}return"Expected "+b(t)+" but "+C(e)+" found."}};function vu(n,t){t=t!==void 0?t:{};let e={},r=t.grammarSource,i={Program:Iu},s=Iu,a="in",l="a",f="b",h="c",b="d",C="e",S="f",T="g",z="i",Y="j",ne="l",G="m",R="n",x="o",O="p",Z="r",me="s",Ht="t",Ur="w",Hr="x",Wr="y",Vr="0",it="1",Gr="2",Us=",",Hs="/",Ws="=",Vs="%",Xr="<",Yr=">",gt="<=",Xn=">=",Jr="==",Qr="!=",Zr="!",Kr="(",Gs=")",Xs="{",Ys="}",Js="-",Qs="+",Zs="\xA7",st="*",Wt='"',Ks=";",nn=":",ze="::",Yn=/^[a-zA-Z_]/,eo=/^[a-zA-Z_0-9]/,yt=/^[0-9a-f]/i,St=/^[0-1]/,to=/^[+\-]/,ei=/^[0-9]/,vt=/^[=]/,ti=/^[\t\v-\f \xA0\uFEFF]/,ni=/^[\n\r]/,Jn=/^[a-d]/i,ri=/^[x-y]/i,wt=Ue("directive"),g=U("in",!1),P=et([["a","z"],["A","Z"],"_"],!1,!1,!1),$=et([["a","z"],["A","Z"],"_",["0","9"]],!1,!1,!1),I=et([["0","9"],["a","f"]],!1,!0,!1),ie=et([["0","1"]],!1,!1,!1),re=et(["+","-"],!1,!1,!1),oe=et([["0","9"]],!1,!1,!1),le=U("a",!0),J=U("b",!0),ae=U("c",!0),ee=U("d",!0),ge=U("e",!0),Re=U("f",!0),Be=U("g",!0),no=U("i",!0),Sm=U("j",!0),wm=U("l",!0),Cm=U("m",!0),Pm=U("n",!0),Tm=U("o",!0),Em=U("p",!0),qm=U("r",!0),$m=U("s",!0),Om=U("t",!0),Mm=U("w",!0),Lm=U("x",!0),Nm=U("y",!0),km=U("0",!1),Im=U("1",!1),Am=U("2",!1),jm=U(",",!1),Fm=U("/",!1),zm=U("=",!1),Bm=U("%",!1),Um=U("<",!1),ro=et(["="],!1,!1,!1),Hm=U(">",!1),Wm=U("<=",!1),Vm=U(">=",!1),Gm=U("==",!1),Xm=U("!=",!1),Ym=U("!",!1),Jm=U("(",!1),Qm=U(")",!1),Zm=U("{",!1),Km=U("}",!1),eg=U("-",!1),tg=U("+",!1),ng=U("\xA7",!1),rg=U("*",!1),Qn=U('"',!1),io=fy(),Mu=Ue("whitespace"),ig=et(["	",["\v","\f"]," ","\xA0","\uFEFF"],!1,!1,!1),sg=Ue("end of line"),og=et([`
`,"\r"],!1,!1,!1),ag=Ue("comment"),cg=U(";",!1),ug=Ue("label"),lg=U(":",!1),fg=Ue("ORG"),dg=Ue("mnemonic"),pg=Ue("literal"),Lu=Ue("identifier"),Zn=U("::",!1),hg=Ue("register"),mg=et([["a","d"]],!1,!0,!1),gg=et([["x","y"]],!1,!0,!1),yg=Ue("current-pc");function vg(o){return Uh(o,Q())}function bg(o,c){return hi(o,c,1)}function M0(o){return o}function Dg(o,c){return tn(o,null,c,Q())}function xg(o,c){return tn(o,c,null,Q())}function Rg(o){return tn(o,null,null,Q())}function _g(o){return tn(null,o,null,Q())}function Sg(o){return tn(null,o,null,Q())}function wg(){return tn(null,null,null,Q())}function L0(o){return o}function N0(o){return o}function Cg(o,c){let p=o=="byte"?mt.Byte:mt.Word;return Gh(p,c,Q())}function Pg(o,c){return Xh(o,c,Q())}function Tg(o,c,p,d){let y=[o,...p.map(k=>k.condition)],v=[c,...p.map(k=>k.trueBranch)],A=y.map((k,ot)=>[k,v[ot]]);return Jh(A,d,Q())}function Eg(o,c,p){return Zh(o,c,p,Q())}function qg(o,c){return Kh(o,c,Q())}function $g(o){return Qh(o,Q())}function Og(o){return Yh(o,Q())}function Mg(o,c){return{condition:o,trueBranch:c}}function k0(o){return o}function Lg(o,c){return hi(o,c,3)}function Ng(o,c,p){return Fs(o,c,p,Q())}function kg(o,c){return Fs(o,c,null,Q())}function Ig(o){return Fs(o,null,null,Q())}function Ag(o,c){return c.reduce(function(p,d){return Er(d[1],p,d[3],Q())},o)}function jg(o,c){return c.reduce(function(p,d){return Er(d[1],p,d[3],Q())},o)}function Fg(o,c){return c.reduce(function(p,d){return Er(d[1],p,d[3],Q())},o)}function zg(o,c){return c.reduce(function(p,d){return Er(d[1],p,d[3],Q())},o)}function Bg(o,c){return em(o,c,Q())}function I0(o){return o}function A0(o){return o}function j0(o){return o}function F0(o){return o}function z0(o){return o}function B0(o){return o}function U0(o){return o}function H0(o){return o}function W0(o){return o}function V0(o){return o}function G0(o){return o}function X0(o){return o}function Y0(o){return o}function J0(o){return o}function Q0(o){return o}function Z0(o){return o}function K0(o){return o}function eD(o){return o}function tD(o){return o}function nD(o){return o}function Ug(){return"byte"}function Hg(){return"word"}function Wg(o){return parseInt(o,2)}function Vg(o){return parseInt(o,16)}function Gg(o){return parseInt(o)}function Xg(o){return o.join("")}function Yg(o){return Bn(o.join(""),Q())}function rD(o){return o}function Jg(){return cy()}function iD(o){return o}function Qg(o){return Hh(o,Q())}function Zg(o){return Wh(o,Q())}function sD(o){return o}function Kg(o){return Bn(o,"b",Q())}function ey(o){return Bn(o,"h",Q())}function ty(o){return Bn(o,"d",Q())}function ny(o){return Bn(o,"s",Q())}function ry(o,c){return hu(hi(o,c,1),!1,Q())}function iy(o,c){return hu(hi(o,c,1),!0,Q())}function sy(o){return nm(o,Q())}function oy(o){return tm(o.toLowerCase(),Q())}function ay(){return Vh(Q())}let u=t.peg$currPos|0,M=u,rn=[{line:1,column:1}],Ke=u,ii=t.peg$maxFailExpected||[],_=t.peg$silentFails|0,Kn;if(t.startRule){if(!(t.startRule in i))throw new Error(`Can't start parsing from rule "`+t.startRule+'".');s=i[t.startRule]}function cy(){return n.substring(M,u)}function oD(){return M}function aD(){return{source:r,start:M,end:u}}function uy(){return er(M,u)}function cD(o,c){throw c=c!==void 0?c:er(M,u),ku([Ue(o)],n.substring(M,u),c)}function uD(o,c){throw c=c!==void 0?c:er(M,u),py(o,c)}function ly(o=u){let c=n.codePointAt(o);return c===void 0?"":String.fromCodePoint(c)}function U(o,c){return{type:"literal",text:o,ignoreCase:c}}function et(o,c,p,d){return{type:"class",parts:o,inverted:c,ignoreCase:p,unicode:d}}function fy(){return{type:"any"}}function dy(){return{type:"end"}}function Ue(o){return{type:"other",description:o}}function Nu(o){let c=rn[o],p;if(c)return c;if(o>=rn.length)p=rn.length-1;else for(p=o;!rn[--p];);for(c=rn[p],c={line:c.line,column:c.column};p<o;)n.charCodeAt(p)===10?(c.line++,c.column=1):c.column++,p++;return rn[o]=c,c}function er(o,c,p){let d=Nu(o),y=Nu(c),v={source:r,start:{offset:o,line:d.line,column:d.column},end:{offset:c,line:y.line,column:y.column}};return p&&r&&typeof r.offset=="function"&&(v.start=r.offset(v.start),v.end=r.offset(v.end)),v}function E(o){u<Ke||(u>Ke&&(Ke=u,ii=[]),ii.push(o))}function py(o,c){return new $r(o,null,null,c)}function ku(o,c,p){return new $r($r.buildMessage(o,c),o,c,p)}function Iu(){let o,c;return o=u,c=sn(),c!==e&&(M=o,c=vg(c)),o=c,o}function sn(){let o,c,p,d,y,v;if(o=u,c=so(),c!==e){for(p=[],d=u,y=pi(),y!==e?(v=so(),v!==e?(y=[y,v],d=y):(u=d,d=e)):(u=d,d=e);d!==e;)p.push(d),d=u,y=pi(),y!==e?(v=so(),v!==e?(y=[y,v],d=y):(u=d,d=e)):(u=d,d=e);M=o,o=bg(c,p)}else u=o,o=e;return o}function so(){let o,c,p,d,y;return o=u,c=j(),p=hy(),p!==e?(d=j(),y=Hy(),y===e&&(y=null),M=o,o=p):(u=o,o=e),o}function hy(){let o,c,p,d,y,v,A,k;return o=u,c=go(),c!==e?(p=j(),d=tr(),d!==e?(y=j(),v=sn(),v!==e?(A=j(),k=nr(),k!==e?(M=o,o=Dg(c,v)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o===e&&(o=u,c=go(),c!==e?(p=j(),d=Au(),d!==e?(M=o,o=xg(c,d)):(u=o,o=e)):(u=o,o=e),o===e&&(o=u,c=go(),c!==e&&(M=o,c=Rg(c)),o=c,o===e&&(o=u,c=Wy(),c!==e&&(M=o,c=_g(c)),o=c,o===e&&(o=u,c=Au(),c!==e&&(M=o,c=Sg(c)),o=c,o===e&&(o=u,c=j(),M=o,c=wg(),o=c))))),o}function Au(){let o,c;return o=u,c=my(),c!==e&&(M=o,c=c),o=c,o===e&&(o=u,c=yy(),c!==e&&(M=o,c=c),o=c),o}function my(){let o,c,p,d,y,v,A,k,ot,un,rr,Pt,ln,fn,dn,Tt;if(_++,o=u,c=Ey(),c===e&&(c=qy()),c!==e?(p=He(),p!==e?(d=Fu(),d!==e?(M=o,o=Cg(c,d)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o===e&&(o=u,c=Iy(),c!==e?(p=He(),p!==e?(d=qe(),d!==e?(y=j(),v=ci(),v!==e?(A=j(),k=qe(),k!==e?(M=o,o=Pg(d,k)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o===e)){if(o=u,c=My(),c!==e)if(p=He(),p!==e)if(d=ui(),d!==e)if(y=j(),v=qe(),v!==e)if(A=j(),k=li(),k!==e)if(ot=j(),un=tr(),un!==e)if(rr=j(),Pt=sn(),Pt!==e)if(ln=j(),fn=nr(),fn!==e){for(dn=[],Tt=ju();Tt!==e;)dn.push(Tt),Tt=ju();Tt=gy(),Tt===e&&(Tt=null),M=o,o=Tg(v,Pt,dn,Tt)}else u=o,o=e;else u=o,o=e;else u=o,o=e;else u=o,o=e;else u=o,o=e;else u=o,o=e;else u=o,o=e;else u=o,o=e;o===e&&(o=u,c=$y(),c!==e?(p=He(),p!==e?(d=ll(),d!==e?(y=He(),y!==e?(n.substr(u,2)===a?(v=a,u+=2):(v=e,_===0&&E(g)),v!==e?(A=He(),A!==e?(k=qe(),k!==e?(ot=j(),un=tr(),un!==e?(rr=j(),Pt=sn(),Pt!==e?(ln=j(),fn=nr(),fn!==e?(M=o,o=Eg(d,k,Pt)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o===e&&(o=u,c=Oy(),c!==e?(p=He(),p!==e?(d=ll(),d!==e?(y=j(),v=Py(),v!==e?(A=j(),k=qe(),k!==e?(M=o,o=qg(d,k)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o===e&&(o=u,c=ky(),c!==e?(p=He(),p!==e?(d=By(),d!==e?(M=o,o=$g(d)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o===e&&(o=u,c=Ty(),c!==e?(p=He(),p!==e?(d=qe(),d!==e?(M=o,o=Og(d)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)))))}return _--,o===e&&(c=e,_===0&&E(wt)),o}function ju(){let o,c,p,d,y,v,A,k,ot,un,rr,Pt,ln,fn,dn;return o=u,c=j(),p=Ny(),p!==e?(d=j(),y=ui(),y!==e?(v=j(),A=qe(),A!==e?(k=j(),ot=li(),ot!==e?(un=j(),rr=tr(),rr!==e?(Pt=j(),ln=sn(),ln!==e?(fn=j(),dn=nr(),dn!==e?(M=o,o=Mg(A,ln)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o}function gy(){let o,c,p,d,y,v,A,k,ot;return o=u,c=j(),p=Ly(),p!==e?(d=j(),y=tr(),y!==e?(v=j(),A=sn(),A!==e?(k=j(),ot=nr(),ot!==e?(M=o,o=A):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o}function Fu(){let o,c,p,d,y,v,A,k;if(o=u,c=qe(),c!==e){for(p=[],d=u,y=j(),v=ci(),v!==e?(A=j(),k=qe(),k!==e?(y=[y,v,A,k],d=y):(u=d,d=e)):(u=d,d=e);d!==e;)p.push(d),d=u,y=j(),v=ci(),v!==e?(A=j(),k=qe(),k!==e?(y=[y,v,A,k],d=y):(u=d,d=e)):(u=d,d=e);M=o,o=Lg(c,p)}else u=o,o=e;return o}function yy(){let o,c,p,d,y,v,A,k;return o=u,c=yo(),c!==e?(p=He(),p!==e?(d=qe(),d!==e?(y=j(),v=ci(),v!==e?(A=j(),k=qe(),k!==e?(M=o,o=Ng(c,d,k)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o===e&&(o=u,c=yo(),c!==e?(p=He(),p!==e?(d=qe(),d!==e?(M=o,o=kg(c,d)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o===e&&(o=u,c=yo(),c!==e&&(M=o,c=Ig(c)),o=c)),o}function oo(){let o,c,p,d,y,v,A,k;if(o=u,c=uo(),c!==e){for(p=[],d=u,y=j(),v=mo(),v===e&&(v=Zu(),v===e&&(v=Ku())),v!==e?(A=j(),k=uo(),k!==e?(y=[y,v,A,k],d=y):(u=d,d=e)):(u=d,d=e);d!==e;)p.push(d),d=u,y=j(),v=mo(),v===e&&(v=Zu(),v===e&&(v=Ku())),v!==e?(A=j(),k=uo(),k!==e?(y=[y,v,A,k],d=y):(u=d,d=e)):(u=d,d=e);M=o,o=Ag(c,p)}else u=o,o=e;return o===e&&(o=lo()),o}function ao(){let o,c,p,d,y,v,A,k;if(o=u,c=oo(),c!==e){for(p=[],d=u,y=j(),v=al(),v===e&&(v=ol(),v===e&&(v=cl())),v!==e?(A=j(),k=oo(),k!==e?(y=[y,v,A,k],d=y):(u=d,d=e)):(u=d,d=e);d!==e;)p.push(d),d=u,y=j(),v=al(),v===e&&(v=ol(),v===e&&(v=cl())),v!==e?(A=j(),k=oo(),k!==e?(y=[y,v,A,k],d=y):(u=d,d=e)):(u=d,d=e);M=o,o=jg(c,p)}else u=o,o=e;return o}function co(){let o,c,p,d,y,v,A,k;if(o=u,c=ao(),c!==e){for(p=[],d=u,y=j(),v=nl(),v===e&&(v=rl(),v===e&&(v=el(),v===e&&(v=tl()))),v!==e?(A=j(),k=ao(),k!==e?(y=[y,v,A,k],d=y):(u=d,d=e)):(u=d,d=e);d!==e;)p.push(d),d=u,y=j(),v=nl(),v===e&&(v=rl(),v===e&&(v=el(),v===e&&(v=tl()))),v!==e?(A=j(),k=ao(),k!==e?(y=[y,v,A,k],d=y):(u=d,d=e)):(u=d,d=e);M=o,o=Fg(c,p)}else u=o,o=e;return o}function qe(){let o,c,p,d,y,v,A,k;if(o=u,c=co(),c!==e){for(p=[],d=u,y=j(),v=il(),v===e&&(v=sl()),v!==e?(A=j(),k=co(),k!==e?(y=[y,v,A,k],d=y):(u=d,d=e)):(u=d,d=e);d!==e;)p.push(d),d=u,y=j(),v=il(),v===e&&(v=sl()),v!==e?(A=j(),k=co(),k!==e?(y=[y,v,A,k],d=y):(u=d,d=e)):(u=d,d=e);M=o,o=zg(c,p)}else u=o,o=e;return o}function uo(){let o;return o=vy(),o===e&&(o=lo()),o}function vy(){let o,c,p,d,y,v,A,k;return o=u,c=lo(),c!==e?(p=j(),d=ui(),d!==e?(y=j(),v=Fu(),v===e&&(v=null),A=j(),k=li(),k!==e?(M=o,o=Bg(c,v)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o}function lo(){let o,c,p,d,y,v;return o=ul(),o===e&&(o=Gy(),o===e&&(o=Vy(),o===e&&(o=Xy(),o===e&&(o=u,c=ui(),c!==e?(p=j(),d=qe(),d!==e?(y=j(),v=li(),v!==e?(M=o,o=d):(u=o,o=e)):(u=o,o=e)):(u=o,o=e))))),o}function fo(){let o;return o=n.charAt(u),Yn.test(o)?u++:(o=e,_===0&&E(P)),o}function zu(){let o;return o=n.charAt(u),eo.test(o)?u++:(o=e,_===0&&E($)),o}function by(){let o,c;if(o=[],c=n.charAt(u),yt.test(c)?u++:(c=e,_===0&&E(I)),c!==e)for(;c!==e;)o.push(c),c=n.charAt(u),yt.test(c)?u++:(c=e,_===0&&E(I));else o=e;return o}function Dy(){let o,c;if(o=[],c=n.charAt(u),St.test(c)?u++:(c=e,_===0&&E(ie)),c!==e)for(;c!==e;)o.push(c),c=n.charAt(u),St.test(c)?u++:(c=e,_===0&&E(ie));else o=e;return o}function xy(){let o,c,p,d;if(o=u,c=n.charAt(u),to.test(c)?u++:(c=e,_===0&&E(re)),c===e&&(c=null),p=[],d=n.charAt(u),ei.test(d)?u++:(d=e,_===0&&E(oe)),d!==e)for(;d!==e;)p.push(d),d=n.charAt(u),ei.test(d)?u++:(d=e,_===0&&E(oe));else p=e;return p!==e?(c=[c,p],o=c):(u=o,o=e),o}function Bu(){let o;return o=n.charAt(u),o.toLowerCase()===l?u++:(o=e,_===0&&E(le)),o}function Uu(){let o;return o=n.charAt(u),o.toLowerCase()===f?u++:(o=e,_===0&&E(J)),o}function Ry(){let o;return o=n.charAt(u),o.toLowerCase()===h?u++:(o=e,_===0&&E(ae)),o}function Hu(){let o;return o=n.charAt(u),o.toLowerCase()===b?u++:(o=e,_===0&&E(ee)),o}function on(){let o;return o=n.charAt(u),o.toLowerCase()===C?u++:(o=e,_===0&&E(ge)),o}function si(){let o;return o=n.charAt(u),o.toLowerCase()===S?u++:(o=e,_===0&&E(Re)),o}function Wu(){let o;return o=n.charAt(u),o.toLowerCase()===T?u++:(o=e,_===0&&E(Be)),o}function oi(){let o;return o=n.charAt(u),o.toLowerCase()===z?u++:(o=e,_===0&&E(no)),o}function po(){let o;return o=n.charAt(u),o.toLowerCase()===Y?u++:(o=e,_===0&&E(Sm)),o}function an(){let o;return o=n.charAt(u),o.toLowerCase()===ne?u++:(o=e,_===0&&E(wm)),o}function ho(){let o;return o=n.charAt(u),o.toLowerCase()===G?u++:(o=e,_===0&&E(Cm)),o}function _y(){let o;return o=n.charAt(u),o.toLowerCase()===R?u++:(o=e,_===0&&E(Pm)),o}function ai(){let o;return o=n.charAt(u),o.toLowerCase()===x?u++:(o=e,_===0&&E(Tm)),o}function Sy(){let o;return o=n.charAt(u),o.toLowerCase()===O?u++:(o=e,_===0&&E(Em)),o}function cn(){let o;return o=n.charAt(u),o.toLowerCase()===Z?u++:(o=e,_===0&&E(qm)),o}function Vu(){let o;return o=n.charAt(u),o.toLowerCase()===me?u++:(o=e,_===0&&E($m)),o}function Gu(){let o;return o=n.charAt(u),o.toLowerCase()===Ht?u++:(o=e,_===0&&E(Om)),o}function wy(){let o;return o=n.charAt(u),o.toLowerCase()===Ur?u++:(o=e,_===0&&E(Mm)),o}function Xu(){let o;return o=n.charAt(u),o.toLowerCase()===Hr?u++:(o=e,_===0&&E(Lm)),o}function Yu(){let o;return o=n.charAt(u),o.toLowerCase()===Wr?u++:(o=e,_===0&&E(Nm)),o}function Cy(){let o;return n.charCodeAt(u)===48?(o=Vr,u++):(o=e,_===0&&E(km)),o}function Ju(){let o;return n.charCodeAt(u)===49?(o=it,u++):(o=e,_===0&&E(Im)),o}function Qu(){let o;return n.charCodeAt(u)===50?(o=Gr,u++):(o=e,_===0&&E(Am)),o}function ci(){let o,c;return o=u,n.charCodeAt(u)===44?(c=Us,u++):(c=e,_===0&&E(jm)),c!==e&&(M=o,c=c),o=c,o}function Zu(){let o,c;return o=u,n.charCodeAt(u)===47?(c=Hs,u++):(c=e,_===0&&E(Fm)),c!==e&&(M=o,c=c),o=c,o}function Py(){let o,c;return o=u,n.charCodeAt(u)===61?(c=Ws,u++):(c=e,_===0&&E(zm)),c!==e&&(M=o,c=c),o=c,o}function Ku(){let o,c;return o=u,n.charCodeAt(u)===37?(c=Vs,u++):(c=e,_===0&&E(Bm)),c!==e&&(M=o,c=c),o=c,o}function el(){let o,c,p,d;return o=u,n.charCodeAt(u)===60?(c=Xr,u++):(c=e,_===0&&E(Um)),c!==e?(p=u,_++,d=n.charAt(u),vt.test(d)?u++:(d=e,_===0&&E(ro)),_--,d===e?p=void 0:(u=p,p=e),p!==e?(M=o,o=c):(u=o,o=e)):(u=o,o=e),o}function tl(){let o,c,p,d;return o=u,n.charCodeAt(u)===62?(c=Yr,u++):(c=e,_===0&&E(Hm)),c!==e?(p=u,_++,d=n.charAt(u),vt.test(d)?u++:(d=e,_===0&&E(ro)),_--,d===e?p=void 0:(u=p,p=e),p!==e?(M=o,o=c):(u=o,o=e)):(u=o,o=e),o}function nl(){let o,c;return o=u,n.substr(u,2)===gt?(c=gt,u+=2):(c=e,_===0&&E(Wm)),c!==e&&(M=o,c=c),o=c,o}function rl(){let o,c;return o=u,n.substr(u,2)===Xn?(c=Xn,u+=2):(c=e,_===0&&E(Vm)),c!==e&&(M=o,c=c),o=c,o}function il(){let o,c;return o=u,n.substr(u,2)===Jr?(c=Jr,u+=2):(c=e,_===0&&E(Gm)),c!==e&&(M=o,c=c),o=c,o}function sl(){let o,c;return o=u,n.substr(u,2)===Qr?(c=Qr,u+=2):(c=e,_===0&&E(Xm)),c!==e&&(M=o,c=c),o=c,o}function Ct(){let o,c,p,d;return o=u,n.charCodeAt(u)===33?(c=Zr,u++):(c=e,_===0&&E(Ym)),c!==e?(p=u,_++,d=n.charAt(u),vt.test(d)?u++:(d=e,_===0&&E(ro)),_--,d===e?p=void 0:(u=p,p=e),p!==e?(M=o,o=c):(u=o,o=e)):(u=o,o=e),o}function ui(){let o,c;return o=u,n.charCodeAt(u)===40?(c=Kr,u++):(c=e,_===0&&E(Jm)),c!==e&&(M=o,c=c),o=c,o}function li(){let o,c;return o=u,n.charCodeAt(u)===41?(c=Gs,u++):(c=e,_===0&&E(Qm)),c!==e&&(M=o,c=c),o=c,o}function tr(){let o,c;return o=u,n.charCodeAt(u)===123?(c=Xs,u++):(c=e,_===0&&E(Zm)),c!==e&&(M=o,c=c),o=c,o}function nr(){let o,c;return o=u,n.charCodeAt(u)===125?(c=Ys,u++):(c=e,_===0&&E(Km)),c!==e&&(M=o,c=c),o=c,o}function ol(){let o,c;return o=u,n.charCodeAt(u)===45?(c=Js,u++):(c=e,_===0&&E(eg)),c!==e&&(M=o,c=c),o=c,o}function al(){let o,c;return o=u,n.charCodeAt(u)===43?(c=Qs,u++):(c=e,_===0&&E(tg)),c!==e&&(M=o,c=c),o=c,o}function cl(){let o,c;return o=u,n.charCodeAt(u)===167?(c=Zs,u++):(c=e,_===0&&E(ng)),c!==e&&(M=o,c=c),o=c,o}function mo(){let o,c;return o=u,n.charCodeAt(u)===42?(c=st,u++):(c=e,_===0&&E(rg)),c!==e&&(M=o,c=c),o=c,o}function Ty(){let o,c,p,d,y,v,A;return o=u,c=Ct(),c!==e?(p=Bu(),p!==e?(d=an(),d!==e?(y=oi(),y!==e?(v=Wu(),v!==e?(A=_y(),A!==e?(c=[c,p,d,y,v,A],o=c):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o}function Ey(){let o,c,p,d,y,v;return o=u,c=Ct(),c!==e?(p=Uu(),p!==e?(d=Yu(),d!==e?(y=Gu(),y!==e?(v=on(),v!==e?(M=o,o=Ug()):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o}function qy(){let o,c,p,d,y,v;return o=u,c=Ct(),c!==e?(p=wy(),p!==e?(d=ai(),d!==e?(y=cn(),y!==e?(v=Hu(),v!==e?(M=o,o=Hg()):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o}function $y(){let o,c,p,d,y;return o=u,c=Ct(),c!==e?(p=si(),p!==e?(d=ai(),d!==e?(y=cn(),y!==e?(c=[c,p,d,y],o=c):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o}function Oy(){let o,c,p,d,y;return o=u,c=Ct(),c!==e?(p=an(),p!==e?(d=on(),d!==e?(y=Gu(),y!==e?(c=[c,p,d,y],o=c):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o}function My(){let o,c,p,d;return o=u,c=Ct(),c!==e?(p=oi(),p!==e?(d=si(),d!==e?(c=[c,p,d],o=c):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o}function Ly(){let o,c,p,d,y;return o=u,c=on(),c!==e?(p=an(),p!==e?(d=Vu(),d!==e?(y=on(),y!==e?(c=[c,p,d,y],o=c):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o}function Ny(){let o,c,p,d,y;return o=u,c=on(),c!==e?(p=an(),p!==e?(d=oi(),d!==e?(y=si(),y!==e?(c=[c,p,d,y],o=c):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o}function ky(){let o,c,p,d,y,v,A;return o=u,c=Ct(),c!==e?(p=on(),p!==e?(d=cn(),d!==e?(y=cn(),y!==e?(v=ai(),v!==e?(A=cn(),A!==e?(c=[c,p,d,y,v,A],o=c):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o}function Iy(){let o,c,p,d,y,v;return o=u,c=Ct(),c!==e?(p=si(),p!==e?(d=oi(),d!==e?(y=an(),y!==e?(v=an(),v!==e?(c=[c,p,d,y,v],o=c):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o}function Ay(){let o,c,p;return o=u,c=u,p=Dy(),p!==e?c=n.substring(c,u):c=p,c!==e?(p=Uu(),p!==e?(M=o,o=Wg(c)):(u=o,o=e)):(u=o,o=e),o}function jy(){let o,c,p,d,y;return o=u,c=Cy(),c!==e?(p=Xu(),p!==e?(d=u,y=by(),y!==e?d=n.substring(d,u):d=y,d!==e?(M=o,o=Vg(d)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),o}function Fy(){let o,c,p;return o=u,c=u,p=xy(),p!==e?c=n.substring(c,u):c=p,c!==e?(p=Hu(),p===e&&(p=null),M=o,o=Gg(c)):(u=o,o=e),o}function zy(){let o,c,p,d;if(o=u,n.charCodeAt(u)===34?(c=Wt,u++):(c=e,_===0&&E(Qn)),c!==e){for(p=[],d=fi();d!==e;)p.push(d),d=fi();n.charCodeAt(u)===34?(d=Wt,u++):(d=e,_===0&&E(Qn)),d!==e?(M=o,o=Xg(p)):(u=o,o=e)}else u=o,o=e;return o}function By(){let o,c,p,d;if(o=u,n.charCodeAt(u)===34?(c=Wt,u++):(c=e,_===0&&E(Qn)),c!==e){for(p=[],d=fi();d!==e;)p.push(d),d=fi();n.charCodeAt(u)===34?(d=Wt,u++):(d=e,_===0&&E(Qn)),d!==e?(M=o,o=Yg(p)):(u=o,o=e)}else u=o,o=e;return o}function fi(){let o,c,p;return o=u,c=u,_++,n.charCodeAt(u)===34?(p=Wt,u++):(p=e,_===0&&E(Qn)),_--,p===e?c=void 0:(u=c,c=e),c!==e?(n.length>u?(p=n.charAt(u),u++):(p=e,_===0&&E(io)),p!==e?(M=o,o=p):(u=o,o=e)):(u=o,o=e),o}function bt(){let o,c,p,d,y;if(o=u,c=u,p=[],d=fo(),d!==e)for(;d!==e;)p.push(d),d=fo();else p=e;if(p!==e){for(d=[],y=zu();y!==e;)d.push(y),y=zu();p=[p,d],c=p}else u=c,c=e;return c!==e&&(M=o,c=Jg()),o=c,o}function Uy(){let o,c;return o=u,c=bt(),c!==e&&(M=o,c=c),o=c,o}function He(){let o,c;if(_++,o=[],c=di(),c!==e)for(;c!==e;)o.push(c),c=di();else o=e;return _--,o===e&&(c=e,_===0&&E(Mu)),o}function j(){let o,c;for(_++,o=[],c=di();c!==e;)o.push(c),c=di();return _--,o}function di(){let o,c;return _++,o=n.charAt(u),ti.test(o)?u++:(o=e,_===0&&E(ig)),_--,o===e&&(c=e,_===0&&E(Mu)),o}function pi(){let o,c;return _++,o=n.charAt(u),ni.test(o)?u++:(o=e,_===0&&E(og)),_--,o===e&&(c=e,_===0&&E(sg)),o}function Hy(){let o,c,p,d,y,v;if(_++,o=u,n.charCodeAt(u)===59?(c=Ks,u++):(c=e,_===0&&E(cg)),c!==e){for(p=[],d=u,y=u,_++,v=pi(),_--,v===e?y=void 0:(u=y,y=e),y!==e?(n.length>u?(v=n.charAt(u),u++):(v=e,_===0&&E(io)),v!==e?(y=[y,v],d=y):(u=d,d=e)):(u=d,d=e);d!==e;)p.push(d),d=u,y=u,_++,v=pi(),_--,v===e?y=void 0:(u=y,y=e),y!==e?(n.length>u?(v=n.charAt(u),u++):(v=e,_===0&&E(io)),v!==e?(y=[y,v],d=y):(u=d,d=e)):(u=d,d=e);c=[c,p],o=c}else u=o,o=e;return _--,o===e&&(c=e,_===0&&E(ag)),o}function go(){let o,c,p;return _++,o=u,c=bt(),c!==e?(n.charCodeAt(u)===58?(p=nn,u++):(p=e,_===0&&E(lg)),p!==e?(M=o,o=Qg(c)):(u=o,o=e)):(u=o,o=e),_--,o===e&&(c=e,_===0&&E(ug)),o}function Wy(){let o,c,p,d,y,v;return _++,o=u,c=ai(),c!==e?(p=cn(),p!==e?(d=Wu(),d!==e?(y=He(),y!==e?(v=ul(),v!==e?(M=o,o=Zg(v)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e)):(u=o,o=e),_--,o===e&&(c=e,_===0&&E(fg)),o}function yo(){let o,c;return _++,o=u,c=bt(),c!==e&&(M=o,c=c),o=c,_--,o===e&&(c=e,_===0&&E(dg)),o}function ul(){let o,c;return _++,o=u,c=Ay(),c!==e&&(M=o,c=Kg(c)),o=c,o===e&&(o=u,c=jy(),c!==e&&(M=o,c=ey(c)),o=c,o===e&&(o=u,c=Fy(),c!==e&&(M=o,c=ty(c)),o=c,o===e&&(o=u,c=zy(),c!==e&&(M=o,c=ny(c)),o=c))),_--,o===e&&(c=e,_===0&&E(pg)),o}function Vy(){let o,c,p,d,y,v,A;if(_++,o=u,c=bt(),c!==e){for(p=[],d=u,n.substr(u,2)===ze?(y=ze,u+=2):(y=e,_===0&&E(Zn)),y!==e?(v=bt(),v!==e?(y=[y,v],d=y):(u=d,d=e)):(u=d,d=e);d!==e;)p.push(d),d=u,n.substr(u,2)===ze?(y=ze,u+=2):(y=e,_===0&&E(Zn)),y!==e?(v=bt(),v!==e?(y=[y,v],d=y):(u=d,d=e)):(u=d,d=e);M=o,o=ry(c,p)}else u=o,o=e;if(o===e)if(o=u,n.substr(u,2)===ze?(c=ze,u+=2):(c=e,_===0&&E(Zn)),c!==e)if(p=bt(),p!==e){for(d=[],y=u,n.substr(u,2)===ze?(v=ze,u+=2):(v=e,_===0&&E(Zn)),v!==e?(A=bt(),A!==e?(v=[v,A],y=v):(u=y,y=e)):(u=y,y=e);y!==e;)d.push(y),y=u,n.substr(u,2)===ze?(v=ze,u+=2):(v=e,_===0&&E(Zn)),v!==e?(A=bt(),A!==e?(v=[v,A],y=v):(u=y,y=e)):(u=y,y=e);M=o,o=iy(p,d)}else u=o,o=e;else u=o,o=e;return _--,o===e&&(c=e,_===0&&E(Lu)),o}function ll(){let o,c;return _++,o=u,c=Uy(),c!==e&&(M=o,c=sy(c)),o=c,_--,o===e&&(c=e,_===0&&E(Lu)),o}function Gy(){let o,c,p,d,y;return _++,o=u,c=u,p=u,d=Bu(),d!==e?(y=Vu(),y!==e?(d=[d,y],p=d):(u=p,p=e)):(u=p,p=e),p===e&&(p=n.charAt(u),Jn.test(p)?u++:(p=e,_===0&&E(mg)),p===e&&(p=u,d=ho(),d!==e?(y=Qu(),y!==e?(d=[d,y],p=d):(u=p,p=e)):(u=p,p=e),p===e&&(p=u,d=ho(),d!==e?(y=Ju(),y!==e?(d=[d,y],p=d):(u=p,p=e)):(u=p,p=e),p===e&&(p=ho(),p===e&&(p=u,d=Sy(),d!==e?(y=Ry(),y!==e?(d=[d,y],p=d):(u=p,p=e)):(u=p,p=e),p===e&&(p=u,d=Xu(),d!==e?(y=Yu(),y!==e?(d=[d,y],p=d):(u=p,p=e)):(u=p,p=e),p===e&&(p=n.charAt(u),ri.test(p)?u++:(p=e,_===0&&E(gg)),p===e&&(p=u,d=po(),d!==e?(y=Ju(),y!==e?(d=[d,y],p=d):(u=p,p=e)):(u=p,p=e),p===e&&(p=u,d=po(),d!==e?(y=Qu(),y!==e?(d=[d,y],p=d):(u=p,p=e)):(u=p,p=e),p===e&&(p=po())))))))))),p!==e?c=n.substring(c,u):c=p,c!==e?(p=u,_++,d=fo(),_--,d===e?p=void 0:(u=p,p=e),p!==e?(M=o,o=oy(c)):(u=o,o=e)):(u=o,o=e),_--,o===e&&(c=e,_===0&&E(hg)),o}function Xy(){let o,c;return _++,o=u,c=mo(),c!==e&&(M=o,c=ay()),o=c,_--,o===e&&(c=e,_===0&&E(yg)),o}function Yy(o,c){return o.map(function(p){return p[c]})}function hi(o,c,p){return[o].concat(Yy(c,p))}function Q(){return{...uy()}}Kn=s();let vo=Kn!==e&&u===n.length;function fl(){throw Kn!==e&&u<n.length&&E(dy()),ku(ii,Ke<n.length?ly(Ke):null,Ke<n.length?er(Ke,Ke+1):er(Ke,Ke))}if(t.peg$library)return{peg$result:Kn,peg$currPos:u,peg$FAILED:e,peg$maxFailExpected:ii,peg$maxFailPos:Ke,peg$success:vo,peg$throw:vo?void 0:fl};if(vo)return Kn;fl()}function rt(n){return{value:n,errors:!0,completeFirstPass:!1}}function _t(n,t){return{value:n,errors:!1,completeFirstPass:t}}function Qe(...n){return n.some(t=>t!==void 0&&t.errors)}function pm(...n){return n.every(t=>t!==void 0&&t.completeFirstPass)}var Du=class n{constructor(t,e){this.syms=new Map,this.parent=null,this.children=new Map,this.parent=t,this.name=e}newScope(t,e){let r=this.children.get(t);if(r!==void 0)return r;let i=new n(e,t);return this.children.set(t,i),i}findSymbol(t){for(let e=this;e!==null;e=e.parent){let r=e.syms.get(t);if(r!==void 0)return r}}findSymbolPath(t){if(t.length===1)return this.findSymbol(t[0]);let e=this;for(;e.children.get(t[0])===void 0;)if(e=e.parent,e===null)return;for(let r=0;r<t.length-1;r++)if(e=e.children.get(t[r]),e===void 0)return;return e.syms.get(t[t.length-1])}addSymbol(t,e,r){this.syms.set(t,{...e,seen:r})}updateSymbol(t,e,r){for(let i=this;i!==null;i=i.parent)if(i.syms.get(t)!==void 0){i.syms.set(t,{...e,seen:r});return}}},xu=class{constructor(){this.passCount=0,this.root=new Du(null,""),this.curSymtab=this.root,this.anonScopeCount=0}startPass(t){this.curSymtab=this.root,this.anonScopeCount=0,this.passCount=t}withAnonScope(t,e){let r=`__anon_scope_${this.anonScopeCount}`;this.anonScopeCount++,this.withLabelScope(r,t,e)}withLabelScope(t,e,r){let i=this.curSymtab;this.curSymtab=this.curSymtab.newScope(t,r||i),e(),this.curSymtab=i}findPath(t,e){return e?this.root.findSymbolPath(t):this.curSymtab.findSymbolPath(t)}findQualifiedSym(t,e){return this.findPath(t,e)}symbolSeen(t){let e=this.curSymtab.syms.get(t);return e!==void 0?e.seen===this.passCount:!1}declareLabelSymbol(t,e,r){let{name:i,loc:s}=t,a=this.curSymtab.syms.get(i);if(a===void 0){let f={type:"label",segment:r,data:_t({addr:e,loc:s},!1)};return this.curSymtab.addSymbol(i,f,this.passCount),!1}if(a.type!=="label")throw new Error("ICE: declareLabelSymbol should be called only on labels");if(a.data.value.addr!==e){let f={type:"label",segment:r,data:{...a.data,value:{...a.data.value,addr:e}}};return this.curSymtab.updateSymbol(i,f,this.passCount),!0}return this.curSymtab.updateSymbol(i,a,this.passCount),!1}declareVar(t,e){this.curSymtab.addSymbol(t,{type:"var",data:e},this.passCount)}dumpLabels(t,e){let r={};for(let[h,b]of e)r[b.id]=h;let i=[],s=(h,b)=>{if(h!==void 0){let C=[...h,b.name];i.push({path:C,sym:b})}else i.push({path:[],sym:b})};s(void 0,this.root);let a=[];for(;i.length>0;){let h=i.pop();if(h){for(let[b,C]of h.sym.syms)C.type==="label"&&a.push({path:[...h.path,b],addr:C.data.value.addr,size:0,segmentName:r[C.segment.id]});for(let[,b]of h.sym.children)s(h.path,b)}}let l=a.sort((h,b)=>h.addr-b.addr),f=l.length;if(f>0){for(let b=1;b<f;b++)l[b-1].size=l[b].addr-l[b-1].addr;let h=l[f-1];h.size=t-h.addr}return l.map(({path:h,addr:b,size:C,segmentName:S})=>({name:h.join("::"),addr:b,size:C,segmentName:S}))}};function C0(n){return n===!0||n!=0}function Rt(n){let t=typeof n;return t==="object"&&n instanceof Array?"array":t}function bu(n){return`${n.absolute?"::":""}${n.path.join("::")}`}var Ze=(n,t,e)=>{let r=e(n.value,t.value),i=pm(n,t);return _t(typeof r=="boolean"?r?1:0:r,i)},Ru=class{constructor(){this.curSegmentName="",this.curSegment=new Un(0,0,!1,0),this.pass=0,this.needPass=!1,this.scopes=new xu,this.segments=[],this.errorList=[],this.warningList=[],this.debugInfo=new qr,this.errors=()=>this.formatErrors(this.errorList,"error"),this.warnings=()=>this.formatErrors(this.warningList,"warning")}prg(){let{startPC:t,binary:e}=am(this.segments),r=t&255,i=t>>8&255;return Uint8Array.from([r,i,...e])}anyErrors(){return this.errorList.length!==0}formatErrors(t,e){return[...new Set(t.map(i=>JSON.stringify(i)))].map(i=>{let{loc:s,msg:a}=JSON.parse(i),l=`<unknown>:1:1: ${e}: ${a}`;return s&&(l=`${s.start.line}:${s.start.column}: ${e}: ${a}`),{loc:s,msg:a,formatted:l}})}addError(t,e){this.errorList.push({msg:t,loc:e})}addWarning(t,e){this.warningList.push({msg:t,loc:e})}startPass(t){this.pass=t,this.needPass=!1,this.errorList=[],this.scopes.startPass(t),this.debugInfo=new qr,this.segments=[];let e=this.newSegment("default",0,void 0,!0);this.setCurrentSegment({type:"segment",data:e},"default")}setCurrentSegment(t,e){this.curSegmentName=e,this.curSegment=t.data}newSegment(t,e,r,i){let s=new Un(e,r,i,this.segments.length-1);return this.segments.push([t,s]),s}getPC(){return this.curSegment.currentPC()}evalExprType(t,e,r){let i=this.evalExpr(t),{errors:s,value:a,completeFirstPass:l}=i;return!s&&typeof a!==e?(this.addError(`Expecting ${r} to be '${e}' type, got '${Rt(a)}'`,t.loc),{errors:!0,completeFirstPass:l,value:a}):i}evalExprToInt(t,e){return this.evalExprType(t,"number",e)}evalExprToString(t,e){return this.evalExprType(t,"string",e)}evalExpr(t){switch(t.type){case"binary":{let e=this.evalExpr(t.left),r=this.evalExpr(t.right);if(Qe(e,r))return rt(0);if(typeof e.value!=typeof r.value)return this.addError(`Binary expression operands are expected to be of the same type.  Got: '${Rt(e.value)}' (left), '${Rt(r.value)}' (right)`,t.loc),rt(0);if(typeof e.value!="string"&&typeof e.value!="number")return this.addError(`Binary expression operands can only operator on numbers or strings.  Got: '${Rt(e.value)}'`,t.loc),rt(0);if(typeof e.value=="string"){let i=["+","==","<","<=",">",">="];if(i.indexOf(t.op)<0)return this.addError(`'${t.op}' operator is not supported for strings.  Valid operators for strings are: ${i.join(", ")}`,t.loc),rt(0)}switch(t.op){case"+":return Ze(e,r,(i,s)=>i+s);case"-":return Ze(e,r,(i,s)=>i-s);case"*":return Ze(e,r,(i,s)=>i*s);case"/":return Ze(e,r,(i,s)=>i/s);case"%":return Ze(e,r,(i,s)=>i%s);case"\xA7":return Ze(e,r,(i,s)=>(i&255)<<8|s&255);case"==":return Ze(e,r,(i,s)=>i==s);case"!=":return Ze(e,r,(i,s)=>i!=s);case"<":return Ze(e,r,(i,s)=>i<s);case"<=":return Ze(e,r,(i,s)=>i<=s);case">":return Ze(e,r,(i,s)=>i>s);case">=":return Ze(e,r,(i,s)=>i>=s);default:throw new Error(`Unhandled binary operator ${t.op}`)}}case"literal":return _t(t.lit,!0);case"register":return this.addError("Unexpected register",t.loc),rt(0);case"ident":throw new Error("should not see an ident here -- if you do, it is probably a wrong type node in parser");case"qualified-ident":{let e=this.scopes.findQualifiedSym(t.path,t.absolute);if(e===void 0)return this.pass>=1?(this.addError(`Undefined symbol '${bu(t)}'`,t.loc),rt(0)):(this.needPass=!0,_t(0,!1));switch(e.type){case"label":return{errors:e.data.errors,value:e.data.value.addr,completeFirstPass:e.seen===this.pass};case"var":return e.seen<this.pass&&this.addError(`Undeclared variable '${bu(t)}'`,t.loc),e.data}break}case"callfunc":{let e=this.evalExpr(t.callee),r=t.args.map(i=>this.evalExpr(i));if(e.errors)return rt(0);if(typeof e.value!="function")return this.addError(`Callee must be a function type.  Got '${Rt(e)}'`,t.loc),rt(0);if(Qe(...r))return rt(0);try{let i=e.completeFirstPass&&pm(...r);return _t(e.value(...r.map(s=>s.value)),i)}catch(i){return t.callee.type=="qualified-ident"?this.addError(`Call to '${bu(t.callee)}' failed with an error: ${i.message}`,t.loc):(this.addError("Unexpected error calling function",t.loc),this.addError(`Plugin call failed with an error: ${i.message}`,t.loc)),rt(0)}break}case"getcurpc":return _t(this.getPC(),!0);default:break}throw new Error(`should be unreachable on ${t.type}`)}emit(t){let e=this.curSegment.emit(t);e!==void 0&&this.addError(e,this.lineLoc)}emit16(t){this.emit(t>>8&255),this.emit(t&255)}assembleNonInstr(t,e){let r=t.ops[0];e.p1&&this.addWarning("Parameter not required",e.p1.loc),e.p2&&this.addWarning("Parameter not required",e.p2.loc),this.emit(r.op)}assembleAluInstr(t,e){let r=t.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let i=r.op;if(e.p1&&r.p1){let s=this.checkRegister(e.p1,r.p1);if(s===void 0)return;i|=r.p1.op(s)}this.emit(i)}assembleDivideInstr(t,e){let r=t.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let i=r.op;if(e.p1&&r.p1){let s=this.checkRegister(e.p1,r.p1);if(s===void 0)return;i|=r.p1.op(s)}this.emit(i)}assembleClrInstr(t,e){if(!e.p1){this.addError("Parameter required",e.loc);return}if(e.p2&&this.addWarning("Parameter not required",e.p2.loc),!t.ops[0]||!t.ops[0].p1||!t.ops[1]||!t.ops[1].p1){this.addError("Internal opcode definition error",e.loc);return}let r=this.checkRegister(e.p1,t.ops[0].p1,t.ops[1].p1);if(r===void 0)return;let i=this.hasRegister(e.p1,t.ops[1].p1)?t.ops[1]:t.ops[0];if(!i.p1){this.addError("Internal opcode definition error",e.loc);return}let s=i.op;s|=i.p1.op(r),this.emit(s)}assembleMovInstr(t,e){if(!e.p1||!e.p2){this.addError("Two parameters required",e.loc);return}if(!t.ops[0]||!t.ops[0].p1||!t.ops[1]||!t.ops[1].p1){this.addError("Internal opcode definition error",e.loc);return}let r=this.checkRegister(e.p1,t.ops[0].p1,t.ops[1].p1);if(r===void 0)return;let i=this.hasRegister(e.p1,t.ops[1].p1)?t.ops[1]:t.ops[0];if(!e.p1||!i.p1||!e.p2||!i.p2){this.addError("Two parameters required",e.loc);return}let s=i.op;s|=i.p1.op(r);let a=this.checkRegister(e.p2,i.p2);a!==void 0&&(s|=i.p2.op(a),this.emit(s))}assembleLitOpc(t,e){let r=t.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let i=r.op;if(!e.p1||!r.p1){this.addError("Parameter required",e.loc);return}let s=this.checkLiteral(e.p1,0,255,"h");s!==void 0&&(i|=r.p1.op(s),this.emit(i))}assembleLodSwInstr(t,e){let r=t.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let i=r.op;if(!e.p1||!r.p1){this.addError("Parameter required",e.loc);return}let s=this.checkRegister(e.p1,r.p1);s!==void 0&&(i|=r.p1.op(s),this.emit(i))}assembleSetInstr(t,e){if(!e.p1||!e.p2){this.addError("Two parameters required",e.loc);return}if(!t.ops[0]||!t.ops[0].p1||!t.ops[1]||!t.ops[1].p1){this.addError("Internal opcode definition error",e.loc);return}let r=this.checkRegister(e.p1,t.ops[0].p1,t.ops[1].p1);if(r===void 0)return;let i=this.hasRegister(e.p1,t.ops[1].p1),s=i?t.ops[1]:t.ops[0];if(!s.p1){this.addError("Internal opcode definition error",e.loc);return}let a=s.op;if(a|=s.p1.op(r),i){let l=this.evalExpr(e.p2);if(Qe(l))return;if(typeof l.value!="number"){this.addError(`Expecting branch label to evaluate to integer, got ${Rt(l.value)}`,e.p2.loc);return}let{value:f}=l;if(f>65535){this.addError("Value out of range (must be between 0x0000 and 0xFFFF)",e.p2.loc);return}this.emit(a),this.emit((f&65280)>>8),this.emit(f&255)}else{if(!s.p2){this.addError("Internal opcode definition error",e.loc);return}let l=this.checkLiteral(e.p2,-16,15);if(l===void 0)return;a|=s.p2.op(l),this.emit(a)}}assembleLoadStoreInstr(t,e){let r=t.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let i=r.op;if(!e.p1||!r.p1){this.addError("Parameter required",e.loc);return}let s=this.checkRegister(e.p1,r.p1);s!==void 0&&(i|=r.p1.op(s),this.emit(i))}checkRegister(t,e,r=void 0){if(t.type!=="register")this.addError("Register required",t.loc);else{let i=e.cs?.[t.value]??r?.cs?.[t.value];return i===void 0&&(e.cs?r&&r.cs?this.addError(`Invalid register - choose one of [${Object.keys(e.cs).join("|")}] or [${Object.keys(r.cs).join("|")}]`,t.loc):this.addError(`Invalid register - choose one of [${Object.keys(e.cs).join("|")}]`,t.loc):this.addError("Invalid register",t.loc)),i}}hasRegister(t,e){return t.type!=="register"?!1:e.cs?.[t.value]!==void 0}checkLiteral(t,e,r,i="d"){let s=this.evalExprToInt(t,"value");if(!Qe(s)){let a=s.value;if(a<e||a>r){let l="";switch(i){case"b":{let f=r.toString(2);l=`${("0".repeat(f.length)+e.toString(2)).slice(-f.length)}b and ${f}b`;break}case"h":{let f=r.toString(16).toUpperCase();l=`0x${("0".repeat(f.length)+e.toString(16).toUpperCase()).slice(-f.length)} and 0x${f}`;break}default:l=`${e} and ${r}`}this.addError(`Literal out of range (must be between ${l})`,t.loc)}else return a}}assembleBranch(t,e){let r=t.ops[0];if(e.p2&&this.addWarning("Parameter not required",e.p2.loc),!e.p1){this.addError("Parameter required",e.loc);return}let i=this.evalExpr(e.p1);if(Qe(i))return;if(typeof i.value!="number"){this.addError(`Expecting branch label to evaluate to integer, got ${Rt(i.value)}`,e.p1.loc);return}let{value:s}=i;this.emit(r.op),this.emit((s&65280)>>8),this.emit(s&255)}handleSetPC(t){let e=this.evalExprToInt(t,"pc");if(!Qe(e)){let{value:r,completeFirstPass:i}=e;if(!i){this.addError("Value for new program counter must evaluate to a value in the first pass",t.loc);return}!this.curSegment.empty()&&this.curSegment.currentPC()>r&&this.addError(`Cannot set program counter to a smaller value than current (current: $${Ae(this.curSegment.currentPC())}, trying to set $${Ae(r)})`,t.loc);let s=this.curSegment.setCurrentPC(r);s!==void 0&&this.addError(s,t.loc)}}emit8or16(t,e){if(e===8){this.emit(t);return}this.emit16(t)}emitData(t,e){let r=Math.pow(2,e);for(let i=0;i<t.length;i++){let s=this.evalExpr(t[i]);if(Qe(s))continue;let{value:a}=s;if(typeof a=="number")a>=r?this.addError(`Data out of range for ${e} bits`,t[i].loc):this.emit8or16(a,e);else if(typeof a=="string"){let l=a.split("").map(f=>f.charCodeAt(0));l.find(f=>f>=r)?this.addError(`Data contains character out of range for ${e} bits`,t[i].loc):l.forEach(f=>this.emit8or16(f,e))}else this.addError(`Only literal types can be emitted. Got ${Rt(a)}`,t[i].loc)}}fillBytes(t){let e=this.evalExprToInt(t.numBytes,"!fill num_bytes"),r=this.evalExprToInt(t.fillValue,"!fill value");if(Qe(e,r))return;let{value:i}=r;if(i<0||i>=256){this.addError(`!fill value to repeat must be in 8-bit range, '${i}' given`,t.fillValue.loc);return}let s=e.value;if(s<0){this.addError(`!fill repeat count must be >= 0, got ${s}`,t.numBytes.loc);return}for(let a=0;a<s;a++)this.emit(i)}alignBytes(t){let e=this.evalExprToInt(t.alignBytes,"alignment");if(Qe(e))return;let{value:r}=e;if(r<1){this.addError(`Alignment must be a positive integer, ${r} given`,t.alignBytes.loc);return}if((r&r-1)!=0){this.addError(`Alignment must be a power of two, ${r} given`,t.loc);return}for(;(this.getPC()&r-1)!=0;)this.emit(0)}withAnonScope(t,e,r){if(t!==null)return this.withLabelScope(t,e,r);this.scopes.withAnonScope(e,r)}withLabelScope(t,e,r){this.scopes.withLabelScope(t,e)}checkDirectives(t,e){let r=i=>{let s=this.getPC();i();let a=this.getPC();this.debugInfo.markAsData(s,a)};switch(t.type){case"data":{r(()=>{this.emitData(t.values,t.dataSize===mt.Byte?8:16)});break}case"fill":{r(()=>{this.fillBytes(t)});break}case"align":{this.alignBytes(t);break}case"setpc":{this.handleSetPC(t.pc);break}case"error":{let i=this.evalExprToString(t.error,"error message");if(!Qe(i)){this.addError(i.value,t.loc);return}break}case"if":{let{cases:i,elseBranch:s}=t;for(let a in i){let[l,f]=i[a],h=this.evalExpr(l);if(!Qe(h)&&C0(h.value))return this.withAnonScope(e,()=>{this.assembleLines(f)})}return this.withAnonScope(e,()=>{this.assembleLines(s)})}case"for":{let{index:i,list:s,body:a}=t,l=this.evalExpr(s);if(Qe(l))return;let{value:f}=l;if(!(f instanceof Array)){this.addError("for-loop range must be an array expression (e.g., a range() or an array)",s.loc);return}for(let h=0;h<f.length;h++){let b=null;e!==null&&(b=`${e}__${h}`),this.withAnonScope(b,()=>(this.scopes.declareVar(i.name,_t(f[h],l.completeFirstPass)),this.assembleLines(a)))}break}case"let":{let i=t.name,s=this.scopes.findQualifiedSym([i.name],!1),a=this.evalExpr(t.value);if(s!==void 0&&this.scopes.symbolSeen(i.name)){this.addError(`Variable '${i.name}' already defined`,t.loc);return}this.scopes.declareVar(i.name,a);break}default:this.addError(`unknown directive ${t.type}`,t.loc);return}}assembleLines(t){if(t===null||t.length===0||t.length===0)return;let e=i=>{for(let s=0;s<i.length;s++)this.debugInfo.startLine(i[s].loc,this.getPC(),this.curSegment),this.assembleLine(i[s]),this.debugInfo.endLine(this.getPC(),this.curSegment)},r=0;for(;r<t.length;){let{label:i,stmt:s}=t[r];if(i===null&&s===null)r++;else break}if(!(r>=t.length))return e(t)}checkAndDeclareLabel(t){this.scopes.symbolSeen(t.name)?this.addError(`Symbol '${t.name}' already defined`,t.loc):this.scopes.declareLabelSymbol(t,this.getPC(),this.curSegment)&&(this.needPass=!0)}assembleLine(t){if(this.lineLoc=t.loc,t.label===null&&t.stmt===null&&t.scopedStmts===null)return;t.label!==null&&this.checkAndDeclareLabel(t.label);let e=t.scopedStmts;if(e!=null){if(!t.label)throw new Error("ICE: line.label cannot be undefined");this.withLabelScope(t.label.name,()=>{this.assembleLines(e)});return}if(t.stmt===null)return;if(t.stmt.type!=="insn"){this.checkDirectives(t.stmt,t.label===null?null:t.label.name);return}let r=t.stmt,i=sm[r.mnemonic.toLocaleLowerCase()];i!==void 0?(a=>{let l=this.getPC();a();let f=this.getPC();this.debugInfo.markAsInstruction(l,f)})(()=>{switch(i.mt){case W.Direct:this.assembleNonInstr(i,r);break;case W.Alu:this.assembleAluInstr(i,r);break;case W.Clear:this.assembleClrInstr(i,r);break;case W.Move:this.assembleMovInstr(i,r);break;case W.LitOpc:this.assembleLitOpc(i,r);break;case W.LodSw:this.assembleLodSwInstr(i,r);break;case W.Set:this.assembleSetInstr(i,r);break;case W.LoadStore:this.assembleLoadStoreInstr(i,r);break;case W.Goto:this.assembleBranch(i,r);break;case W.Divide:this.assembleDivideInstr(i,r);break;default:this.addError(`Couldn't encode instruction '${r.mnemonic} '`,t.loc)}}):this.addError(`Unknown mnemonic '${r.mnemonic}'`,r.loc)}assemble(t){try{let e=vu(t.toString());e!==void 0&&e.lines&&this.assembleLines(e.lines)}catch(e){if("name"in e&&e.name==="SyntaxError")this.addError(`Syntax error: ${e.message}`,{...e.location});else{if("name"in e&&e.name==="semantic")return;throw e}}}_requireType(t,e){if(typeof t==e)return t;this.addError(`Expecting a ${e} value, got ${Rt(t)}`,t.loc)}requireNumber(t){return this._requireType(t,"number")}registerPlugins(){((r,i)=>{this.scopes.declareVar(r,_t(i,!1))})("range",(...r)=>{let i=0,s;if(r.length==1)s=this.requireNumber(r[0]);else if(r.length==2)i=this.requireNumber(r[0]),s=this.requireNumber(r[1]);else throw new Error("Invalid number of args to 'range'.  Expecting 1 or 2 arguments.");if(s==i)return[];if(s<i)throw new Error("range 'end' must be larger or equal to 'start'");return Array(s-i).fill(null).map((a,l)=>l+i)})}dumpLabels(){return this.scopes.dumpLabels(this.getPC(),this.segments)}collectSegmentInfo(){return cm(this.segments)}};function _u(n){try{return vu(n.toString())}catch{return}}function Su(n){let t=new Ru,e=0;do{if(t.startPass(e),t.registerPlugins(),t.assemble(n),e>0&&t.anyErrors())return{prg:Uint8Array.from([]),labels:[],segments:[],debugInfo:void 0,errors:t.errors(),warnings:t.warnings()};e+=1}while(t.needPass);return{prg:t.prg(),errors:t.errors(),warnings:t.warnings(),labels:t.dumpLabels(),segments:t.collectSegmentInfo(),debugInfo:t.debugInfo}}var Or=class{constructor(t){this.ctx=t}rcasmDiagnostics(t){let e=this.ctx.config,{errors:r,warnings:i}=Su(t.getText()),s=(f,h)=>({severity:h,range:{start:t.positionAt(f.loc.start.offset),end:t.positionAt(f.loc.end.offset)},message:f.msg,source:"rcasm"}),a=[],l=e.maxNumberOfProblems;return a.push(...r.filter((f,h)=>h<=l).map(f=>s(f,wu.DiagnosticSeverity.Error))),l-=r.length,l>0&&a.push(...i.filter((f,h)=>h<=l).map(f=>s(f,wu.DiagnosticSeverity.Warning))),a}};function P0(n,t){let e;if(!(!n||t<n.offset||t>n.end))return n.accept(r=>r.offset===-1&&r.length===-1?!0:r.offset<=t&&r.end>=t?(e?r.length<=e.length&&(e=r):e=r,!0):!1),e}function mm(n,t){let e=P0(n,t),r=[];for(;e;)r.unshift(e),e=e.parent;return r}function Pu(n,t,e,r){return new Cu(n,t,e,r)}var Cu=class{get end(){return this.offset+this.length}constructor(t,e,r,i){this.type=t,this.offset=e,this.length=r,this.value=i}accept(t){if(t(this)&&this.children)for(let e of this.children)e.accept(t)}acceptVisitor(t){this.accept(t.visitNode.bind(t))}adoptChild(t){t.parent=this,this.children=this.children||[],this.children.push(t)}};var Bs=class n{constructor(t,e){this.syms=new Map;this.parent=null;this.children=new Map;this.parent=t,this.name=e}newScope(t,e){let r=this.children.get(t);if(r!==void 0)return r;let i=new n(e,t);return this.children.set(t,i),i}addSymbol(t,e){this.syms.set(t,e)}};function qu(n){let t=_u(n),e=new Tu;return{tree:e.adapt(t),scopes:e.ctx.root}}var Tu=class{constructor(){this.ctx=new Eu;this.adaptExpr=t=>{switch(t.type){case"binary":return ve(t,"BinaryOp",t.op,this.adaptExpr(t.left),this.adaptExpr(t.right));case"callfunc":return ve(t,"CallFunc",void 0,this.adaptExpr(t.callee),...t.args.map(e=>this.adaptExpr(e)));case"literal":return ve(t,"Literal",t.lit);case"register":return ve(t,"Register",t.value);case"qualified-ident":return this.adaptSQIndent(t);case"ident":return ve(t,"Ref");case"getcurpc":return ve(t,"CurrentPC");default:throw"Expr type not covered"}}}adapt(t){if(!t)return Pu("Program",0,0);let e=ve(t,"Program");return t.lines?.filter(r=>r.label||r.scopedStmts||r.stmt).forEach(r=>e.adoptChild(this.adaptLine(r))),e}adaptLine(t){let e=ve(t,"Line");return t.label&&e.adoptChild(this.adaptLabel(t.label)),t.scopedStmts&&e.adoptChild(this.adaptScope(t)),t.stmt&&e.adoptChild(this.adaptStmt(t.stmt,t.label)),e}adaptStmt(t,e){switch(t.type){case"insn":return this.adaptInstruction(t);case"setpc":return this.adaptSetPc(t);case"data":return this.adaptDataDirective(t);case"fill":return ve(t,"Directive","!fill",this.adaptExpr(t.numBytes),this.adaptExpr(t.fillValue));case"align":return ve(t,"Directive","!align",this.adaptExpr(t.alignBytes));case"for":return this.adaptForDirective(t,e?.name);case"if":return this.adaptIfDirective(t,e?.name);case"let":return this.adaptLetDirective(t);case"error":return ve(t,"Directive","!error")}}adaptLabel(t){let e=ve(t,"Label",t.name);return e.length=t.name.length,this.ctx.declareLabelSymbol(t.name,e),e}adaptScope(t){let e=ve(t,"Scope",t.label?.name),r=t.label?.name??"?";return this.ctx.withLabelScope(r,()=>{t.scopedStmts?.filter(i=>i.label||i.scopedStmts||i.stmt).forEach(i=>{e.adoptChild(this.adaptLine(i))})}),e}adaptInstruction(t){let e=ve(t,"Instruction",t.mnemonic.toLowerCase());return t.p1&&e.adoptChild(this.adaptExpr(t.p1)),t.p2&&e.adoptChild(this.adaptExpr(t.p2)),e}adaptSetPc(t){return ve(t,"SetPC",void 0,this.adaptExpr(t.pc))}adaptDataDirective(t){return ve(t,"Directive",t.dataSize===mt.Byte?"!byte":"!word",...t.values.map(r=>this.adaptExpr(r)))}adaptLetDirective(t){return ve(t,"Directive","!let",this.adaptVariable(t.name),this.adaptExpr(t.value))}adaptForDirective(t,e){let r=ve(t,"Directive","!for");r.adoptChild(this.adaptExpr(t.list));let i;return e&&(i=`${e}__n`),this.ctx.withAnonOrLabelScope(i,()=>{r.adoptChild(this.adaptVariable(t.index)),t.body&&t.body.filter(s=>s.label||s.scopedStmts||s.stmt).forEach(s=>r.adoptChild(this.adaptLine(s)))}),r}adaptIfDirective(t,e){let r=ve(t,"Directive","!if");return t.cases.forEach(i=>{r.adoptChild(this.adaptExpr(i[0])),this.ctx.withAnonOrLabelScope(e,()=>{i[1].filter(s=>s.label||s.scopedStmts||s.stmt).forEach(s=>r.adoptChild(this.adaptLine(s)))})}),t.elseBranch&&this.ctx.withAnonOrLabelScope(e,()=>{t.elseBranch.filter(i=>i.label||i.scopedStmts||i.stmt).forEach(i=>r.adoptChild(this.adaptLine(i)))}),r}adaptVariable(t){let e=ve(t,"Variable",t.name);return this.ctx.declareVar(t.name,e),e}adaptSQIndent(t){let e=ve(t,"SQRef",`${t.path}${t.absolute?" (abs)":""}`);return e.ref={path:t.path,absolute:t.absolute,scope:this.ctx.scope},e}},ve=(n,t,e,...r)=>{let i=Pu(t,n.loc.start.offset,n.loc.end.offset-n.loc.start.offset,e);return r.forEach(s=>i.adoptChild(s)),i},Eu=class{constructor(){this.root=new Bs(null,"");this.scope=this.root;this.anonScopeCount=0;this.path=[]}withAnonScope(t){let e=`__anon_scope_${this.anonScopeCount}`;this.anonScopeCount++,this.withLabelScope(e,t)}withLabelScope(t,e){let r=this.scope;this.path.push(t),this.scope=this.scope.newScope(t,r),e(),this.path.pop(),this.scope=r}withAnonOrLabelScope(t,e){if(t)return this.withLabelScope(t,e);this.withAnonScope(e)}declareLabelSymbol(t,e){this.scope.addSymbol(t,{type:"label",name:t,node:e})}declareVar(t,e){this.scope.addSymbol(t,{type:"var",name:t,node:e})}};var Mr=class{constructor(t){this.ctx=t}async process(t){this.ctx.logger.log("processDocument: "+t.uri);let{tree:e,scopes:r}=qu(t.getText()),i=kh(t,e,r),s={document:t,tree:e,scopes:r,symbols:i};return this.ctx.store.set(t.uri,s),s}};var Lr=class{constructor(t){this.ctx=t;this.processor=new Mr(t),this.diagnostics=new Or(t),this.connection=t.connection}onDidOpenTextDocument({textDocument:{uri:t,languageId:e,text:r,version:i}}){let s=Tr.create(t,e,i,r);this.processor.process(s).then(()=>{this.fileDiagnostics(t)})}onDidChangeTextDocument({textDocument:{uri:t,version:e},contentChanges:r}){let i=this.ctx.store.get(t);if(!i)return;let{document:s}=i,a=Tr.update(s,r,e);this.processor.process(a).then(({document:l})=>{let f=this.diagnostics.rcasmDiagnostics(l);this.connection.sendDiagnostics({uri:t,diagnostics:f})})}async onDidSaveTextDocument({textDocument:{uri:t}}){this.fileDiagnostics(t)}async fileDiagnostics(t){let e=this.ctx.store.get(t);if(!e)return;let r=await this.diagnostics.rcasmDiagnostics(e.document);this.connection.sendDiagnostics({uri:t,diagnostics:[...r]})}register(t){return t.onDidOpenTextDocument(this.onDidOpenTextDocument.bind(this)),t.onDidChangeTextDocument(this.onDidChangeTextDocument.bind(this)),t.onDidSaveTextDocument(this.onDidSaveTextDocument.bind(this)),{textDocumentSync:ym.TextDocumentSyncKind.Incremental}}};var Fe=at(ht());var Nr=class{constructor(t){this.ctx=t}async onHover({textDocument:t,position:e}){let r=this.ctx.store.get(t.uri);if(!r)return;let i=r.document.offsetAt(e),s=mm(r.tree,i);if(!s||s.length==0)return;let a=l=>Fe.Range.create(r.document.positionAt(l.offset),r.document.positionAt(l.end));for(let l=s.length-1;l>=0;l--){let f=s[l];switch(f.type){case"Instruction":return f.value?this.hoverInstructionMnemonic(f.value.toString(),a(f)):void 0;case"Directive":return f.value?this.hoverDirectiveMnemonic(f.value.toString(),a(f)):void 0;case"SetPC":return this.hoverSetPC(a(f));case"SQRef":case"Label":return this.hoverSymbol(r.document,e,a(f));case"Literal":return f.value?this.hoverNumber(f.value,a(f)):void 0;case"Register":return f.value?this.hoverRegister(f.value.toString(),a(f)):void 0}}}register(t){return t.onHover(this.onHover.bind(this)),{hoverProvider:!0}}hoverInstructionMnemonic(t,e){let r=$u(t);return{range:e,contents:r||{kind:Fe.MarkupKind.PlainText,value:"(instruction) "+t}}}hoverDirectiveMnemonic(t,e){let r=$u(t);return{range:e,contents:r||{kind:Fe.MarkupKind.PlainText,value:"(directive) "+t}}}hoverSetPC(t){let e=$u("org");return{range:t,contents:e||{kind:Fe.MarkupKind.PlainText,value:"(set program counter)"}}}async hoverSymbol(t,e,r){let[i]=await zn(t.uri,e,this.ctx),s=[];if(i)switch(i.comment&&(s.push(i.comment),s.push("***")),i.type){case"variable":{let a=i.location.range.start.line,l=this.ctx.store.get(i.location.uri)?.document;if(l){let f=l.getText(Fe.Range.create(Fe.Position.create(a,0),Fe.Position.create(a,Number.MAX_VALUE)));s.push("```rcasm\n"+Ah(f)+"\n```")}break}default:s.push(`(${i.type}) ${i.name}`)}return{range:r,contents:{kind:Fe.MarkupKind.Markdown,value:s.join(`
`)}}}async hoverNumber(t,e){return{range:e,contents:{kind:Fe.MarkupKind.Markdown,value:typeof t=="number"?jh(t):t}}}async hoverRegister(t,e){let r=E0(t);return{range:e,contents:r||{kind:Fe.MarkupKind.PlainText,value:"(register) "+t}}}};function $u(n){if(n=n.toLowerCase(),jn[n])return Is(jn[n])}function E0(n){let t=n.toLowerCase();if(en[t])return As(en[t])}var kr=class{constructor(t){this.ctx=t}async onDefinition({textDocument:t,position:e}){return(await zn(t.uri,e,this.ctx)).map(i=>i.location)}register(t){return t.onDefinition(this.onDefinition.bind(this)),{definitionProvider:!0}}};var vm=at(ht()),Ir=class{constructor(t){this.ctx=t}async onFoldingRanges({textDocument:t}){let e=this.ctx.store.get(t.uri);if(!e)return[];let r=[],i=f=>vm.Range.create(e.document.positionAt(f.offset),e.document.positionAt(f.end));e.tree.accept(f=>{if(f.type==="Instruction")return!1;if(f.type==="Scope"){let h=i(f);r.push({startLine:h.start.line,endLine:h.end.line,kind:"region"})}else if(f.type=="Directive"&&(f.value=="!for"||f.value=="!if")){let h=i(f);r.push({startLine:h.start.line,endLine:h.end.line,kind:"region"})}return!0});let s=r.sort((f,h)=>{let b=f.startLine-h.startLine;return b===0&&(b=f.endLine-h.endLine),b}),a=[],l=-1;return s.forEach(f=>{f.startLine<l&&l<f.endLine||(a.push(f),l=f.endLine)}),a}register(t){return t.onFoldingRanges(this.onFoldingRanges.bind(this)),{foldingRangeProvider:!0}}};var Ar=class{constructor(t){this.ctx=t}async onReferences({textDocument:t,position:e,context:r}){return(await ks(t.uri,e,this.ctx,r.includeDeclaration)).map(s=>s.location)}register(t){return t.onReferences(this.onReferences.bind(this)),{referencesProvider:!0}}};var Gn=at(ht());var jr=class{constructor(t){this.ctx=t}async onDocumentHighlight({textDocument:t,position:e}){let{store:r}=this.ctx,i=r.get(t.uri)?.symbols;if(!i)return;let s=Fn(i,e);if(!s)return[];let a=[],l=i.references.get(s.name);if(l)for(let h of l)a.push(Gn.DocumentHighlight.create(h.location.range,Gn.DocumentHighlightKind.Read));let f=i.definitions.get(s.name);return f&&a.push(Gn.DocumentHighlight.create(f.selectionRange,Gn.DocumentHighlightKind.Write)),a}register(t){return t.onDocumentHighlight(this.onDocumentHighlight.bind(this)),{documentHighlightProvider:!0}}};var bm=at(ht());var Fr=class{constructor(t){this.ctx=t}async onDocumentSymbol({textDocument:t}){let e=this.ctx.store.get(t.uri)?.symbols;if(!e)return[];let r=[];for(let i of e.definitions.values()){let s=bm.DocumentSymbol.create(i.name,void 0,Ih[i.type],i.location.range,i.selectionRange);r.push(s)}return r}register(t){return t.onDocumentSymbol(this.onDocumentSymbol.bind(this)),{documentSymbolProvider:!0}}};var zr=class{constructor(t){this.ctx=t}async onPrepareRename({textDocument:t,position:e}){let r=this.ctx.store.get(t.uri)?.symbols;if(!r)return null;let i=Fn(r,e);return i?Nh(i)?i.selectionRange:i.location.range:null}async onRenameRequest({textDocument:t,position:e,newName:r}){let i={},s=await zn(t.uri,e,this.ctx);for(let l of s)i[l.location.uri]||(i[l.location.uri]=[]),i[l.location.uri].push({newText:r,range:l.selectionRange});let a=await ks(t.uri,e,this.ctx);for(let l of a)i[l.location.uri]||(i[l.location.uri]=[]),i[l.location.uri].push({newText:r,range:l.location.range});return{changes:i}}register(t){return t.onPrepareRename(this.onPrepareRename.bind(this)),t.onRenameRequest(this.onRenameRequest.bind(this)),{renameProvider:{prepareProvider:!0}}}};var q0=[Pr,kr,jr,Fr,Ir,Nr,Ar,zr,Lr];function Ou(n,t){return q0.reduce((e,r)=>{let s=new r(t).register(n);return Object.assign(e,s)},{})}var Dm={processors:["rcasm"],maxNumberOfProblems:1e3};function xm(n,t){return{...t,...n}}function Rm(n,t,e,r){return{store:new Map,workspaceFolders:n,logger:t,connection:e,config:xm(r,Dm)}}var _m=self,$0=new Ut.BrowserMessageReader(_m),O0=new Ut.BrowserMessageWriter(_m),Br=(0,Ut.createConnection)($0,O0,{},Ut.ProposedFeatures.all);Br.onInitialize(n=>{let t=Rm(n.workspaceFolders??[],Br.console,Br,n.initializationOptions);return{capabilities:Ou(Br,t)}});Br.listen();
