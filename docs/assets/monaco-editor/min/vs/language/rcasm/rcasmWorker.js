"use strict";/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.34.1(5cb8f322a1f59ed5208a748bf49ee12a3d06394a)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/
define("vs/language/rcasm/rcasmWorker", ["require","require"],(require)=>{
var moduleExports=(()=>{var ht=Object.defineProperty;var Oi=Object.getOwnPropertyDescriptor;var Fi=Object.getOwnPropertyNames;var Ri=Object.prototype.hasOwnProperty;var ji=(t,r)=>()=>(t&&(r=t(t=0)),r);var hr=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports),gr=(t,r)=>{for(var e in r)ht(t,e,{get:r[e],enumerable:!0})},Bi=(t,r,e,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of Fi(r))!Ri.call(t,n)&&n!==e&&ht(t,n,{get:()=>r[n],enumerable:!(s=Oi(r,n))||s.enumerable});return t};var pr=t=>Bi(ht({},"__esModule",{value:!0}),t);var pt={};gr(pt,{DataSize:()=>he,mkAsmLine:()=>Ni,mkData:()=>Hi,mkInsn:()=>qi,mkLabel:()=>zi,mkLiteral:()=>Gi,mkProgram:()=>Wi,mkRegister:()=>Xi,mkScopeQualifiedIdent:()=>Ji,mkSetPC:()=>Vi});function Wi(t,r){return{lines:t,loc:r}}function Ni(t,r,e){return{label:t,stmt:r,loc:e}}function zi(t,r){return{name:t,loc:r}}function Vi(t,r){return{type:"setpc",pc:t,loc:r}}function qi(t,r,e,s){return{type:"insn",mnemonic:t,p1:r,p2:e,loc:s}}function Hi(t,r,e){return{type:"data",values:r,dataSize:t,loc:e}}function Gi(t,r,e){return{type:"literal",lit:t,ot:r,loc:e}}function Xi(t,r){return{type:"register",value:t,loc:r}}function Ji(t,r,e){return{type:"qualified-ident",path:t,absolute:r,loc:e}}var he,mt=ji(()=>{(function(t){t[t.Byte=0]="Byte",t[t.Word=1]="Word"})(he||(he={}))});var br=hr((yo,yr)=>{"use strict";function A(t){if(this.words=[],t)if(Symbol&&Symbol.iterator&&t[Symbol.iterator]!==void 0){let r=t[Symbol.iterator](),e=r.next();for(;!e.done;)this.add(e.value),e=r.next()}else for(let r=0;r<t.length;r++)this.add(t[r])}A.prototype.fromWords=function(t){let r=Object.create(A.prototype);return r.words=t,r};A.prototype.add=function(t){this.resize(t),this.words[t>>>5]|=1<<t};A.prototype.flip=function(t){this.resize(t),this.words[t>>>5]^=1<<t};A.prototype.clear=function(){this.words.length=0};A.prototype.remove=function(t){this.resize(t),this.words[t>>>5]&=~(1<<t)};A.prototype.isEmpty=function(t){let r=this.words.length;for(let e=0;e<r;e++)if(this.words[e]!==0)return!1;return!0};A.prototype.has=function(t){return(this.words[t>>>5]&1<<t)!==0};A.prototype.checkedAdd=function(t){this.resize(t);let r=this.words[t>>>5],e=r|1<<t;return this.words[t>>>5]=e,(e^r)>>>t};A.prototype.trim=function(t){let r=this.words.length;for(;r>0&&this.words[r-1]===0;)r--;this.words=this.words.slice(0,r)};A.prototype.resize=function(t){let r=t+32>>>5;for(let e=this.words.length;e<r;e++)this.words[e]=0};A.prototype.hammingWeight=function(t){return t-=t>>>1&1431655765,t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24};A.prototype.hammingWeight4=function(t,r,e,s){return t-=t>>>1&1431655765,r-=r>>>1&1431655765,e-=e>>>1&1431655765,s-=s>>>1&1431655765,t=(t&858993459)+(t>>>2&858993459),r=(r&858993459)+(r>>>2&858993459),e=(e&858993459)+(e>>>2&858993459),s=(s&858993459)+(s>>>2&858993459),t=t+(t>>>4)&252645135,r=r+(r>>>4)&252645135,e=e+(e>>>4)&252645135,s=s+(s>>>4)&252645135,(t+r+e+s)*16843009>>>24};A.prototype.size=function(){let t=0,r=this.words.length,e=this.words;for(let s=0;s<r;s++)t+=this.hammingWeight(e[s]);return t};A.prototype.array=function(){let t=new Array(this.size()),r=0,e=this.words.length;for(let s=0;s<e;++s){let n=this.words[s];for(;n!=0;){let c=n&-n;t[r++]=(s<<5)+this.hammingWeight(c-1|0),n^=c}}return t};A.prototype.forEach=function(t){let r=this.words.length;for(let e=0;e<r;++e){let s=this.words[e];for(;s!=0;){let n=s&-s;t((e<<5)+this.hammingWeight(n-1|0)),s^=n}}};A.prototype[Symbol.iterator]=function*(){let t=this.words.length;for(let r=0;r<t;++r){let e=this.words[r];for(;e!=0;){let s=e&-e;yield(r<<5)+this.hammingWeight(s-1|0),e^=s}}};A.prototype.clone=function(){let t=Object.create(A.prototype);return t.words=this.words.slice(),t};A.prototype.intersects=function(t){let r=Math.min(this.words.length,t.words.length);for(let e=0;e<r;++e)if((this.words[e]&t.words[e])!==0)return!0;return!1};A.prototype.intersection=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]&=t.words[e],this.words[e+1]&=t.words[e+1],this.words[e+2]&=t.words[e+2],this.words[e+3]&=t.words[e+3],this.words[e+4]&=t.words[e+4],this.words[e+5]&=t.words[e+5],this.words[e+6]&=t.words[e+6],this.words[e+7]&=t.words[e+7];for(;e<r;++e)this.words[e]&=t.words[e];let s=this.words.length;for(e=r;e<s;++e)this.words[e]=0;return this};A.prototype.intersection_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(let s=0;s<r;++s)e+=this.hammingWeight(this.words[s]&t.words[s]);return e};A.prototype.new_intersection=function(t){let r=Object.create(A.prototype),e=Math.min(this.words.length,t.words.length);r.words=new Array(e);let s=0;for(;s+7<e;s+=8)r.words[s]=this.words[s]&t.words[s],r.words[s+1]=this.words[s+1]&t.words[s+1],r.words[s+2]=this.words[s+2]&t.words[s+2],r.words[s+3]=this.words[s+3]&t.words[s+3],r.words[s+4]=this.words[s+4]&t.words[s+4],r.words[s+5]=this.words[s+5]&t.words[s+5],r.words[s+6]=this.words[s+6]&t.words[s+6],r.words[s+7]=this.words[s+7]&t.words[s+7];for(;s<e;++s)r.words[s]=this.words[s]&t.words[s];return r};A.prototype.equals=function(t){let r=Math.min(this.words.length,t.words.length);for(let e=0;e<r;++e)if(this.words[e]!=t.words[e])return!1;if(this.words.length<t.words.length){let e=t.words.length;for(let s=this.words.length;s<e;++s)if(t.words[s]!=0)return!1}else if(t.words.length<this.words.length){let e=this.words.length;for(let s=t.words.length;s<e;++s)if(this.words[s]!=0)return!1}return!0};A.prototype.difference=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]&=~t.words[e],this.words[e+1]&=~t.words[e+1],this.words[e+2]&=~t.words[e+2],this.words[e+3]&=~t.words[e+3],this.words[e+4]&=~t.words[e+4],this.words[e+5]&=~t.words[e+5],this.words[e+6]&=~t.words[e+6],this.words[e+7]&=~t.words[e+7];for(;e<r;++e)this.words[e]&=~t.words[e];return this};A.prototype.difference2=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)t.words[e]=this.words[e]&~t.words[e],t.words[e+1]=this.words[e+1]&~t.words[e+1],t.words[e+2]=this.words[e+2]&~t.words[e+2],t.words[e+3]=this.words[e+3]&~t.words[e+3],t.words[e+4]=this.words[e+4]&~t.words[e+4],t.words[e+5]=this.words[e+5]&~t.words[e+5],t.words[e+6]=this.words[e+6]&~t.words[e+6],t.words[e+7]=this.words[e+7]&~t.words[e+7];for(;e<r;++e)t.words[e]=this.words[e]&~t.words[e];for(e=this.words.length-1;e>=r;--e)t.words[e]=this.words[e];return t.words=t.words.slice(0,this.words.length),t};A.prototype.new_difference=function(t){return this.clone().difference(t)};A.prototype.difference_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0,s=0;for(;s<r;++s)e+=this.hammingWeight(this.words[s]&~t.words[s]);let n=this.words.length;for(;s<n;++s)e+=this.hammingWeight(this.words[s]);return e};A.prototype.change=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]^=t.words[e],this.words[e+1]^=t.words[e+1],this.words[e+2]^=t.words[e+2],this.words[e+3]^=t.words[e+3],this.words[e+4]^=t.words[e+4],this.words[e+5]^=t.words[e+5],this.words[e+6]^=t.words[e+6],this.words[e+7]^=t.words[e+7];for(;e<r;++e)this.words[e]^=t.words[e];for(e=t.words.length-1;e>=r;--e)this.words[e]=t.words[e];return this};A.prototype.new_change=function(t){let r=Object.create(A.prototype),e=Math.max(this.words.length,t.words.length);r.words=new Array(e);let s=Math.min(this.words.length,t.words.length),n=0;for(;n+7<s;n+=8)r.words[n]=this.words[n]^t.words[n],r.words[n+1]=this.words[n+1]^t.words[n+1],r.words[n+2]=this.words[n+2]^t.words[n+2],r.words[n+3]=this.words[n+3]^t.words[n+3],r.words[n+4]=this.words[n+4]^t.words[n+4],r.words[n+5]=this.words[n+5]^t.words[n+5],r.words[n+6]=this.words[n+6]^t.words[n+6],r.words[n+7]=this.words[n+7]^t.words[n+7];for(;n<s;++n)r.words[n]=this.words[n]^t.words[n];let c=this.words.length;for(n=s;n<c;++n)r.words[n]=this.words[n];let l=t.words.length;for(n=s;n<l;++n)r.words[n]=t.words[n];return r};A.prototype.change_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0,s=0;for(;s<r;++s)e+=this.hammingWeight(this.words[s]^t.words[s]);let n=this.words.length>t.words.length?this:t,c=n.words.length;for(;s<c;++s)e+=this.hammingWeight(n.words[s]);return e};A.prototype.toString=function(){return"{"+this.array().join(",")+"}"};A.prototype.union=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]|=t.words[e],this.words[e+1]|=t.words[e+1],this.words[e+2]|=t.words[e+2],this.words[e+3]|=t.words[e+3],this.words[e+4]|=t.words[e+4],this.words[e+5]|=t.words[e+5],this.words[e+6]|=t.words[e+6],this.words[e+7]|=t.words[e+7];for(;e<r;++e)this.words[e]|=t.words[e];if(this.words.length<t.words.length){this.resize((t.words.length<<5)-1);let s=t.words.length;for(let n=r;n<s;++n)this.words[n]=t.words[n]}return this};A.prototype.new_union=function(t){let r=Object.create(A.prototype),e=Math.max(this.words.length,t.words.length);r.words=new Array(e);let s=Math.min(this.words.length,t.words.length),n=0;for(;n+7<s;n+=8)r.words[n]=this.words[n]|t.words[n],r.words[n+1]=this.words[n+1]|t.words[n+1],r.words[n+2]=this.words[n+2]|t.words[n+2],r.words[n+3]=this.words[n+3]|t.words[n+3],r.words[n+4]=this.words[n+4]|t.words[n+4],r.words[n+5]=this.words[n+5]|t.words[n+5],r.words[n+6]=this.words[n+6]|t.words[n+6],r.words[n+7]=this.words[n+7]|t.words[n+7];for(;n<s;++n)r.words[n]=this.words[n]|t.words[n];let c=this.words.length;for(n=s;n<c;++n)r.words[n]=this.words[n];let l=t.words.length;for(n=s;n<l;++n)r.words[n]=t.words[n];return r};A.prototype.union_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(let s=0;s<r;++s)e+=this.hammingWeight(this.words[s]|t.words[s]);if(this.words.length<t.words.length){let s=t.words.length;for(let n=this.words.length;n<s;++n)e+=this.hammingWeight(t.words[n]|0)}else{let s=this.words.length;for(let n=t.words.length;n<s;++n)e+=this.hammingWeight(this.words[n]|0)}return e};yr.exports=A});var Ar=hr(($o,$r)=>{"use strict";function Qi(t,r){function e(){this.constructor=t}e.prototype=r.prototype,t.prototype=new e}function J(t,r,e,s){this.message=t,this.expected=r,this.found=e,this.location=s,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,J)}Qi(J,Error);J.buildMessage=function(t,r){var e={literal:function(g){return'"'+n(g.text)+'"'},class:function(g){var m="",y;for(y=0;y<g.parts.length;y++)m+=g.parts[y]instanceof Array?c(g.parts[y][0])+"-"+c(g.parts[y][1]):c(g.parts[y]);return"["+(g.inverted?"^":"")+m+"]"},any:function(g){return"any character"},end:function(g){return"end of input"},other:function(g){return g.description}};function s(g){return g.charCodeAt(0).toString(16).toUpperCase()}function n(g){return g.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+s(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+s(m)})}function c(g){return g.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+s(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+s(m)})}function l(g){return e[g.type](g)}function h(g){var m=new Array(g.length),y,L;for(y=0;y<g.length;y++)m[y]=l(g[y]);if(m.sort(),m.length>0){for(y=1,L=1;y<m.length;y++)m[y-1]!==m[y]&&(m[L]=m[y],L++);m.length=L}switch(m.length){case 1:return m[0];case 2:return m[0]+" or "+m[1];default:return m.slice(0,-1).join(", ")+", or "+m[m.length-1]}}function v(g){return g?'"'+n(g)+'"':"end of input"}return"Expected "+h(t)+" but "+v(r)+" found."};function Yi(t,r){r=r!==void 0?r:{};var e={},s={Lines:tr},n=tr,c=function(i,a){return _.mkProgram(Fe(i,a,1),P())},l=function(i){return i},h=function(i,a){return _.mkAsmLine(i,a,P())},v=function(i){return _.mkAsmLine(i,null,P())},g=function(i){return _.mkAsmLine(null,i,P())},m=function(i){return _.mkAsmLine(null,i,P())},y=function(){return _.mkAsmLine(null,null,P())},L=function(i){return i},$=function(i){return i},q=T("directive"),K=function(i,a){let u=i=="byte"?_.DataSize.Byte:_.DataSize.Word;return _.mkData(u,a,P())},_e=function(i,a){return Fe(i,a,3)},An=function(i,a,u){return _.mkInsn(i,a,u,P())},Cn=function(i,a){return _.mkInsn(i,a,null,P())},Ln=function(i){return _.mkInsn(i,null,null,P())},Sn=/^[a-zA-Z_]/,En=V([["a","z"],["A","Z"],"_"],!1,!1),kn=/^[a-zA-Z_0-9]/,_n=V([["a","z"],["A","Z"],"_",["0","9"]],!1,!1),zt=/^[0-9a-f]/i,Vt=V([["0","9"],["a","f"]],!1,!0),qt=/^[0-1]/,Ht=V([["0","1"]],!1,!1),Pn=/^[+\-]/,Dn=V(["+","-"],!1,!1),Gt=/^[0-9]/,Xt=V([["0","9"]],!1,!1),Pe=/^[a-z]/i,De=V([["a","z"]],!1,!0),Jt=/^[0-9a-z_]/i,Zt=V([["0","9"],["a","z"],"_"],!1,!0),In="a",Mn=k("a",!0),On="b",Fn=k("b",!0),Rn="c",jn=k("c",!0),Bn="d",Tn=k("d",!0),Un="g",Wn=k("g",!0),Nn="h",zn=k("h",!0),Vn="j",qn=k("j",!0),Hn="m",Gn=k("m",!0),Xn="o",Jn=k("o",!0),Zn="r",Qn=k("r",!0),Yn="x",Kn=k("x",!0),es="y",ts=k("y",!0),rs="0",ns=k("0",!1),ss="1",is=k("1",!1),os="2",as=k("2",!1),cs=",",ls=k(",",!1),us=":",fs=k(":",!1),ds=";",hs=k(";",!1),gs="dfb",ps=k("dfb",!0),ms=function(){return"byte"},ws="dfw",vs=k("dfw",!0),xs=function(){return"word"},ys=function(i){return parseInt(i,2)},bs=function(i){return parseInt(i,16)},$s=function(i){return parseInt(i)},rt='"',nt=k('"',!1),As=function(i){return i.join("")},st=si(),Cs=function(i){return i},Qt=function(){return ri()},Yt=T("whitespace"),Ls="	",Ss=k("	",!1),Es="\v",ks=k("\v",!1),_s="\f",Ps=k("\f",!1),Ds=" ",Is=k(" ",!1),Ms="\xA0",Os=k("\xA0",!1),Fs="\uFEFF",Rs=k("\uFEFF",!1),js=T("end of line"),Bs=/^[\n\r]/,Ts=V([`
`,"\r"],!1,!1),Us=T("comment"),Ws=T("label"),Ns=function(i){return _.mkLabel(i,P())},zs=T("ORG"),Vs=function(i){return _.mkSetPC(i,P())},qs=T("mnemonic"),Hs=T("literal"),Gs=function(i){return _.mkLiteral(i,"b",P())},Xs=function(i){return _.mkLiteral(i,"h",P())},Js=function(i){return _.mkLiteral(i,"d",P())},Zs=function(i){return _.mkLiteral(i,"s",P())},Qs=T("identifier"),W="::",fe=k("::",!1),Ys=function(i,a){return _.mkScopeQualifiedIdent(Fe(i,a,1),!1,P())},Ks=function(i,a){return _.mkScopeQualifiedIdent(Fe(i,a,1),!0,P())},ei=T("register"),ti=function(i){return _.mkRegister(i.toLowerCase(),P())},o=0,C=0,Ie=[{line:1,column:1}],N=0,it=[],w=0,Me;if("startRule"in r){if(!(r.startRule in s))throw new Error(`Can't start parsing from rule "`+r.startRule+'".');n=s[r.startRule]}function ri(){return t.substring(C,o)}function ni(){return de(C,o)}function ho(i,a){throw a=a!==void 0?a:de(C,o),er([T(i)],t.substring(C,o),a)}function go(i,a){throw a=a!==void 0?a:de(C,o),oi(i,a)}function k(i,a){return{type:"literal",text:i,ignoreCase:a}}function V(i,a,u){return{type:"class",parts:i,inverted:a,ignoreCase:u}}function si(){return{type:"any"}}function ii(){return{type:"end"}}function T(i){return{type:"other",description:i}}function Kt(i){var a=Ie[i],u;if(a)return a;for(u=i-1;!Ie[u];)u--;for(a=Ie[u],a={line:a.line,column:a.column};u<i;)t.charCodeAt(u)===10?(a.line++,a.column=1):a.column++,u++;return Ie[i]=a,a}function de(i,a){var u=Kt(i),f=Kt(a);return{start:{offset:i,line:u.line,column:u.column},end:{offset:a,line:f.line,column:f.column}}}function x(i){o<N||(o>N&&(N=o,it=[]),it.push(i))}function oi(i,a){return new J(i,null,null,a)}function er(i,a,u){return new J(J.buildMessage(i,a),i,a,u)}function tr(){var i,a,u,f,p,b;if(i=o,a=ot(),a!==e){for(u=[],f=o,p=Oe(),p!==e?(b=ot(),b!==e?(p=[p,b],f=p):(o=f,f=e)):(o=f,f=e);f!==e;)u.push(f),f=o,p=Oe(),p!==e?(b=ot(),b!==e?(p=[p,b],f=p):(o=f,f=e)):(o=f,f=e);u!==e?(C=i,a=c(a,u),i=a):(o=i,i=e)}else o=i,i=e;return i}function ot(){var i,a,u,f,p;return i=o,a=F(),a!==e?(u=ai(),u!==e?(f=F(),f!==e?(p=_i(),p===e&&(p=null),p!==e?(C=i,a=l(u),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),i}function ai(){var i,a,u,f;return i=o,a=fr(),a!==e?(u=F(),u!==e?(f=rr(),f!==e?(C=i,a=h(a,f),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),i===e&&(i=o,a=fr(),a!==e&&(C=i,a=v(a)),i=a,i===e&&(i=o,a=Pi(),a!==e&&(C=i,a=g(a)),i=a,i===e&&(i=o,a=rr(),a!==e&&(C=i,a=m(a)),i=a,i===e&&(i=o,a=F(),a!==e&&(C=i,a=y()),i=a)))),i}function rr(){var i,a;return i=o,a=ci(),a!==e&&(C=i,a=L(a)),i=a,i===e&&(i=o,a=ui(),a!==e&&(C=i,a=$(a)),i=a),i}function ci(){var i,a,u,f;return w++,i=o,a=Ai(),a===e&&(a=Ci()),a!==e?(u=F(),u!==e?(f=li(),f!==e?(C=i,a=K(a,f),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),w--,i===e&&(a=e,w===0&&x(q)),i}function li(){var i,a,u,f,p,b,I,z;if(i=o,a=ee(),a!==e){for(u=[],f=o,p=F(),p!==e?(b=ft(),b!==e?(I=F(),I!==e?(z=ee(),z!==e?(p=[p,b,I,z],f=p):(o=f,f=e)):(o=f,f=e)):(o=f,f=e)):(o=f,f=e);f!==e;)u.push(f),f=o,p=F(),p!==e?(b=ft(),b!==e?(I=F(),I!==e?(z=ee(),z!==e?(p=[p,b,I,z],f=p):(o=f,f=e)):(o=f,f=e)):(o=f,f=e)):(o=f,f=e);u!==e?(C=i,a=_e(a,u),i=a):(o=i,i=e)}else o=i,i=e;return i}function ui(){var i,a,u,f,p,b,I,z;return i=o,a=dt(),a!==e?(u=F(),u!==e?(f=ee(),f!==e?(p=F(),p!==e?(b=ft(),b!==e?(I=F(),I!==e?(z=ee(),z!==e?(C=i,a=An(a,f,z),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),i===e&&(i=o,a=dt(),a!==e?(u=F(),u!==e?(f=ee(),f!==e?(C=i,a=Cn(a,f),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),i===e&&(i=o,a=dt(),a!==e&&(C=i,a=Ln(a)),i=a)),i}function ee(){var i;return i=dr(),i===e&&(i=Ii(),i===e&&(i=Di())),i}function at(){var i;return Sn.test(t.charAt(o))?(i=t.charAt(o),o++):(i=e,w===0&&x(En)),i}function nr(){var i;return kn.test(t.charAt(o))?(i=t.charAt(o),o++):(i=e,w===0&&x(_n)),i}function fi(){var i,a;if(i=[],zt.test(t.charAt(o))?(a=t.charAt(o),o++):(a=e,w===0&&x(Vt)),a!==e)for(;a!==e;)i.push(a),zt.test(t.charAt(o))?(a=t.charAt(o),o++):(a=e,w===0&&x(Vt));else i=e;return i}function di(){var i,a;if(i=[],qt.test(t.charAt(o))?(a=t.charAt(o),o++):(a=e,w===0&&x(Ht)),a!==e)for(;a!==e;)i.push(a),qt.test(t.charAt(o))?(a=t.charAt(o),o++):(a=e,w===0&&x(Ht));else i=e;return i}function hi(){var i,a,u,f;if(i=o,Pn.test(t.charAt(o))?(a=t.charAt(o),o++):(a=e,w===0&&x(Dn)),a===e&&(a=null),a!==e){if(u=[],Gt.test(t.charAt(o))?(f=t.charAt(o),o++):(f=e,w===0&&x(Xt)),f!==e)for(;f!==e;)u.push(f),Gt.test(t.charAt(o))?(f=t.charAt(o),o++):(f=e,w===0&&x(Xt));else u=e;u!==e?(a=[a,u],i=a):(o=i,i=e)}else o=i,i=e;return i}function gi(){var i,a,u,f;if(i=o,a=[],Pe.test(t.charAt(o))?(u=t.charAt(o),o++):(u=e,w===0&&x(De)),u!==e)for(;u!==e;)a.push(u),Pe.test(t.charAt(o))?(u=t.charAt(o),o++):(u=e,w===0&&x(De));else a=e;if(a!==e){for(u=[],Jt.test(t.charAt(o))?(f=t.charAt(o),o++):(f=e,w===0&&x(Zt));f!==e;)u.push(f),Jt.test(t.charAt(o))?(f=t.charAt(o),o++):(f=e,w===0&&x(Zt));u!==e?(a=[a,u],i=a):(o=i,i=e)}else o=i,i=e;return i}function pi(){var i;return t.substr(o,1).toLowerCase()===In?(i=t.charAt(o),o++):(i=e,w===0&&x(Mn)),i}function sr(){var i;return t.substr(o,1).toLowerCase()===On?(i=t.charAt(o),o++):(i=e,w===0&&x(Fn)),i}function mi(){var i;return t.substr(o,1).toLowerCase()===Rn?(i=t.charAt(o),o++):(i=e,w===0&&x(jn)),i}function ir(){var i;return t.substr(o,1).toLowerCase()===Bn?(i=t.charAt(o),o++):(i=e,w===0&&x(Tn)),i}function wi(){var i;return t.substr(o,1).toLowerCase()===Un?(i=t.charAt(o),o++):(i=e,w===0&&x(Wn)),i}function po(){var i;return t.substr(o,1).toLowerCase()===Nn?(i=t.charAt(o),o++):(i=e,w===0&&x(zn)),i}function ct(){var i;return t.substr(o,1).toLowerCase()===Vn?(i=t.charAt(o),o++):(i=e,w===0&&x(qn)),i}function lt(){var i;return t.substr(o,1).toLowerCase()===Hn?(i=t.charAt(o),o++):(i=e,w===0&&x(Gn)),i}function vi(){var i;return t.substr(o,1).toLowerCase()===Xn?(i=t.charAt(o),o++):(i=e,w===0&&x(Jn)),i}function xi(){var i;return t.substr(o,1).toLowerCase()===Zn?(i=t.charAt(o),o++):(i=e,w===0&&x(Qn)),i}function ut(){var i;return t.substr(o,1).toLowerCase()===Yn?(i=t.charAt(o),o++):(i=e,w===0&&x(Kn)),i}function or(){var i;return t.substr(o,1).toLowerCase()===es?(i=t.charAt(o),o++):(i=e,w===0&&x(ts)),i}function yi(){var i;return t.charCodeAt(o)===48?(i=rs,o++):(i=e,w===0&&x(ns)),i}function ar(){var i;return t.charCodeAt(o)===49?(i=ss,o++):(i=e,w===0&&x(is)),i}function cr(){var i;return t.charCodeAt(o)===50?(i=os,o++):(i=e,w===0&&x(as)),i}function ft(){var i;return t.charCodeAt(o)===44?(i=cs,o++):(i=e,w===0&&x(ls)),i}function bi(){var i;return t.charCodeAt(o)===58?(i=us,o++):(i=e,w===0&&x(fs)),i}function $i(){var i;return t.charCodeAt(o)===59?(i=ds,o++):(i=e,w===0&&x(hs)),i}function Ai(){var i,a;return i=o,t.substr(o,3).toLowerCase()===gs?(a=t.substr(o,3),o+=3):(a=e,w===0&&x(ps)),a!==e&&(C=i,a=ms()),i=a,i}function Ci(){var i,a;return i=o,t.substr(o,3).toLowerCase()===ws?(a=t.substr(o,3),o+=3):(a=e,w===0&&x(vs)),a!==e&&(C=i,a=xs()),i=a,i}function Li(){var i,a,u;return i=o,a=o,u=di(),u!==e?a=t.substring(a,o):a=u,a!==e?(u=sr(),u!==e?(C=i,a=ys(a),i=a):(o=i,i=e)):(o=i,i=e),i}function Si(){var i,a,u,f,p;return i=o,a=yi(),a!==e?(u=ut(),u!==e?(f=o,p=fi(),p!==e?f=t.substring(f,o):f=p,f!==e?(C=i,a=bs(f),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),i}function Ei(){var i,a,u;return i=o,a=o,u=hi(),u!==e?a=t.substring(a,o):a=u,a!==e?(u=ir(),u===e&&(u=null),u!==e?(C=i,a=$s(a),i=a):(o=i,i=e)):(o=i,i=e),i}function ki(){var i,a,u,f;if(i=o,t.charCodeAt(o)===34?(a=rt,o++):(a=e,w===0&&x(nt)),a!==e){for(u=[],f=lr();f!==e;)u.push(f),f=lr();u!==e?(t.charCodeAt(o)===34?(f=rt,o++):(f=e,w===0&&x(nt)),f!==e?(C=i,a=As(u),i=a):(o=i,i=e)):(o=i,i=e)}else o=i,i=e;return i}function lr(){var i,a,u;return i=o,a=o,w++,t.charCodeAt(o)===34?(u=rt,o++):(u=e,w===0&&x(nt)),w--,u===e?a=void 0:(o=a,a=e),a!==e?(t.length>o?(u=t.charAt(o),o++):(u=e,w===0&&x(st)),u!==e?(C=i,a=Cs(u),i=a):(o=i,i=e)):(o=i,i=e),i}function te(){var i,a,u,f,p;if(i=o,a=o,u=[],f=at(),f!==e)for(;f!==e;)u.push(f),f=at();else u=e;if(u!==e){for(f=[],p=nr();p!==e;)f.push(p),p=nr();f!==e?(u=[u,f],a=u):(o=a,a=e)}else o=a,a=e;return a!==e&&(C=i,a=Qt()),i=a,i}function F(){var i,a;for(w++,i=[],a=ur();a!==e;)i.push(a),a=ur();return w--,i===e&&(a=e,w===0&&x(Yt)),i}function ur(){var i,a;return w++,t.charCodeAt(o)===9?(i=Ls,o++):(i=e,w===0&&x(Ss)),i===e&&(t.charCodeAt(o)===11?(i=Es,o++):(i=e,w===0&&x(ks)),i===e&&(t.charCodeAt(o)===12?(i=_s,o++):(i=e,w===0&&x(Ps)),i===e&&(t.charCodeAt(o)===32?(i=Ds,o++):(i=e,w===0&&x(Is)),i===e&&(t.charCodeAt(o)===160?(i=Ms,o++):(i=e,w===0&&x(Os)),i===e&&(t.charCodeAt(o)===65279?(i=Fs,o++):(i=e,w===0&&x(Rs))))))),w--,i===e&&(a=e,w===0&&x(Yt)),i}function Oe(){var i,a;return w++,Bs.test(t.charAt(o))?(i=t.charAt(o),o++):(i=e,w===0&&x(Ts)),w--,i===e&&(a=e,w===0&&x(js)),i}function _i(){var i,a,u,f,p,b;if(w++,i=o,a=$i(),a!==e){for(u=[],f=o,p=o,w++,b=Oe(),w--,b===e?p=void 0:(o=p,p=e),p!==e?(t.length>o?(b=t.charAt(o),o++):(b=e,w===0&&x(st)),b!==e?(p=[p,b],f=p):(o=f,f=e)):(o=f,f=e);f!==e;)u.push(f),f=o,p=o,w++,b=Oe(),w--,b===e?p=void 0:(o=p,p=e),p!==e?(t.length>o?(b=t.charAt(o),o++):(b=e,w===0&&x(st)),b!==e?(p=[p,b],f=p):(o=f,f=e)):(o=f,f=e);u!==e?(a=[a,u],i=a):(o=i,i=e)}else o=i,i=e;return w--,i===e&&(a=e,w===0&&x(Us)),i}function fr(){var i,a,u;return w++,i=o,a=o,u=gi(),u!==e?a=t.substring(a,o):a=u,a!==e?(u=bi(),u!==e?(C=i,a=Ns(a),i=a):(o=i,i=e)):(o=i,i=e),w--,i===e&&(a=e,w===0&&x(Ws)),i}function Pi(){var i,a,u,f,p,b;return w++,i=o,a=vi(),a!==e?(u=xi(),u!==e?(f=wi(),f!==e?(p=F(),p!==e?(b=dr(),b!==e?(C=i,a=Vs(b),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),w--,i===e&&(a=e,w===0&&x(zs)),i}function dt(){var i,a,u;if(w++,i=o,a=[],Pe.test(t.charAt(o))?(u=t.charAt(o),o++):(u=e,w===0&&x(De)),u!==e)for(;u!==e;)a.push(u),Pe.test(t.charAt(o))?(u=t.charAt(o),o++):(u=e,w===0&&x(De));else a=e;return a!==e&&(C=i,a=Qt()),i=a,w--,i===e&&(a=e,w===0&&x(qs)),i}function dr(){var i,a;return w++,i=o,a=Li(),a!==e&&(C=i,a=Gs(a)),i=a,i===e&&(i=o,a=Si(),a!==e&&(C=i,a=Xs(a)),i=a,i===e&&(i=o,a=Ei(),a!==e&&(C=i,a=Js(a)),i=a,i===e&&(i=o,a=ki(),a!==e&&(C=i,a=Zs(a)),i=a))),w--,i===e&&(a=e,w===0&&x(Hs)),i}function Di(){var i,a,u,f,p,b,I;if(w++,i=o,a=te(),a!==e){for(u=[],f=o,t.substr(o,2)===W?(p=W,o+=2):(p=e,w===0&&x(fe)),p!==e?(b=te(),b!==e?(p=[p,b],f=p):(o=f,f=e)):(o=f,f=e);f!==e;)u.push(f),f=o,t.substr(o,2)===W?(p=W,o+=2):(p=e,w===0&&x(fe)),p!==e?(b=te(),b!==e?(p=[p,b],f=p):(o=f,f=e)):(o=f,f=e);u!==e?(C=i,a=Ys(a,u),i=a):(o=i,i=e)}else o=i,i=e;if(i===e)if(i=o,t.substr(o,2)===W?(a=W,o+=2):(a=e,w===0&&x(fe)),a!==e)if(u=te(),u!==e){for(f=[],p=o,t.substr(o,2)===W?(b=W,o+=2):(b=e,w===0&&x(fe)),b!==e?(I=te(),I!==e?(b=[b,I],p=b):(o=p,p=e)):(o=p,p=e);p!==e;)f.push(p),p=o,t.substr(o,2)===W?(b=W,o+=2):(b=e,w===0&&x(fe)),b!==e?(I=te(),I!==e?(b=[b,I],p=b):(o=p,p=e)):(o=p,p=e);f!==e?(C=i,a=Ks(u,f),i=a):(o=i,i=e)}else o=i,i=e;else o=i,i=e;return w--,i===e&&(a=e,w===0&&x(Qs)),i}function Ii(){var i,a,u,f,p;return w++,i=o,a=o,u=pi(),u===e&&(u=sr(),u===e&&(u=mi(),u===e&&(u=ir(),u===e&&(u=o,f=lt(),f!==e?(p=cr(),p!==e?(f=[f,p],u=f):(o=u,u=e)):(o=u,u=e),u===e&&(u=o,f=lt(),f!==e?(p=ar(),p!==e?(f=[f,p],u=f):(o=u,u=e)):(o=u,u=e),u===e&&(u=lt(),u===e&&(u=o,f=ut(),f!==e?(p=or(),p!==e?(f=[f,p],u=f):(o=u,u=e)):(o=u,u=e),u===e&&(u=ut(),u===e&&(u=or(),u===e&&(u=o,f=ct(),f!==e?(p=ar(),p!==e?(f=[f,p],u=f):(o=u,u=e)):(o=u,u=e),u===e&&(u=o,f=ct(),f!==e?(p=cr(),p!==e?(f=[f,p],u=f):(o=u,u=e)):(o=u,u=e),u===e&&(u=ct())))))))))))),u!==e?a=t.substring(a,o):a=u,a!==e?(u=o,w++,f=at(),w--,f===e?u=void 0:(o=u,u=e),u!==e?(C=i,a=ti(a),i=a):(o=i,i=e)):(o=i,i=e),w--,i===e&&(a=e,w===0&&x(ei)),i}var _=(mt(),pr(pt));function Mi(i,a){return i.map(function(u){return u[a]})}function Fe(i,a,u){return[i].concat(Mi(a,u))}function P(){return{...ni()}}if(Me=n(),Me!==e&&o===t.length)return Me;throw Me!==e&&o<t.length&&x(ii()),er(it,N<t.length?t.charAt(N):null,N<t.length?de(N,N+1):de(N,N))}$r.exports={SyntaxError:J,parse:Yi}});var fo={};gr(fo,{RCASMWorker:()=>tt,create:()=>uo});var H={a:0,d:1},Ti={a:0,b:1,m:2,j:3},gt={a:0,b:1,c:2,d:3,m1:4,m2:5,x:6,y:7},S;(function(t){t[t.None=0]="None",t[t.AluDst=1]="AluDst",t[t.ClrTgt=2]="ClrTgt",t[t.GtoTgt=3]="GtoTgt",t[t.LitOpc=4]="LitOpc",t[t.MovDstSrc=5]="MovDstSrc",t[t.SetTgtVal=6]="SetTgtVal"})(S||(S={}));var mr={add:{op:129,pf:S.AluDst,p1:{cs:H,op:t=>t<<3},p2:null},inc:{op:130,pf:S.AluDst,p1:{cs:H,op:t=>t<<3},p2:null},and:{op:131,pf:S.AluDst,p1:{cs:H,op:t=>t<<3},p2:null},orr:{op:132,pf:S.AluDst,p1:{cs:H,op:t=>t<<3},p2:null},eor:{op:133,pf:S.AluDst,p1:{cs:H,op:t=>t<<3},p2:null},cmp:{op:133,pf:S.AluDst,p1:{cs:H,op:t=>t<<3},p2:null},not:{op:134,pf:S.AluDst,p1:{cs:H,op:t=>t<<3},p2:null},rol:{op:135,pf:S.AluDst,p1:{cs:H,op:t=>t<<3},p2:null},mov:{op:0,pf:S.MovDstSrc,p1:{cs:gt,op:t=>t<<3},p2:{cs:gt,op:t=>t}},clr:{op:0,pf:S.ClrTgt,p1:{cs:gt,op:t=>t<<3|t},p2:null},ldi:{op:0,pf:S.SetTgtVal,p1:{cs:Ti,op:t=>((t&2)===2?192:64)|t<<5},p2:{cs:null,op:t=>t}},hlt:{op:174,pf:S.None,p1:null,p2:null},hlr:{op:175,pf:S.None,p1:null,p2:null},jmp:{op:230,pf:S.GtoTgt,p1:null,p2:null},jsr:{op:231,pf:S.GtoTgt,p1:null,p2:null},bne:{op:226,pf:S.GtoTgt,p1:null,p2:null},beq:{op:228,pf:S.GtoTgt,p1:null,p2:null},bcs:{op:232,pf:S.GtoTgt,p1:null,p2:null},bmi:{op:240,pf:S.GtoTgt,p1:null,p2:null},blt:{op:240,pf:S.GtoTgt,p1:null,p2:null},ble:{op:244,pf:S.GtoTgt,p1:null,p2:null},opc:{op:0,pf:S.LitOpc,p1:{cs:null,op:t=>t},p2:null}};function R(t){return t.toString(16).padStart(4,"0")}mt();var re=class{constructor(r,e,s,n){this.start=r,this.end=e,this.inferStart=s,this.id=n,this.blocks=[{start:r,binary:[]}],this.curBlock=this.blocks[0]}setCurrentPC(r){let e;if(this.inferStart&&this.blocks.length===1&&this.blocks[0].binary.length===0)this.start=r;else{let c=this.end!==void 0?`$${R(this.end)}`:"",l=`Segment address range: $${R(this.start)}-${c}`;r<this.start?e=`${l}.  Cannot set program counter to a lower address $${R(r)}.`:this.end!==void 0&&r>this.end?e=`${l}.  Trying to set program counter to $${R(r)} -- it is past segment end ${c}.`:this.blocks.length===1&&this.blocks[0].binary.length===0&&(this.start=r)}let s={start:r,binary:[]},n=this.blocks.push(s);return this.curBlock=this.blocks[n-1],e}empty(){return this.blocks.every(r=>r.binary.length===0)}currentPC(){return this.curBlock.start+this.curBlock.binary.length}emit(r){if(this.currentPC()<this.start||this.end!==void 0&&this.currentPC()>this.end){let e=this.end!==void 0?`$${R(this.end)}`:"",s=this.start!==void 0?`$${R(this.start)}`:"";return`Segment overflow at $${R(this.currentPC())}.  Segment address range: ${s}-${e}`}this.curBlock.binary.push(r)}formatRange(){let r=this.end!==void 0?`$${R(this.end)}`:"";return`${this.start!==void 0?`$${R(this.start)}`:""}-${r}`}overlaps(r){let e=this.start,s=r.start,n=this.end!==void 0?this.end:this.currentPC(),c=r.end!==void 0?r.end:r.currentPC();return e<s?s<=n:c>=e}};function wr(t){let r=[];for(let[e,s]of t){let n=s.blocks.filter(c=>c.binary.length!==0).sort((c,l)=>c.start-l.start);if(n.length!==0){let c=new re(s.start,s.end,s.inferStart,r.length-1);c.blocks=n,c.curBlock=n[n.length-1],r.push([e,c])}}return r}function vr(t){let r=wr(t);if(r.length===0)return{startPC:0,binary:Uint8Array.from([])};let[,e]=r[0],s=e.blocks[0],n=e.blocks[e.blocks.length-1],c=s.start,l=n.start+n.binary.length;for(let v=1;v<r.length;v++){let g=r[v][1],m=g.blocks[0].start,y=g.curBlock.start+g.curBlock.binary.length;c=Math.min(m,c),l=Math.max(y,l)}let h=new Uint8Array(l);for(let[,v]of r)for(let g of v.blocks)for(let m=0;m<g.binary.length;m++)h[g.start+m]=g.binary[m];return{startPC:c,binary:h.slice(c)}}function xr(t){return wr(t).sort((e,s)=>e[1].start-s[1].start).map(([e,s])=>{let n=s.blocks.map(c=>({start:c.start,end:c.start+c.binary.length-1}));return{name:e,blocks:n}})}var Zi=br(),ge=class{constructor(){this.lineStack=[],this.pcToLocs={},this.insnBitset=new Zi}startLine(r,e,s){let n={lineNo:r.start.line,segmentId:s.id,numBytes:0};this.lineStack.push({loc:n,pc:e,segmentId:s.id})}endLine(r,e){let s=this.lineStack.pop();if(!s)throw new Error("internal compiler error, mismatching start/end lines in debugInfo");let n=r-s.pc;if(n>0&&e.id===s.segmentId){let c={...s.loc,numBytes:n};this.pcToLocs[s.pc]===void 0?this.pcToLocs[s.pc]=[c]:this.pcToLocs[s.pc].push(c)}}markAsInstruction(r,e){for(let s=r;s<e;s++)this.insnBitset.add(s)}info(){let r=this.insnBitset.clone(),e=s=>r.has(s);return{pcToLocs:this.pcToLocs,isInstruction:e}}};var Cr=Ar();function wt(t){return{value:t,errors:!0,completeFirstPass:!1}}function xt(t,r){return{value:t,errors:!1,completeFirstPass:r}}function Re(...t){return t.some(r=>r!==void 0&&r.errors)}var yt=class{constructor(r,e){this.syms=new Map,this.parent=null,this.children=new Map,this.parent=r,this.name=e}findSymbol(r){for(let e=this;e!==null;e=e.parent){let s=e.syms.get(r);if(s!==void 0)return s}}findSymbolPath(r){if(r.length===1)return this.findSymbol(r[0]);let e=this;for(;e.children.get(r[0])===void 0;)if(e=e.parent,e===null)return;for(let s=0;s<r.length-1;s++)if(e=e.children.get(r[s]),e===void 0)return;return e.syms.get(r[r.length-1])}addSymbol(r,e,s){this.syms.set(r,{...e,seen:s})}updateSymbol(r,e,s){for(let n=this;n!==null;n=n.parent)if(n.syms.get(r)!==void 0){n.syms.set(r,{...e,seen:s});return}}},bt=class{constructor(){this.passCount=0,this.root=new yt(null,""),this.curSymtab=this.root,this.anonScopeCount=0}startPass(r){this.curSymtab=this.root,this.anonScopeCount=0,this.passCount=r}findPath(r,e){return e?this.root.findSymbolPath(r):this.curSymtab.findSymbolPath(r)}findQualifiedSym(r,e){return this.findPath(r,e)}symbolSeen(r){let e=this.curSymtab.syms.get(r);return e!==void 0?e.seen===this.passCount:!1}declareLabelSymbol(r,e,s){let{name:n,loc:c}=r,l=this.curSymtab.syms.get(n);if(l===void 0){let v={type:"label",segment:s,data:xt({addr:e,loc:c},!1)};return this.curSymtab.addSymbol(n,v,this.passCount),!1}if(l.type!=="label")throw new Error("ICE: declareLabelSymbol should be called only on labels");if(l.data.value.addr!==e){let v={type:"label",segment:s,data:{...l.data,value:{...l.data.value,addr:e}}};return this.curSymtab.updateSymbol(n,v,this.passCount),!0}return this.curSymtab.updateSymbol(n,l,this.passCount),!1}dumpLabels(r,e){let s={};for(let[g,m]of e)s[m.id]=g;let n=[],c=(g,m)=>{if(g!==void 0){let y=[...g,m.name];n.push({path:y,sym:m})}else n.push({path:[],sym:m})};c(void 0,this.root);let l=[];for(;n.length>0;){let g=n.pop();if(g){for(let[m,y]of g.sym.syms)y.type==="label"&&l.push({path:[...g.path,m],addr:y.data.value.addr,size:0,segmentName:s[y.segment.id]});for(let[,m]of g.sym.children)c(g.path,m)}}let h=l.sort((g,m)=>g.addr-m.addr),v=h.length;if(v>0){for(let m=1;m<v;m++)h[m-1].size=h[m].addr-h[m-1].addr;let g=h[v-1];g.size=r-g.addr}return h.map(({path:g,addr:m,size:y,segmentName:L})=>({name:g.join("::"),addr:m,size:y,segmentName:L}))}};function vt(t){let r=typeof t;return r==="object"&&t instanceof Array?"array":r}function Ki(t){return`${t.absolute?"::":""}${t.path.join("::")}`}var $t=class{constructor(){this.curSegmentName="",this.curSegment=new re(0,0,!1,0),this.pass=0,this.needPass=!1,this.scopes=new bt,this.segments=[],this.errorList=[],this.warningList=[],this.debugInfo=new ge,this.errors=()=>this.formatErrors(this.errorList,"error"),this.warnings=()=>this.formatErrors(this.warningList,"warning")}prg(){let{startPC:r,binary:e}=vr(this.segments),s=r&255,n=r>>8&255;return Uint8Array.from([s,n,...e])}anyErrors(){return this.errorList.length!==0}formatErrors(r,e){return[...new Set(r.map(n=>JSON.stringify(n)))].map(n=>{let{loc:c,msg:l}=JSON.parse(n),h=`<unknown>:1:1: ${e}: ${l}`;return c&&(h=`${c.start.line}:${c.start.column}: ${e}: ${l}`),{loc:c,msg:l,formatted:h}})}addError(r,e){this.errorList.push({msg:r,loc:e})}addWarning(r,e){this.warningList.push({msg:r,loc:e})}startPass(r){this.pass=r,this.needPass=!1,this.errorList=[],this.scopes.startPass(r),this.debugInfo=new ge,this.segments=[];let e=this.newSegment("default",0,void 0,!0);this.setCurrentSegment({type:"segment",data:e},"default")}setCurrentSegment(r,e){this.curSegmentName=e,this.curSegment=r.data}newSegment(r,e,s,n){let c=new re(e,s,n,this.segments.length-1);return this.segments.push([r,c]),c}getPC(){return this.curSegment.currentPC()}evalExprType(r,e,s){let n=this.evalExpr(r),{errors:c,value:l,completeFirstPass:h}=n;return!c&&typeof l!==e?(this.addError(`Expecting ${s} to be '${e}' type, got '${vt(l)}'`,r.loc),{errors:!0,completeFirstPass:h,value:l}):n}evalExprToInt(r,e){return this.evalExprType(r,"number",e)}evalExpr(r){switch(r.type){case"literal":return xt(r.lit,!0);case"register":return this.addError("Unexpected register",r.loc),wt(0);case"ident":throw new Error("should not see an ident here -- if you do, it is probably a wrong type node in parser");case"qualified-ident":{let e=this.scopes.findQualifiedSym(r.path,r.absolute);if(e===void 0)return this.pass>=1?(this.addError(`Undefined symbol '${Ki(r)}'`,r.loc),wt(0)):(this.needPass=!0,xt(0,!1));switch(e.type){case"label":return{errors:e.data.errors,value:e.data.value.addr,completeFirstPass:e.seen===this.pass}}break}default:break}throw new Error(`should be unreachable on ${r}`)}emit(r){let e=this.curSegment.emit(r);e!==void 0&&this.addError(e,this.lineLoc)}emit16(r){this.emit(r>>8&255),this.emit(r&255)}assembleNonInstr(r,e){e.p1&&this.addWarning("Parameter not required",e.p1.loc),e.p2&&this.addWarning("Parameter not required",e.p2.loc),this.emit(r.op)}assembleAluInstr(r,e){e.p2&&this.addWarning("Parameter not required",e.p2.loc);let s=r.op;if(e.p1&&r.p1){let n=this.checkRegister(e.p1,r.p1);if(n===void 0)return;s|=r.p1.op(n)}this.emit(s)}assembleClrInstr(r,e){e.p2&&this.addWarning("Parameter not required",e.p2.loc);let s=r.op;if(!e.p1||!r.p1){this.addError("Parameter required",e.loc);return}let n=this.checkRegister(e.p1,r.p1);n!==void 0&&(s|=r.p1.op(n),this.emit(s))}assembleMovInstr(r,e){if(!e.p1||!r.p1||!e.p2||!r.p2){this.addError("Two parameters required",e.loc);return}let s=r.op,n=this.checkRegister(e.p1,r.p1);if(n===void 0)return;s|=r.p1.op(n);let c=this.checkRegister(e.p2,r.p2);c!==void 0&&(s|=r.p2.op(c),this.emit(s))}assembleLitOpc(r,e){e.p2&&this.addWarning("Parameter not required",e.p2.loc);let s=r.op;if(!e.p1||!r.p1){this.addError("Parameter required",e.loc);return}let n=this.checkLiteral(e.p1,0,255,"h");n!==void 0&&(s|=r.p1.op(n),this.emit(s))}assembleSetInstr(r,e){if(!e.p1||!r.p1||!e.p2||!r.p2){this.addError("Two parameters required",e.loc);return}let s=r.op,n=this.checkRegister(e.p1,r.p1);if(n!==void 0){if(s|=r.p1.op(n),n<=16){let c=this.checkLiteral(e.p2,-16,15);if(c===void 0)return;s|=r.p2.op(c)}this.emit(s)}}checkRegister(r,e){if(r.type!=="register")this.addError("Register required",r.loc);else{let s=e.cs?.[r.value];return s===void 0&&(e.cs?this.addError(`Invalid register - choose one of [${Object.keys(e.cs).join("|")}]`,r.loc):this.addError("Invalid register",r.loc)),s}}checkLiteral(r,e,s,n="d"){let c=this.evalExprToInt(r,"value");if(!Re(c)){let l=c.value;if(l<e||l>s){let h="";switch(n){case"b":{let v=s.toString(2);h=`${("0".repeat(v.length)+e.toString(2)).slice(-v.length)}b and ${v}b`;break}case"h":{let v=s.toString(16).toUpperCase();h=`0x${("0".repeat(v.length)+e.toString(16).toUpperCase()).slice(-v.length)} and 0x${v}`;break}default:h=`${e} and ${s}`}this.addError(`Literal out of range (must be between ${h})`,r.loc)}else return l}}assembleBranch(r,e){if(e.p2&&this.addWarning("Parameter not required",e.p2.loc),!e.p1){this.addError("Parameter required",e.loc);return}if(e.p1.type!=="qualified-ident"){this.addError("Identifier required",e.p1.loc);return}let s=this.evalExpr(e.p1);if(Re(s))return;if(typeof s.value!="number"){this.addError(`Expecting branch label to evaluate to integer, got ${vt(s.value)}`,e.p1.loc);return}let{value:n}=s;this.emit(r.op),this.emit((n&65280)>>8),this.emit(n&255)}handleSetPC(r){let e=this.evalExprToInt(r,"pc");if(!Re(e)){let{value:s,completeFirstPass:n}=e;if(!n){this.addError("Value for new program counter must evaluate to a value in the first pass",r.loc);return}!this.curSegment.empty()&&this.curSegment.currentPC()>s&&this.addError(`Cannot set program counter to a smaller value than current (current: $${R(this.curSegment.currentPC())}, trying to set $${R(s)})`,r.loc);let c=this.curSegment.setCurrentPC(s);c!==void 0&&this.addError(c,r.loc)}}emit8or16(r,e){if(e===8){this.emit(r);return}this.emit16(r)}emitData(r,e){let s=Math.pow(2,e);for(let n=0;n<r.length;n++){let c=this.evalExpr(r[n]);if(Re(c))continue;let{value:l}=c;if(typeof l=="number")l>=s?this.addError(`Data out of range for ${e} bits`,r[n].loc):this.emit8or16(l,e);else if(typeof l=="string"){let h=l.split("").map(v=>v.charCodeAt(0));h.find(v=>v>=s)?this.addError(`Data contains character out of range for ${e} bits`,r[n].loc):h.forEach(v=>this.emit8or16(v,e))}else this.addError(`Only literal types can be emitted. Got ${vt(l)}`,r[n].loc)}}checkDirectives(r,e){switch(r.type){case"data":{this.emitData(r.values,r.dataSize===he.Byte?8:16);break}case"setpc":{this.handleSetPC(r.pc);break}default:this.addError(`unknown directive ${r.type}`,r.loc);return}}assembleLines(r){if(r===null||r.length===0||r.length===0)return;let e=n=>{for(let c=0;c<n.length;c++)this.debugInfo.startLine(n[c].loc,this.getPC(),this.curSegment),this.assembleLine(n[c]),this.debugInfo.endLine(this.getPC(),this.curSegment)},s=0;for(;s<r.length;){let{label:n,stmt:c}=r[s];if(n===null&&c===null)s++;else break}if(!(s>=r.length))return e(r)}checkAndDeclareLabel(r){this.scopes.symbolSeen(r.name)?this.addError(`Symbol '${r.name}' already defined`,r.loc):this.scopes.declareLabelSymbol(r,this.getPC(),this.curSegment)&&(this.needPass=!0)}assembleLine(r){if(this.lineLoc=r.loc,r.label===null&&r.stmt===null||(r.label!==null&&this.checkAndDeclareLabel(r.label),r.stmt===null))return;if(r.stmt.type!=="insn"){this.checkDirectives(r.stmt,r.label===null?null:r.label.name);return}let e=r.stmt,s=mr[e.mnemonic.toLocaleLowerCase()];s!==void 0?(c=>{let l=this.getPC();c();let h=this.getPC();this.debugInfo.markAsInstruction(l,h)})(()=>{switch(s.pf){case S.None:this.assembleNonInstr(s,e);break;case S.AluDst:this.assembleAluInstr(s,e);break;case S.ClrTgt:this.assembleClrInstr(s,e);break;case S.MovDstSrc:this.assembleMovInstr(s,e);break;case S.LitOpc:this.assembleLitOpc(s,e);break;case S.SetTgtVal:this.assembleSetInstr(s,e);break;case S.GtoTgt:this.assembleBranch(s,e);break;default:this.addError(`Couldn't encode instruction '${e.mnemonic} '`,r.loc)}}):this.addError(`Unknown mnemonic '${e.mnemonic}'`,e.loc)}assemble(r){try{let e=Cr.parse(r.toString());e!==void 0&&e.lines&&this.assembleLines(e.lines)}catch(e){if("name"in e&&e.name==="SyntaxError")this.addError(`Syntax error: ${e.message}`,{...e.location});else{if("name"in e&&e.name==="semantic")return;throw e}}}dumpLabels(){return this.scopes.dumpLabels(this.getPC(),this.segments)}collectSegmentInfo(){return xr(this.segments)}};function At(t){try{return Cr.parse(t.toString())}catch{return}}function Ct(t){let r=new $t,e=0;do{if(r.startPass(e),r.assemble(t),e>0&&r.anyErrors())return{prg:Uint8Array.from([]),labels:[],segments:[],debugInfo:void 0,errors:r.errors(),warnings:r.warnings()};e+=1}while(r.needPass);return{prg:r.prg(),errors:r.errors(),warnings:r.warnings(),labels:r.dumpLabels(),segments:r.collectSegmentInfo(),debugInfo:r.debugInfo}}var D;(function(t){t[t.Program=0]="Program",t[t.Line=1]="Line",t[t.Label=2]="Label",t[t.LabelRef=3]="LabelRef",t[t.Instruction=4]="Instruction",t[t.Literal=5]="Literal",t[t.Register=6]="Register",t[t.SetPC=7]="SetPC",t[t.Expr=8]="Expr",t[t.Data=9]="Data"})(D||(D={}));var pe;(function(t){t[t.Label=0]="Label"})(pe||(pe={}));function Be(t,r){let e=null;return!t||r<t.offset||r>t.end?null:(t.accept(s=>s.offset===-1&&s.length===-1?!0:s.offset<=r&&s.end>=r?(e?s.length<=e.length&&(e=s):e=s,!0):!1),e)}function Sr(t,r){let e=Be(t,r),s=[];for(;e;)s.unshift(e),e=e.parent;return s}var j=class{get end(){return this.offset+this.length}constructor(r,e){this.nodeType=e,this.parent=null,this.offset=r?.loc.start.offset??0,this.length=(r?.loc.end.offset??0)-this.offset}get type(){return this.nodeType}getTextProvider(){let r=this;for(;r&&!r.textProvider;)r=r.parent;return r?r.textProvider:()=>"unknown"}getText(){return this.getTextProvider()(this.offset,this.length)}matches(r){return this.length===r.length&&this.getTextProvider()(this.offset,this.length)===r}accept(r){if(r(this)&&this.children)for(let e of this.children)e.accept(r)}acceptVisitor(r){this.accept(r.visitNode.bind(r))}adoptChild(r){r.parent=this;let e=this.children;return e||(e=this.children=[]),e.push(r),r}};var je=class extends j{constructor(r){super(r,D.Program),r?.lines?.forEach(e=>this.adoptChild(new Lt(e)))}},Lt=class extends j{constructor(r){if(super(r,D.Line),r.label&&this.adoptChild(new G(r.label)),r.stmt)switch(r.stmt.type){case"insn":this.adoptChild(new ve(r.stmt));break;case"setpc":this.adoptChild(new me(r.stmt));break;case"data":this.adoptChild(new we(r.stmt))}}},G=class extends j{constructor(r){super(r,D.Label),this.length--}},me=class extends j{constructor(r){super(r,D.SetPC),this.pcExpr=this.adoptChild(new St(r.pc))}},we=class extends j{constructor(r){super(r,D.Data)}},St=class extends j{constructor(r){super(r,D.Expr)}},ve=class extends j{constructor(r){super(r,D.Instruction);let e=s=>{switch(s.type){case"literal":return this.adoptChild(new xe(s));case"register":return this.adoptChild(new ye(s));case"qualified-ident":return this.adoptChild(new Z(s));default:return}};this.mnemonic=r.mnemonic.toLowerCase(),r.p1&&(this.p1=e(r.p1)),r.p2&&(this.p2=e(r.p2))}},Z=class extends j{constructor(r){super(r,D.LabelRef)}},xe=class extends j{constructor(r){super(r,D.Literal),this.value=r.lit}},ye=class extends j{constructor(r){super(r,D.Register),this.value=r.value.toUpperCase()}};var Ue=class{parseProgram(r){let e=r.version,s=r.getText(),n=At(r.getText()),c=new je(n),l=(h,v)=>{if(r.version!==e)throw new Error("Underlying model has changed, AST is no longer valid");return s.substr(h,v)};return c.textProvider=l,c}};var Er={version:1,mnemonics:[{name:"add",class:"ALU",summary:"Arithmetic Add",description:"Adds the contents of register B and C (B+C) placing the result in register A or D.",synopsis:"{0} = B + C",syntax:"[ a | d ]"},{name:"and",class:"ALU",summary:"Logic And",description:"Performs a bitwise AND operation on register B and C (B&C) placing the result in register A or D.",synopsis:"{0} = B & C",syntax:"[ a | d ]"},{name:"bcs",class:"GOTO",summary:"Branch if Carry Set",snippet:"bcs ${1:label}",description:"Jumps to the given address if the carry flag is set.",synopsis:"PC = {0} [if CY]",syntax:"<label>"},{name:"beq",class:"GOTO",summary:"Branch if Equal/Zero",snippet:"beq ${1:label}",description:"Jumps to the given address if the zero flag is set (equal).",synopsis:"PC = {0} [if Z]",syntax:"<label>"},{name:"ble",class:"GOTO",summary:"Branch if Less Than or Equal (Sign+Zero)",snippet:"ble ${1:label}",description:"Jumps to the given address if the sign or zero flag is set (less than or equal).",synopsis:"PC = {0} [if S or Z]",syntax:"<label>"},{name:"blt",class:"GOTO",summary:"Branch if Less Than (Sign)",snippet:"blt ${1:label}",description:"Jumps to the given address if the sign flag is set (less than).",synopsis:"PC = {0} [if S]",syntax:"<label>"},{name:"bmi",class:"GOTO",summary:"Branch if Minus/Sign",snippet:"bmi ${1:label}",description:"Jumps to the given address if the sign flag is set (negative).",synopsis:"PC = {0} [if S]",syntax:"<label>"},{name:"bne",class:"GOTO",summary:"Branch if Not Equal/Zero",snippet:"bne ${1:label}",description:"Jumps to the given address if the zero flag is not set (not equal).",synopsis:"PC = {0} [if not Z]",syntax:"<label>"},{name:"clr",class:"MOV8",summary:"Zero Value",description:"Clears the content (=0) of a given 8-bit register.",synopsis:"{0} = 0",syntax:"<target>{a,d|m1|m2|x|y}"},{name:"cmp",class:"ALU",summary:"Compare (Logic Xor)",description:"Compares the values in register B and C setting the zero flag if the same (affects register A or D) (equivalent to eor).",synopsis:"{0} = B != C",syntax:"[ a | d ]"},{name:"eor",class:"ALU",summary:"Logic Xor",description:"Performs a bitwise XOR operation on register B and C (B^C) placing the result in register A or D.",synopsis:"{0} = B ^ C",syntax:"[ a | d ]"},{name:"inc",class:"ALU",summary:"Increment",description:"Increments contents of register B placing the result in register A or D",synopsis:"{0} = B + 1",syntax:"[ a | d ]"},{name:"hlt",class:"MISC",summary:"Halt",description:"Halts execution of the program",synopsis:"PC = PC + 1",syntax:"<label>"},{name:"hlr",class:"MISC",summary:"Halt and Reload",description:"Halts execution of the program and sets the program counter from the address switches",synopsis:"PC = AS",syntax:"<label>"},{name:"jmp",class:"GOTO",summary:"Jump to Label",snippet:"jmp ${1:label}",description:"Unconditionally jumps to the given address.",synopsis:"PC = {0}",syntax:"<label>"},{name:"jsr",class:"GOTO",summary:"Call Subroutine (Jump and Link)",snippet:"jsr ${1:label}",description:"Calls the subroutine at the given address.",synopsis:"XY = PC, PC = {0}",syntax:"<label>"},{name:"ldi",class:"SETAB",summary:"Load Immediate",snippet:"ldi ${1:a},${2:0}",description:"Loads an 8-bit value in to register A/B or a 16-bit value in to register M/J.",synopsis:"{0} = {1}",syntax:"[ <target>{a|b} , <value>{-16,15} ] | [ <target>{m|j} , [ <value>{0x0000,0xFFFF} | <label> ] ]"},{name:"mov",class:"MOV8",summary:"Copy Register to Register",snippet:"mov ${1:b},${2:a}",description:"Copies the content of one 8-bit register to another.",synopsis:"{0} = {1}",syntax:"<destination>{a,d|m1|m2|x|y} , <source>{a,d|m1|m2|x|y}"},{name:"not",class:"ALU",summary:"Logic Not",description:"Performs a bitwise NOT operation on register B (~B) placing the result in register A or D.",synopsis:"{0} = ~B",syntax:"[ a | d ]"},{name:"opc",class:"PSEUDO",summary:"Literal Opcode",snippet:"opc ${1:opcode}",description:"Performs the given machine opcode directly.",syntax:"[ <opcode>{0x00,0xFF} | <opcode>{0b00000000,0b11111111} ]"},{name:"orr",class:"ALU",summary:"Logic Or",description:"Performs a bitwise OR operation on register B and C (B|C) placing the result in register A or D.",synopsis:"{0} = B | C",syntax:"[ a | d ]"},{name:"rol",class:"ALU",summary:"Bitwise Circular Shift Left",description:"Performs a bitwise left rotation on register B (<<B) placing the result in register A or D.",synopsis:"{0} = <<B",syntax:"[ a | d ]"},{name:"org",class:"PSEUDO",summary:"Set Program Counter",description:"Sets the program counter to the given address such that the following instructions start from that location.",synopsis:"PC = {0}",syntax:"<value>{0x0000,0xFFFF}"},{name:"dfb",class:"PSEUDO",summary:"Define Byte Data",description:"Writes the given 8-bit values directly into the output starting from current location.",syntax:"<value>{0x00,0xFF} [ ,...n ]"},{name:"dfw",class:"PSEUDO",summary:"Define Word Data",description:"Writes the given 16-bit values directly into the output starting from current location.",syntax:"<value>{0x0000,0xFFFF} [ ,...n ]"}]};function kr(t){return Object.keys(t).map(r=>t[r])}function ne(t){return typeof t<"u"}var We=class{constructor(r){this.dataProviders=r,this._mnemonicSet={},this._mnemonics=[],this.collectData()}collectData(){this.dataProviders.forEach(r=>{r.provideMnemonics().forEach(e=>{this._mnemonicSet[e.name]||(this._mnemonicSet[e.name]=e)})}),this._mnemonics=kr(this._mnemonicSet)}getMnemonic(r){return this._mnemonicSet[r]}getMnemonics(){return this._mnemonics}};var Ne=class{constructor(r){this._mnemonics=[],this.addData(r)}provideMnemonics(){return this._mnemonics}addData(r){r.mnemonics&&(this._mnemonics=this._mnemonics.concat(r.mnemonics))}};function ze(t,r){return r?{kind:"markdown",value:no(t)}:{kind:"plaintext",value:ro(t)}}function ro(t){if(!t.description||t.description==="")return"";if(typeof t.description!="string")return t.description.value;let r="";return r+=t.description,"syntax"in t&&(r+=`

Syntax: ${t.syntax}`),r}function no(t){if(!t.description||t.description==="")return"";let r="";return typeof t.description=="string"?r+=t.description:r=t.description.value,"syntax"in t&&(r+=`

Syntax: \`${t.syntax}\``),r}function Et(t,r,e){return e?{kind:"markdown",value:_r(io(t),r)}:{kind:"plaintext",value:_r(so(t),r)}}function _r(t,r){if(!r||r.length===0)return t;for(let e=0;e<r.length;e++)t=t.replace(`{${e}}`,r[e]);return t}function so(t){if(!t.synopsis||t.synopsis==="")return"";let r="";return t.summary&&(t.class?r+=`${t.summary} [${t.class}]

`:r+=`${t.summary}

`),r+=t.synopsis,r}function io(t){if(!t.synopsis||t.synopsis==="")return"";let r="";return t.summary&&(t.class?r+=`${t.summary} [${t.class}]

`:r+=`${t.summary}

`),r+="`"+t.synopsis+"`",r}var se=new We([new Ne(Er)]);var Dr;(function(t){function r(e){return typeof e=="string"}t.is=r})(Dr||(Dr={}));var kt;(function(t){function r(e){return typeof e=="string"}t.is=r})(kt||(kt={}));var Ir;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647;function r(e){return typeof e=="number"&&t.MIN_VALUE<=e&&e<=t.MAX_VALUE}t.is=r})(Ir||(Ir={}));var qe;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647;function r(e){return typeof e=="number"&&t.MIN_VALUE<=e&&e<=t.MAX_VALUE}t.is=r})(qe||(qe={}));var O;(function(t){function r(s,n){return s===Number.MAX_VALUE&&(s=qe.MAX_VALUE),n===Number.MAX_VALUE&&(n=qe.MAX_VALUE),{line:s,character:n}}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&d.uinteger(n.line)&&d.uinteger(n.character)}t.is=e})(O||(O={}));var E;(function(t){function r(s,n,c,l){if(d.uinteger(s)&&d.uinteger(n)&&d.uinteger(c)&&d.uinteger(l))return{start:O.create(s,n),end:O.create(c,l)};if(O.is(s)&&O.is(n))return{start:s,end:n};throw new Error("Range#create called with invalid arguments[".concat(s,", ").concat(n,", ").concat(c,", ").concat(l,"]"))}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&O.is(n.start)&&O.is(n.end)}t.is=e})(E||(E={}));var Q;(function(t){function r(s,n){return{uri:s,range:n}}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&E.is(n.range)&&(d.string(n.uri)||d.undefined(n.uri))}t.is=e})(Q||(Q={}));var Mr;(function(t){function r(s,n,c,l){return{targetUri:s,targetRange:n,targetSelectionRange:c,originSelectionRange:l}}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&E.is(n.targetRange)&&d.string(n.targetUri)&&E.is(n.targetSelectionRange)&&(E.is(n.originSelectionRange)||d.undefined(n.originSelectionRange))}t.is=e})(Mr||(Mr={}));var _t;(function(t){function r(s,n,c,l){return{red:s,green:n,blue:c,alpha:l}}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&d.numberRange(n.red,0,1)&&d.numberRange(n.green,0,1)&&d.numberRange(n.blue,0,1)&&d.numberRange(n.alpha,0,1)}t.is=e})(_t||(_t={}));var Or;(function(t){function r(s,n){return{range:s,color:n}}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&E.is(n.range)&&_t.is(n.color)}t.is=e})(Or||(Or={}));var Fr;(function(t){function r(s,n,c){return{label:s,textEdit:n,additionalTextEdits:c}}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&d.string(n.label)&&(d.undefined(n.textEdit)||U.is(n))&&(d.undefined(n.additionalTextEdits)||d.typedArray(n.additionalTextEdits,U.is))}t.is=e})(Fr||(Fr={}));var Rr;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(Rr||(Rr={}));var jr;(function(t){function r(s,n,c,l,h,v){var g={startLine:s,endLine:n};return d.defined(c)&&(g.startCharacter=c),d.defined(l)&&(g.endCharacter=l),d.defined(h)&&(g.kind=h),d.defined(v)&&(g.collapsedText=v),g}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&d.uinteger(n.startLine)&&d.uinteger(n.startLine)&&(d.undefined(n.startCharacter)||d.uinteger(n.startCharacter))&&(d.undefined(n.endCharacter)||d.uinteger(n.endCharacter))&&(d.undefined(n.kind)||d.string(n.kind))}t.is=e})(jr||(jr={}));var Pt;(function(t){function r(s,n){return{location:s,message:n}}t.create=r;function e(s){var n=s;return d.defined(n)&&Q.is(n.location)&&d.string(n.message)}t.is=e})(Pt||(Pt={}));var oe;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(oe||(oe={}));var Br;(function(t){t.Unnecessary=1,t.Deprecated=2})(Br||(Br={}));var Tr;(function(t){function r(e){var s=e;return d.objectLiteral(s)&&d.string(s.href)}t.is=r})(Tr||(Tr={}));var be;(function(t){function r(s,n,c,l,h,v){var g={range:s,message:n};return d.defined(c)&&(g.severity=c),d.defined(l)&&(g.code=l),d.defined(h)&&(g.source=h),d.defined(v)&&(g.relatedInformation=v),g}t.create=r;function e(s){var n,c=s;return d.defined(c)&&E.is(c.range)&&d.string(c.message)&&(d.number(c.severity)||d.undefined(c.severity))&&(d.integer(c.code)||d.string(c.code)||d.undefined(c.code))&&(d.undefined(c.codeDescription)||d.string((n=c.codeDescription)===null||n===void 0?void 0:n.href))&&(d.string(c.source)||d.undefined(c.source))&&(d.undefined(c.relatedInformation)||d.typedArray(c.relatedInformation,Pt.is))}t.is=e})(be||(be={}));var ae;(function(t){function r(s,n){for(var c=[],l=2;l<arguments.length;l++)c[l-2]=arguments[l];var h={title:s,command:n};return d.defined(c)&&c.length>0&&(h.arguments=c),h}t.create=r;function e(s){var n=s;return d.defined(n)&&d.string(n.title)&&d.string(n.command)}t.is=e})(ae||(ae={}));var U;(function(t){function r(c,l){return{range:c,newText:l}}t.replace=r;function e(c,l){return{range:{start:c,end:c},newText:l}}t.insert=e;function s(c){return{range:c,newText:""}}t.del=s;function n(c){var l=c;return d.objectLiteral(l)&&d.string(l.newText)&&E.is(l.range)}t.is=n})(U||(U={}));var ie;(function(t){function r(s,n,c){var l={label:s};return n!==void 0&&(l.needsConfirmation=n),c!==void 0&&(l.description=c),l}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&d.string(n.label)&&(d.boolean(n.needsConfirmation)||n.needsConfirmation===void 0)&&(d.string(n.description)||n.description===void 0)}t.is=e})(ie||(ie={}));var M;(function(t){function r(e){var s=e;return d.string(s)}t.is=r})(M||(M={}));var X;(function(t){function r(c,l,h){return{range:c,newText:l,annotationId:h}}t.replace=r;function e(c,l,h){return{range:{start:c,end:c},newText:l,annotationId:h}}t.insert=e;function s(c,l){return{range:c,newText:"",annotationId:l}}t.del=s;function n(c){var l=c;return U.is(l)&&(ie.is(l.annotationId)||M.is(l.annotationId))}t.is=n})(X||(X={}));var He;(function(t){function r(s,n){return{textDocument:s,edits:n}}t.create=r;function e(s){var n=s;return d.defined(n)&&Ge.is(n.textDocument)&&Array.isArray(n.edits)}t.is=e})(He||(He={}));var $e;(function(t){function r(s,n,c){var l={kind:"create",uri:s};return n!==void 0&&(n.overwrite!==void 0||n.ignoreIfExists!==void 0)&&(l.options=n),c!==void 0&&(l.annotationId=c),l}t.create=r;function e(s){var n=s;return n&&n.kind==="create"&&d.string(n.uri)&&(n.options===void 0||(n.options.overwrite===void 0||d.boolean(n.options.overwrite))&&(n.options.ignoreIfExists===void 0||d.boolean(n.options.ignoreIfExists)))&&(n.annotationId===void 0||M.is(n.annotationId))}t.is=e})($e||($e={}));var Ae;(function(t){function r(s,n,c,l){var h={kind:"rename",oldUri:s,newUri:n};return c!==void 0&&(c.overwrite!==void 0||c.ignoreIfExists!==void 0)&&(h.options=c),l!==void 0&&(h.annotationId=l),h}t.create=r;function e(s){var n=s;return n&&n.kind==="rename"&&d.string(n.oldUri)&&d.string(n.newUri)&&(n.options===void 0||(n.options.overwrite===void 0||d.boolean(n.options.overwrite))&&(n.options.ignoreIfExists===void 0||d.boolean(n.options.ignoreIfExists)))&&(n.annotationId===void 0||M.is(n.annotationId))}t.is=e})(Ae||(Ae={}));var Ce;(function(t){function r(s,n,c){var l={kind:"delete",uri:s};return n!==void 0&&(n.recursive!==void 0||n.ignoreIfNotExists!==void 0)&&(l.options=n),c!==void 0&&(l.annotationId=c),l}t.create=r;function e(s){var n=s;return n&&n.kind==="delete"&&d.string(n.uri)&&(n.options===void 0||(n.options.recursive===void 0||d.boolean(n.options.recursive))&&(n.options.ignoreIfNotExists===void 0||d.boolean(n.options.ignoreIfNotExists)))&&(n.annotationId===void 0||M.is(n.annotationId))}t.is=e})(Ce||(Ce={}));var Dt;(function(t){function r(e){var s=e;return s&&(s.changes!==void 0||s.documentChanges!==void 0)&&(s.documentChanges===void 0||s.documentChanges.every(function(n){return d.string(n.kind)?$e.is(n)||Ae.is(n)||Ce.is(n):He.is(n)}))}t.is=r})(Dt||(Dt={}));var Ve=function(){function t(r,e){this.edits=r,this.changeAnnotations=e}return t.prototype.insert=function(r,e,s){var n,c;if(s===void 0?n=U.insert(r,e):M.is(s)?(c=s,n=X.insert(r,e,s)):(this.assertChangeAnnotations(this.changeAnnotations),c=this.changeAnnotations.manage(s),n=X.insert(r,e,c)),this.edits.push(n),c!==void 0)return c},t.prototype.replace=function(r,e,s){var n,c;if(s===void 0?n=U.replace(r,e):M.is(s)?(c=s,n=X.replace(r,e,s)):(this.assertChangeAnnotations(this.changeAnnotations),c=this.changeAnnotations.manage(s),n=X.replace(r,e,c)),this.edits.push(n),c!==void 0)return c},t.prototype.delete=function(r,e){var s,n;if(e===void 0?s=U.del(r):M.is(e)?(n=e,s=X.del(r,e)):(this.assertChangeAnnotations(this.changeAnnotations),n=this.changeAnnotations.manage(e),s=X.del(r,n)),this.edits.push(s),n!==void 0)return n},t.prototype.add=function(r){this.edits.push(r)},t.prototype.all=function(){return this.edits},t.prototype.clear=function(){this.edits.splice(0,this.edits.length)},t.prototype.assertChangeAnnotations=function(r){if(r===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},t}(),Ur=function(){function t(r){this._annotations=r===void 0?Object.create(null):r,this._counter=0,this._size=0}return t.prototype.all=function(){return this._annotations},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),t.prototype.manage=function(r,e){var s;if(M.is(r)?s=r:(s=this.nextId(),e=r),this._annotations[s]!==void 0)throw new Error("Id ".concat(s," is already in use."));if(e===void 0)throw new Error("No annotation provided for id ".concat(s));return this._annotations[s]=e,this._size++,s},t.prototype.nextId=function(){return this._counter++,this._counter.toString()},t}(),Wo=function(){function t(r){var e=this;this._textEditChanges=Object.create(null),r!==void 0?(this._workspaceEdit=r,r.documentChanges?(this._changeAnnotations=new Ur(r.changeAnnotations),r.changeAnnotations=this._changeAnnotations.all(),r.documentChanges.forEach(function(s){if(He.is(s)){var n=new Ve(s.edits,e._changeAnnotations);e._textEditChanges[s.textDocument.uri]=n}})):r.changes&&Object.keys(r.changes).forEach(function(s){var n=new Ve(r.changes[s]);e._textEditChanges[s]=n})):this._workspaceEdit={}}return Object.defineProperty(t.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),t.prototype.getTextEditChange=function(r){if(Ge.is(r)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var e={uri:r.uri,version:r.version},s=this._textEditChanges[e.uri];if(!s){var n=[],c={textDocument:e,edits:n};this._workspaceEdit.documentChanges.push(c),s=new Ve(n,this._changeAnnotations),this._textEditChanges[e.uri]=s}return s}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var s=this._textEditChanges[r];if(!s){var n=[];this._workspaceEdit.changes[r]=n,s=new Ve(n),this._textEditChanges[r]=s}return s}},t.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new Ur,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},t.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},t.prototype.createFile=function(r,e,s){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var n;ie.is(e)||M.is(e)?n=e:s=e;var c,l;if(n===void 0?c=$e.create(r,s):(l=M.is(n)?n:this._changeAnnotations.manage(n),c=$e.create(r,s,l)),this._workspaceEdit.documentChanges.push(c),l!==void 0)return l},t.prototype.renameFile=function(r,e,s,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var c;ie.is(s)||M.is(s)?c=s:n=s;var l,h;if(c===void 0?l=Ae.create(r,e,n):(h=M.is(c)?c:this._changeAnnotations.manage(c),l=Ae.create(r,e,n,h)),this._workspaceEdit.documentChanges.push(l),h!==void 0)return h},t.prototype.deleteFile=function(r,e,s){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var n;ie.is(e)||M.is(e)?n=e:s=e;var c,l;if(n===void 0?c=Ce.create(r,s):(l=M.is(n)?n:this._changeAnnotations.manage(n),c=Ce.create(r,s,l)),this._workspaceEdit.documentChanges.push(c),l!==void 0)return l},t}();var Wr;(function(t){function r(s){return{uri:s}}t.create=r;function e(s){var n=s;return d.defined(n)&&d.string(n.uri)}t.is=e})(Wr||(Wr={}));var Nr;(function(t){function r(s,n){return{uri:s,version:n}}t.create=r;function e(s){var n=s;return d.defined(n)&&d.string(n.uri)&&d.integer(n.version)}t.is=e})(Nr||(Nr={}));var Ge;(function(t){function r(s,n){return{uri:s,version:n}}t.create=r;function e(s){var n=s;return d.defined(n)&&d.string(n.uri)&&(n.version===null||d.integer(n.version))}t.is=e})(Ge||(Ge={}));var zr;(function(t){function r(s,n,c,l){return{uri:s,languageId:n,version:c,text:l}}t.create=r;function e(s){var n=s;return d.defined(n)&&d.string(n.uri)&&d.string(n.languageId)&&d.integer(n.version)&&d.string(n.text)}t.is=e})(zr||(zr={}));var B;(function(t){t.PlainText="plaintext",t.Markdown="markdown";function r(e){var s=e;return s===t.PlainText||s===t.Markdown}t.is=r})(B||(B={}));var ce;(function(t){function r(e){var s=e;return d.objectLiteral(e)&&B.is(s.kind)&&d.string(s.value)}t.is=r})(ce||(ce={}));var Xe;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(Xe||(Xe={}));var Le;(function(t){t.PlainText=1,t.Snippet=2})(Le||(Le={}));var Vr;(function(t){t.Deprecated=1})(Vr||(Vr={}));var qr;(function(t){function r(s,n,c){return{newText:s,insert:n,replace:c}}t.create=r;function e(s){var n=s;return n&&d.string(n.newText)&&E.is(n.insert)&&E.is(n.replace)}t.is=e})(qr||(qr={}));var Hr;(function(t){t.asIs=1,t.adjustIndentation=2})(Hr||(Hr={}));var Gr;(function(t){function r(e){var s=e;return s&&(d.string(s.detail)||s.detail===void 0)&&(d.string(s.description)||s.description===void 0)}t.is=r})(Gr||(Gr={}));var Xr;(function(t){function r(e){return{label:e}}t.create=r})(Xr||(Xr={}));var It;(function(t){function r(e,s){return{items:e||[],isIncomplete:!!s}}t.create=r})(It||(It={}));var Se;(function(t){function r(s){return s.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}t.fromPlainText=r;function e(s){var n=s;return d.string(n)||d.objectLiteral(n)&&d.string(n.language)&&d.string(n.value)}t.is=e})(Se||(Se={}));var Mt;(function(t){function r(e){var s=e;return!!s&&d.objectLiteral(s)&&(ce.is(s.contents)||Se.is(s.contents)||d.typedArray(s.contents,Se.is))&&(e.range===void 0||E.is(e.range))}t.is=r})(Mt||(Mt={}));var Jr;(function(t){function r(e,s){return s?{label:e,documentation:s}:{label:e}}t.create=r})(Jr||(Jr={}));var Zr;(function(t){function r(e,s){for(var n=[],c=2;c<arguments.length;c++)n[c-2]=arguments[c];var l={label:e};return d.defined(s)&&(l.documentation=s),d.defined(n)?l.parameters=n:l.parameters=[],l}t.create=r})(Zr||(Zr={}));var le;(function(t){t.Text=1,t.Read=2,t.Write=3})(le||(le={}));var Ot;(function(t){function r(e,s){var n={range:e};return d.number(s)&&(n.kind=s),n}t.create=r})(Ot||(Ot={}));var ue;(function(t){t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(ue||(ue={}));var Qr;(function(t){t.Deprecated=1})(Qr||(Qr={}));var Ft;(function(t){function r(e,s,n,c,l){var h={name:e,kind:s,location:{uri:c,range:n}};return l&&(h.containerName=l),h}t.create=r})(Ft||(Ft={}));var Yr;(function(t){function r(e,s,n,c){return c!==void 0?{name:e,kind:s,location:{uri:n,range:c}}:{name:e,kind:s,location:{uri:n}}}t.create=r})(Yr||(Yr={}));var Kr;(function(t){function r(s,n,c,l,h,v){var g={name:s,detail:n,kind:c,range:l,selectionRange:h};return v!==void 0&&(g.children=v),g}t.create=r;function e(s){var n=s;return n&&d.string(n.name)&&d.number(n.kind)&&E.is(n.range)&&E.is(n.selectionRange)&&(n.detail===void 0||d.string(n.detail))&&(n.deprecated===void 0||d.boolean(n.deprecated))&&(n.children===void 0||Array.isArray(n.children))&&(n.tags===void 0||Array.isArray(n.tags))}t.is=e})(Kr||(Kr={}));var en;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(en||(en={}));var Je;(function(t){t.Invoked=1,t.Automatic=2})(Je||(Je={}));var tn;(function(t){function r(s,n,c){var l={diagnostics:s};return n!=null&&(l.only=n),c!=null&&(l.triggerKind=c),l}t.create=r;function e(s){var n=s;return d.defined(n)&&d.typedArray(n.diagnostics,be.is)&&(n.only===void 0||d.typedArray(n.only,d.string))&&(n.triggerKind===void 0||n.triggerKind===Je.Invoked||n.triggerKind===Je.Automatic)}t.is=e})(tn||(tn={}));var rn;(function(t){function r(s,n,c){var l={title:s},h=!0;return typeof n=="string"?(h=!1,l.kind=n):ae.is(n)?l.command=n:l.edit=n,h&&c!==void 0&&(l.kind=c),l}t.create=r;function e(s){var n=s;return n&&d.string(n.title)&&(n.diagnostics===void 0||d.typedArray(n.diagnostics,be.is))&&(n.kind===void 0||d.string(n.kind))&&(n.edit!==void 0||n.command!==void 0)&&(n.command===void 0||ae.is(n.command))&&(n.isPreferred===void 0||d.boolean(n.isPreferred))&&(n.edit===void 0||Dt.is(n.edit))}t.is=e})(rn||(rn={}));var nn;(function(t){function r(s,n){var c={range:s};return d.defined(n)&&(c.data=n),c}t.create=r;function e(s){var n=s;return d.defined(n)&&E.is(n.range)&&(d.undefined(n.command)||ae.is(n.command))}t.is=e})(nn||(nn={}));var sn;(function(t){function r(s,n){return{tabSize:s,insertSpaces:n}}t.create=r;function e(s){var n=s;return d.defined(n)&&d.uinteger(n.tabSize)&&d.boolean(n.insertSpaces)}t.is=e})(sn||(sn={}));var on;(function(t){function r(s,n,c){return{range:s,target:n,data:c}}t.create=r;function e(s){var n=s;return d.defined(n)&&E.is(n.range)&&(d.undefined(n.target)||d.string(n.target))}t.is=e})(on||(on={}));var an;(function(t){function r(s,n){return{range:s,parent:n}}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&E.is(n.range)&&(n.parent===void 0||t.is(n.parent))}t.is=e})(an||(an={}));var cn;(function(t){t.namespace="namespace",t.type="type",t.class="class",t.enum="enum",t.interface="interface",t.struct="struct",t.typeParameter="typeParameter",t.parameter="parameter",t.variable="variable",t.property="property",t.enumMember="enumMember",t.event="event",t.function="function",t.method="method",t.macro="macro",t.keyword="keyword",t.modifier="modifier",t.comment="comment",t.string="string",t.number="number",t.regexp="regexp",t.operator="operator",t.decorator="decorator"})(cn||(cn={}));var ln;(function(t){t.declaration="declaration",t.definition="definition",t.readonly="readonly",t.static="static",t.deprecated="deprecated",t.abstract="abstract",t.async="async",t.modification="modification",t.documentation="documentation",t.defaultLibrary="defaultLibrary"})(ln||(ln={}));var un;(function(t){function r(e){var s=e;return d.objectLiteral(s)&&(s.resultId===void 0||typeof s.resultId=="string")&&Array.isArray(s.data)&&(s.data.length===0||typeof s.data[0]=="number")}t.is=r})(un||(un={}));var fn;(function(t){function r(s,n){return{range:s,text:n}}t.create=r;function e(s){var n=s;return n!=null&&E.is(n.range)&&d.string(n.text)}t.is=e})(fn||(fn={}));var dn;(function(t){function r(s,n,c){return{range:s,variableName:n,caseSensitiveLookup:c}}t.create=r;function e(s){var n=s;return n!=null&&E.is(n.range)&&d.boolean(n.caseSensitiveLookup)&&(d.string(n.variableName)||n.variableName===void 0)}t.is=e})(dn||(dn={}));var hn;(function(t){function r(s,n){return{range:s,expression:n}}t.create=r;function e(s){var n=s;return n!=null&&E.is(n.range)&&(d.string(n.expression)||n.expression===void 0)}t.is=e})(hn||(hn={}));var gn;(function(t){function r(s,n){return{frameId:s,stoppedLocation:n}}t.create=r;function e(s){var n=s;return d.defined(n)&&E.is(s.stoppedLocation)}t.is=e})(gn||(gn={}));var Rt;(function(t){t.Type=1,t.Parameter=2;function r(e){return e===1||e===2}t.is=r})(Rt||(Rt={}));var jt;(function(t){function r(s){return{value:s}}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&(n.tooltip===void 0||d.string(n.tooltip)||ce.is(n.tooltip))&&(n.location===void 0||Q.is(n.location))&&(n.command===void 0||ae.is(n.command))}t.is=e})(jt||(jt={}));var pn;(function(t){function r(s,n,c){var l={position:s,label:n};return c!==void 0&&(l.kind=c),l}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&O.is(n.position)&&(d.string(n.label)||d.typedArray(n.label,jt.is))&&(n.kind===void 0||Rt.is(n.kind))&&n.textEdits===void 0||d.typedArray(n.textEdits,U.is)&&(n.tooltip===void 0||d.string(n.tooltip)||ce.is(n.tooltip))&&(n.paddingLeft===void 0||d.boolean(n.paddingLeft))&&(n.paddingRight===void 0||d.boolean(n.paddingRight))}t.is=e})(pn||(pn={}));var mn;(function(t){function r(e){var s=e;return d.objectLiteral(s)&&kt.is(s.uri)&&d.string(s.name)}t.is=r})(mn||(mn={}));var wn;(function(t){function r(c,l,h,v){return new oo(c,l,h,v)}t.create=r;function e(c){var l=c;return!!(d.defined(l)&&d.string(l.uri)&&(d.undefined(l.languageId)||d.string(l.languageId))&&d.uinteger(l.lineCount)&&d.func(l.getText)&&d.func(l.positionAt)&&d.func(l.offsetAt))}t.is=e;function s(c,l){for(var h=c.getText(),v=n(l,function(q,K){var _e=q.range.start.line-K.range.start.line;return _e===0?q.range.start.character-K.range.start.character:_e}),g=h.length,m=v.length-1;m>=0;m--){var y=v[m],L=c.offsetAt(y.range.start),$=c.offsetAt(y.range.end);if($<=g)h=h.substring(0,L)+y.newText+h.substring($,h.length);else throw new Error("Overlapping edit");g=L}return h}t.applyEdits=s;function n(c,l){if(c.length<=1)return c;var h=c.length/2|0,v=c.slice(0,h),g=c.slice(h);n(v,l),n(g,l);for(var m=0,y=0,L=0;m<v.length&&y<g.length;){var $=l(v[m],g[y]);$<=0?c[L++]=v[m++]:c[L++]=g[y++]}for(;m<v.length;)c[L++]=v[m++];for(;y<g.length;)c[L++]=g[y++];return c}})(wn||(wn={}));var oo=function(){function t(r,e,s,n){this._uri=r,this._languageId=e,this._version=s,this._content=n,this._lineOffsets=void 0}return Object.defineProperty(t.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),t.prototype.getText=function(r){if(r){var e=this.offsetAt(r.start),s=this.offsetAt(r.end);return this._content.substring(e,s)}return this._content},t.prototype.update=function(r,e){this._content=r.text,this._version=e,this._lineOffsets=void 0},t.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var r=[],e=this._content,s=!0,n=0;n<e.length;n++){s&&(r.push(n),s=!1);var c=e.charAt(n);s=c==="\r"||c===`
`,c==="\r"&&n+1<e.length&&e.charAt(n+1)===`
`&&n++}s&&e.length>0&&r.push(e.length),this._lineOffsets=r}return this._lineOffsets},t.prototype.positionAt=function(r){r=Math.max(Math.min(r,this._content.length),0);var e=this.getLineOffsets(),s=0,n=e.length;if(n===0)return O.create(0,r);for(;s<n;){var c=Math.floor((s+n)/2);e[c]>r?n=c:s=c+1}var l=s-1;return O.create(l,r-e[l])},t.prototype.offsetAt=function(r){var e=this.getLineOffsets();if(r.line>=e.length)return this._content.length;if(r.line<0)return 0;var s=e[r.line],n=r.line+1<e.length?e[r.line+1]:this._content.length;return Math.max(Math.min(s+r.character,n),s)},Object.defineProperty(t.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),t}(),d;(function(t){var r=Object.prototype.toString;function e($){return typeof $<"u"}t.defined=e;function s($){return typeof $>"u"}t.undefined=s;function n($){return $===!0||$===!1}t.boolean=n;function c($){return r.call($)==="[object String]"}t.string=c;function l($){return r.call($)==="[object Number]"}t.number=l;function h($,q,K){return r.call($)==="[object Number]"&&q<=$&&$<=K}t.numberRange=h;function v($){return r.call($)==="[object Number]"&&-2147483648<=$&&$<=2147483647}t.integer=v;function g($){return r.call($)==="[object Number]"&&0<=$&&$<=2147483647}t.uinteger=g;function m($){return r.call($)==="[object Function]"}t.func=m;function y($){return $!==null&&typeof $=="object"}t.objectLiteral=y;function L($,q){return Array.isArray($)&&$.every(q)}t.typedArray=L})(d||(d={}));var Y=class{constructor(r,e,s,n){this._uri=r,this._languageId=e,this._version=s,this._content=n,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(r){if(r){let e=this.offsetAt(r.start),s=this.offsetAt(r.end);return this._content.substring(e,s)}return this._content}update(r,e){for(let s of r)if(Y.isIncremental(s)){let n=xn(s.range),c=this.offsetAt(n.start),l=this.offsetAt(n.end);this._content=this._content.substring(0,c)+s.text+this._content.substring(l,this._content.length);let h=Math.max(n.start.line,0),v=Math.max(n.end.line,0),g=this._lineOffsets,m=vn(s.text,!1,c);if(v-h===m.length)for(let L=0,$=m.length;L<$;L++)g[L+h+1]=m[L];else m.length<1e4?g.splice(h+1,v-h,...m):this._lineOffsets=g=g.slice(0,h+1).concat(m,g.slice(v+1));let y=s.text.length-(l-c);if(y!==0)for(let L=h+1+m.length,$=g.length;L<$;L++)g[L]=g[L]+y}else if(Y.isFull(s))this._content=s.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=e}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=vn(this._content,!0)),this._lineOffsets}positionAt(r){r=Math.max(Math.min(r,this._content.length),0);let e=this.getLineOffsets(),s=0,n=e.length;if(n===0)return{line:0,character:r};for(;s<n;){let l=Math.floor((s+n)/2);e[l]>r?n=l:s=l+1}let c=s-1;return{line:c,character:r-e[c]}}offsetAt(r){let e=this.getLineOffsets();if(r.line>=e.length)return this._content.length;if(r.line<0)return 0;let s=e[r.line],n=r.line+1<e.length?e[r.line+1]:this._content.length;return Math.max(Math.min(s+r.character,n),s)}get lineCount(){return this.getLineOffsets().length}static isIncremental(r){let e=r;return e!=null&&typeof e.text=="string"&&e.range!==void 0&&(e.rangeLength===void 0||typeof e.rangeLength=="number")}static isFull(r){let e=r;return e!=null&&typeof e.text=="string"&&e.range===void 0&&e.rangeLength===void 0}},Ee;(function(t){function r(n,c,l,h){return new Y(n,c,l,h)}t.create=r;function e(n,c,l){if(n instanceof Y)return n.update(c,l),n;throw new Error("TextDocument.update: document must be created by TextDocument.create")}t.update=e;function s(n,c){let l=n.getText(),h=Bt(c.map(ao),(m,y)=>{let L=m.range.start.line-y.range.start.line;return L===0?m.range.start.character-y.range.start.character:L}),v=0,g=[];for(let m of h){let y=n.offsetAt(m.range.start);if(y<v)throw new Error("Overlapping edit");y>v&&g.push(l.substring(v,y)),m.newText.length&&g.push(m.newText),v=n.offsetAt(m.range.end)}return g.push(l.substr(v)),g.join("")}t.applyEdits=s})(Ee||(Ee={}));function Bt(t,r){if(t.length<=1)return t;let e=t.length/2|0,s=t.slice(0,e),n=t.slice(e);Bt(s,r),Bt(n,r);let c=0,l=0,h=0;for(;c<s.length&&l<n.length;)r(s[c],n[l])<=0?t[h++]=s[c++]:t[h++]=n[l++];for(;c<s.length;)t[h++]=s[c++];for(;l<n.length;)t[h++]=n[l++];return t}function vn(t,r,e=0){let s=r?[e]:[];for(let n=0;n<t.length;n++){let c=t.charCodeAt(n);(c===13||c===10)&&(c===13&&n+1<t.length&&t.charCodeAt(n+1)===10&&n++,s.push(e+n+1))}return s}function xn(t){let r=t.start,e=t.end;return r.line>e.line||r.line===e.line&&r.character>e.character?{start:e,end:r}:t}function ao(t){let r=xn(t.range);return r!==t.range?{newText:t.newText,range:r}:t}var yn;(function(t){t.LATEST={textDocument:{completion:{completionItem:{documentationFormat:[B.Markdown,B.PlainText]}},hover:{contentFormat:[B.Markdown,B.PlainText]}}}})(yn||(yn={}));var Ze=class{constructor(r){this.clientCapabilities=r}doComplete(r,e,s){this.offset=r.offsetAt(e),this.position=e,this.currentWord=co(r,this.offset),this.defaultReplaceRange=E.create(O.create(this.position.line,this.position.character-this.currentWord.length),this.position),this.textDocument=r,this.program=s;try{let c={isIncomplete:!1,items:[]};var n=r.getText(E.create(O.create(this.position.line,0),this.position));return n.match(/^([a-z]+:)?([ \t]+)?([a-z]{0,3})$/i)&&this.getCompletionsForMnemonic(c),c}finally{this.position=null,this.currentWord=null,this.textDocument=null,this.program=null,this.defaultReplaceRange=null}}getCompletionsForMnemonic(r){return se.getMnemonics().forEach(s=>{let n,c;n=this.getCompletionRange(null),c=s.snippet??s.name;let l={label:s.name,detail:s.class?`${s.summary} [${s.class}]`:s.summary,documentation:ze(s,this.doesSupportMarkdown()),textEdit:U.replace(n,c),insertTextFormat:Le.Snippet,kind:Xe.Function};r.items.push(l)}),r}doesSupportMarkdown(){if(!ne(this.supportsMarkdown)){if(!ne(this.clientCapabilities))return this.supportsMarkdown=!0,this.supportsMarkdown;let r=this.clientCapabilities&&this.clientCapabilities.textDocument&&this.clientCapabilities.textDocument.hover;this.supportsMarkdown=r&&r.contentFormat&&Array.isArray(r.contentFormat)&&r.contentFormat.indexOf(B.Markdown)!==-1}return this.supportsMarkdown}getCompletionRange(r){if(r&&r.offset<=this.offset&&this.offset<=r.end){let e=r.end!==-1?this.textDocument.positionAt(r.end):this.position,s=this.textDocument.positionAt(r.offset);if(s.line===e.line)return E.create(s,e)}return this.defaultReplaceRange}};function co(t,r){let e=r-1,s=t.getText();for(;e>=0&&` 	
\r:,`.indexOf(s.charAt(e))===-1;)e--;return s.substring(e+1,r)}var Qe=class{constructor(r){this.clientCapabilities=r}doHover(r,e,s){function n(v){return E.create(r.positionAt(v.offset),r.positionAt(v.end))}let c=r.offsetAt(e),l=Sr(s,c),h=null;for(let v=0;v<l.length;v++){let g=l[v];if(g instanceof ve){let m=g.mnemonic,y=se.getMnemonic(m);if(y){let L=this.getParamNames(y,g);h={contents:Et(y,L,this.doesSupportMarkdown()),range:n(g)}}}if(g instanceof me){let m=se.getMnemonic("org");if(m){let y=[g.pcExpr.getText()];h={contents:Et(m,y,this.doesSupportMarkdown()),range:n(g)}}}if(g instanceof we){let m=g.getText().slice(0,3).toLowerCase(),y=se.getMnemonic(m);y&&(h={contents:ze(y,this.doesSupportMarkdown()),range:n(g)})}}return h&&(h.contents=this.convertContents(h.contents)),h}getParamNames(r,e){let s=[];return e.p1?s.push(this.getParamName(e.p1,e.mnemonic)):r.class==="ALU"?s.push("A"):s.push("?"),e.p2?s.push(this.getParamName(e.p2,e.mnemonic)):s.push("?"),s}getParamName(r,e){return r instanceof ye?r.value:r instanceof Z?`(${r.getText()})`:r instanceof xe?e.toLowerCase()==="ldi"&&r.value>15?`0x${r.value.toString(16).toUpperCase()}`:r.value.toString():"?"}convertContents(r){return this.doesSupportMarkdown()||typeof r=="string"?r:"kind"in r?{kind:"plaintext",value:r.value}:Array.isArray(r)?r.map(e=>typeof e=="string"?e:e.value):r.value}doesSupportMarkdown(){if(!ne(this.supportsMarkdown)){if(!ne(this.clientCapabilities))return this.supportsMarkdown=!0,this.supportsMarkdown;let r=this.clientCapabilities.textDocument&&this.clientCapabilities.textDocument.hover;this.supportsMarkdown=r&&r.contentFormat&&Array.isArray(r.contentFormat)&&r.contentFormat.indexOf(B.Markdown)!==-1}return this.supportsMarkdown}};var Tt=class{constructor(r,e){this.symbols=[]}addSymbol(r){this.symbols.push(r)}getSymbol(r,e){for(let s=0;s<this.symbols.length;s++){let n=this.symbols[s];if(n.name===r&&n.type===e)return n}return null}},Ut=class extends Tt{constructor(){super(0,Number.MAX_VALUE)}},Wt=class{constructor(r,e,s,n){this.name=r,this.value=e,this.node=s,this.type=n}},Nt=class{constructor(r){this.scope=r}addSymbol(r,e,s,n){r.offset!==-1&&this.scope.addSymbol(new Wt(e,s,r,n))}visitNode(r){switch(r.type){case D.Label:return this.addSymbol(r,r.getText(),void 0,pe.Label),!0}return!0}},ke=class{constructor(r){this.global=new Ut,r.acceptVisitor(new Nt(this.global))}internalFindSymbol(r,e){let s=r.getText(),n=this.global;for(let c=0;c<e.length;c++){let l=e[c],h=n.getSymbol(s,l);if(h)return h}return null}evaluateReferenceTypes(r){return r instanceof Z||r instanceof G?[pe.Label]:null}findSymbolFromNode(r){if(!r)return null;let e=this.evaluateReferenceTypes(r);return e?this.internalFindSymbol(r,e):null}matchesSymbol(r,e){if(!r||!r.matches(e.name))return!1;let s=this.evaluateReferenceTypes(r);return!s||s.indexOf(e.type)===-1?!1:this.internalFindSymbol(r,s)===e}};var Ke=class{findDefinition(r,e,s){let n=new ke(s),c=r.offsetAt(e),l=Be(s,c);if(!l)return null;let h=n.findSymbolFromNode(l);return h?{uri:r.uri,range:Ye(h.node,r)}:null}findReferences(r,e,s){return this.findDocumentHighlights(r,e,s).map(c=>({uri:r.uri,range:c.range}))}findDocumentHighlights(r,e,s){let n=[],c=r.offsetAt(e),l=Be(s,c);if(!l||l.type!==D.Label&&l.type!==D.LabelRef)return n;let h=new ke(s),v=h.findSymbolFromNode(l),g=l.getText();return s.accept(m=>{if(v){if(h.matchesSymbol(m,v))return n.push({kind:bn(m),range:Ye(m,r)}),!1}else l&&l.type===m.type&&m.matches(g)&&n.push({kind:bn(m),range:Ye(m,r)});return!0}),n}findDocumentSymbols(r,e){let s=[];return e.accept(n=>{let c={name:null,kind:ue.Class,location:null},l=n;return n instanceof G&&(c.name=n.getText(),c.kind=ue.Variable),c.name&&(c.location=Q.create(r.uri,Ye(l,r)),s.push(c)),!0}),s}};function bn(t){return t instanceof G?le.Write:le.Read}function Ye(t,r){return E.create(r.positionAt(t.offset),r.positionAt(t.end))}var et=class{constructor(){}configure(r){this.settings=r}doValidation(r,e=this.settings){if(e&&e.validate===!1)return[];let{errors:s,warnings:n}=Ct(r.getText()),c=(h,v)=>({severity:v,range:{start:r.positionAt(h.loc.start.offset),end:r.positionAt(h.loc.end.offset)},message:h.msg,source:r.languageId}),l=[];return l.push(...s.map(h=>c(h,oe.Error))),l.push(...n.map(h=>c(h,oe.Warning))),l}};function $n(t){let r=new Ue,e=new Qe(t&&t.clientCapabilities),s=new Ze(t&&t.clientCapabilities),n=new Ke,c=new et;return{doValidation:c.doValidation.bind(c),parseProgram:r.parseProgram.bind(r),doComplete:s.doComplete.bind(s),doHover:e.doHover.bind(e),findDefinition:n.findDefinition.bind(n),findReferences:n.findReferences.bind(n),findDocumentHighlights:n.findDocumentHighlights.bind(n),findDocumentSymbols:n.findDocumentSymbols.bind(n)}}var tt=class{_ctx;_languageService;_languageId;constructor(r,e){this._ctx=r,this._languageId=e.languageId,this._languageService=$n({})}async doValidation(r){let e=this._getTextDocument(r);if(e){let s=this._languageService.doValidation(e);return Promise.resolve(s)}return Promise.resolve([])}async doComplete(r,e){let s=this._getTextDocument(r);if(!s)return null;let n=this._languageService.parseProgram(s),c=this._languageService.doComplete(s,e,n);return Promise.resolve(c)}async doHover(r,e){let s=this._getTextDocument(r);if(!s)return null;let n=this._languageService.parseProgram(s),c=this._languageService.doHover(s,e,n);return Promise.resolve(c)}async findDefinition(r,e){let s=this._getTextDocument(r);if(!s)return null;let n=this._languageService.parseProgram(s),c=this._languageService.findDefinition(s,e,n);return Promise.resolve(c)}async findReferences(r,e){let s=this._getTextDocument(r);if(!s)return[];let n=this._languageService.parseProgram(s),c=this._languageService.findReferences(s,e,n);return Promise.resolve(c)}async findDocumentHighlights(r,e){let s=this._getTextDocument(r);if(!s)return[];let n=this._languageService.parseProgram(s),c=this._languageService.findDocumentHighlights(s,e,n);return Promise.resolve(c)}async findDocumentSymbols(r){let e=this._getTextDocument(r);if(!e)return[];let s=this._languageService.parseProgram(e),n=this._languageService.findDocumentSymbols(e,s);return Promise.resolve(n)}_getTextDocument(r){let e=this._ctx.getMirrorModels();for(let s of e)if(s.uri.toString()===r)return Ee.create(r,this._languageId,s.version,s.getValue());return null}};function uo(t,r){return new tt(t,r)}return pr(fo);})();
return moduleExports;
});
