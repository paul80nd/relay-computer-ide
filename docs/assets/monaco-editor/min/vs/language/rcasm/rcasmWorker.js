"use strict";/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.34.2(c4113c3111ab66e33392ed677319fc1db11cc70b)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/
define("vs/language/rcasm/rcasmWorker", ["require","require"],(require)=>{
var moduleExports=(()=>{var pt=Object.defineProperty;var Ui=Object.getOwnPropertyDescriptor;var Ti=Object.getOwnPropertyNames;var zi=Object.prototype.hasOwnProperty;var Ni=(t,r)=>()=>(t&&(r=t(t=0)),r);var gr=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports),mr=(t,r)=>{for(var e in r)pt(t,e,{get:r[e],enumerable:!0})},qi=(t,r,e,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of Ti(r))!zi.call(t,n)&&n!==e&&pt(t,n,{get:()=>r[n],enumerable:!(s=Ui(r,n))||s.enumerable});return t};var wr=t=>qi(pt({},"__esModule",{value:!0}),t);var mt={};mr(mt,{DataSize:()=>he,mkAsmLine:()=>Ki,mkData:()=>no,mkInsn:()=>ro,mkLabel:()=>eo,mkLiteral:()=>so,mkProgram:()=>Yi,mkRegister:()=>io,mkScopeQualifiedIdent:()=>oo,mkSetPC:()=>to});function Yi(t,r){return{lines:t,loc:r}}function Ki(t,r,e){return{label:t,stmt:r,loc:e}}function eo(t,r){return{name:t,loc:r}}function to(t,r){return{type:"setpc",pc:t,loc:r}}function ro(t,r,e,s){return{type:"insn",mnemonic:t,p1:r,p2:e,loc:s}}function no(t,r,e){return{type:"data",values:r,dataSize:t,loc:e}}function so(t,r,e){return{type:"literal",lit:t,ot:r,loc:e}}function io(t,r){return{type:"register",value:t,loc:r}}function oo(t,r,e){return{type:"qualified-ident",path:t,absolute:r,loc:e}}var he,wt=Ni(()=>{(function(t){t[t.Byte=0]="Byte",t[t.Word=1]="Word"})(he||(he={}))});var Ar=gr((Io,$r)=>{"use strict";function A(t){if(this.words=[],t)if(Symbol&&Symbol.iterator&&t[Symbol.iterator]!==void 0){let r=t[Symbol.iterator](),e=r.next();for(;!e.done;)this.add(e.value),e=r.next()}else for(let r=0;r<t.length;r++)this.add(t[r])}A.prototype.fromWords=function(t){let r=Object.create(A.prototype);return r.words=t,r};A.prototype.add=function(t){this.resize(t),this.words[t>>>5]|=1<<t};A.prototype.flip=function(t){this.resize(t),this.words[t>>>5]^=1<<t};A.prototype.clear=function(){this.words.length=0};A.prototype.remove=function(t){this.resize(t),this.words[t>>>5]&=~(1<<t)};A.prototype.isEmpty=function(t){let r=this.words.length;for(let e=0;e<r;e++)if(this.words[e]!==0)return!1;return!0};A.prototype.has=function(t){return(this.words[t>>>5]&1<<t)!==0};A.prototype.checkedAdd=function(t){this.resize(t);let r=this.words[t>>>5],e=r|1<<t;return this.words[t>>>5]=e,(e^r)>>>t};A.prototype.trim=function(t){let r=this.words.length;for(;r>0&&this.words[r-1]===0;)r--;this.words=this.words.slice(0,r)};A.prototype.resize=function(t){let r=t+32>>>5;for(let e=this.words.length;e<r;e++)this.words[e]=0};A.prototype.hammingWeight=function(t){return t-=t>>>1&1431655765,t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24};A.prototype.hammingWeight4=function(t,r,e,s){return t-=t>>>1&1431655765,r-=r>>>1&1431655765,e-=e>>>1&1431655765,s-=s>>>1&1431655765,t=(t&858993459)+(t>>>2&858993459),r=(r&858993459)+(r>>>2&858993459),e=(e&858993459)+(e>>>2&858993459),s=(s&858993459)+(s>>>2&858993459),t=t+(t>>>4)&252645135,r=r+(r>>>4)&252645135,e=e+(e>>>4)&252645135,s=s+(s>>>4)&252645135,(t+r+e+s)*16843009>>>24};A.prototype.size=function(){let t=0,r=this.words.length,e=this.words;for(let s=0;s<r;s++)t+=this.hammingWeight(e[s]);return t};A.prototype.array=function(){let t=new Array(this.size()),r=0,e=this.words.length;for(let s=0;s<e;++s){let n=this.words[s];for(;n!=0;){let o=n&-n;t[r++]=(s<<5)+this.hammingWeight(o-1|0),n^=o}}return t};A.prototype.forEach=function(t){let r=this.words.length;for(let e=0;e<r;++e){let s=this.words[e];for(;s!=0;){let n=s&-s;t((e<<5)+this.hammingWeight(n-1|0)),s^=n}}};A.prototype[Symbol.iterator]=function*(){let t=this.words.length;for(let r=0;r<t;++r){let e=this.words[r];for(;e!=0;){let s=e&-e;yield(r<<5)+this.hammingWeight(s-1|0),e^=s}}};A.prototype.clone=function(){let t=Object.create(A.prototype);return t.words=this.words.slice(),t};A.prototype.intersects=function(t){let r=Math.min(this.words.length,t.words.length);for(let e=0;e<r;++e)if((this.words[e]&t.words[e])!==0)return!0;return!1};A.prototype.intersection=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]&=t.words[e],this.words[e+1]&=t.words[e+1],this.words[e+2]&=t.words[e+2],this.words[e+3]&=t.words[e+3],this.words[e+4]&=t.words[e+4],this.words[e+5]&=t.words[e+5],this.words[e+6]&=t.words[e+6],this.words[e+7]&=t.words[e+7];for(;e<r;++e)this.words[e]&=t.words[e];let s=this.words.length;for(e=r;e<s;++e)this.words[e]=0;return this};A.prototype.intersection_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(let s=0;s<r;++s)e+=this.hammingWeight(this.words[s]&t.words[s]);return e};A.prototype.new_intersection=function(t){let r=Object.create(A.prototype),e=Math.min(this.words.length,t.words.length);r.words=new Array(e);let s=0;for(;s+7<e;s+=8)r.words[s]=this.words[s]&t.words[s],r.words[s+1]=this.words[s+1]&t.words[s+1],r.words[s+2]=this.words[s+2]&t.words[s+2],r.words[s+3]=this.words[s+3]&t.words[s+3],r.words[s+4]=this.words[s+4]&t.words[s+4],r.words[s+5]=this.words[s+5]&t.words[s+5],r.words[s+6]=this.words[s+6]&t.words[s+6],r.words[s+7]=this.words[s+7]&t.words[s+7];for(;s<e;++s)r.words[s]=this.words[s]&t.words[s];return r};A.prototype.equals=function(t){let r=Math.min(this.words.length,t.words.length);for(let e=0;e<r;++e)if(this.words[e]!=t.words[e])return!1;if(this.words.length<t.words.length){let e=t.words.length;for(let s=this.words.length;s<e;++s)if(t.words[s]!=0)return!1}else if(t.words.length<this.words.length){let e=this.words.length;for(let s=t.words.length;s<e;++s)if(this.words[s]!=0)return!1}return!0};A.prototype.difference=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]&=~t.words[e],this.words[e+1]&=~t.words[e+1],this.words[e+2]&=~t.words[e+2],this.words[e+3]&=~t.words[e+3],this.words[e+4]&=~t.words[e+4],this.words[e+5]&=~t.words[e+5],this.words[e+6]&=~t.words[e+6],this.words[e+7]&=~t.words[e+7];for(;e<r;++e)this.words[e]&=~t.words[e];return this};A.prototype.difference2=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)t.words[e]=this.words[e]&~t.words[e],t.words[e+1]=this.words[e+1]&~t.words[e+1],t.words[e+2]=this.words[e+2]&~t.words[e+2],t.words[e+3]=this.words[e+3]&~t.words[e+3],t.words[e+4]=this.words[e+4]&~t.words[e+4],t.words[e+5]=this.words[e+5]&~t.words[e+5],t.words[e+6]=this.words[e+6]&~t.words[e+6],t.words[e+7]=this.words[e+7]&~t.words[e+7];for(;e<r;++e)t.words[e]=this.words[e]&~t.words[e];for(e=this.words.length-1;e>=r;--e)t.words[e]=this.words[e];return t.words=t.words.slice(0,this.words.length),t};A.prototype.new_difference=function(t){return this.clone().difference(t)};A.prototype.difference_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0,s=0;for(;s<r;++s)e+=this.hammingWeight(this.words[s]&~t.words[s]);let n=this.words.length;for(;s<n;++s)e+=this.hammingWeight(this.words[s]);return e};A.prototype.change=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]^=t.words[e],this.words[e+1]^=t.words[e+1],this.words[e+2]^=t.words[e+2],this.words[e+3]^=t.words[e+3],this.words[e+4]^=t.words[e+4],this.words[e+5]^=t.words[e+5],this.words[e+6]^=t.words[e+6],this.words[e+7]^=t.words[e+7];for(;e<r;++e)this.words[e]^=t.words[e];for(e=t.words.length-1;e>=r;--e)this.words[e]=t.words[e];return this};A.prototype.new_change=function(t){let r=Object.create(A.prototype),e=Math.max(this.words.length,t.words.length);r.words=new Array(e);let s=Math.min(this.words.length,t.words.length),n=0;for(;n+7<s;n+=8)r.words[n]=this.words[n]^t.words[n],r.words[n+1]=this.words[n+1]^t.words[n+1],r.words[n+2]=this.words[n+2]^t.words[n+2],r.words[n+3]=this.words[n+3]^t.words[n+3],r.words[n+4]=this.words[n+4]^t.words[n+4],r.words[n+5]=this.words[n+5]^t.words[n+5],r.words[n+6]=this.words[n+6]^t.words[n+6],r.words[n+7]=this.words[n+7]^t.words[n+7];for(;n<s;++n)r.words[n]=this.words[n]^t.words[n];let o=this.words.length;for(n=s;n<o;++n)r.words[n]=this.words[n];let l=t.words.length;for(n=s;n<l;++n)r.words[n]=t.words[n];return r};A.prototype.change_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0,s=0;for(;s<r;++s)e+=this.hammingWeight(this.words[s]^t.words[s]);let n=this.words.length>t.words.length?this:t,o=n.words.length;for(;s<o;++s)e+=this.hammingWeight(n.words[s]);return e};A.prototype.toString=function(){return"{"+this.array().join(",")+"}"};A.prototype.union=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]|=t.words[e],this.words[e+1]|=t.words[e+1],this.words[e+2]|=t.words[e+2],this.words[e+3]|=t.words[e+3],this.words[e+4]|=t.words[e+4],this.words[e+5]|=t.words[e+5],this.words[e+6]|=t.words[e+6],this.words[e+7]|=t.words[e+7];for(;e<r;++e)this.words[e]|=t.words[e];if(this.words.length<t.words.length){this.resize((t.words.length<<5)-1);let s=t.words.length;for(let n=r;n<s;++n)this.words[n]=t.words[n]}return this};A.prototype.new_union=function(t){let r=Object.create(A.prototype),e=Math.max(this.words.length,t.words.length);r.words=new Array(e);let s=Math.min(this.words.length,t.words.length),n=0;for(;n+7<s;n+=8)r.words[n]=this.words[n]|t.words[n],r.words[n+1]=this.words[n+1]|t.words[n+1],r.words[n+2]=this.words[n+2]|t.words[n+2],r.words[n+3]=this.words[n+3]|t.words[n+3],r.words[n+4]=this.words[n+4]|t.words[n+4],r.words[n+5]=this.words[n+5]|t.words[n+5],r.words[n+6]=this.words[n+6]|t.words[n+6],r.words[n+7]=this.words[n+7]|t.words[n+7];for(;n<s;++n)r.words[n]=this.words[n]|t.words[n];let o=this.words.length;for(n=s;n<o;++n)r.words[n]=this.words[n];let l=t.words.length;for(n=s;n<l;++n)r.words[n]=t.words[n];return r};A.prototype.union_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(let s=0;s<r;++s)e+=this.hammingWeight(this.words[s]|t.words[s]);if(this.words.length<t.words.length){let s=t.words.length;for(let n=this.words.length;n<s;++n)e+=this.hammingWeight(t.words[n]|0)}else{let s=this.words.length;for(let n=t.words.length;n<s;++n)e+=this.hammingWeight(this.words[n]|0)}return e};$r.exports=A});var Lr=gr((Mo,Cr)=>{"use strict";function co(t,r){function e(){this.constructor=t}e.prototype=r.prototype,t.prototype=new e}function J(t,r,e,s){this.message=t,this.expected=r,this.found=e,this.location=s,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,J)}co(J,Error);J.buildMessage=function(t,r){var e={literal:function(p){return'"'+n(p.text)+'"'},class:function(p){var m="",y;for(y=0;y<p.parts.length;y++)m+=p.parts[y]instanceof Array?o(p.parts[y][0])+"-"+o(p.parts[y][1]):o(p.parts[y]);return"["+(p.inverted?"^":"")+m+"]"},any:function(p){return"any character"},end:function(p){return"end of input"},other:function(p){return p.description}};function s(p){return p.charCodeAt(0).toString(16).toUpperCase()}function n(p){return p.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+s(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+s(m)})}function o(p){return p.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+s(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+s(m)})}function l(p){return e[p.type](p)}function h(p){var m=new Array(p.length),y,L;for(y=0;y<p.length;y++)m[y]=l(p[y]);if(m.sort(),m.length>0){for(y=1,L=1;y<m.length;y++)m[y-1]!==m[y]&&(m[L]=m[y],L++);m.length=L}switch(m.length){case 1:return m[0];case 2:return m[0]+" or "+m[1];default:return m.slice(0,-1).join(", ")+", or "+m[m.length-1]}}function v(p){return p?'"'+n(p)+'"':"end of input"}return"Expected "+h(t)+" but "+v(r)+" found."};function lo(t,r){r=r!==void 0?r:{};var e={},s={Lines:tr},n=tr,o=function(i,c){return P.mkProgram(Re(i,c,1),_())},l=function(i){return i},h=function(i,c){return P.mkAsmLine(i,c,_())},v=function(i){return P.mkAsmLine(i,null,_())},p=function(i){return P.mkAsmLine(null,i,_())},m=function(i){return P.mkAsmLine(null,i,_())},y=function(){return P.mkAsmLine(null,null,_())},L=function(i){return i},$=function(i){return i},V=W("directive"),K=function(i,c){let u=i=="byte"?P.DataSize.Byte:P.DataSize.Word;return P.mkData(u,c,_())},_e=function(i,c){return Re(i,c,3)},Ln=function(i,c,u){return P.mkInsn(i,c,u,_())},Sn=function(i,c){return P.mkInsn(i,c,null,_())},En=function(i){return P.mkInsn(i,null,null,_())},kn=/^[a-zA-Z_]/,Pn=q([["a","z"],["A","Z"],"_"],!1,!1),_n=/^[a-zA-Z_0-9]/,In=q([["a","z"],["A","Z"],"_",["0","9"]],!1,!1),Nt=/^[0-9a-f]/i,qt=q([["0","9"],["a","f"]],!1,!0),Vt=/^[0-1]/,Ht=q([["0","1"]],!1,!1),Dn=/^[+\-]/,Mn=q(["+","-"],!1,!1),Gt=/^[0-9]/,Xt=q([["0","9"]],!1,!1),Ie=/^[a-z]/i,De=q([["a","z"]],!1,!0),Jt=/^[0-9a-z_]/i,Zt=q([["0","9"],["a","z"],"_"],!1,!0),On="a",Fn=E("a",!0),Rn="b",jn=E("b",!0),Bn="c",Wn=E("c",!0),Un="d",Tn=E("d",!0),zn="g",Nn=E("g",!0),qn="h",Vn=E("h",!0),Hn="j",Gn=E("j",!0),Xn="m",Jn=E("m",!0),Zn="o",Qn=E("o",!0),Yn="p",Kn=E("p",!0),es="r",ts=E("r",!0),rs="s",ns=E("s",!0),ss="x",is=E("x",!0),os="y",as=E("y",!0),cs="0",ls=E("0",!1),us="1",fs=E("1",!1),ds="2",hs=E("2",!1),ps=",",gs=E(",",!1),ms=":",ws=E(":",!1),vs=";",xs=E(";",!1),ys="dfb",bs=E("dfb",!0),$s=function(){return"byte"},As="dfw",Cs=E("dfw",!0),Ls=function(){return"word"},Ss=function(i){return parseInt(i,2)},Es=function(i){return parseInt(i,16)},ks=function(i){return parseInt(i)},nt='"',st=E('"',!1),Ps=function(i){return i.join("")},it=ui(),_s=function(i){return i},Qt=function(){return ci()},Yt=W("whitespace"),Is="	",Ds=E("	",!1),Ms="\v",Os=E("\v",!1),Fs="\f",Rs=E("\f",!1),js=" ",Bs=E(" ",!1),Ws="\xA0",Us=E("\xA0",!1),Ts="\uFEFF",zs=E("\uFEFF",!1),Ns=W("end of line"),qs=/^[\n\r]/,Vs=q([`
`,"\r"],!1,!1),Hs=W("comment"),Gs=W("label"),Xs=function(i){return P.mkLabel(i,_())},Js=W("ORG"),Zs=function(i){return P.mkSetPC(i,_())},Qs=W("mnemonic"),Ys=W("literal"),Ks=function(i){return P.mkLiteral(i,"b",_())},ei=function(i){return P.mkLiteral(i,"h",_())},ti=function(i){return P.mkLiteral(i,"d",_())},ri=function(i){return P.mkLiteral(i,"s",_())},ni=W("identifier"),T="::",fe=E("::",!1),si=function(i,c){return P.mkScopeQualifiedIdent(Re(i,c,1),!1,_())},ii=function(i,c){return P.mkScopeQualifiedIdent(Re(i,c,1),!0,_())},oi=W("register"),ai=function(i){return P.mkRegister(i.toLowerCase(),_())},a=0,C=0,Me=[{line:1,column:1}],z=0,ot=[],w=0,Oe;if("startRule"in r){if(!(r.startRule in s))throw new Error(`Can't start parsing from rule "`+r.startRule+'".');n=s[r.startRule]}function ci(){return t.substring(C,a)}function li(){return de(C,a)}function Co(i,c){throw c=c!==void 0?c:de(C,a),er([W(i)],t.substring(C,a),c)}function Lo(i,c){throw c=c!==void 0?c:de(C,a),di(i,c)}function E(i,c){return{type:"literal",text:i,ignoreCase:c}}function q(i,c,u){return{type:"class",parts:i,inverted:c,ignoreCase:u}}function ui(){return{type:"any"}}function fi(){return{type:"end"}}function W(i){return{type:"other",description:i}}function Kt(i){var c=Me[i],u;if(c)return c;for(u=i-1;!Me[u];)u--;for(c=Me[u],c={line:c.line,column:c.column};u<i;)t.charCodeAt(u)===10?(c.line++,c.column=1):c.column++,u++;return Me[i]=c,c}function de(i,c){var u=Kt(i),f=Kt(c);return{start:{offset:i,line:u.line,column:u.column},end:{offset:c,line:f.line,column:f.column}}}function x(i){a<z||(a>z&&(z=a,ot=[]),ot.push(i))}function di(i,c){return new J(i,null,null,c)}function er(i,c,u){return new J(J.buildMessage(i,c),i,c,u)}function tr(){var i,c,u,f,g,b;if(i=a,c=at(),c!==e){for(u=[],f=a,g=Fe(),g!==e?(b=at(),b!==e?(g=[g,b],f=g):(a=f,f=e)):(a=f,f=e);f!==e;)u.push(f),f=a,g=Fe(),g!==e?(b=at(),b!==e?(g=[g,b],f=g):(a=f,f=e)):(a=f,f=e);u!==e?(C=i,c=o(c,u),i=c):(a=i,i=e)}else a=i,i=e;return i}function at(){var i,c,u,f,g;return i=a,c=F(),c!==e?(u=hi(),u!==e?(f=F(),f!==e?(g=Fi(),g===e&&(g=null),g!==e?(C=i,c=l(u),i=c):(a=i,i=e)):(a=i,i=e)):(a=i,i=e)):(a=i,i=e),i}function hi(){var i,c,u,f;return i=a,c=hr(),c!==e?(u=F(),u!==e?(f=rr(),f!==e?(C=i,c=h(c,f),i=c):(a=i,i=e)):(a=i,i=e)):(a=i,i=e),i===e&&(i=a,c=hr(),c!==e&&(C=i,c=v(c)),i=c,i===e&&(i=a,c=Ri(),c!==e&&(C=i,c=p(c)),i=c,i===e&&(i=a,c=rr(),c!==e&&(C=i,c=m(c)),i=c,i===e&&(i=a,c=F(),c!==e&&(C=i,c=y()),i=c)))),i}function rr(){var i,c;return i=a,c=pi(),c!==e&&(C=i,c=L(c)),i=c,i===e&&(i=a,c=mi(),c!==e&&(C=i,c=$(c)),i=c),i}function pi(){var i,c,u,f;return w++,i=a,c=Pi(),c===e&&(c=_i()),c!==e?(u=F(),u!==e?(f=gi(),f!==e?(C=i,c=K(c,f),i=c):(a=i,i=e)):(a=i,i=e)):(a=i,i=e),w--,i===e&&(c=e,w===0&&x(V)),i}function gi(){var i,c,u,f,g,b,D,N;if(i=a,c=ee(),c!==e){for(u=[],f=a,g=F(),g!==e?(b=dt(),b!==e?(D=F(),D!==e?(N=ee(),N!==e?(g=[g,b,D,N],f=g):(a=f,f=e)):(a=f,f=e)):(a=f,f=e)):(a=f,f=e);f!==e;)u.push(f),f=a,g=F(),g!==e?(b=dt(),b!==e?(D=F(),D!==e?(N=ee(),N!==e?(g=[g,b,D,N],f=g):(a=f,f=e)):(a=f,f=e)):(a=f,f=e)):(a=f,f=e);u!==e?(C=i,c=_e(c,u),i=c):(a=i,i=e)}else a=i,i=e;return i}function mi(){var i,c,u,f,g,b,D,N;return i=a,c=ht(),c!==e?(u=F(),u!==e?(f=ee(),f!==e?(g=F(),g!==e?(b=dt(),b!==e?(D=F(),D!==e?(N=ee(),N!==e?(C=i,c=Ln(c,f,N),i=c):(a=i,i=e)):(a=i,i=e)):(a=i,i=e)):(a=i,i=e)):(a=i,i=e)):(a=i,i=e)):(a=i,i=e),i===e&&(i=a,c=ht(),c!==e?(u=F(),u!==e?(f=ee(),f!==e?(C=i,c=Sn(c,f),i=c):(a=i,i=e)):(a=i,i=e)):(a=i,i=e),i===e&&(i=a,c=ht(),c!==e&&(C=i,c=En(c)),i=c)),i}function ee(){var i;return i=pr(),i===e&&(i=Bi(),i===e&&(i=ji())),i}function ct(){var i;return kn.test(t.charAt(a))?(i=t.charAt(a),a++):(i=e,w===0&&x(Pn)),i}function nr(){var i;return _n.test(t.charAt(a))?(i=t.charAt(a),a++):(i=e,w===0&&x(In)),i}function wi(){var i,c;if(i=[],Nt.test(t.charAt(a))?(c=t.charAt(a),a++):(c=e,w===0&&x(qt)),c!==e)for(;c!==e;)i.push(c),Nt.test(t.charAt(a))?(c=t.charAt(a),a++):(c=e,w===0&&x(qt));else i=e;return i}function vi(){var i,c;if(i=[],Vt.test(t.charAt(a))?(c=t.charAt(a),a++):(c=e,w===0&&x(Ht)),c!==e)for(;c!==e;)i.push(c),Vt.test(t.charAt(a))?(c=t.charAt(a),a++):(c=e,w===0&&x(Ht));else i=e;return i}function xi(){var i,c,u,f;if(i=a,Dn.test(t.charAt(a))?(c=t.charAt(a),a++):(c=e,w===0&&x(Mn)),c===e&&(c=null),c!==e){if(u=[],Gt.test(t.charAt(a))?(f=t.charAt(a),a++):(f=e,w===0&&x(Xt)),f!==e)for(;f!==e;)u.push(f),Gt.test(t.charAt(a))?(f=t.charAt(a),a++):(f=e,w===0&&x(Xt));else u=e;u!==e?(c=[c,u],i=c):(a=i,i=e)}else a=i,i=e;return i}function yi(){var i,c,u,f;if(i=a,c=[],Ie.test(t.charAt(a))?(u=t.charAt(a),a++):(u=e,w===0&&x(De)),u!==e)for(;u!==e;)c.push(u),Ie.test(t.charAt(a))?(u=t.charAt(a),a++):(u=e,w===0&&x(De));else c=e;if(c!==e){for(u=[],Jt.test(t.charAt(a))?(f=t.charAt(a),a++):(f=e,w===0&&x(Zt));f!==e;)u.push(f),Jt.test(t.charAt(a))?(f=t.charAt(a),a++):(f=e,w===0&&x(Zt));u!==e?(c=[c,u],i=c):(a=i,i=e)}else a=i,i=e;return i}function sr(){var i;return t.substr(a,1).toLowerCase()===On?(i=t.charAt(a),a++):(i=e,w===0&&x(Fn)),i}function ir(){var i;return t.substr(a,1).toLowerCase()===Rn?(i=t.charAt(a),a++):(i=e,w===0&&x(jn)),i}function or(){var i;return t.substr(a,1).toLowerCase()===Bn?(i=t.charAt(a),a++):(i=e,w===0&&x(Wn)),i}function ar(){var i;return t.substr(a,1).toLowerCase()===Un?(i=t.charAt(a),a++):(i=e,w===0&&x(Tn)),i}function bi(){var i;return t.substr(a,1).toLowerCase()===zn?(i=t.charAt(a),a++):(i=e,w===0&&x(Nn)),i}function So(){var i;return t.substr(a,1).toLowerCase()===qn?(i=t.charAt(a),a++):(i=e,w===0&&x(Vn)),i}function lt(){var i;return t.substr(a,1).toLowerCase()===Hn?(i=t.charAt(a),a++):(i=e,w===0&&x(Gn)),i}function ut(){var i;return t.substr(a,1).toLowerCase()===Xn?(i=t.charAt(a),a++):(i=e,w===0&&x(Jn)),i}function $i(){var i;return t.substr(a,1).toLowerCase()===Zn?(i=t.charAt(a),a++):(i=e,w===0&&x(Qn)),i}function Ai(){var i;return t.substr(a,1).toLowerCase()===Yn?(i=t.charAt(a),a++):(i=e,w===0&&x(Kn)),i}function Ci(){var i;return t.substr(a,1).toLowerCase()===es?(i=t.charAt(a),a++):(i=e,w===0&&x(ts)),i}function Li(){var i;return t.substr(a,1).toLowerCase()===rs?(i=t.charAt(a),a++):(i=e,w===0&&x(ns)),i}function ft(){var i;return t.substr(a,1).toLowerCase()===ss?(i=t.charAt(a),a++):(i=e,w===0&&x(is)),i}function cr(){var i;return t.substr(a,1).toLowerCase()===os?(i=t.charAt(a),a++):(i=e,w===0&&x(as)),i}function Si(){var i;return t.charCodeAt(a)===48?(i=cs,a++):(i=e,w===0&&x(ls)),i}function lr(){var i;return t.charCodeAt(a)===49?(i=us,a++):(i=e,w===0&&x(fs)),i}function ur(){var i;return t.charCodeAt(a)===50?(i=ds,a++):(i=e,w===0&&x(hs)),i}function dt(){var i;return t.charCodeAt(a)===44?(i=ps,a++):(i=e,w===0&&x(gs)),i}function Ei(){var i;return t.charCodeAt(a)===58?(i=ms,a++):(i=e,w===0&&x(ws)),i}function ki(){var i;return t.charCodeAt(a)===59?(i=vs,a++):(i=e,w===0&&x(xs)),i}function Pi(){var i,c;return i=a,t.substr(a,3).toLowerCase()===ys?(c=t.substr(a,3),a+=3):(c=e,w===0&&x(bs)),c!==e&&(C=i,c=$s()),i=c,i}function _i(){var i,c;return i=a,t.substr(a,3).toLowerCase()===As?(c=t.substr(a,3),a+=3):(c=e,w===0&&x(Cs)),c!==e&&(C=i,c=Ls()),i=c,i}function Ii(){var i,c,u;return i=a,c=a,u=vi(),u!==e?c=t.substring(c,a):c=u,c!==e?(u=ir(),u!==e?(C=i,c=Ss(c),i=c):(a=i,i=e)):(a=i,i=e),i}function Di(){var i,c,u,f,g;return i=a,c=Si(),c!==e?(u=ft(),u!==e?(f=a,g=wi(),g!==e?f=t.substring(f,a):f=g,f!==e?(C=i,c=Es(f),i=c):(a=i,i=e)):(a=i,i=e)):(a=i,i=e),i}function Mi(){var i,c,u;return i=a,c=a,u=xi(),u!==e?c=t.substring(c,a):c=u,c!==e?(u=ar(),u===e&&(u=null),u!==e?(C=i,c=ks(c),i=c):(a=i,i=e)):(a=i,i=e),i}function Oi(){var i,c,u,f;if(i=a,t.charCodeAt(a)===34?(c=nt,a++):(c=e,w===0&&x(st)),c!==e){for(u=[],f=fr();f!==e;)u.push(f),f=fr();u!==e?(t.charCodeAt(a)===34?(f=nt,a++):(f=e,w===0&&x(st)),f!==e?(C=i,c=Ps(u),i=c):(a=i,i=e)):(a=i,i=e)}else a=i,i=e;return i}function fr(){var i,c,u;return i=a,c=a,w++,t.charCodeAt(a)===34?(u=nt,a++):(u=e,w===0&&x(st)),w--,u===e?c=void 0:(a=c,c=e),c!==e?(t.length>a?(u=t.charAt(a),a++):(u=e,w===0&&x(it)),u!==e?(C=i,c=_s(u),i=c):(a=i,i=e)):(a=i,i=e),i}function te(){var i,c,u,f,g;if(i=a,c=a,u=[],f=ct(),f!==e)for(;f!==e;)u.push(f),f=ct();else u=e;if(u!==e){for(f=[],g=nr();g!==e;)f.push(g),g=nr();f!==e?(u=[u,f],c=u):(a=c,c=e)}else a=c,c=e;return c!==e&&(C=i,c=Qt()),i=c,i}function F(){var i,c;for(w++,i=[],c=dr();c!==e;)i.push(c),c=dr();return w--,i===e&&(c=e,w===0&&x(Yt)),i}function dr(){var i,c;return w++,t.charCodeAt(a)===9?(i=Is,a++):(i=e,w===0&&x(Ds)),i===e&&(t.charCodeAt(a)===11?(i=Ms,a++):(i=e,w===0&&x(Os)),i===e&&(t.charCodeAt(a)===12?(i=Fs,a++):(i=e,w===0&&x(Rs)),i===e&&(t.charCodeAt(a)===32?(i=js,a++):(i=e,w===0&&x(Bs)),i===e&&(t.charCodeAt(a)===160?(i=Ws,a++):(i=e,w===0&&x(Us)),i===e&&(t.charCodeAt(a)===65279?(i=Ts,a++):(i=e,w===0&&x(zs))))))),w--,i===e&&(c=e,w===0&&x(Yt)),i}function Fe(){var i,c;return w++,qs.test(t.charAt(a))?(i=t.charAt(a),a++):(i=e,w===0&&x(Vs)),w--,i===e&&(c=e,w===0&&x(Ns)),i}function Fi(){var i,c,u,f,g,b;if(w++,i=a,c=ki(),c!==e){for(u=[],f=a,g=a,w++,b=Fe(),w--,b===e?g=void 0:(a=g,g=e),g!==e?(t.length>a?(b=t.charAt(a),a++):(b=e,w===0&&x(it)),b!==e?(g=[g,b],f=g):(a=f,f=e)):(a=f,f=e);f!==e;)u.push(f),f=a,g=a,w++,b=Fe(),w--,b===e?g=void 0:(a=g,g=e),g!==e?(t.length>a?(b=t.charAt(a),a++):(b=e,w===0&&x(it)),b!==e?(g=[g,b],f=g):(a=f,f=e)):(a=f,f=e);u!==e?(c=[c,u],i=c):(a=i,i=e)}else a=i,i=e;return w--,i===e&&(c=e,w===0&&x(Hs)),i}function hr(){var i,c,u;return w++,i=a,c=a,u=yi(),u!==e?c=t.substring(c,a):c=u,c!==e?(u=Ei(),u!==e?(C=i,c=Xs(c),i=c):(a=i,i=e)):(a=i,i=e),w--,i===e&&(c=e,w===0&&x(Gs)),i}function Ri(){var i,c,u,f,g,b;return w++,i=a,c=$i(),c!==e?(u=Ci(),u!==e?(f=bi(),f!==e?(g=F(),g!==e?(b=pr(),b!==e?(C=i,c=Zs(b),i=c):(a=i,i=e)):(a=i,i=e)):(a=i,i=e)):(a=i,i=e)):(a=i,i=e),w--,i===e&&(c=e,w===0&&x(Js)),i}function ht(){var i,c,u;if(w++,i=a,c=[],Ie.test(t.charAt(a))?(u=t.charAt(a),a++):(u=e,w===0&&x(De)),u!==e)for(;u!==e;)c.push(u),Ie.test(t.charAt(a))?(u=t.charAt(a),a++):(u=e,w===0&&x(De));else c=e;return c!==e&&(C=i,c=Qt()),i=c,w--,i===e&&(c=e,w===0&&x(Qs)),i}function pr(){var i,c;return w++,i=a,c=Ii(),c!==e&&(C=i,c=Ks(c)),i=c,i===e&&(i=a,c=Di(),c!==e&&(C=i,c=ei(c)),i=c,i===e&&(i=a,c=Mi(),c!==e&&(C=i,c=ti(c)),i=c,i===e&&(i=a,c=Oi(),c!==e&&(C=i,c=ri(c)),i=c))),w--,i===e&&(c=e,w===0&&x(Ys)),i}function ji(){var i,c,u,f,g,b,D;if(w++,i=a,c=te(),c!==e){for(u=[],f=a,t.substr(a,2)===T?(g=T,a+=2):(g=e,w===0&&x(fe)),g!==e?(b=te(),b!==e?(g=[g,b],f=g):(a=f,f=e)):(a=f,f=e);f!==e;)u.push(f),f=a,t.substr(a,2)===T?(g=T,a+=2):(g=e,w===0&&x(fe)),g!==e?(b=te(),b!==e?(g=[g,b],f=g):(a=f,f=e)):(a=f,f=e);u!==e?(C=i,c=si(c,u),i=c):(a=i,i=e)}else a=i,i=e;if(i===e)if(i=a,t.substr(a,2)===T?(c=T,a+=2):(c=e,w===0&&x(fe)),c!==e)if(u=te(),u!==e){for(f=[],g=a,t.substr(a,2)===T?(b=T,a+=2):(b=e,w===0&&x(fe)),b!==e?(D=te(),D!==e?(b=[b,D],g=b):(a=g,g=e)):(a=g,g=e);g!==e;)f.push(g),g=a,t.substr(a,2)===T?(b=T,a+=2):(b=e,w===0&&x(fe)),b!==e?(D=te(),D!==e?(b=[b,D],g=b):(a=g,g=e)):(a=g,g=e);f!==e?(C=i,c=ii(u,f),i=c):(a=i,i=e)}else a=i,i=e;else a=i,i=e;return w--,i===e&&(c=e,w===0&&x(ni)),i}function Bi(){var i,c,u,f,g;return w++,i=a,c=a,u=a,f=sr(),f!==e?(g=Li(),g!==e?(f=[f,g],u=f):(a=u,u=e)):(a=u,u=e),u===e&&(u=sr(),u===e&&(u=ir(),u===e&&(u=or(),u===e&&(u=ar(),u===e&&(u=a,f=ut(),f!==e?(g=ur(),g!==e?(f=[f,g],u=f):(a=u,u=e)):(a=u,u=e),u===e&&(u=a,f=ut(),f!==e?(g=lr(),g!==e?(f=[f,g],u=f):(a=u,u=e)):(a=u,u=e),u===e&&(u=ut(),u===e&&(u=a,f=Ai(),f!==e?(g=or(),g!==e?(f=[f,g],u=f):(a=u,u=e)):(a=u,u=e),u===e&&(u=a,f=ft(),f!==e?(g=cr(),g!==e?(f=[f,g],u=f):(a=u,u=e)):(a=u,u=e),u===e&&(u=ft(),u===e&&(u=cr(),u===e&&(u=a,f=lt(),f!==e?(g=lr(),g!==e?(f=[f,g],u=f):(a=u,u=e)):(a=u,u=e),u===e&&(u=a,f=lt(),f!==e?(g=ur(),g!==e?(f=[f,g],u=f):(a=u,u=e)):(a=u,u=e),u===e&&(u=lt())))))))))))))),u!==e?c=t.substring(c,a):c=u,c!==e?(u=a,w++,f=ct(),w--,f===e?u=void 0:(a=u,u=e),u!==e?(C=i,c=ai(c),i=c):(a=i,i=e)):(a=i,i=e),w--,i===e&&(c=e,w===0&&x(oi)),i}var P=(wt(),wr(mt));function Wi(i,c){return i.map(function(u){return u[c]})}function Re(i,c,u){return[i].concat(Wi(c,u))}function _(){return{...li()}}if(Oe=n(),Oe!==e&&a===t.length)return Oe;throw Oe!==e&&a<t.length&&x(fi()),er(ot,z<t.length?t.charAt(z):null,z<t.length?de(z,z+1):de(z,z))}Cr.exports={SyntaxError:J,parse:lo}});var Ao={};mr(Ao,{RCASMWorker:()=>rt,create:()=>$o});var H={a:0,d:1},Vi={a:0,d:1},Hi={a:0,b:1},Gi={m:0,j:1},gt={a:0,b:1,c:2,d:3,m1:4,m2:5,x:6,y:7},Xi={xy:0,pc:1},Ji={m:0,xy:1,j:2,as:3},Zi={xy:1},S;(function(t){t[t.Direct=0]="Direct",t[t.Alu=1]="Alu",t[t.Clear=2]="Clear",t[t.Goto=3]="Goto",t[t.LodSw=4]="LodSw",t[t.LitOpc=5]="LitOpc",t[t.Move=6]="Move",t[t.Set=7]="Set"})(S||(S={}));var vr={add:{mt:S.Alu,ops:[{op:129,p1:{cs:H,op:t=>t<<3},p2:null}]},inc:{mt:S.Alu,ops:[{op:130,p1:{cs:H,op:t=>t<<3},p2:null}]},and:{mt:S.Alu,ops:[{op:131,p1:{cs:H,op:t=>t<<3},p2:null}]},orr:{mt:S.Alu,ops:[{op:132,p1:{cs:H,op:t=>t<<3},p2:null}]},eor:{mt:S.Alu,ops:[{op:133,p1:{cs:H,op:t=>t<<3},p2:null}]},cmp:{mt:S.Alu,ops:[{op:133,p1:{cs:H,op:t=>t<<3},p2:null}]},not:{mt:S.Alu,ops:[{op:134,p1:{cs:H,op:t=>t<<3},p2:null}]},rol:{mt:S.Alu,ops:[{op:135,p1:{cs:H,op:t=>t<<3},p2:null}]},mov:{mt:S.Move,ops:[{op:0,p1:{cs:gt,op:t=>t<<3},p2:{cs:gt,op:t=>t}},{op:160,p1:{cs:Xi,op:t=>t<<2},p2:{cs:Ji,op:t=>t}}]},clr:{mt:S.Clear,ops:[{op:0,p1:{cs:gt,op:t=>t<<3|t},p2:null},{op:160,p1:{cs:Zi,op:t=>t},p2:null}]},rts:{mt:S.Direct,ops:[{op:165,p1:null,p2:null}]},ldi:{mt:S.Set,ops:[{op:64,p1:{cs:Hi,op:t=>t<<5},p2:{cs:null,op:t=>t&31}},{op:192,p1:{cs:Gi,op:t=>t<<5},p2:null}]},hlt:{mt:S.Direct,ops:[{op:174,p1:null,p2:null}]},hlr:{mt:S.Direct,ops:[{op:175,p1:null,p2:null}]},lds:{mt:S.LodSw,ops:[{op:172,p1:{cs:Vi,op:t=>t},p2:null}]},jmp:{mt:S.Goto,ops:[{op:230,p1:null,p2:null}]},jsr:{mt:S.Goto,ops:[{op:231,p1:null,p2:null}]},bne:{mt:S.Goto,ops:[{op:226,p1:null,p2:null}]},beq:{mt:S.Goto,ops:[{op:228,p1:null,p2:null}]},bcs:{mt:S.Goto,ops:[{op:232,p1:null,p2:null}]},bmi:{mt:S.Goto,ops:[{op:240,p1:null,p2:null}]},blt:{mt:S.Goto,ops:[{op:240,p1:null,p2:null}]},ble:{mt:S.Goto,ops:[{op:244,p1:null,p2:null}]},opc:{mt:S.LitOpc,ops:[{op:0,p1:{cs:null,op:t=>t},p2:null}]}};function R(t){return t.toString(16).padStart(4,"0")}wt();var re=class{constructor(r,e,s,n){this.start=r,this.end=e,this.inferStart=s,this.id=n,this.blocks=[{start:r,binary:[]}],this.curBlock=this.blocks[0]}setCurrentPC(r){let e;if(this.inferStart&&this.blocks.length===1&&this.blocks[0].binary.length===0)this.start=r;else{let o=this.end!==void 0?`$${R(this.end)}`:"",l=`Segment address range: $${R(this.start)}-${o}`;r<this.start?e=`${l}.  Cannot set program counter to a lower address $${R(r)}.`:this.end!==void 0&&r>this.end?e=`${l}.  Trying to set program counter to $${R(r)} -- it is past segment end ${o}.`:this.blocks.length===1&&this.blocks[0].binary.length===0&&(this.start=r)}let s={start:r,binary:[]},n=this.blocks.push(s);return this.curBlock=this.blocks[n-1],e}empty(){return this.blocks.every(r=>r.binary.length===0)}currentPC(){return this.curBlock.start+this.curBlock.binary.length}emit(r){if(this.currentPC()<this.start||this.end!==void 0&&this.currentPC()>this.end){let e=this.end!==void 0?`$${R(this.end)}`:"",s=this.start!==void 0?`$${R(this.start)}`:"";return`Segment overflow at $${R(this.currentPC())}.  Segment address range: ${s}-${e}`}this.curBlock.binary.push(r)}formatRange(){let r=this.end!==void 0?`$${R(this.end)}`:"";return`${this.start!==void 0?`$${R(this.start)}`:""}-${r}`}overlaps(r){let e=this.start,s=r.start,n=this.end!==void 0?this.end:this.currentPC(),o=r.end!==void 0?r.end:r.currentPC();return e<s?s<=n:o>=e}};function xr(t){let r=[];for(let[e,s]of t){let n=s.blocks.filter(o=>o.binary.length!==0).sort((o,l)=>o.start-l.start);if(n.length!==0){let o=new re(s.start,s.end,s.inferStart,r.length-1);o.blocks=n,o.curBlock=n[n.length-1],r.push([e,o])}}return r}function yr(t){let r=xr(t);if(r.length===0)return{startPC:0,binary:Uint8Array.from([])};let[,e]=r[0],s=e.blocks[0],n=e.blocks[e.blocks.length-1],o=s.start,l=n.start+n.binary.length;for(let v=1;v<r.length;v++){let p=r[v][1],m=p.blocks[0].start,y=p.curBlock.start+p.curBlock.binary.length;o=Math.min(m,o),l=Math.max(y,l)}let h=new Uint8Array(l);for(let[,v]of r)for(let p of v.blocks)for(let m=0;m<p.binary.length;m++)h[p.start+m]=p.binary[m];return{startPC:o,binary:h.slice(o)}}function br(t){return xr(t).sort((e,s)=>e[1].start-s[1].start).map(([e,s])=>{let n=s.blocks.map(o=>({start:o.start,end:o.start+o.binary.length-1}));return{name:e,blocks:n}})}var ao=Ar(),pe=class{constructor(){this.lineStack=[],this.pcToLocs={},this.insnBitset=new ao}startLine(r,e,s){let n={lineNo:r.start.line,segmentId:s.id,numBytes:0};this.lineStack.push({loc:n,pc:e,segmentId:s.id})}endLine(r,e){let s=this.lineStack.pop();if(!s)throw new Error("internal compiler error, mismatching start/end lines in debugInfo");let n=r-s.pc;if(n>0&&e.id===s.segmentId){let o={...s.loc,numBytes:n};this.pcToLocs[s.pc]===void 0?this.pcToLocs[s.pc]=[o]:this.pcToLocs[s.pc].push(o)}}markAsInstruction(r,e){for(let s=r;s<e;s++)this.insnBitset.add(s)}info(){let r=this.insnBitset.clone(),e=s=>r.has(s);return{pcToLocs:this.pcToLocs,isInstruction:e}}};var Sr=Lr();function vt(t){return{value:t,errors:!0,completeFirstPass:!1}}function xt(t,r){return{value:t,errors:!1,completeFirstPass:r}}function ge(...t){return t.some(r=>r!==void 0&&r.errors)}var yt=class{constructor(r,e){this.syms=new Map,this.parent=null,this.children=new Map,this.parent=r,this.name=e}findSymbol(r){for(let e=this;e!==null;e=e.parent){let s=e.syms.get(r);if(s!==void 0)return s}}findSymbolPath(r){if(r.length===1)return this.findSymbol(r[0]);let e=this;for(;e.children.get(r[0])===void 0;)if(e=e.parent,e===null)return;for(let s=0;s<r.length-1;s++)if(e=e.children.get(r[s]),e===void 0)return;return e.syms.get(r[r.length-1])}addSymbol(r,e,s){this.syms.set(r,{...e,seen:s})}updateSymbol(r,e,s){for(let n=this;n!==null;n=n.parent)if(n.syms.get(r)!==void 0){n.syms.set(r,{...e,seen:s});return}}},bt=class{constructor(){this.passCount=0,this.root=new yt(null,""),this.curSymtab=this.root,this.anonScopeCount=0}startPass(r){this.curSymtab=this.root,this.anonScopeCount=0,this.passCount=r}findPath(r,e){return e?this.root.findSymbolPath(r):this.curSymtab.findSymbolPath(r)}findQualifiedSym(r,e){return this.findPath(r,e)}symbolSeen(r){let e=this.curSymtab.syms.get(r);return e!==void 0?e.seen===this.passCount:!1}declareLabelSymbol(r,e,s){let{name:n,loc:o}=r,l=this.curSymtab.syms.get(n);if(l===void 0){let v={type:"label",segment:s,data:xt({addr:e,loc:o},!1)};return this.curSymtab.addSymbol(n,v,this.passCount),!1}if(l.type!=="label")throw new Error("ICE: declareLabelSymbol should be called only on labels");if(l.data.value.addr!==e){let v={type:"label",segment:s,data:{...l.data,value:{...l.data.value,addr:e}}};return this.curSymtab.updateSymbol(n,v,this.passCount),!0}return this.curSymtab.updateSymbol(n,l,this.passCount),!1}dumpLabels(r,e){let s={};for(let[p,m]of e)s[m.id]=p;let n=[],o=(p,m)=>{if(p!==void 0){let y=[...p,m.name];n.push({path:y,sym:m})}else n.push({path:[],sym:m})};o(void 0,this.root);let l=[];for(;n.length>0;){let p=n.pop();if(p){for(let[m,y]of p.sym.syms)y.type==="label"&&l.push({path:[...p.path,m],addr:y.data.value.addr,size:0,segmentName:s[y.segment.id]});for(let[,m]of p.sym.children)o(p.path,m)}}let h=l.sort((p,m)=>p.addr-m.addr),v=h.length;if(v>0){for(let m=1;m<v;m++)h[m-1].size=h[m].addr-h[m-1].addr;let p=h[v-1];p.size=r-p.addr}return h.map(({path:p,addr:m,size:y,segmentName:L})=>({name:p.join("::"),addr:m,size:y,segmentName:L}))}};function je(t){let r=typeof t;return r==="object"&&t instanceof Array?"array":r}function uo(t){return`${t.absolute?"::":""}${t.path.join("::")}`}var $t=class{constructor(){this.curSegmentName="",this.curSegment=new re(0,0,!1,0),this.pass=0,this.needPass=!1,this.scopes=new bt,this.segments=[],this.errorList=[],this.warningList=[],this.debugInfo=new pe,this.errors=()=>this.formatErrors(this.errorList,"error"),this.warnings=()=>this.formatErrors(this.warningList,"warning")}prg(){let{startPC:r,binary:e}=yr(this.segments),s=r&255,n=r>>8&255;return Uint8Array.from([s,n,...e])}anyErrors(){return this.errorList.length!==0}formatErrors(r,e){return[...new Set(r.map(n=>JSON.stringify(n)))].map(n=>{let{loc:o,msg:l}=JSON.parse(n),h=`<unknown>:1:1: ${e}: ${l}`;return o&&(h=`${o.start.line}:${o.start.column}: ${e}: ${l}`),{loc:o,msg:l,formatted:h}})}addError(r,e){this.errorList.push({msg:r,loc:e})}addWarning(r,e){this.warningList.push({msg:r,loc:e})}startPass(r){this.pass=r,this.needPass=!1,this.errorList=[],this.scopes.startPass(r),this.debugInfo=new pe,this.segments=[];let e=this.newSegment("default",0,void 0,!0);this.setCurrentSegment({type:"segment",data:e},"default")}setCurrentSegment(r,e){this.curSegmentName=e,this.curSegment=r.data}newSegment(r,e,s,n){let o=new re(e,s,n,this.segments.length-1);return this.segments.push([r,o]),o}getPC(){return this.curSegment.currentPC()}evalExprType(r,e,s){let n=this.evalExpr(r),{errors:o,value:l,completeFirstPass:h}=n;return!o&&typeof l!==e?(this.addError(`Expecting ${s} to be '${e}' type, got '${je(l)}'`,r.loc),{errors:!0,completeFirstPass:h,value:l}):n}evalExprToInt(r,e){return this.evalExprType(r,"number",e)}evalExpr(r){switch(r.type){case"literal":return xt(r.lit,!0);case"register":return this.addError("Unexpected register",r.loc),vt(0);case"ident":throw new Error("should not see an ident here -- if you do, it is probably a wrong type node in parser");case"qualified-ident":{let e=this.scopes.findQualifiedSym(r.path,r.absolute);if(e===void 0)return this.pass>=1?(this.addError(`Undefined symbol '${uo(r)}'`,r.loc),vt(0)):(this.needPass=!0,xt(0,!1));switch(e.type){case"label":return{errors:e.data.errors,value:e.data.value.addr,completeFirstPass:e.seen===this.pass}}break}default:break}throw new Error(`should be unreachable on ${r}`)}emit(r){let e=this.curSegment.emit(r);e!==void 0&&this.addError(e,this.lineLoc)}emit16(r){this.emit(r>>8&255),this.emit(r&255)}assembleNonInstr(r,e){let s=r.ops[0];e.p1&&this.addWarning("Parameter not required",e.p1.loc),e.p2&&this.addWarning("Parameter not required",e.p2.loc),this.emit(s.op)}assembleAluInstr(r,e){let s=r.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let n=s.op;if(e.p1&&s.p1){let o=this.checkRegister(e.p1,s.p1);if(o===void 0)return;n|=s.p1.op(o)}this.emit(n)}assembleClrInstr(r,e){if(!e.p1){this.addError("Parameter required",e.loc);return}if(e.p2&&this.addWarning("Parameter not required",e.p2.loc),!r.ops[0]||!r.ops[0].p1||!r.ops[1]||!r.ops[1].p1){this.addError("Internal opcode definition error",e.loc);return}let s=this.checkRegister(e.p1,r.ops[0].p1,r.ops[1].p1);if(s===void 0)return;let n=this.hasRegister(e.p1,r.ops[1].p1)?r.ops[1]:r.ops[0];if(!n.p1){this.addError("Internal opcode definition error",e.loc);return}let o=n.op;o|=n.p1.op(s),this.emit(o)}assembleMovInstr(r,e){if(!e.p1||!e.p2){this.addError("Two parameters required",e.loc);return}if(!r.ops[0]||!r.ops[0].p1||!r.ops[1]||!r.ops[1].p1){this.addError("Internal opcode definition error",e.loc);return}let s=this.checkRegister(e.p1,r.ops[0].p1,r.ops[1].p1);if(s===void 0)return;let n=this.hasRegister(e.p1,r.ops[1].p1)?r.ops[1]:r.ops[0];if(!e.p1||!n.p1||!e.p2||!n.p2){this.addError("Two parameters required",e.loc);return}let o=n.op;o|=n.p1.op(s);let l=this.checkRegister(e.p2,n.p2);l!==void 0&&(o|=n.p2.op(l),this.emit(o))}assembleLitOpc(r,e){let s=r.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let n=s.op;if(!e.p1||!s.p1){this.addError("Parameter required",e.loc);return}let o=this.checkLiteral(e.p1,0,255,"h");o!==void 0&&(n|=s.p1.op(o),this.emit(n))}assembleLodSwInstr(r,e){let s=r.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let n=s.op;if(!e.p1||!s.p1){this.addError("Parameter required",e.loc);return}let o=this.checkRegister(e.p1,s.p1);o!==void 0&&(n|=s.p1.op(o),this.emit(n))}assembleSetInstr(r,e){if(!e.p1||!e.p2){this.addError("Two parameters required",e.loc);return}if(!r.ops[0]||!r.ops[0].p1||!r.ops[1]||!r.ops[1].p1){this.addError("Internal opcode definition error",e.loc);return}let s=this.checkRegister(e.p1,r.ops[0].p1,r.ops[1].p1);if(s===void 0)return;let n=this.hasRegister(e.p1,r.ops[1].p1),o=n?r.ops[1]:r.ops[0];if(!o.p1){this.addError("Internal opcode definition error",e.loc);return}let l=o.op;if(l|=o.p1.op(s),n){let h=this.evalExpr(e.p2);if(ge(h))return;if(typeof h.value!="number"){this.addError(`Expecting branch label to evaluate to integer, got ${je(h.value)}`,e.p2.loc);return}let{value:v}=h;if(v>65535){this.addError("Value out of range (must be between 0x0000 and 0xFFFF)",e.p2.loc);return}this.emit(l),this.emit((v&65280)>>8),this.emit(v&255)}else{if(!o.p2){this.addError("Internal opcode definition error",e.loc);return}let h=this.checkLiteral(e.p2,-16,15);if(h===void 0)return;l|=o.p2.op(h),this.emit(l)}}checkRegister(r,e,s=void 0){if(r.type!=="register")this.addError("Register required",r.loc);else{let n=e.cs?.[r.value]??s?.cs?.[r.value];return n===void 0&&(e.cs?s&&s.cs?this.addError(`Invalid register - choose one of [${Object.keys(e.cs).join("|")}] or [${Object.keys(s.cs).join("|")}]`,r.loc):this.addError(`Invalid register - choose one of [${Object.keys(e.cs).join("|")}]`,r.loc):this.addError("Invalid register",r.loc)),n}}hasRegister(r,e){return r.type!=="register"?!1:e.cs?.[r.value]!==void 0}checkLiteral(r,e,s,n="d"){let o=this.evalExprToInt(r,"value");if(!ge(o)){let l=o.value;if(l<e||l>s){let h="";switch(n){case"b":{let v=s.toString(2);h=`${("0".repeat(v.length)+e.toString(2)).slice(-v.length)}b and ${v}b`;break}case"h":{let v=s.toString(16).toUpperCase();h=`0x${("0".repeat(v.length)+e.toString(16).toUpperCase()).slice(-v.length)} and 0x${v}`;break}default:h=`${e} and ${s}`}this.addError(`Literal out of range (must be between ${h})`,r.loc)}else return l}}assembleBranch(r,e){let s=r.ops[0];if(e.p2&&this.addWarning("Parameter not required",e.p2.loc),!e.p1){this.addError("Parameter required",e.loc);return}if(e.p1.type!=="qualified-ident"){this.addError("Identifier required",e.p1.loc);return}let n=this.evalExpr(e.p1);if(ge(n))return;if(typeof n.value!="number"){this.addError(`Expecting branch label to evaluate to integer, got ${je(n.value)}`,e.p1.loc);return}let{value:o}=n;this.emit(s.op),this.emit((o&65280)>>8),this.emit(o&255)}handleSetPC(r){let e=this.evalExprToInt(r,"pc");if(!ge(e)){let{value:s,completeFirstPass:n}=e;if(!n){this.addError("Value for new program counter must evaluate to a value in the first pass",r.loc);return}!this.curSegment.empty()&&this.curSegment.currentPC()>s&&this.addError(`Cannot set program counter to a smaller value than current (current: $${R(this.curSegment.currentPC())}, trying to set $${R(s)})`,r.loc);let o=this.curSegment.setCurrentPC(s);o!==void 0&&this.addError(o,r.loc)}}emit8or16(r,e){if(e===8){this.emit(r);return}this.emit16(r)}emitData(r,e){let s=Math.pow(2,e);for(let n=0;n<r.length;n++){let o=this.evalExpr(r[n]);if(ge(o))continue;let{value:l}=o;if(typeof l=="number")l>=s?this.addError(`Data out of range for ${e} bits`,r[n].loc):this.emit8or16(l,e);else if(typeof l=="string"){let h=l.split("").map(v=>v.charCodeAt(0));h.find(v=>v>=s)?this.addError(`Data contains character out of range for ${e} bits`,r[n].loc):h.forEach(v=>this.emit8or16(v,e))}else this.addError(`Only literal types can be emitted. Got ${je(l)}`,r[n].loc)}}checkDirectives(r,e){switch(r.type){case"data":{this.emitData(r.values,r.dataSize===he.Byte?8:16);break}case"setpc":{this.handleSetPC(r.pc);break}default:this.addError(`unknown directive ${r.type}`,r.loc);return}}assembleLines(r){if(r===null||r.length===0||r.length===0)return;let e=n=>{for(let o=0;o<n.length;o++)this.debugInfo.startLine(n[o].loc,this.getPC(),this.curSegment),this.assembleLine(n[o]),this.debugInfo.endLine(this.getPC(),this.curSegment)},s=0;for(;s<r.length;){let{label:n,stmt:o}=r[s];if(n===null&&o===null)s++;else break}if(!(s>=r.length))return e(r)}checkAndDeclareLabel(r){this.scopes.symbolSeen(r.name)?this.addError(`Symbol '${r.name}' already defined`,r.loc):this.scopes.declareLabelSymbol(r,this.getPC(),this.curSegment)&&(this.needPass=!0)}assembleLine(r){if(this.lineLoc=r.loc,r.label===null&&r.stmt===null||(r.label!==null&&this.checkAndDeclareLabel(r.label),r.stmt===null))return;if(r.stmt.type!=="insn"){this.checkDirectives(r.stmt,r.label===null?null:r.label.name);return}let e=r.stmt,s=vr[e.mnemonic.toLocaleLowerCase()];s!==void 0?(o=>{let l=this.getPC();o();let h=this.getPC();this.debugInfo.markAsInstruction(l,h)})(()=>{switch(s.mt){case S.Direct:this.assembleNonInstr(s,e);break;case S.Alu:this.assembleAluInstr(s,e);break;case S.Clear:this.assembleClrInstr(s,e);break;case S.Move:this.assembleMovInstr(s,e);break;case S.LitOpc:this.assembleLitOpc(s,e);break;case S.LodSw:this.assembleLodSwInstr(s,e);break;case S.Set:this.assembleSetInstr(s,e);break;case S.Goto:this.assembleBranch(s,e);break;default:this.addError(`Couldn't encode instruction '${e.mnemonic} '`,r.loc)}}):this.addError(`Unknown mnemonic '${e.mnemonic}'`,e.loc)}assemble(r){try{let e=Sr.parse(r.toString());e!==void 0&&e.lines&&this.assembleLines(e.lines)}catch(e){if("name"in e&&e.name==="SyntaxError")this.addError(`Syntax error: ${e.message}`,{...e.location});else{if("name"in e&&e.name==="semantic")return;throw e}}}dumpLabels(){return this.scopes.dumpLabels(this.getPC(),this.segments)}collectSegmentInfo(){return br(this.segments)}};function At(t){try{return Sr.parse(t.toString())}catch{return}}function Ct(t){let r=new $t,e=0;do{if(r.startPass(e),r.assemble(t),e>0&&r.anyErrors())return{prg:Uint8Array.from([]),labels:[],segments:[],debugInfo:void 0,errors:r.errors(),warnings:r.warnings()};e+=1}while(r.needPass);return{prg:r.prg(),errors:r.errors(),warnings:r.warnings(),labels:r.dumpLabels(),segments:r.collectSegmentInfo(),debugInfo:r.debugInfo}}var I;(function(t){t[t.Program=0]="Program",t[t.Line=1]="Line",t[t.Label=2]="Label",t[t.LabelRef=3]="LabelRef",t[t.Instruction=4]="Instruction",t[t.Literal=5]="Literal",t[t.Register=6]="Register",t[t.SetPC=7]="SetPC",t[t.Expr=8]="Expr",t[t.Data=9]="Data"})(I||(I={}));var me;(function(t){t[t.Label=0]="Label"})(me||(me={}));function We(t,r){let e=null;return!t||r<t.offset||r>t.end?null:(t.accept(s=>s.offset===-1&&s.length===-1?!0:s.offset<=r&&s.end>=r?(e?s.length<=e.length&&(e=s):e=s,!0):!1),e)}function kr(t,r){let e=We(t,r),s=[];for(;e;)s.unshift(e),e=e.parent;return s}var j=class{get end(){return this.offset+this.length}constructor(r,e){this.nodeType=e,this.parent=null,this.offset=r?.loc.start.offset??0,this.length=(r?.loc.end.offset??0)-this.offset}get type(){return this.nodeType}getTextProvider(){let r=this;for(;r&&!r.textProvider;)r=r.parent;return r?r.textProvider:()=>"unknown"}getText(){return this.getTextProvider()(this.offset,this.length)}matches(r){return this.length===r.length&&this.getTextProvider()(this.offset,this.length)===r}accept(r){if(r(this)&&this.children)for(let e of this.children)e.accept(r)}acceptVisitor(r){this.accept(r.visitNode.bind(r))}adoptChild(r){r.parent=this;let e=this.children;return e||(e=this.children=[]),e.push(r),r}};var Be=class extends j{constructor(r){super(r,I.Program),r?.lines?.forEach(e=>this.adoptChild(new Lt(e)))}},Lt=class extends j{constructor(r){if(super(r,I.Line),r.label&&this.adoptChild(new G(r.label)),r.stmt)switch(r.stmt.type){case"insn":this.adoptChild(new xe(r.stmt));break;case"setpc":this.adoptChild(new we(r.stmt));break;case"data":this.adoptChild(new ve(r.stmt))}}},G=class extends j{constructor(r){super(r,I.Label),this.length--}},we=class extends j{constructor(r){super(r,I.SetPC),this.pcExpr=this.adoptChild(new St(r.pc))}},ve=class extends j{constructor(r){super(r,I.Data)}},St=class extends j{constructor(r){super(r,I.Expr)}},xe=class extends j{constructor(r){super(r,I.Instruction);let e=s=>{switch(s.type){case"literal":return this.adoptChild(new ye(s));case"register":return this.adoptChild(new be(s));case"qualified-ident":return this.adoptChild(new Z(s));default:return}};this.mnemonic=r.mnemonic.toLowerCase(),r.p1&&(this.p1=e(r.p1)),r.p2&&(this.p2=e(r.p2))}},Z=class extends j{constructor(r){super(r,I.LabelRef)}},ye=class extends j{constructor(r){super(r,I.Literal),this.value=r.lit}},be=class extends j{constructor(r){super(r,I.Register),this.value=r.value.toUpperCase()}};var Te=class{parseProgram(r){let e=r.version,s=r.getText(),n=At(r.getText()),o=new Be(n),l=(h,v)=>{if(r.version!==e)throw new Error("Underlying model has changed, AST is no longer valid");return s.substr(h,v)};return o.textProvider=l,o}};var Pr={version:1,mnemonics:[{name:"add",class:"ALU",summary:"Arithmetic Add",description:"Adds the contents of register B and C (B+C) placing the result in register A or D.",synopsis:"{0} = B + C",syntax:"[ a | d ]"},{name:"and",class:"ALU",summary:"Logic And",description:"Performs a bitwise AND operation on register B and C (B&C) placing the result in register A or D.",synopsis:"{0} = B & C",syntax:"[ a | d ]"},{name:"bcs",class:"GOTO",summary:"Branch if Carry Set",snippet:"bcs ${1:label}",description:"Jumps to the given address if the carry flag is set.",synopsis:"PC = {0} [if CY]",syntax:"<label>"},{name:"beq",class:"GOTO",summary:"Branch if Equal/Zero",snippet:"beq ${1:label}",description:"Jumps to the given address if the zero flag is set (equal).",synopsis:"PC = {0} [if Z]",syntax:"<label>"},{name:"ble",class:"GOTO",summary:"Branch if Less Than or Equal (Sign+Zero)",snippet:"ble ${1:label}",description:"Jumps to the given address if the sign or zero flag is set (less than or equal).",synopsis:"PC = {0} [if S or Z]",syntax:"<label>"},{name:"blt",class:"GOTO",summary:"Branch if Less Than (Sign)",snippet:"blt ${1:label}",description:"Jumps to the given address if the sign flag is set (less than).",synopsis:"PC = {0} [if S]",syntax:"<label>"},{name:"bmi",class:"GOTO",summary:"Branch if Minus/Sign",snippet:"bmi ${1:label}",description:"Jumps to the given address if the sign flag is set (negative).",synopsis:"PC = {0} [if S]",syntax:"<label>"},{name:"bne",class:"GOTO",summary:"Branch if Not Equal/Zero",snippet:"bne ${1:label}",description:"Jumps to the given address if the zero flag is not set (not equal).",synopsis:"PC = {0} [if not Z]",syntax:"<label>"},{name:"clr",class:"MOV8",summary:"Zero Value",description:"Clears the content (=0) of a given register.",synopsis:"{0} = 0",syntax:"<target>{a,d|m1|m2|x|y|xy}"},{name:"cmp",class:"ALU",summary:"Compare (Logic Xor)",description:"Compares the values in register B and C setting the zero flag if the same (affects register A or D) (equivalent to eor).",synopsis:"{0} = B != C",syntax:"[ a | d ]"},{name:"eor",class:"ALU",summary:"Logic Xor",description:"Performs a bitwise XOR operation on register B and C (B^C) placing the result in register A or D.",synopsis:"{0} = B ^ C",syntax:"[ a | d ]"},{name:"inc",class:"ALU",summary:"Increment",description:"Increments contents of register B placing the result in register A or D",synopsis:"{0} = B + 1",syntax:"[ a | d ]"},{name:"hlt",class:"MISC",summary:"Halt",description:"Halts execution of the program",synopsis:"PC = PC + 1",syntax:"<label>"},{name:"hlr",class:"MISC",summary:"Halt and Reload",description:"Halts execution of the program and sets the program counter from the address switches",synopsis:"PC = AS",syntax:"<label>"},{name:"lds",class:"MISC",summary:"Load Switches",description:"Takes the 8-bit value on the main switches and loads register A or D.",synopsis:"{0} = DS",syntax:"[ a | d ]"},{name:"jmp",class:"GOTO",summary:"Jump to Label",snippet:"jmp ${1:label}",description:"Unconditionally jumps to the given address.",synopsis:"PC = {0}",syntax:"<label>"},{name:"jsr",class:"GOTO",summary:"Call Subroutine (Jump and Link)",snippet:"jsr ${1:label}",description:"Calls the subroutine at the given address.",synopsis:"XY = PC, PC = {0}",syntax:"<label>"},{name:"rts",class:"MOV16",summary:"Return from Subroutine",description:"Jumps back from a jsr call.",synopsis:"PC = XY"},{name:"ldi",class:"SETAB",summary:"Load Immediate",snippet:"ldi ${1:a},${2:0}",description:"Loads an 8-bit value in to register A/B or a 16-bit value in to register M/J.",synopsis:"{0} = {1}",syntax:"[ <target>{a|b} , <value>{-16,15} ] | [ <target>{m|j} , [ <value>{0x0000,0xFFFF} | <label> ] ]"},{name:"mov",class:"MOV8|MOV16",summary:"Copy Register to Register",snippet:"mov ${1:b},${2:a}",description:"Copies the content of one register to another.",synopsis:"{0} = {1}",syntax:"[ <destination>{a,d|m1|m2|x|y} , <source>{a,d|m1|m2|x|y} | <destination>{xy|pc} , <source>{m|xy|j|as} ]"},{name:"not",class:"ALU",summary:"Logic Not",description:"Performs a bitwise NOT operation on register B (~B) placing the result in register A or D.",synopsis:"{0} = ~B",syntax:"[ a | d ]"},{name:"opc",class:"PSEUDO",summary:"Literal Opcode",snippet:"opc ${1:opcode}",description:"Performs the given machine opcode directly.",syntax:"[ <opcode>{0x00,0xFF} | <opcode>{0b00000000,0b11111111} ]"},{name:"orr",class:"ALU",summary:"Logic Or",description:"Performs a bitwise OR operation on register B and C (B|C) placing the result in register A or D.",synopsis:"{0} = B | C",syntax:"[ a | d ]"},{name:"rol",class:"ALU",summary:"Bitwise Circular Shift Left",description:"Performs a bitwise left rotation on register B (<<B) placing the result in register A or D.",synopsis:"{0} = <<B",syntax:"[ a | d ]"},{name:"org",class:"PSEUDO",summary:"Set Program Counter",description:"Sets the program counter to the given address such that the following instructions start from that location.",synopsis:"PC = {0}",syntax:"<value>{0x0000,0xFFFF}"},{name:"dfb",class:"PSEUDO",summary:"Define Byte Data",description:"Writes the given 8-bit values directly into the output starting from current location.",syntax:"<value>{0x00,0xFF} [ ,...n ]"},{name:"dfw",class:"PSEUDO",summary:"Define Word Data",description:"Writes the given 16-bit values directly into the output starting from current location.",syntax:"<value>{0x0000,0xFFFF} [ ,...n ]"}]};function _r(t){return Object.keys(t).map(r=>t[r])}function ne(t){return typeof t<"u"}var ze=class{constructor(r){this.dataProviders=r,this._mnemonicSet={},this._mnemonics=[],this.collectData()}collectData(){this.dataProviders.forEach(r=>{r.provideMnemonics().forEach(e=>{this._mnemonicSet[e.name]||(this._mnemonicSet[e.name]=e)})}),this._mnemonics=_r(this._mnemonicSet)}getMnemonic(r){return this._mnemonicSet[r]}getMnemonics(){return this._mnemonics}};var Ne=class{constructor(r){this._mnemonics=[],this.addData(r)}provideMnemonics(){return this._mnemonics}addData(r){r.mnemonics&&(this._mnemonics=this._mnemonics.concat(r.mnemonics))}};function qe(t,r){return r?{kind:"markdown",value:go(t)}:{kind:"plaintext",value:po(t)}}function po(t){if(!t.description||t.description==="")return"";if(typeof t.description!="string")return t.description.value;let r="";return r+=t.description,"syntax"in t&&(r+=`

Syntax: ${t.syntax}`),r}function go(t){if(!t.description||t.description==="")return"";let r="";return typeof t.description=="string"?r+=t.description:r=t.description.value,"syntax"in t&&(r+=`

Syntax: \`${t.syntax}\``),r}function Et(t,r,e){return e?{kind:"markdown",value:Ir(wo(t),r)}:{kind:"plaintext",value:Ir(mo(t),r)}}function Ir(t,r){if(!r||r.length===0)return t;for(let e=0;e<r.length;e++)t=t.replace(`{${e}}`,r[e]);return t}function mo(t){if(!t.synopsis||t.synopsis==="")return"";let r="";return t.summary&&(t.class?r+=`${t.summary} [${t.class}]

`:r+=`${t.summary}

`),r+=t.synopsis,r}function wo(t){if(!t.synopsis||t.synopsis==="")return"";let r="";return t.summary&&(t.class?r+=`${t.summary} [${t.class}]

`:r+=`${t.summary}

`),r+="`"+t.synopsis+"`",r}var se=new ze([new Ne(Pr)]);var Mr;(function(t){function r(e){return typeof e=="string"}t.is=r})(Mr||(Mr={}));var kt;(function(t){function r(e){return typeof e=="string"}t.is=r})(kt||(kt={}));var Or;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647;function r(e){return typeof e=="number"&&t.MIN_VALUE<=e&&e<=t.MAX_VALUE}t.is=r})(Or||(Or={}));var He;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647;function r(e){return typeof e=="number"&&t.MIN_VALUE<=e&&e<=t.MAX_VALUE}t.is=r})(He||(He={}));var O;(function(t){function r(s,n){return s===Number.MAX_VALUE&&(s=He.MAX_VALUE),n===Number.MAX_VALUE&&(n=He.MAX_VALUE),{line:s,character:n}}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&d.uinteger(n.line)&&d.uinteger(n.character)}t.is=e})(O||(O={}));var k;(function(t){function r(s,n,o,l){if(d.uinteger(s)&&d.uinteger(n)&&d.uinteger(o)&&d.uinteger(l))return{start:O.create(s,n),end:O.create(o,l)};if(O.is(s)&&O.is(n))return{start:s,end:n};throw new Error("Range#create called with invalid arguments[".concat(s,", ").concat(n,", ").concat(o,", ").concat(l,"]"))}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&O.is(n.start)&&O.is(n.end)}t.is=e})(k||(k={}));var Q;(function(t){function r(s,n){return{uri:s,range:n}}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&k.is(n.range)&&(d.string(n.uri)||d.undefined(n.uri))}t.is=e})(Q||(Q={}));var Fr;(function(t){function r(s,n,o,l){return{targetUri:s,targetRange:n,targetSelectionRange:o,originSelectionRange:l}}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&k.is(n.targetRange)&&d.string(n.targetUri)&&k.is(n.targetSelectionRange)&&(k.is(n.originSelectionRange)||d.undefined(n.originSelectionRange))}t.is=e})(Fr||(Fr={}));var Pt;(function(t){function r(s,n,o,l){return{red:s,green:n,blue:o,alpha:l}}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&d.numberRange(n.red,0,1)&&d.numberRange(n.green,0,1)&&d.numberRange(n.blue,0,1)&&d.numberRange(n.alpha,0,1)}t.is=e})(Pt||(Pt={}));var Rr;(function(t){function r(s,n){return{range:s,color:n}}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&k.is(n.range)&&Pt.is(n.color)}t.is=e})(Rr||(Rr={}));var jr;(function(t){function r(s,n,o){return{label:s,textEdit:n,additionalTextEdits:o}}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&d.string(n.label)&&(d.undefined(n.textEdit)||U.is(n))&&(d.undefined(n.additionalTextEdits)||d.typedArray(n.additionalTextEdits,U.is))}t.is=e})(jr||(jr={}));var Br;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(Br||(Br={}));var Wr;(function(t){function r(s,n,o,l,h,v){var p={startLine:s,endLine:n};return d.defined(o)&&(p.startCharacter=o),d.defined(l)&&(p.endCharacter=l),d.defined(h)&&(p.kind=h),d.defined(v)&&(p.collapsedText=v),p}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&d.uinteger(n.startLine)&&d.uinteger(n.startLine)&&(d.undefined(n.startCharacter)||d.uinteger(n.startCharacter))&&(d.undefined(n.endCharacter)||d.uinteger(n.endCharacter))&&(d.undefined(n.kind)||d.string(n.kind))}t.is=e})(Wr||(Wr={}));var _t;(function(t){function r(s,n){return{location:s,message:n}}t.create=r;function e(s){var n=s;return d.defined(n)&&Q.is(n.location)&&d.string(n.message)}t.is=e})(_t||(_t={}));var oe;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(oe||(oe={}));var Ur;(function(t){t.Unnecessary=1,t.Deprecated=2})(Ur||(Ur={}));var Tr;(function(t){function r(e){var s=e;return d.objectLiteral(s)&&d.string(s.href)}t.is=r})(Tr||(Tr={}));var $e;(function(t){function r(s,n,o,l,h,v){var p={range:s,message:n};return d.defined(o)&&(p.severity=o),d.defined(l)&&(p.code=l),d.defined(h)&&(p.source=h),d.defined(v)&&(p.relatedInformation=v),p}t.create=r;function e(s){var n,o=s;return d.defined(o)&&k.is(o.range)&&d.string(o.message)&&(d.number(o.severity)||d.undefined(o.severity))&&(d.integer(o.code)||d.string(o.code)||d.undefined(o.code))&&(d.undefined(o.codeDescription)||d.string((n=o.codeDescription)===null||n===void 0?void 0:n.href))&&(d.string(o.source)||d.undefined(o.source))&&(d.undefined(o.relatedInformation)||d.typedArray(o.relatedInformation,_t.is))}t.is=e})($e||($e={}));var ae;(function(t){function r(s,n){for(var o=[],l=2;l<arguments.length;l++)o[l-2]=arguments[l];var h={title:s,command:n};return d.defined(o)&&o.length>0&&(h.arguments=o),h}t.create=r;function e(s){var n=s;return d.defined(n)&&d.string(n.title)&&d.string(n.command)}t.is=e})(ae||(ae={}));var U;(function(t){function r(o,l){return{range:o,newText:l}}t.replace=r;function e(o,l){return{range:{start:o,end:o},newText:l}}t.insert=e;function s(o){return{range:o,newText:""}}t.del=s;function n(o){var l=o;return d.objectLiteral(l)&&d.string(l.newText)&&k.is(l.range)}t.is=n})(U||(U={}));var ie;(function(t){function r(s,n,o){var l={label:s};return n!==void 0&&(l.needsConfirmation=n),o!==void 0&&(l.description=o),l}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&d.string(n.label)&&(d.boolean(n.needsConfirmation)||n.needsConfirmation===void 0)&&(d.string(n.description)||n.description===void 0)}t.is=e})(ie||(ie={}));var M;(function(t){function r(e){var s=e;return d.string(s)}t.is=r})(M||(M={}));var X;(function(t){function r(o,l,h){return{range:o,newText:l,annotationId:h}}t.replace=r;function e(o,l,h){return{range:{start:o,end:o},newText:l,annotationId:h}}t.insert=e;function s(o,l){return{range:o,newText:"",annotationId:l}}t.del=s;function n(o){var l=o;return U.is(l)&&(ie.is(l.annotationId)||M.is(l.annotationId))}t.is=n})(X||(X={}));var Ge;(function(t){function r(s,n){return{textDocument:s,edits:n}}t.create=r;function e(s){var n=s;return d.defined(n)&&Xe.is(n.textDocument)&&Array.isArray(n.edits)}t.is=e})(Ge||(Ge={}));var Ae;(function(t){function r(s,n,o){var l={kind:"create",uri:s};return n!==void 0&&(n.overwrite!==void 0||n.ignoreIfExists!==void 0)&&(l.options=n),o!==void 0&&(l.annotationId=o),l}t.create=r;function e(s){var n=s;return n&&n.kind==="create"&&d.string(n.uri)&&(n.options===void 0||(n.options.overwrite===void 0||d.boolean(n.options.overwrite))&&(n.options.ignoreIfExists===void 0||d.boolean(n.options.ignoreIfExists)))&&(n.annotationId===void 0||M.is(n.annotationId))}t.is=e})(Ae||(Ae={}));var Ce;(function(t){function r(s,n,o,l){var h={kind:"rename",oldUri:s,newUri:n};return o!==void 0&&(o.overwrite!==void 0||o.ignoreIfExists!==void 0)&&(h.options=o),l!==void 0&&(h.annotationId=l),h}t.create=r;function e(s){var n=s;return n&&n.kind==="rename"&&d.string(n.oldUri)&&d.string(n.newUri)&&(n.options===void 0||(n.options.overwrite===void 0||d.boolean(n.options.overwrite))&&(n.options.ignoreIfExists===void 0||d.boolean(n.options.ignoreIfExists)))&&(n.annotationId===void 0||M.is(n.annotationId))}t.is=e})(Ce||(Ce={}));var Le;(function(t){function r(s,n,o){var l={kind:"delete",uri:s};return n!==void 0&&(n.recursive!==void 0||n.ignoreIfNotExists!==void 0)&&(l.options=n),o!==void 0&&(l.annotationId=o),l}t.create=r;function e(s){var n=s;return n&&n.kind==="delete"&&d.string(n.uri)&&(n.options===void 0||(n.options.recursive===void 0||d.boolean(n.options.recursive))&&(n.options.ignoreIfNotExists===void 0||d.boolean(n.options.ignoreIfNotExists)))&&(n.annotationId===void 0||M.is(n.annotationId))}t.is=e})(Le||(Le={}));var It;(function(t){function r(e){var s=e;return s&&(s.changes!==void 0||s.documentChanges!==void 0)&&(s.documentChanges===void 0||s.documentChanges.every(function(n){return d.string(n.kind)?Ae.is(n)||Ce.is(n)||Le.is(n):Ge.is(n)}))}t.is=r})(It||(It={}));var Ve=function(){function t(r,e){this.edits=r,this.changeAnnotations=e}return t.prototype.insert=function(r,e,s){var n,o;if(s===void 0?n=U.insert(r,e):M.is(s)?(o=s,n=X.insert(r,e,s)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(s),n=X.insert(r,e,o)),this.edits.push(n),o!==void 0)return o},t.prototype.replace=function(r,e,s){var n,o;if(s===void 0?n=U.replace(r,e):M.is(s)?(o=s,n=X.replace(r,e,s)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(s),n=X.replace(r,e,o)),this.edits.push(n),o!==void 0)return o},t.prototype.delete=function(r,e){var s,n;if(e===void 0?s=U.del(r):M.is(e)?(n=e,s=X.del(r,e)):(this.assertChangeAnnotations(this.changeAnnotations),n=this.changeAnnotations.manage(e),s=X.del(r,n)),this.edits.push(s),n!==void 0)return n},t.prototype.add=function(r){this.edits.push(r)},t.prototype.all=function(){return this.edits},t.prototype.clear=function(){this.edits.splice(0,this.edits.length)},t.prototype.assertChangeAnnotations=function(r){if(r===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},t}(),zr=function(){function t(r){this._annotations=r===void 0?Object.create(null):r,this._counter=0,this._size=0}return t.prototype.all=function(){return this._annotations},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),t.prototype.manage=function(r,e){var s;if(M.is(r)?s=r:(s=this.nextId(),e=r),this._annotations[s]!==void 0)throw new Error("Id ".concat(s," is already in use."));if(e===void 0)throw new Error("No annotation provided for id ".concat(s));return this._annotations[s]=e,this._size++,s},t.prototype.nextId=function(){return this._counter++,this._counter.toString()},t}(),Yo=function(){function t(r){var e=this;this._textEditChanges=Object.create(null),r!==void 0?(this._workspaceEdit=r,r.documentChanges?(this._changeAnnotations=new zr(r.changeAnnotations),r.changeAnnotations=this._changeAnnotations.all(),r.documentChanges.forEach(function(s){if(Ge.is(s)){var n=new Ve(s.edits,e._changeAnnotations);e._textEditChanges[s.textDocument.uri]=n}})):r.changes&&Object.keys(r.changes).forEach(function(s){var n=new Ve(r.changes[s]);e._textEditChanges[s]=n})):this._workspaceEdit={}}return Object.defineProperty(t.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),t.prototype.getTextEditChange=function(r){if(Xe.is(r)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var e={uri:r.uri,version:r.version},s=this._textEditChanges[e.uri];if(!s){var n=[],o={textDocument:e,edits:n};this._workspaceEdit.documentChanges.push(o),s=new Ve(n,this._changeAnnotations),this._textEditChanges[e.uri]=s}return s}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var s=this._textEditChanges[r];if(!s){var n=[];this._workspaceEdit.changes[r]=n,s=new Ve(n),this._textEditChanges[r]=s}return s}},t.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new zr,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},t.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},t.prototype.createFile=function(r,e,s){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var n;ie.is(e)||M.is(e)?n=e:s=e;var o,l;if(n===void 0?o=Ae.create(r,s):(l=M.is(n)?n:this._changeAnnotations.manage(n),o=Ae.create(r,s,l)),this._workspaceEdit.documentChanges.push(o),l!==void 0)return l},t.prototype.renameFile=function(r,e,s,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var o;ie.is(s)||M.is(s)?o=s:n=s;var l,h;if(o===void 0?l=Ce.create(r,e,n):(h=M.is(o)?o:this._changeAnnotations.manage(o),l=Ce.create(r,e,n,h)),this._workspaceEdit.documentChanges.push(l),h!==void 0)return h},t.prototype.deleteFile=function(r,e,s){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var n;ie.is(e)||M.is(e)?n=e:s=e;var o,l;if(n===void 0?o=Le.create(r,s):(l=M.is(n)?n:this._changeAnnotations.manage(n),o=Le.create(r,s,l)),this._workspaceEdit.documentChanges.push(o),l!==void 0)return l},t}();var Nr;(function(t){function r(s){return{uri:s}}t.create=r;function e(s){var n=s;return d.defined(n)&&d.string(n.uri)}t.is=e})(Nr||(Nr={}));var qr;(function(t){function r(s,n){return{uri:s,version:n}}t.create=r;function e(s){var n=s;return d.defined(n)&&d.string(n.uri)&&d.integer(n.version)}t.is=e})(qr||(qr={}));var Xe;(function(t){function r(s,n){return{uri:s,version:n}}t.create=r;function e(s){var n=s;return d.defined(n)&&d.string(n.uri)&&(n.version===null||d.integer(n.version))}t.is=e})(Xe||(Xe={}));var Vr;(function(t){function r(s,n,o,l){return{uri:s,languageId:n,version:o,text:l}}t.create=r;function e(s){var n=s;return d.defined(n)&&d.string(n.uri)&&d.string(n.languageId)&&d.integer(n.version)&&d.string(n.text)}t.is=e})(Vr||(Vr={}));var B;(function(t){t.PlainText="plaintext",t.Markdown="markdown";function r(e){var s=e;return s===t.PlainText||s===t.Markdown}t.is=r})(B||(B={}));var ce;(function(t){function r(e){var s=e;return d.objectLiteral(e)&&B.is(s.kind)&&d.string(s.value)}t.is=r})(ce||(ce={}));var Je;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(Je||(Je={}));var Se;(function(t){t.PlainText=1,t.Snippet=2})(Se||(Se={}));var Hr;(function(t){t.Deprecated=1})(Hr||(Hr={}));var Gr;(function(t){function r(s,n,o){return{newText:s,insert:n,replace:o}}t.create=r;function e(s){var n=s;return n&&d.string(n.newText)&&k.is(n.insert)&&k.is(n.replace)}t.is=e})(Gr||(Gr={}));var Xr;(function(t){t.asIs=1,t.adjustIndentation=2})(Xr||(Xr={}));var Jr;(function(t){function r(e){var s=e;return s&&(d.string(s.detail)||s.detail===void 0)&&(d.string(s.description)||s.description===void 0)}t.is=r})(Jr||(Jr={}));var Zr;(function(t){function r(e){return{label:e}}t.create=r})(Zr||(Zr={}));var Dt;(function(t){function r(e,s){return{items:e||[],isIncomplete:!!s}}t.create=r})(Dt||(Dt={}));var Ee;(function(t){function r(s){return s.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}t.fromPlainText=r;function e(s){var n=s;return d.string(n)||d.objectLiteral(n)&&d.string(n.language)&&d.string(n.value)}t.is=e})(Ee||(Ee={}));var Mt;(function(t){function r(e){var s=e;return!!s&&d.objectLiteral(s)&&(ce.is(s.contents)||Ee.is(s.contents)||d.typedArray(s.contents,Ee.is))&&(e.range===void 0||k.is(e.range))}t.is=r})(Mt||(Mt={}));var Qr;(function(t){function r(e,s){return s?{label:e,documentation:s}:{label:e}}t.create=r})(Qr||(Qr={}));var Yr;(function(t){function r(e,s){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var l={label:e};return d.defined(s)&&(l.documentation=s),d.defined(n)?l.parameters=n:l.parameters=[],l}t.create=r})(Yr||(Yr={}));var le;(function(t){t.Text=1,t.Read=2,t.Write=3})(le||(le={}));var Ot;(function(t){function r(e,s){var n={range:e};return d.number(s)&&(n.kind=s),n}t.create=r})(Ot||(Ot={}));var ue;(function(t){t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(ue||(ue={}));var Kr;(function(t){t.Deprecated=1})(Kr||(Kr={}));var Ft;(function(t){function r(e,s,n,o,l){var h={name:e,kind:s,location:{uri:o,range:n}};return l&&(h.containerName=l),h}t.create=r})(Ft||(Ft={}));var en;(function(t){function r(e,s,n,o){return o!==void 0?{name:e,kind:s,location:{uri:n,range:o}}:{name:e,kind:s,location:{uri:n}}}t.create=r})(en||(en={}));var tn;(function(t){function r(s,n,o,l,h,v){var p={name:s,detail:n,kind:o,range:l,selectionRange:h};return v!==void 0&&(p.children=v),p}t.create=r;function e(s){var n=s;return n&&d.string(n.name)&&d.number(n.kind)&&k.is(n.range)&&k.is(n.selectionRange)&&(n.detail===void 0||d.string(n.detail))&&(n.deprecated===void 0||d.boolean(n.deprecated))&&(n.children===void 0||Array.isArray(n.children))&&(n.tags===void 0||Array.isArray(n.tags))}t.is=e})(tn||(tn={}));var rn;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(rn||(rn={}));var Ze;(function(t){t.Invoked=1,t.Automatic=2})(Ze||(Ze={}));var nn;(function(t){function r(s,n,o){var l={diagnostics:s};return n!=null&&(l.only=n),o!=null&&(l.triggerKind=o),l}t.create=r;function e(s){var n=s;return d.defined(n)&&d.typedArray(n.diagnostics,$e.is)&&(n.only===void 0||d.typedArray(n.only,d.string))&&(n.triggerKind===void 0||n.triggerKind===Ze.Invoked||n.triggerKind===Ze.Automatic)}t.is=e})(nn||(nn={}));var sn;(function(t){function r(s,n,o){var l={title:s},h=!0;return typeof n=="string"?(h=!1,l.kind=n):ae.is(n)?l.command=n:l.edit=n,h&&o!==void 0&&(l.kind=o),l}t.create=r;function e(s){var n=s;return n&&d.string(n.title)&&(n.diagnostics===void 0||d.typedArray(n.diagnostics,$e.is))&&(n.kind===void 0||d.string(n.kind))&&(n.edit!==void 0||n.command!==void 0)&&(n.command===void 0||ae.is(n.command))&&(n.isPreferred===void 0||d.boolean(n.isPreferred))&&(n.edit===void 0||It.is(n.edit))}t.is=e})(sn||(sn={}));var on;(function(t){function r(s,n){var o={range:s};return d.defined(n)&&(o.data=n),o}t.create=r;function e(s){var n=s;return d.defined(n)&&k.is(n.range)&&(d.undefined(n.command)||ae.is(n.command))}t.is=e})(on||(on={}));var an;(function(t){function r(s,n){return{tabSize:s,insertSpaces:n}}t.create=r;function e(s){var n=s;return d.defined(n)&&d.uinteger(n.tabSize)&&d.boolean(n.insertSpaces)}t.is=e})(an||(an={}));var cn;(function(t){function r(s,n,o){return{range:s,target:n,data:o}}t.create=r;function e(s){var n=s;return d.defined(n)&&k.is(n.range)&&(d.undefined(n.target)||d.string(n.target))}t.is=e})(cn||(cn={}));var ln;(function(t){function r(s,n){return{range:s,parent:n}}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&k.is(n.range)&&(n.parent===void 0||t.is(n.parent))}t.is=e})(ln||(ln={}));var un;(function(t){t.namespace="namespace",t.type="type",t.class="class",t.enum="enum",t.interface="interface",t.struct="struct",t.typeParameter="typeParameter",t.parameter="parameter",t.variable="variable",t.property="property",t.enumMember="enumMember",t.event="event",t.function="function",t.method="method",t.macro="macro",t.keyword="keyword",t.modifier="modifier",t.comment="comment",t.string="string",t.number="number",t.regexp="regexp",t.operator="operator",t.decorator="decorator"})(un||(un={}));var fn;(function(t){t.declaration="declaration",t.definition="definition",t.readonly="readonly",t.static="static",t.deprecated="deprecated",t.abstract="abstract",t.async="async",t.modification="modification",t.documentation="documentation",t.defaultLibrary="defaultLibrary"})(fn||(fn={}));var dn;(function(t){function r(e){var s=e;return d.objectLiteral(s)&&(s.resultId===void 0||typeof s.resultId=="string")&&Array.isArray(s.data)&&(s.data.length===0||typeof s.data[0]=="number")}t.is=r})(dn||(dn={}));var hn;(function(t){function r(s,n){return{range:s,text:n}}t.create=r;function e(s){var n=s;return n!=null&&k.is(n.range)&&d.string(n.text)}t.is=e})(hn||(hn={}));var pn;(function(t){function r(s,n,o){return{range:s,variableName:n,caseSensitiveLookup:o}}t.create=r;function e(s){var n=s;return n!=null&&k.is(n.range)&&d.boolean(n.caseSensitiveLookup)&&(d.string(n.variableName)||n.variableName===void 0)}t.is=e})(pn||(pn={}));var gn;(function(t){function r(s,n){return{range:s,expression:n}}t.create=r;function e(s){var n=s;return n!=null&&k.is(n.range)&&(d.string(n.expression)||n.expression===void 0)}t.is=e})(gn||(gn={}));var mn;(function(t){function r(s,n){return{frameId:s,stoppedLocation:n}}t.create=r;function e(s){var n=s;return d.defined(n)&&k.is(s.stoppedLocation)}t.is=e})(mn||(mn={}));var Rt;(function(t){t.Type=1,t.Parameter=2;function r(e){return e===1||e===2}t.is=r})(Rt||(Rt={}));var jt;(function(t){function r(s){return{value:s}}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&(n.tooltip===void 0||d.string(n.tooltip)||ce.is(n.tooltip))&&(n.location===void 0||Q.is(n.location))&&(n.command===void 0||ae.is(n.command))}t.is=e})(jt||(jt={}));var wn;(function(t){function r(s,n,o){var l={position:s,label:n};return o!==void 0&&(l.kind=o),l}t.create=r;function e(s){var n=s;return d.objectLiteral(n)&&O.is(n.position)&&(d.string(n.label)||d.typedArray(n.label,jt.is))&&(n.kind===void 0||Rt.is(n.kind))&&n.textEdits===void 0||d.typedArray(n.textEdits,U.is)&&(n.tooltip===void 0||d.string(n.tooltip)||ce.is(n.tooltip))&&(n.paddingLeft===void 0||d.boolean(n.paddingLeft))&&(n.paddingRight===void 0||d.boolean(n.paddingRight))}t.is=e})(wn||(wn={}));var vn;(function(t){function r(e){var s=e;return d.objectLiteral(s)&&kt.is(s.uri)&&d.string(s.name)}t.is=r})(vn||(vn={}));var xn;(function(t){function r(o,l,h,v){return new vo(o,l,h,v)}t.create=r;function e(o){var l=o;return!!(d.defined(l)&&d.string(l.uri)&&(d.undefined(l.languageId)||d.string(l.languageId))&&d.uinteger(l.lineCount)&&d.func(l.getText)&&d.func(l.positionAt)&&d.func(l.offsetAt))}t.is=e;function s(o,l){for(var h=o.getText(),v=n(l,function(V,K){var _e=V.range.start.line-K.range.start.line;return _e===0?V.range.start.character-K.range.start.character:_e}),p=h.length,m=v.length-1;m>=0;m--){var y=v[m],L=o.offsetAt(y.range.start),$=o.offsetAt(y.range.end);if($<=p)h=h.substring(0,L)+y.newText+h.substring($,h.length);else throw new Error("Overlapping edit");p=L}return h}t.applyEdits=s;function n(o,l){if(o.length<=1)return o;var h=o.length/2|0,v=o.slice(0,h),p=o.slice(h);n(v,l),n(p,l);for(var m=0,y=0,L=0;m<v.length&&y<p.length;){var $=l(v[m],p[y]);$<=0?o[L++]=v[m++]:o[L++]=p[y++]}for(;m<v.length;)o[L++]=v[m++];for(;y<p.length;)o[L++]=p[y++];return o}})(xn||(xn={}));var vo=function(){function t(r,e,s,n){this._uri=r,this._languageId=e,this._version=s,this._content=n,this._lineOffsets=void 0}return Object.defineProperty(t.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),t.prototype.getText=function(r){if(r){var e=this.offsetAt(r.start),s=this.offsetAt(r.end);return this._content.substring(e,s)}return this._content},t.prototype.update=function(r,e){this._content=r.text,this._version=e,this._lineOffsets=void 0},t.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var r=[],e=this._content,s=!0,n=0;n<e.length;n++){s&&(r.push(n),s=!1);var o=e.charAt(n);s=o==="\r"||o===`
`,o==="\r"&&n+1<e.length&&e.charAt(n+1)===`
`&&n++}s&&e.length>0&&r.push(e.length),this._lineOffsets=r}return this._lineOffsets},t.prototype.positionAt=function(r){r=Math.max(Math.min(r,this._content.length),0);var e=this.getLineOffsets(),s=0,n=e.length;if(n===0)return O.create(0,r);for(;s<n;){var o=Math.floor((s+n)/2);e[o]>r?n=o:s=o+1}var l=s-1;return O.create(l,r-e[l])},t.prototype.offsetAt=function(r){var e=this.getLineOffsets();if(r.line>=e.length)return this._content.length;if(r.line<0)return 0;var s=e[r.line],n=r.line+1<e.length?e[r.line+1]:this._content.length;return Math.max(Math.min(s+r.character,n),s)},Object.defineProperty(t.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),t}(),d;(function(t){var r=Object.prototype.toString;function e($){return typeof $<"u"}t.defined=e;function s($){return typeof $>"u"}t.undefined=s;function n($){return $===!0||$===!1}t.boolean=n;function o($){return r.call($)==="[object String]"}t.string=o;function l($){return r.call($)==="[object Number]"}t.number=l;function h($,V,K){return r.call($)==="[object Number]"&&V<=$&&$<=K}t.numberRange=h;function v($){return r.call($)==="[object Number]"&&-2147483648<=$&&$<=2147483647}t.integer=v;function p($){return r.call($)==="[object Number]"&&0<=$&&$<=2147483647}t.uinteger=p;function m($){return r.call($)==="[object Function]"}t.func=m;function y($){return $!==null&&typeof $=="object"}t.objectLiteral=y;function L($,V){return Array.isArray($)&&$.every(V)}t.typedArray=L})(d||(d={}));var Y=class{constructor(r,e,s,n){this._uri=r,this._languageId=e,this._version=s,this._content=n,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(r){if(r){let e=this.offsetAt(r.start),s=this.offsetAt(r.end);return this._content.substring(e,s)}return this._content}update(r,e){for(let s of r)if(Y.isIncremental(s)){let n=bn(s.range),o=this.offsetAt(n.start),l=this.offsetAt(n.end);this._content=this._content.substring(0,o)+s.text+this._content.substring(l,this._content.length);let h=Math.max(n.start.line,0),v=Math.max(n.end.line,0),p=this._lineOffsets,m=yn(s.text,!1,o);if(v-h===m.length)for(let L=0,$=m.length;L<$;L++)p[L+h+1]=m[L];else m.length<1e4?p.splice(h+1,v-h,...m):this._lineOffsets=p=p.slice(0,h+1).concat(m,p.slice(v+1));let y=s.text.length-(l-o);if(y!==0)for(let L=h+1+m.length,$=p.length;L<$;L++)p[L]=p[L]+y}else if(Y.isFull(s))this._content=s.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=e}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=yn(this._content,!0)),this._lineOffsets}positionAt(r){r=Math.max(Math.min(r,this._content.length),0);let e=this.getLineOffsets(),s=0,n=e.length;if(n===0)return{line:0,character:r};for(;s<n;){let l=Math.floor((s+n)/2);e[l]>r?n=l:s=l+1}let o=s-1;return{line:o,character:r-e[o]}}offsetAt(r){let e=this.getLineOffsets();if(r.line>=e.length)return this._content.length;if(r.line<0)return 0;let s=e[r.line],n=r.line+1<e.length?e[r.line+1]:this._content.length;return Math.max(Math.min(s+r.character,n),s)}get lineCount(){return this.getLineOffsets().length}static isIncremental(r){let e=r;return e!=null&&typeof e.text=="string"&&e.range!==void 0&&(e.rangeLength===void 0||typeof e.rangeLength=="number")}static isFull(r){let e=r;return e!=null&&typeof e.text=="string"&&e.range===void 0&&e.rangeLength===void 0}},ke;(function(t){function r(n,o,l,h){return new Y(n,o,l,h)}t.create=r;function e(n,o,l){if(n instanceof Y)return n.update(o,l),n;throw new Error("TextDocument.update: document must be created by TextDocument.create")}t.update=e;function s(n,o){let l=n.getText(),h=Bt(o.map(xo),(m,y)=>{let L=m.range.start.line-y.range.start.line;return L===0?m.range.start.character-y.range.start.character:L}),v=0,p=[];for(let m of h){let y=n.offsetAt(m.range.start);if(y<v)throw new Error("Overlapping edit");y>v&&p.push(l.substring(v,y)),m.newText.length&&p.push(m.newText),v=n.offsetAt(m.range.end)}return p.push(l.substr(v)),p.join("")}t.applyEdits=s})(ke||(ke={}));function Bt(t,r){if(t.length<=1)return t;let e=t.length/2|0,s=t.slice(0,e),n=t.slice(e);Bt(s,r),Bt(n,r);let o=0,l=0,h=0;for(;o<s.length&&l<n.length;)r(s[o],n[l])<=0?t[h++]=s[o++]:t[h++]=n[l++];for(;o<s.length;)t[h++]=s[o++];for(;l<n.length;)t[h++]=n[l++];return t}function yn(t,r,e=0){let s=r?[e]:[];for(let n=0;n<t.length;n++){let o=t.charCodeAt(n);(o===13||o===10)&&(o===13&&n+1<t.length&&t.charCodeAt(n+1)===10&&n++,s.push(e+n+1))}return s}function bn(t){let r=t.start,e=t.end;return r.line>e.line||r.line===e.line&&r.character>e.character?{start:e,end:r}:t}function xo(t){let r=bn(t.range);return r!==t.range?{newText:t.newText,range:r}:t}var $n;(function(t){t.LATEST={textDocument:{completion:{completionItem:{documentationFormat:[B.Markdown,B.PlainText]}},hover:{contentFormat:[B.Markdown,B.PlainText]}}}})($n||($n={}));var Qe=class{constructor(r){this.clientCapabilities=r}doComplete(r,e,s){this.offset=r.offsetAt(e),this.position=e,this.currentWord=yo(r,this.offset),this.defaultReplaceRange=k.create(O.create(this.position.line,this.position.character-this.currentWord.length),this.position),this.textDocument=r,this.program=s;try{let o={isIncomplete:!1,items:[]};var n=r.getText(k.create(O.create(this.position.line,0),this.position));return n.match(/^([a-z]+:)?([ \t]+)?([a-z]{0,3})$/i)&&this.getCompletionsForMnemonic(o),o}finally{this.position=null,this.currentWord=null,this.textDocument=null,this.program=null,this.defaultReplaceRange=null}}getCompletionsForMnemonic(r){return se.getMnemonics().forEach(s=>{let n,o;n=this.getCompletionRange(null),o=s.snippet??s.name;let l={label:s.name,detail:s.class?`${s.summary} [${s.class}]`:s.summary,documentation:qe(s,this.doesSupportMarkdown()),textEdit:U.replace(n,o),insertTextFormat:Se.Snippet,kind:Je.Function};r.items.push(l)}),r}doesSupportMarkdown(){if(!ne(this.supportsMarkdown)){if(!ne(this.clientCapabilities))return this.supportsMarkdown=!0,this.supportsMarkdown;let r=this.clientCapabilities&&this.clientCapabilities.textDocument&&this.clientCapabilities.textDocument.hover;this.supportsMarkdown=r&&r.contentFormat&&Array.isArray(r.contentFormat)&&r.contentFormat.indexOf(B.Markdown)!==-1}return this.supportsMarkdown}getCompletionRange(r){if(r&&r.offset<=this.offset&&this.offset<=r.end){let e=r.end!==-1?this.textDocument.positionAt(r.end):this.position,s=this.textDocument.positionAt(r.offset);if(s.line===e.line)return k.create(s,e)}return this.defaultReplaceRange}};function yo(t,r){let e=r-1,s=t.getText();for(;e>=0&&` 	
\r:,`.indexOf(s.charAt(e))===-1;)e--;return s.substring(e+1,r)}var Ye=class{constructor(r){this.clientCapabilities=r}doHover(r,e,s){function n(v){return k.create(r.positionAt(v.offset),r.positionAt(v.end))}let o=r.offsetAt(e),l=kr(s,o),h=null;for(let v=0;v<l.length;v++){let p=l[v];if(p instanceof xe){let m=p.mnemonic,y=se.getMnemonic(m);if(y){let L=this.getParamNames(y,p);h={contents:Et(y,L,this.doesSupportMarkdown()),range:n(p)}}}if(p instanceof we){let m=se.getMnemonic("org");if(m){let y=[p.pcExpr.getText()];h={contents:Et(m,y,this.doesSupportMarkdown()),range:n(p)}}}if(p instanceof ve){let m=p.getText().slice(0,3).toLowerCase(),y=se.getMnemonic(m);y&&(h={contents:qe(y,this.doesSupportMarkdown()),range:n(p)})}}return h&&(h.contents=this.convertContents(h.contents)),h}getParamNames(r,e){let s=[];return e.p1?s.push(this.getParamName(e.p1,e.mnemonic)):r.class==="ALU"?s.push("A"):s.push("?"),e.p2?s.push(this.getParamName(e.p2,e.mnemonic)):s.push("?"),s}getParamName(r,e){return r instanceof be?r.value:r instanceof Z?`(${r.getText()})`:r instanceof ye?e.toLowerCase()==="ldi"&&r.value>15?`0x${r.value.toString(16).toUpperCase()}`:r.value.toString():"?"}convertContents(r){return this.doesSupportMarkdown()||typeof r=="string"?r:"kind"in r?{kind:"plaintext",value:r.value}:Array.isArray(r)?r.map(e=>typeof e=="string"?e:e.value):r.value}doesSupportMarkdown(){if(!ne(this.supportsMarkdown)){if(!ne(this.clientCapabilities))return this.supportsMarkdown=!0,this.supportsMarkdown;let r=this.clientCapabilities.textDocument&&this.clientCapabilities.textDocument.hover;this.supportsMarkdown=r&&r.contentFormat&&Array.isArray(r.contentFormat)&&r.contentFormat.indexOf(B.Markdown)!==-1}return this.supportsMarkdown}};var Wt=class{constructor(r,e){this.symbols=[]}addSymbol(r){this.symbols.push(r)}getSymbol(r,e){for(let s=0;s<this.symbols.length;s++){let n=this.symbols[s];if(n.name===r&&n.type===e)return n}return null}},Ut=class extends Wt{constructor(){super(0,Number.MAX_VALUE)}},Tt=class{constructor(r,e,s,n){this.name=r,this.value=e,this.node=s,this.type=n}},zt=class{constructor(r){this.scope=r}addSymbol(r,e,s,n){r.offset!==-1&&this.scope.addSymbol(new Tt(e,s,r,n))}visitNode(r){switch(r.type){case I.Label:return this.addSymbol(r,r.getText(),void 0,me.Label),!0}return!0}},Pe=class{constructor(r){this.global=new Ut,r.acceptVisitor(new zt(this.global))}internalFindSymbol(r,e){let s=r.getText(),n=this.global;for(let o=0;o<e.length;o++){let l=e[o],h=n.getSymbol(s,l);if(h)return h}return null}evaluateReferenceTypes(r){return r instanceof Z||r instanceof G?[me.Label]:null}findSymbolFromNode(r){if(!r)return null;let e=this.evaluateReferenceTypes(r);return e?this.internalFindSymbol(r,e):null}matchesSymbol(r,e){if(!r||!r.matches(e.name))return!1;let s=this.evaluateReferenceTypes(r);return!s||s.indexOf(e.type)===-1?!1:this.internalFindSymbol(r,s)===e}};var et=class{findDefinition(r,e,s){let n=new Pe(s),o=r.offsetAt(e),l=We(s,o);if(!l)return null;let h=n.findSymbolFromNode(l);return h?{uri:r.uri,range:Ke(h.node,r)}:null}findReferences(r,e,s){return this.findDocumentHighlights(r,e,s).map(o=>({uri:r.uri,range:o.range}))}findDocumentHighlights(r,e,s){let n=[],o=r.offsetAt(e),l=We(s,o);if(!l||l.type!==I.Label&&l.type!==I.LabelRef)return n;let h=new Pe(s),v=h.findSymbolFromNode(l),p=l.getText();return s.accept(m=>{if(v){if(h.matchesSymbol(m,v))return n.push({kind:An(m),range:Ke(m,r)}),!1}else l&&l.type===m.type&&m.matches(p)&&n.push({kind:An(m),range:Ke(m,r)});return!0}),n}findDocumentSymbols(r,e){let s=[];return e.accept(n=>{let o={name:null,kind:ue.Class,location:null},l=n;return n instanceof G&&(o.name=n.getText(),o.kind=ue.Variable),o.name&&(o.location=Q.create(r.uri,Ke(l,r)),s.push(o)),!0}),s}};function An(t){return t instanceof G?le.Write:le.Read}function Ke(t,r){return k.create(r.positionAt(t.offset),r.positionAt(t.end))}var tt=class{constructor(){}configure(r){this.settings=r}doValidation(r,e=this.settings){if(e&&e.validate===!1)return[];let{errors:s,warnings:n}=Ct(r.getText()),o=(h,v)=>({severity:v,range:{start:r.positionAt(h.loc.start.offset),end:r.positionAt(h.loc.end.offset)},message:h.msg,source:r.languageId}),l=[];return l.push(...s.map(h=>o(h,oe.Error))),l.push(...n.map(h=>o(h,oe.Warning))),l}};function Cn(t){let r=new Te,e=new Ye(t&&t.clientCapabilities),s=new Qe(t&&t.clientCapabilities),n=new et,o=new tt;return{doValidation:o.doValidation.bind(o),parseProgram:r.parseProgram.bind(r),doComplete:s.doComplete.bind(s),doHover:e.doHover.bind(e),findDefinition:n.findDefinition.bind(n),findReferences:n.findReferences.bind(n),findDocumentHighlights:n.findDocumentHighlights.bind(n),findDocumentSymbols:n.findDocumentSymbols.bind(n)}}var rt=class{_ctx;_languageService;_languageId;constructor(r,e){this._ctx=r,this._languageId=e.languageId,this._languageService=Cn({})}async doValidation(r){let e=this._getTextDocument(r);if(e){let s=this._languageService.doValidation(e);return Promise.resolve(s)}return Promise.resolve([])}async doComplete(r,e){let s=this._getTextDocument(r);if(!s)return null;let n=this._languageService.parseProgram(s),o=this._languageService.doComplete(s,e,n);return Promise.resolve(o)}async doHover(r,e){let s=this._getTextDocument(r);if(!s)return null;let n=this._languageService.parseProgram(s),o=this._languageService.doHover(s,e,n);return Promise.resolve(o)}async findDefinition(r,e){let s=this._getTextDocument(r);if(!s)return null;let n=this._languageService.parseProgram(s),o=this._languageService.findDefinition(s,e,n);return Promise.resolve(o)}async findReferences(r,e){let s=this._getTextDocument(r);if(!s)return[];let n=this._languageService.parseProgram(s),o=this._languageService.findReferences(s,e,n);return Promise.resolve(o)}async findDocumentHighlights(r,e){let s=this._getTextDocument(r);if(!s)return[];let n=this._languageService.parseProgram(s),o=this._languageService.findDocumentHighlights(s,e,n);return Promise.resolve(o)}async findDocumentSymbols(r){let e=this._getTextDocument(r);if(!e)return[];let s=this._languageService.parseProgram(e),n=this._languageService.findDocumentSymbols(e,s);return Promise.resolve(n)}_getTextDocument(r){let e=this._ctx.getMirrorModels();for(let s of e)if(s.uri.toString()===r)return ke.create(r,this._languageId,s.version,s.getValue());return null}};function $o(t,r){return new rt(t,r)}return wr(Ao);})();
return moduleExports;
});
