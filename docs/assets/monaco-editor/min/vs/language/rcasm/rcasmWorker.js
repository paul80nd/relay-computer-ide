"use strict";/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.44.0(f8845af2367f0e63e32e4797c28ec8585b5fbb1d)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/
define("vs/language/rcasm/rcasmWorker", ["require","require"],(require)=>{
var moduleExports=(()=>{var lt=Object.defineProperty;var wo=Object.getOwnPropertyDescriptor;var xo=Object.getOwnPropertyNames;var yo=Object.prototype.hasOwnProperty;var vo=(t,r)=>()=>(t&&(r=t(t=0)),r);var yr=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports),vr=(t,r)=>{for(var e in r)lt(t,e,{get:r[e],enumerable:!0})},bo=(t,r,e,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of xo(r))!yo.call(t,n)&&n!==e&&lt(t,n,{get:()=>r[n],enumerable:!(s=wo(r,n))||s.enumerable});return t};var br=t=>bo(lt({},"__esModule",{value:!0}),t);var ft={};vr(ft,{DataSize:()=>pe,mkAsmLine:()=>_o,mkBinaryOp:()=>Wo,mkData:()=>Fo,mkFill:()=>Ro,mkGetCurPC:()=>Oo,mkInsn:()=>Mo,mkLabel:()=>Io,mkLiteral:()=>Bo,mkProgram:()=>Po,mkRegister:()=>jo,mkScopeQualifiedIdent:()=>Uo,mkSetPC:()=>Do});function Po(t,r){return{lines:t,loc:r}}function _o(t,r,e){return{label:t,stmt:r,loc:e}}function Io(t,r){return{name:t,loc:r}}function Do(t,r){return{type:"setpc",pc:t,loc:r}}function Oo(t){return{type:"getcurpc",loc:t}}function Mo(t,r,e,s){return{type:"insn",mnemonic:t,p1:r,p2:e,loc:s}}function Fo(t,r,e){return{type:"data",values:r,dataSize:t,loc:e}}function Ro(t,r,e){return{type:"fill",numBytes:t,fillValue:r,loc:e}}function Bo(t,r,e){return{type:"literal",lit:t,ot:r,loc:e}}function jo(t,r){return{type:"register",value:t,loc:r}}function Uo(t,r,e){return{type:"qualified-ident",path:t,absolute:r,loc:e}}function Wo(t,r,e,s){return{type:"binary",op:t,left:r,right:e,loc:s}}var pe,dt=vo(()=>{(function(t){t[t.Byte=0]="Byte",t[t.Word=1]="Word"})(pe||(pe={}))});var kr=yr((ua,Er)=>{"use strict";function S(t){if(this.words=[],t)if(Symbol&&Symbol.iterator&&t[Symbol.iterator]!==void 0){let r=t[Symbol.iterator](),e=r.next();for(;!e.done;)this.add(e.value),e=r.next()}else for(let r=0;r<t.length;r++)this.add(t[r])}S.fromWords=function(t){let r=Object.create(S.prototype);return r.words=t,r};S.prototype.add=function(t){this.resize(t),this.words[t>>>5]|=1<<t};S.prototype.flip=function(t){this.resize(t),this.words[t>>>5]^=1<<t};S.prototype.clear=function(){this.words.length=0};S.prototype.remove=function(t){this.resize(t),this.words[t>>>5]&=~(1<<t)};S.prototype.isEmpty=function(t){let r=this.words.length;for(let e=0;e<r;e++)if(this.words[e]!==0)return!1;return!0};S.prototype.has=function(t){return(this.words[t>>>5]&1<<t)!==0};S.prototype.checkedAdd=function(t){this.resize(t);let r=this.words[t>>>5],e=r|1<<t;return this.words[t>>>5]=e,(e^r)>>>t};S.prototype.trim=function(t){let r=this.words.length;for(;r>0&&this.words[r-1]===0;)r--;this.words.length=r};S.prototype.resize=function(t){let r=t+32>>>5;for(let e=this.words.length;e<r;e++)this.words[e]=0};S.prototype.hammingWeight=function(t){return t-=t>>>1&1431655765,t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24};S.prototype.hammingWeight4=function(t,r,e,s){return t-=t>>>1&1431655765,r-=r>>>1&1431655765,e-=e>>>1&1431655765,s-=s>>>1&1431655765,t=(t&858993459)+(t>>>2&858993459),r=(r&858993459)+(r>>>2&858993459),e=(e&858993459)+(e>>>2&858993459),s=(s&858993459)+(s>>>2&858993459),t=t+(t>>>4)&252645135,r=r+(r>>>4)&252645135,e=e+(e>>>4)&252645135,s=s+(s>>>4)&252645135,(t+r+e+s)*16843009>>>24};S.prototype.size=function(){let t=0,r=this.words.length,e=this.words;for(let s=0;s<r;s++)t+=this.hammingWeight(e[s]);return t};S.prototype.array=function(){let t=new Array(this.size()),r=0,e=this.words.length;for(let s=0;s<e;++s){let n=this.words[s];for(;n!=0;){let c=n&-n;t[r++]=(s<<5)+this.hammingWeight(c-1|0),n^=c}}return t};S.prototype.forEach=function(t){let r=this.words.length;for(let e=0;e<r;++e){let s=this.words[e];for(;s!=0;){let n=s&-s;t((e<<5)+this.hammingWeight(n-1|0)),s^=n}}};S.prototype[Symbol.iterator]=function(){let t=this.words.length,r=0,e=this.words[r],s=this.hammingWeight,n=this.words;return{[Symbol.iterator](){return this},next(){for(;r<t;)if(e!==0){let c=e&-e,u=(r<<5)+s(c-1|0);return e^=c,{done:!1,value:u}}else r++,r<t&&(e=n[r]);return{done:!0,value:void 0}}}};S.prototype.clone=function(){let t=Object.create(S.prototype);return t.words=this.words.slice(),t};S.prototype.intersects=function(t){let r=Math.min(this.words.length,t.words.length);for(let e=0;e<r;++e)if((this.words[e]&t.words[e])!==0)return!0;return!1};S.prototype.intersection=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]&=t.words[e],this.words[e+1]&=t.words[e+1],this.words[e+2]&=t.words[e+2],this.words[e+3]&=t.words[e+3],this.words[e+4]&=t.words[e+4],this.words[e+5]&=t.words[e+5],this.words[e+6]&=t.words[e+6],this.words[e+7]&=t.words[e+7];for(;e<r;++e)this.words[e]&=t.words[e];let s=this.words.length;for(e=r;e<s;++e)this.words[e]=0;return this};S.prototype.intersection_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(let s=0;s<r;++s)e+=this.hammingWeight(this.words[s]&t.words[s]);return e};S.prototype.new_intersection=function(t){let r=Object.create(S.prototype),e=Math.min(this.words.length,t.words.length);r.words=new Array(e);let s=0;for(;s+7<e;s+=8)r.words[s]=this.words[s]&t.words[s],r.words[s+1]=this.words[s+1]&t.words[s+1],r.words[s+2]=this.words[s+2]&t.words[s+2],r.words[s+3]=this.words[s+3]&t.words[s+3],r.words[s+4]=this.words[s+4]&t.words[s+4],r.words[s+5]=this.words[s+5]&t.words[s+5],r.words[s+6]=this.words[s+6]&t.words[s+6],r.words[s+7]=this.words[s+7]&t.words[s+7];for(;s<e;++s)r.words[s]=this.words[s]&t.words[s];return r};S.prototype.equals=function(t){let r=Math.min(this.words.length,t.words.length);for(let e=0;e<r;++e)if(this.words[e]!=t.words[e])return!1;if(this.words.length<t.words.length){let e=t.words.length;for(let s=this.words.length;s<e;++s)if(t.words[s]!=0)return!1}else if(t.words.length<this.words.length){let e=this.words.length;for(let s=t.words.length;s<e;++s)if(this.words[s]!=0)return!1}return!0};S.prototype.difference=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]&=~t.words[e],this.words[e+1]&=~t.words[e+1],this.words[e+2]&=~t.words[e+2],this.words[e+3]&=~t.words[e+3],this.words[e+4]&=~t.words[e+4],this.words[e+5]&=~t.words[e+5],this.words[e+6]&=~t.words[e+6],this.words[e+7]&=~t.words[e+7];for(;e<r;++e)this.words[e]&=~t.words[e];return this};S.prototype.new_difference=function(t){return this.clone().difference(t)};S.prototype.difference2=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)t.words[e]=this.words[e]&~t.words[e],t.words[e+1]=this.words[e+1]&~t.words[e+1],t.words[e+2]=this.words[e+2]&~t.words[e+2],t.words[e+3]=this.words[e+3]&~t.words[e+3],t.words[e+4]=this.words[e+4]&~t.words[e+4],t.words[e+5]=this.words[e+5]&~t.words[e+5],t.words[e+6]=this.words[e+6]&~t.words[e+6],t.words[e+7]=this.words[e+7]&~t.words[e+7];for(;e<r;++e)t.words[e]=this.words[e]&~t.words[e];for(e=this.words.length-1;e>=r;--e)t.words[e]=this.words[e];return t.words.length=this.words.length,t};S.prototype.difference_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0,s=0;for(;s<r;++s)e+=this.hammingWeight(this.words[s]&~t.words[s]);let n=this.words.length;for(;s<n;++s)e+=this.hammingWeight(this.words[s]);return e};S.prototype.change=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]^=t.words[e],this.words[e+1]^=t.words[e+1],this.words[e+2]^=t.words[e+2],this.words[e+3]^=t.words[e+3],this.words[e+4]^=t.words[e+4],this.words[e+5]^=t.words[e+5],this.words[e+6]^=t.words[e+6],this.words[e+7]^=t.words[e+7];for(;e<r;++e)this.words[e]^=t.words[e];for(e=t.words.length-1;e>=r;--e)this.words[e]=t.words[e];return this};S.prototype.new_change=function(t){let r=Object.create(S.prototype),e=Math.max(this.words.length,t.words.length);r.words=new Array(e);let s=Math.min(this.words.length,t.words.length),n=0;for(;n+7<s;n+=8)r.words[n]=this.words[n]^t.words[n],r.words[n+1]=this.words[n+1]^t.words[n+1],r.words[n+2]=this.words[n+2]^t.words[n+2],r.words[n+3]=this.words[n+3]^t.words[n+3],r.words[n+4]=this.words[n+4]^t.words[n+4],r.words[n+5]=this.words[n+5]^t.words[n+5],r.words[n+6]=this.words[n+6]^t.words[n+6],r.words[n+7]=this.words[n+7]^t.words[n+7];for(;n<s;++n)r.words[n]=this.words[n]^t.words[n];let c=this.words.length;for(n=s;n<c;++n)r.words[n]=this.words[n];let u=t.words.length;for(n=s;n<u;++n)r.words[n]=t.words[n];return r};S.prototype.change_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0,s=0;for(;s<r;++s)e+=this.hammingWeight(this.words[s]^t.words[s]);let n=this.words.length>t.words.length?this:t,c=n.words.length;for(;s<c;++s)e+=this.hammingWeight(n.words[s]);return e};S.prototype.toString=function(){return"{"+this.array().join(",")+"}"};S.prototype.union=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]|=t.words[e],this.words[e+1]|=t.words[e+1],this.words[e+2]|=t.words[e+2],this.words[e+3]|=t.words[e+3],this.words[e+4]|=t.words[e+4],this.words[e+5]|=t.words[e+5],this.words[e+6]|=t.words[e+6],this.words[e+7]|=t.words[e+7];for(;e<r;++e)this.words[e]|=t.words[e];if(this.words.length<t.words.length){this.resize((t.words.length<<5)-1);let s=t.words.length;for(let n=r;n<s;++n)this.words[n]=t.words[n]}return this};S.prototype.new_union=function(t){let r=Object.create(S.prototype),e=Math.max(this.words.length,t.words.length);r.words=new Array(e);let s=Math.min(this.words.length,t.words.length),n=0;for(;n+7<s;n+=8)r.words[n]=this.words[n]|t.words[n],r.words[n+1]=this.words[n+1]|t.words[n+1],r.words[n+2]=this.words[n+2]|t.words[n+2],r.words[n+3]=this.words[n+3]|t.words[n+3],r.words[n+4]=this.words[n+4]|t.words[n+4],r.words[n+5]=this.words[n+5]|t.words[n+5],r.words[n+6]=this.words[n+6]|t.words[n+6],r.words[n+7]=this.words[n+7]|t.words[n+7];for(;n<s;++n)r.words[n]=this.words[n]|t.words[n];let c=this.words.length;for(n=s;n<c;++n)r.words[n]=this.words[n];let u=t.words.length;for(n=s;n<u;++n)r.words[n]=t.words[n];return r};S.prototype.union_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(let s=0;s<r;++s)e+=this.hammingWeight(this.words[s]|t.words[s]);if(this.words.length<t.words.length){let s=t.words.length;for(let n=this.words.length;n<s;++n)e+=this.hammingWeight(t.words[n]|0)}else{let s=this.words.length;for(let n=t.words.length;n<s;++n)e+=this.hammingWeight(this.words[n]|0)}return e};Er.exports=S});var _r=yr((da,Pr)=>{"use strict";function To(t,r){function e(){this.constructor=t}e.prototype=r.prototype,t.prototype=new e}function G(t,r,e,s){this.message=t,this.expected=r,this.found=e,this.location=s,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,G)}To(G,Error);G.buildMessage=function(t,r){var e={literal:function(g){return'"'+n(g.text)+'"'},class:function(g){var w="",v;for(v=0;v<g.parts.length;v++)w+=g.parts[v]instanceof Array?c(g.parts[v][0])+"-"+c(g.parts[v][1]):c(g.parts[v]);return"["+(g.inverted?"^":"")+w+"]"},any:function(g){return"any character"},end:function(g){return"end of input"},other:function(g){return g.description}};function s(g){return g.charCodeAt(0).toString(16).toUpperCase()}function n(g){return g.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(w){return"\\x0"+s(w)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(w){return"\\x"+s(w)})}function c(g){return g.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(w){return"\\x0"+s(w)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(w){return"\\x"+s(w)})}function u(g){return e[g.type](g)}function p(g){var w=new Array(g.length),v,L;for(v=0;v<g.length;v++)w[v]=u(g[v]);if(w.sort(),w.length>0){for(v=1,L=1;v<w.length;v++)w[v-1]!==w[v]&&(w[L]=w[v],L++);w.length=L}switch(w.length){case 1:return w[0];case 2:return w[0]+" or "+w[1];default:return w.slice(0,-1).join(", ")+", or "+w[w.length-1]}}function x(g){return g?'"'+n(g)+'"':"end of input"}return"Expected "+p(t)+" but "+x(r)+" found."};function Vo(t,r){r=r!==void 0?r:{};var e={},s={Lines:rr},n=rr,c=function(i,a){return P.mkProgram(Oe(i,a,1),_())},u=function(i){return i},p=function(i,a){return P.mkAsmLine(i,a,_())},x=function(i){return P.mkAsmLine(i,null,_())},g=function(i){return P.mkAsmLine(null,i,_())},w=function(i){return P.mkAsmLine(null,i,_())},v=function(){return P.mkAsmLine(null,null,_())},L=function(i){return i},A=function(i){return i},fe=B("directive"),Ze=function(i,a){let l=i=="byte"?P.DataSize.Byte:P.DataSize.Word;return P.mkData(l,a,_())},Bn=function(i,a){return P.mkFill(i,a,_())},jn=function(i,a){return Oe(i,a,3)},Un=function(i,a,l){return P.mkInsn(i,a,l,_())},Wn=function(i,a){return P.mkInsn(i,a,null,_())},Nn=function(i){return P.mkInsn(i,null,null,_())},Tn=function(i,a){return a.reduce(function(l,f){return P.mkBinaryOp(f[0],l,f[1],_())},i)},Vn=/^[a-zA-Z_]/,zn=T([["a","z"],["A","Z"],"_"],!1,!1),qn=/^[a-zA-Z_0-9]/,Hn=T([["a","z"],["A","Z"],"_",["0","9"]],!1,!1),zt=/^[0-9a-f]/i,qt=T([["0","9"],["a","f"]],!1,!0),Ht=/^[0-1]/,Gt=T([["0","1"]],!1,!1),Gn=/^[+\-]/,Xn=T(["+","-"],!1,!1),Xt=/^[0-9]/,Jt=T([["0","9"]],!1,!1),Ee=/^[a-z]/i,ke=T([["a","z"]],!1,!0),Zt=/^[0-9a-z_]/i,Yt=T([["0","9"],["a","z"],"_"],!1,!0),Jn="a",Zn=E("a",!0),Yn="b",Qn=E("b",!0),Kn="c",es=E("c",!0),ts="d",rs=E("d",!0),ns="g",ss=E("g",!0),is="h",os=E("h",!0),as="j",cs=E("j",!0),ls="m",us=E("m",!0),fs="o",ds=E("o",!0),hs="p",ps=E("p",!0),gs="r",ms=E("r",!0),ws="s",xs=E("s",!0),ys="x",vs=E("x",!0),bs="y",$s=E("y",!0),As="0",Cs=E("0",!1),Ss="1",Ls=E("1",!1),Es="2",ks=E("2",!1),Ps=",",_s=E(",",!1),Is=":",Ds=E(":",!1),Os="-",Ms=E("-",!1),Ye=function(i){return i},Fs="+",Rs=E("+",!1),Bs="\xA7",js=E("\xA7",!1),Us=";",Ws=E(";",!1),Ns="*",Ts=E("*",!1),Vs="dfb",zs=E("dfb",!0),qs=function(){return"byte"},Hs="dfs",Gs=E("dfs",!0),Xs="dfw",Js=E("dfw",!0),Zs=function(){return"word"},Ys=function(i){return parseInt(i,2)},Qs=function(i){return parseInt(i,16)},Ks=function(i){return parseInt(i)},Qe='"',Ke=E('"',!1),ei=function(i){return i.join("")},et=Bi(),ti=function(i){return i},Qt=function(){return Fi()},Kt=B("whitespace"),ri="	",ni=E("	",!1),si="\v",ii=E("\v",!1),oi="\f",ai=E("\f",!1),ci=" ",li=E(" ",!1),ui="\xA0",fi=E("\xA0",!1),di="\uFEFF",hi=E("\uFEFF",!1),pi=B("end of line"),gi=/^[\n\r]/,mi=T([`
`,"\r"],!1,!1),wi=B("comment"),xi=B("label"),yi=function(i){return P.mkLabel(i,_())},vi=B("ORG"),bi=function(i){return P.mkSetPC(i,_())},$i=B("mnemonic"),Ai=B("literal"),Ci=function(i){return P.mkLiteral(i,"b",_())},Si=function(i){return P.mkLiteral(i,"h",_())},Li=function(i){return P.mkLiteral(i,"d",_())},Ei=function(i){return P.mkLiteral(i,"s",_())},ki=B("identifier"),W="::",de=E("::",!1),Pi=function(i,a){return P.mkScopeQualifiedIdent(Oe(i,a,1),!1,_())},_i=function(i,a){return P.mkScopeQualifiedIdent(Oe(i,a,1),!0,_())},Ii=B("register"),Di=function(i){return P.mkRegister(i.toLowerCase(),_())},Oi=B("current-pc"),Mi=function(){return P.mkGetCurPC(_())},o=0,$=0,Pe=[{line:1,column:1}],N=0,tt=[],m=0,_e;if("startRule"in r){if(!(r.startRule in s))throw new Error(`Can't start parsing from rule "`+r.startRule+'".');n=s[r.startRule]}function Fi(){return t.substring($,o)}function Ri(){return he($,o)}function na(i,a){throw a=a!==void 0?a:he($,o),tr([B(i)],t.substring($,o),a)}function sa(i,a){throw a=a!==void 0?a:he($,o),Ui(i,a)}function E(i,a){return{type:"literal",text:i,ignoreCase:a}}function T(i,a,l){return{type:"class",parts:i,inverted:a,ignoreCase:l}}function Bi(){return{type:"any"}}function ji(){return{type:"end"}}function B(i){return{type:"other",description:i}}function er(i){var a=Pe[i],l;if(a)return a;for(l=i-1;!Pe[l];)l--;for(a=Pe[l],a={line:a.line,column:a.column};l<i;)t.charCodeAt(l)===10?(a.line++,a.column=1):a.column++,l++;return Pe[i]=a,a}function he(i,a){var l=er(i),f=er(a);return{start:{offset:i,line:l.line,column:l.column},end:{offset:a,line:f.line,column:f.column}}}function y(i){o<N||(o>N&&(N=o,tt=[]),tt.push(i))}function Ui(i,a){return new G(i,null,null,a)}function tr(i,a,l){return new G(G.buildMessage(i,a),i,a,l)}function rr(){var i,a,l,f,h,b;if(i=o,a=rt(),a!==e){for(l=[],f=o,h=De(),h!==e?(b=rt(),b!==e?(h=[h,b],f=h):(o=f,f=e)):(o=f,f=e);f!==e;)l.push(f),f=o,h=De(),h!==e?(b=rt(),b!==e?(h=[h,b],f=h):(o=f,f=e)):(o=f,f=e);l!==e?($=i,a=c(a,l),i=a):(o=i,i=e)}else o=i,i=e;return i}function rt(){var i,a,l,f,h;return i=o,a=I(),a!==e?(l=Wi(),l!==e?(f=I(),f!==e?(h=uo(),h===e&&(h=null),h!==e?($=i,a=u(l),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),i}function Wi(){var i,a,l,f;return i=o,a=wr(),a!==e?(l=I(),l!==e?(f=nr(),f!==e?($=i,a=p(a,f),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),i===e&&(i=o,a=wr(),a!==e&&($=i,a=x(a)),i=a,i===e&&(i=o,a=fo(),a!==e&&($=i,a=g(a)),i=a,i===e&&(i=o,a=nr(),a!==e&&($=i,a=w(a)),i=a,i===e&&(i=o,a=I(),a!==e&&($=i,a=v()),i=a)))),i}function nr(){var i,a;return i=o,a=Ni(),a!==e&&($=i,a=L(a)),i=a,i===e&&(i=o,a=Vi(),a!==e&&($=i,a=A(a)),i=a),i}function Ni(){var i,a,l,f,h,b,D,F;return m++,i=o,a=no(),a===e&&(a=io()),a!==e?(l=I(),l!==e?(f=Ti(),f!==e?($=i,a=Ze(a,f),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),i===e&&(i=o,a=so(),a!==e?(l=I(),l!==e?(f=V(),f!==e?(h=I(),h!==e?(b=Ie(),b!==e?(D=I(),D!==e?(F=V(),F!==e?($=i,a=Bn(f,F),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)),m--,i===e&&(a=e,m===0&&y(fe)),i}function Ti(){var i,a,l,f,h,b,D,F;if(i=o,a=V(),a!==e){for(l=[],f=o,h=I(),h!==e?(b=Ie(),b!==e?(D=I(),D!==e?(F=V(),F!==e?(h=[h,b,D,F],f=h):(o=f,f=e)):(o=f,f=e)):(o=f,f=e)):(o=f,f=e);f!==e;)l.push(f),f=o,h=I(),h!==e?(b=Ie(),b!==e?(D=I(),D!==e?(F=V(),F!==e?(h=[h,b,D,F],f=h):(o=f,f=e)):(o=f,f=e)):(o=f,f=e)):(o=f,f=e);l!==e?($=i,a=jn(a,l),i=a):(o=i,i=e)}else o=i,i=e;return i}function Vi(){var i,a,l,f,h,b,D,F;return i=o,a=ct(),a!==e?(l=I(),l!==e?(f=V(),f!==e?(h=I(),h!==e?(b=Ie(),b!==e?(D=I(),D!==e?(F=V(),F!==e?($=i,a=Un(a,f,F),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),i===e&&(i=o,a=ct(),a!==e?(l=I(),l!==e?(f=V(),f!==e?($=i,a=Wn(a,f),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),i===e&&(i=o,a=ct(),a!==e&&($=i,a=Nn(a)),i=a)),i}function V(){var i,a,l,f,h,b;if(i=o,a=nt(),a!==e){for(l=[],f=o,h=hr(),h===e&&(h=dr(),h===e&&(h=pr())),h!==e?(b=nt(),b!==e?(h=[h,b],f=h):(o=f,f=e)):(o=f,f=e);f!==e;)l.push(f),f=o,h=hr(),h===e&&(h=dr(),h===e&&(h=pr())),h!==e?(b=nt(),b!==e?(h=[h,b],f=h):(o=f,f=e)):(o=f,f=e);l!==e?($=i,a=Tn(a,l),i=a):(o=i,i=e)}else o=i,i=e;return i}function nt(){var i;return i=xr(),i===e&&(i=po(),i===e&&(i=ho(),i===e&&(i=go()))),i}function st(){var i;return Vn.test(t.charAt(o))?(i=t.charAt(o),o++):(i=e,m===0&&y(zn)),i}function sr(){var i;return qn.test(t.charAt(o))?(i=t.charAt(o),o++):(i=e,m===0&&y(Hn)),i}function zi(){var i,a;if(i=[],zt.test(t.charAt(o))?(a=t.charAt(o),o++):(a=e,m===0&&y(qt)),a!==e)for(;a!==e;)i.push(a),zt.test(t.charAt(o))?(a=t.charAt(o),o++):(a=e,m===0&&y(qt));else i=e;return i}function qi(){var i,a;if(i=[],Ht.test(t.charAt(o))?(a=t.charAt(o),o++):(a=e,m===0&&y(Gt)),a!==e)for(;a!==e;)i.push(a),Ht.test(t.charAt(o))?(a=t.charAt(o),o++):(a=e,m===0&&y(Gt));else i=e;return i}function Hi(){var i,a,l,f;if(i=o,Gn.test(t.charAt(o))?(a=t.charAt(o),o++):(a=e,m===0&&y(Xn)),a===e&&(a=null),a!==e){if(l=[],Xt.test(t.charAt(o))?(f=t.charAt(o),o++):(f=e,m===0&&y(Jt)),f!==e)for(;f!==e;)l.push(f),Xt.test(t.charAt(o))?(f=t.charAt(o),o++):(f=e,m===0&&y(Jt));else l=e;l!==e?(a=[a,l],i=a):(o=i,i=e)}else o=i,i=e;return i}function Gi(){var i,a,l,f;if(i=o,a=[],Ee.test(t.charAt(o))?(l=t.charAt(o),o++):(l=e,m===0&&y(ke)),l!==e)for(;l!==e;)a.push(l),Ee.test(t.charAt(o))?(l=t.charAt(o),o++):(l=e,m===0&&y(ke));else a=e;if(a!==e){for(l=[],Zt.test(t.charAt(o))?(f=t.charAt(o),o++):(f=e,m===0&&y(Yt));f!==e;)l.push(f),Zt.test(t.charAt(o))?(f=t.charAt(o),o++):(f=e,m===0&&y(Yt));l!==e?(a=[a,l],i=a):(o=i,i=e)}else o=i,i=e;return i}function ir(){var i;return t.substr(o,1).toLowerCase()===Jn?(i=t.charAt(o),o++):(i=e,m===0&&y(Zn)),i}function or(){var i;return t.substr(o,1).toLowerCase()===Yn?(i=t.charAt(o),o++):(i=e,m===0&&y(Qn)),i}function ar(){var i;return t.substr(o,1).toLowerCase()===Kn?(i=t.charAt(o),o++):(i=e,m===0&&y(es)),i}function cr(){var i;return t.substr(o,1).toLowerCase()===ts?(i=t.charAt(o),o++):(i=e,m===0&&y(rs)),i}function Xi(){var i;return t.substr(o,1).toLowerCase()===ns?(i=t.charAt(o),o++):(i=e,m===0&&y(ss)),i}function ia(){var i;return t.substr(o,1).toLowerCase()===is?(i=t.charAt(o),o++):(i=e,m===0&&y(os)),i}function it(){var i;return t.substr(o,1).toLowerCase()===as?(i=t.charAt(o),o++):(i=e,m===0&&y(cs)),i}function ot(){var i;return t.substr(o,1).toLowerCase()===ls?(i=t.charAt(o),o++):(i=e,m===0&&y(us)),i}function Ji(){var i;return t.substr(o,1).toLowerCase()===fs?(i=t.charAt(o),o++):(i=e,m===0&&y(ds)),i}function Zi(){var i;return t.substr(o,1).toLowerCase()===hs?(i=t.charAt(o),o++):(i=e,m===0&&y(ps)),i}function Yi(){var i;return t.substr(o,1).toLowerCase()===gs?(i=t.charAt(o),o++):(i=e,m===0&&y(ms)),i}function Qi(){var i;return t.substr(o,1).toLowerCase()===ws?(i=t.charAt(o),o++):(i=e,m===0&&y(xs)),i}function at(){var i;return t.substr(o,1).toLowerCase()===ys?(i=t.charAt(o),o++):(i=e,m===0&&y(vs)),i}function lr(){var i;return t.substr(o,1).toLowerCase()===bs?(i=t.charAt(o),o++):(i=e,m===0&&y($s)),i}function Ki(){var i;return t.charCodeAt(o)===48?(i=As,o++):(i=e,m===0&&y(Cs)),i}function ur(){var i;return t.charCodeAt(o)===49?(i=Ss,o++):(i=e,m===0&&y(Ls)),i}function fr(){var i;return t.charCodeAt(o)===50?(i=Es,o++):(i=e,m===0&&y(ks)),i}function Ie(){var i;return t.charCodeAt(o)===44?(i=Ps,o++):(i=e,m===0&&y(_s)),i}function eo(){var i;return t.charCodeAt(o)===58?(i=Is,o++):(i=e,m===0&&y(Ds)),i}function dr(){var i,a,l;return i=o,t.charCodeAt(o)===45?(a=Os,o++):(a=e,m===0&&y(Ms)),a!==e?(l=I(),l!==e?($=i,a=Ye(a),i=a):(o=i,i=e)):(o=i,i=e),i}function hr(){var i,a,l;return i=o,t.charCodeAt(o)===43?(a=Fs,o++):(a=e,m===0&&y(Rs)),a!==e?(l=I(),l!==e?($=i,a=Ye(a),i=a):(o=i,i=e)):(o=i,i=e),i}function pr(){var i,a,l;return i=o,t.charCodeAt(o)===167?(a=Bs,o++):(a=e,m===0&&y(js)),a!==e?(l=I(),l!==e?($=i,a=Ye(a),i=a):(o=i,i=e)):(o=i,i=e),i}function to(){var i;return t.charCodeAt(o)===59?(i=Us,o++):(i=e,m===0&&y(Ws)),i}function ro(){var i;return t.charCodeAt(o)===42?(i=Ns,o++):(i=e,m===0&&y(Ts)),i}function no(){var i,a;return i=o,t.substr(o,3).toLowerCase()===Vs?(a=t.substr(o,3),o+=3):(a=e,m===0&&y(zs)),a!==e&&($=i,a=qs()),i=a,i}function so(){var i;return t.substr(o,3).toLowerCase()===Hs?(i=t.substr(o,3),o+=3):(i=e,m===0&&y(Gs)),i}function io(){var i,a;return i=o,t.substr(o,3).toLowerCase()===Xs?(a=t.substr(o,3),o+=3):(a=e,m===0&&y(Js)),a!==e&&($=i,a=Zs()),i=a,i}function oo(){var i,a,l;return i=o,a=o,l=qi(),l!==e?a=t.substring(a,o):a=l,a!==e?(l=or(),l!==e?($=i,a=Ys(a),i=a):(o=i,i=e)):(o=i,i=e),i}function ao(){var i,a,l,f,h;return i=o,a=Ki(),a!==e?(l=at(),l!==e?(f=o,h=zi(),h!==e?f=t.substring(f,o):f=h,f!==e?($=i,a=Qs(f),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),i}function co(){var i,a,l;return i=o,a=o,l=Hi(),l!==e?a=t.substring(a,o):a=l,a!==e?(l=cr(),l===e&&(l=null),l!==e?($=i,a=Ks(a),i=a):(o=i,i=e)):(o=i,i=e),i}function lo(){var i,a,l,f;if(i=o,t.charCodeAt(o)===34?(a=Qe,o++):(a=e,m===0&&y(Ke)),a!==e){for(l=[],f=gr();f!==e;)l.push(f),f=gr();l!==e?(t.charCodeAt(o)===34?(f=Qe,o++):(f=e,m===0&&y(Ke)),f!==e?($=i,a=ei(l),i=a):(o=i,i=e)):(o=i,i=e)}else o=i,i=e;return i}function gr(){var i,a,l;return i=o,a=o,m++,t.charCodeAt(o)===34?(l=Qe,o++):(l=e,m===0&&y(Ke)),m--,l===e?a=void 0:(o=a,a=e),a!==e?(t.length>o?(l=t.charAt(o),o++):(l=e,m===0&&y(et)),l!==e?($=i,a=ti(l),i=a):(o=i,i=e)):(o=i,i=e),i}function ee(){var i,a,l,f,h;if(i=o,a=o,l=[],f=st(),f!==e)for(;f!==e;)l.push(f),f=st();else l=e;if(l!==e){for(f=[],h=sr();h!==e;)f.push(h),h=sr();f!==e?(l=[l,f],a=l):(o=a,a=e)}else o=a,a=e;return a!==e&&($=i,a=Qt()),i=a,i}function I(){var i,a;for(m++,i=[],a=mr();a!==e;)i.push(a),a=mr();return m--,i===e&&(a=e,m===0&&y(Kt)),i}function mr(){var i,a;return m++,t.charCodeAt(o)===9?(i=ri,o++):(i=e,m===0&&y(ni)),i===e&&(t.charCodeAt(o)===11?(i=si,o++):(i=e,m===0&&y(ii)),i===e&&(t.charCodeAt(o)===12?(i=oi,o++):(i=e,m===0&&y(ai)),i===e&&(t.charCodeAt(o)===32?(i=ci,o++):(i=e,m===0&&y(li)),i===e&&(t.charCodeAt(o)===160?(i=ui,o++):(i=e,m===0&&y(fi)),i===e&&(t.charCodeAt(o)===65279?(i=di,o++):(i=e,m===0&&y(hi))))))),m--,i===e&&(a=e,m===0&&y(Kt)),i}function De(){var i,a;return m++,gi.test(t.charAt(o))?(i=t.charAt(o),o++):(i=e,m===0&&y(mi)),m--,i===e&&(a=e,m===0&&y(pi)),i}function uo(){var i,a,l,f,h,b;if(m++,i=o,a=to(),a!==e){for(l=[],f=o,h=o,m++,b=De(),m--,b===e?h=void 0:(o=h,h=e),h!==e?(t.length>o?(b=t.charAt(o),o++):(b=e,m===0&&y(et)),b!==e?(h=[h,b],f=h):(o=f,f=e)):(o=f,f=e);f!==e;)l.push(f),f=o,h=o,m++,b=De(),m--,b===e?h=void 0:(o=h,h=e),h!==e?(t.length>o?(b=t.charAt(o),o++):(b=e,m===0&&y(et)),b!==e?(h=[h,b],f=h):(o=f,f=e)):(o=f,f=e);l!==e?(a=[a,l],i=a):(o=i,i=e)}else o=i,i=e;return m--,i===e&&(a=e,m===0&&y(wi)),i}function wr(){var i,a,l;return m++,i=o,a=o,l=Gi(),l!==e?a=t.substring(a,o):a=l,a!==e?(l=eo(),l!==e?($=i,a=yi(a),i=a):(o=i,i=e)):(o=i,i=e),m--,i===e&&(a=e,m===0&&y(xi)),i}function fo(){var i,a,l,f,h,b;return m++,i=o,a=Ji(),a!==e?(l=Yi(),l!==e?(f=Xi(),f!==e?(h=I(),h!==e?(b=xr(),b!==e?($=i,a=bi(b),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),m--,i===e&&(a=e,m===0&&y(vi)),i}function ct(){var i,a,l;if(m++,i=o,a=[],Ee.test(t.charAt(o))?(l=t.charAt(o),o++):(l=e,m===0&&y(ke)),l!==e)for(;l!==e;)a.push(l),Ee.test(t.charAt(o))?(l=t.charAt(o),o++):(l=e,m===0&&y(ke));else a=e;return a!==e&&($=i,a=Qt()),i=a,m--,i===e&&(a=e,m===0&&y($i)),i}function xr(){var i,a;return m++,i=o,a=oo(),a!==e&&($=i,a=Ci(a)),i=a,i===e&&(i=o,a=ao(),a!==e&&($=i,a=Si(a)),i=a,i===e&&(i=o,a=co(),a!==e&&($=i,a=Li(a)),i=a,i===e&&(i=o,a=lo(),a!==e&&($=i,a=Ei(a)),i=a))),m--,i===e&&(a=e,m===0&&y(Ai)),i}function ho(){var i,a,l,f,h,b,D;if(m++,i=o,a=ee(),a!==e){for(l=[],f=o,t.substr(o,2)===W?(h=W,o+=2):(h=e,m===0&&y(de)),h!==e?(b=ee(),b!==e?(h=[h,b],f=h):(o=f,f=e)):(o=f,f=e);f!==e;)l.push(f),f=o,t.substr(o,2)===W?(h=W,o+=2):(h=e,m===0&&y(de)),h!==e?(b=ee(),b!==e?(h=[h,b],f=h):(o=f,f=e)):(o=f,f=e);l!==e?($=i,a=Pi(a,l),i=a):(o=i,i=e)}else o=i,i=e;if(i===e)if(i=o,t.substr(o,2)===W?(a=W,o+=2):(a=e,m===0&&y(de)),a!==e)if(l=ee(),l!==e){for(f=[],h=o,t.substr(o,2)===W?(b=W,o+=2):(b=e,m===0&&y(de)),b!==e?(D=ee(),D!==e?(b=[b,D],h=b):(o=h,h=e)):(o=h,h=e);h!==e;)f.push(h),h=o,t.substr(o,2)===W?(b=W,o+=2):(b=e,m===0&&y(de)),b!==e?(D=ee(),D!==e?(b=[b,D],h=b):(o=h,h=e)):(o=h,h=e);f!==e?($=i,a=_i(l,f),i=a):(o=i,i=e)}else o=i,i=e;else o=i,i=e;return m--,i===e&&(a=e,m===0&&y(ki)),i}function po(){var i,a,l,f,h;return m++,i=o,a=o,l=o,f=ir(),f!==e?(h=Qi(),h!==e?(f=[f,h],l=f):(o=l,l=e)):(o=l,l=e),l===e&&(l=ir(),l===e&&(l=or(),l===e&&(l=ar(),l===e&&(l=cr(),l===e&&(l=o,f=ot(),f!==e?(h=fr(),h!==e?(f=[f,h],l=f):(o=l,l=e)):(o=l,l=e),l===e&&(l=o,f=ot(),f!==e?(h=ur(),h!==e?(f=[f,h],l=f):(o=l,l=e)):(o=l,l=e),l===e&&(l=ot(),l===e&&(l=o,f=Zi(),f!==e?(h=ar(),h!==e?(f=[f,h],l=f):(o=l,l=e)):(o=l,l=e),l===e&&(l=o,f=at(),f!==e?(h=lr(),h!==e?(f=[f,h],l=f):(o=l,l=e)):(o=l,l=e),l===e&&(l=at(),l===e&&(l=lr(),l===e&&(l=o,f=it(),f!==e?(h=ur(),h!==e?(f=[f,h],l=f):(o=l,l=e)):(o=l,l=e),l===e&&(l=o,f=it(),f!==e?(h=fr(),h!==e?(f=[f,h],l=f):(o=l,l=e)):(o=l,l=e),l===e&&(l=it())))))))))))))),l!==e?a=t.substring(a,o):a=l,a!==e?(l=o,m++,f=st(),m--,f===e?l=void 0:(o=l,l=e),l!==e?($=i,a=Di(a),i=a):(o=i,i=e)):(o=i,i=e),m--,i===e&&(a=e,m===0&&y(Ii)),i}function go(){var i,a;return m++,i=o,a=ro(),a!==e&&($=i,a=Mi()),i=a,m--,i===e&&(a=e,m===0&&y(Oi)),i}var P=(dt(),br(ft));function mo(i,a){return i.map(function(l){return l[a]})}function Oe(i,a,l){return[i].concat(mo(a,l))}function _(){return{...Ri()}}if(_e=n(),_e!==e&&o===t.length)return _e;throw _e!==e&&o<t.length&&y(ji()),tr(tt,N<t.length?t.charAt(N):null,N<t.length?he(N,N+1):he(N,N))}Pr.exports={SyntaxError:G,parse:Vo}});var ra={};vr(ra,{RCASMWorker:()=>Je,create:()=>ta});var z={a:0,d:1},$o={a:0,d:1},Ao={a:0,b:1},Co={m:0,j:1},ut={a:0,b:1,c:2,d:3,m1:4,m2:5,x:6,y:7},So={xy:0,pc:1},Lo={m:0,xy:1,j:2,as:3},Eo={xy:1},$r={a:0,b:1,c:2,d:3},C;(function(t){t[t.Direct=0]="Direct",t[t.Alu=1]="Alu",t[t.Clear=2]="Clear",t[t.Goto=3]="Goto",t[t.LodSw=4]="LodSw",t[t.LitOpc=5]="LitOpc",t[t.Move=6]="Move",t[t.Set=7]="Set",t[t.LoadStore=8]="LoadStore"})(C||(C={}));var Ar={add:{mt:C.Alu,ops:[{op:129,p1:{cs:z,op:t=>t<<3},p2:null}]},inc:{mt:C.Alu,ops:[{op:130,p1:{cs:z,op:t=>t<<3},p2:null}]},and:{mt:C.Alu,ops:[{op:131,p1:{cs:z,op:t=>t<<3},p2:null}]},orr:{mt:C.Alu,ops:[{op:132,p1:{cs:z,op:t=>t<<3},p2:null}]},eor:{mt:C.Alu,ops:[{op:133,p1:{cs:z,op:t=>t<<3},p2:null}]},cmp:{mt:C.Alu,ops:[{op:133,p1:{cs:z,op:t=>t<<3},p2:null}]},not:{mt:C.Alu,ops:[{op:134,p1:{cs:z,op:t=>t<<3},p2:null}]},rol:{mt:C.Alu,ops:[{op:135,p1:{cs:z,op:t=>t<<3},p2:null}]},mov:{mt:C.Move,ops:[{op:0,p1:{cs:ut,op:t=>t<<3},p2:{cs:ut,op:t=>t}},{op:160,p1:{cs:So,op:t=>t<<2},p2:{cs:Lo,op:t=>t}}]},clr:{mt:C.Clear,ops:[{op:0,p1:{cs:ut,op:t=>t<<3|t},p2:null},{op:160,p1:{cs:Eo,op:t=>t},p2:null}]},rts:{mt:C.Direct,ops:[{op:165,p1:null,p2:null}]},ldr:{mt:C.LoadStore,ops:[{op:144,p1:{cs:$r,op:t=>t},p2:null}]},str:{mt:C.LoadStore,ops:[{op:152,p1:{cs:$r,op:t=>t},p2:null}]},ldi:{mt:C.Set,ops:[{op:64,p1:{cs:Ao,op:t=>t<<5},p2:{cs:null,op:t=>t&31}},{op:192,p1:{cs:Co,op:t=>t<<5},p2:null}]},hlt:{mt:C.Direct,ops:[{op:174,p1:null,p2:null}]},hlr:{mt:C.Direct,ops:[{op:175,p1:null,p2:null}]},lds:{mt:C.LodSw,ops:[{op:172,p1:{cs:$o,op:t=>t},p2:null}]},ixy:{mt:C.Direct,ops:[{op:176,p1:null,p2:null}]},jmp:{mt:C.Goto,ops:[{op:230,p1:null,p2:null}]},jsr:{mt:C.Goto,ops:[{op:231,p1:null,p2:null}]},bne:{mt:C.Goto,ops:[{op:226,p1:null,p2:null}]},beq:{mt:C.Goto,ops:[{op:228,p1:null,p2:null}]},bcs:{mt:C.Goto,ops:[{op:232,p1:null,p2:null}]},bmi:{mt:C.Goto,ops:[{op:240,p1:null,p2:null}]},blt:{mt:C.Goto,ops:[{op:240,p1:null,p2:null}]},ble:{mt:C.Goto,ops:[{op:244,p1:null,p2:null}]},opc:{mt:C.LitOpc,ops:[{op:0,p1:{cs:null,op:t=>t},p2:null}]}};function R(t){return t.toString(16).padStart(4,"0")}dt();var te=class{constructor(r,e,s,n){this.start=r,this.end=e,this.inferStart=s,this.id=n,this.blocks=[{start:r,binary:[]}],this.curBlock=this.blocks[0]}setCurrentPC(r){let e;if(this.inferStart&&this.blocks.length===1&&this.blocks[0].binary.length===0)this.start=r;else{let c=this.end!==void 0?`$${R(this.end)}`:"",u=`Segment address range: $${R(this.start)}-${c}`;r<this.start?e=`${u}.  Cannot set program counter to a lower address $${R(r)}.`:this.end!==void 0&&r>this.end?e=`${u}.  Trying to set program counter to $${R(r)} -- it is past segment end ${c}.`:this.blocks.length===1&&this.blocks[0].binary.length===0&&(this.start=r)}let s={start:r,binary:[]},n=this.blocks.push(s);return this.curBlock=this.blocks[n-1],e}empty(){return this.blocks.every(r=>r.binary.length===0)}currentPC(){return this.curBlock.start+this.curBlock.binary.length}emit(r){if(this.currentPC()<this.start||this.end!==void 0&&this.currentPC()>this.end){let e=this.end!==void 0?`$${R(this.end)}`:"",s=this.start!==void 0?`$${R(this.start)}`:"";return`Segment overflow at $${R(this.currentPC())}.  Segment address range: ${s}-${e}`}this.curBlock.binary.push(r)}formatRange(){let r=this.end!==void 0?`$${R(this.end)}`:"";return`${this.start!==void 0?`$${R(this.start)}`:""}-${r}`}overlaps(r){let e=this.start,s=r.start,n=this.end!==void 0?this.end:this.currentPC(),c=r.end!==void 0?r.end:r.currentPC();return e<s?s<=n:c>=e}};function Cr(t){let r=[];for(let[e,s]of t){let n=s.blocks.filter(c=>c.binary.length!==0).sort((c,u)=>c.start-u.start);if(n.length!==0){let c=new te(s.start,s.end,s.inferStart,r.length-1);c.blocks=n,c.curBlock=n[n.length-1],r.push([e,c])}}return r}function Sr(t){let r=Cr(t);if(r.length===0)return{startPC:0,binary:Uint8Array.from([])};let[,e]=r[0],s=e.blocks[0],n=e.blocks[e.blocks.length-1],c=s.start,u=n.start+n.binary.length;for(let x=1;x<r.length;x++){let g=r[x][1],w=g.blocks[0].start,v=g.curBlock.start+g.curBlock.binary.length;c=Math.min(w,c),u=Math.max(v,u)}let p=new Uint8Array(u);for(let[,x]of r)for(let g of x.blocks)for(let w=0;w<g.binary.length;w++)p[g.start+w]=g.binary[w];return{startPC:c,binary:p.slice(c)}}function Lr(t){return Cr(t).sort((e,s)=>e[1].start-s[1].start).map(([e,s])=>{let n=s.blocks.map(c=>({start:c.start,end:c.start+c.binary.length-1}));return{name:e,blocks:n}})}var No=kr(),ge=class{constructor(){this.lineStack=[],this.pcToLocs={},this.insnBitset=new No}startLine(r,e,s){let n={lineNo:r.start.line,segmentId:s.id,numBytes:0};this.lineStack.push({loc:n,pc:e,segmentId:s.id})}endLine(r,e){let s=this.lineStack.pop();if(!s)throw new Error("internal compiler error, mismatching start/end lines in debugInfo");let n=r-s.pc;if(n>0&&e.id===s.segmentId){let c={...s.loc,numBytes:n};this.pcToLocs[s.pc]===void 0?this.pcToLocs[s.pc]=[c]:this.pcToLocs[s.pc].push(c)}}markAsInstruction(r,e){for(let s=r;s<e;s++)this.insnBitset.add(s)}info(){let r=this.insnBitset.clone(),e=s=>r.has(s);return{pcToLocs:this.pcToLocs,isInstruction:e}}};var Ir=_r();function X(t){return{value:t,errors:!0,completeFirstPass:!1}}function re(t,r){return{value:t,errors:!1,completeFirstPass:r}}function J(...t){return t.some(r=>r!==void 0&&r.errors)}function zo(...t){return t.every(r=>r!==void 0&&r.completeFirstPass)}var pt=class{constructor(r,e){this.syms=new Map,this.parent=null,this.children=new Map,this.parent=r,this.name=e}findSymbol(r){for(let e=this;e!==null;e=e.parent){let s=e.syms.get(r);if(s!==void 0)return s}}findSymbolPath(r){if(r.length===1)return this.findSymbol(r[0]);let e=this;for(;e.children.get(r[0])===void 0;)if(e=e.parent,e===null)return;for(let s=0;s<r.length-1;s++)if(e=e.children.get(r[s]),e===void 0)return;return e.syms.get(r[r.length-1])}addSymbol(r,e,s){this.syms.set(r,{...e,seen:s})}updateSymbol(r,e,s){for(let n=this;n!==null;n=n.parent)if(n.syms.get(r)!==void 0){n.syms.set(r,{...e,seen:s});return}}},gt=class{constructor(){this.passCount=0,this.root=new pt(null,""),this.curSymtab=this.root,this.anonScopeCount=0}startPass(r){this.curSymtab=this.root,this.anonScopeCount=0,this.passCount=r}findPath(r,e){return e?this.root.findSymbolPath(r):this.curSymtab.findSymbolPath(r)}findQualifiedSym(r,e){return this.findPath(r,e)}symbolSeen(r){let e=this.curSymtab.syms.get(r);return e!==void 0?e.seen===this.passCount:!1}declareLabelSymbol(r,e,s){let{name:n,loc:c}=r,u=this.curSymtab.syms.get(n);if(u===void 0){let x={type:"label",segment:s,data:re({addr:e,loc:c},!1)};return this.curSymtab.addSymbol(n,x,this.passCount),!1}if(u.type!=="label")throw new Error("ICE: declareLabelSymbol should be called only on labels");if(u.data.value.addr!==e){let x={type:"label",segment:s,data:{...u.data,value:{...u.data.value,addr:e}}};return this.curSymtab.updateSymbol(n,x,this.passCount),!0}return this.curSymtab.updateSymbol(n,u,this.passCount),!1}dumpLabels(r,e){let s={};for(let[g,w]of e)s[w.id]=g;let n=[],c=(g,w)=>{if(g!==void 0){let v=[...g,w.name];n.push({path:v,sym:w})}else n.push({path:[],sym:w})};c(void 0,this.root);let u=[];for(;n.length>0;){let g=n.pop();if(g){for(let[w,v]of g.sym.syms)v.type==="label"&&u.push({path:[...g.path,w],addr:v.data.value.addr,size:0,segmentName:s[v.segment.id]});for(let[,w]of g.sym.children)c(g.path,w)}}let p=u.sort((g,w)=>g.addr-w.addr),x=p.length;if(x>0){for(let w=1;w<x;w++)p[w-1].size=p[w].addr-p[w-1].addr;let g=p[x-1];g.size=r-g.addr}return p.map(({path:g,addr:w,size:v,segmentName:L})=>({name:g.join("::"),addr:w,size:v,segmentName:L}))}};function Z(t){let r=typeof t;return r==="object"&&t instanceof Array?"array":r}function qo(t){return`${t.absolute?"::":""}${t.path.join("::")}`}var ht=(t,r,e)=>{let s=e(t.value,r.value),n=zo(t,r);return re(typeof s=="boolean"?s?1:0:s,n)},mt=class{constructor(){this.curSegmentName="",this.curSegment=new te(0,0,!1,0),this.pass=0,this.needPass=!1,this.scopes=new gt,this.segments=[],this.errorList=[],this.warningList=[],this.debugInfo=new ge,this.errors=()=>this.formatErrors(this.errorList,"error"),this.warnings=()=>this.formatErrors(this.warningList,"warning")}prg(){let{startPC:r,binary:e}=Sr(this.segments),s=r&255,n=r>>8&255;return Uint8Array.from([s,n,...e])}anyErrors(){return this.errorList.length!==0}formatErrors(r,e){return[...new Set(r.map(n=>JSON.stringify(n)))].map(n=>{let{loc:c,msg:u}=JSON.parse(n),p=`<unknown>:1:1: ${e}: ${u}`;return c&&(p=`${c.start.line}:${c.start.column}: ${e}: ${u}`),{loc:c,msg:u,formatted:p}})}addError(r,e){this.errorList.push({msg:r,loc:e})}addWarning(r,e){this.warningList.push({msg:r,loc:e})}startPass(r){this.pass=r,this.needPass=!1,this.errorList=[],this.scopes.startPass(r),this.debugInfo=new ge,this.segments=[];let e=this.newSegment("default",0,void 0,!0);this.setCurrentSegment({type:"segment",data:e},"default")}setCurrentSegment(r,e){this.curSegmentName=e,this.curSegment=r.data}newSegment(r,e,s,n){let c=new te(e,s,n,this.segments.length-1);return this.segments.push([r,c]),c}getPC(){return this.curSegment.currentPC()}evalExprType(r,e,s){let n=this.evalExpr(r),{errors:c,value:u,completeFirstPass:p}=n;return!c&&typeof u!==e?(this.addError(`Expecting ${s} to be '${e}' type, got '${Z(u)}'`,r.loc),{errors:!0,completeFirstPass:p,value:u}):n}evalExprToInt(r,e){return this.evalExprType(r,"number",e)}evalExpr(r){switch(r.type){case"binary":{let e=this.evalExpr(r.left),s=this.evalExpr(r.right);if(J(e,s))return X(0);if(typeof e.value!=typeof s.value)return this.addError(`Binary expression operands are expected to be of the same type.  Got: '${Z(e.value)}' (left), '${Z(s.value)}' (right)`,r.loc),X(0);if(typeof e.value!="string"&&typeof e.value!="number")return this.addError(`Binary expression operands can only operator on numbers or strings.  Got: '${Z(e.value)}'`,r.loc),X(0);if(typeof e.value=="string"){let n=["+"];if(n.indexOf(r.op)<0)return this.addError(`'${r.op}' operator is not supported for strings.  Valid operators for strings are: ${n.join(", ")}`,r.loc),X(0)}switch(r.op){case"+":return ht(e,s,(n,c)=>n+c);case"-":return ht(e,s,(n,c)=>n-c);case"\xA7":return ht(e,s,(n,c)=>(n&255)<<8|c&255);default:throw new Error(`Unhandled binary operator ${r.op}`)}}case"literal":return re(r.lit,!0);case"register":return this.addError("Unexpected register",r.loc),X(0);case"ident":throw new Error("should not see an ident here -- if you do, it is probably a wrong type node in parser");case"qualified-ident":{let e=this.scopes.findQualifiedSym(r.path,r.absolute);if(e===void 0)return this.pass>=1?(this.addError(`Undefined symbol '${qo(r)}'`,r.loc),X(0)):(this.needPass=!0,re(0,!1));switch(e.type){case"label":return{errors:e.data.errors,value:e.data.value.addr,completeFirstPass:e.seen===this.pass}}break}case"getcurpc":return re(this.getPC(),!0);default:break}throw new Error(`should be unreachable on ${r}`)}emit(r){let e=this.curSegment.emit(r);e!==void 0&&this.addError(e,this.lineLoc)}emit16(r){this.emit(r>>8&255),this.emit(r&255)}assembleNonInstr(r,e){let s=r.ops[0];e.p1&&this.addWarning("Parameter not required",e.p1.loc),e.p2&&this.addWarning("Parameter not required",e.p2.loc),this.emit(s.op)}assembleAluInstr(r,e){let s=r.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let n=s.op;if(e.p1&&s.p1){let c=this.checkRegister(e.p1,s.p1);if(c===void 0)return;n|=s.p1.op(c)}this.emit(n)}assembleClrInstr(r,e){if(!e.p1){this.addError("Parameter required",e.loc);return}if(e.p2&&this.addWarning("Parameter not required",e.p2.loc),!r.ops[0]||!r.ops[0].p1||!r.ops[1]||!r.ops[1].p1){this.addError("Internal opcode definition error",e.loc);return}let s=this.checkRegister(e.p1,r.ops[0].p1,r.ops[1].p1);if(s===void 0)return;let n=this.hasRegister(e.p1,r.ops[1].p1)?r.ops[1]:r.ops[0];if(!n.p1){this.addError("Internal opcode definition error",e.loc);return}let c=n.op;c|=n.p1.op(s),this.emit(c)}assembleMovInstr(r,e){if(!e.p1||!e.p2){this.addError("Two parameters required",e.loc);return}if(!r.ops[0]||!r.ops[0].p1||!r.ops[1]||!r.ops[1].p1){this.addError("Internal opcode definition error",e.loc);return}let s=this.checkRegister(e.p1,r.ops[0].p1,r.ops[1].p1);if(s===void 0)return;let n=this.hasRegister(e.p1,r.ops[1].p1)?r.ops[1]:r.ops[0];if(!e.p1||!n.p1||!e.p2||!n.p2){this.addError("Two parameters required",e.loc);return}let c=n.op;c|=n.p1.op(s);let u=this.checkRegister(e.p2,n.p2);u!==void 0&&(c|=n.p2.op(u),this.emit(c))}assembleLitOpc(r,e){let s=r.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let n=s.op;if(!e.p1||!s.p1){this.addError("Parameter required",e.loc);return}let c=this.checkLiteral(e.p1,0,255,"h");c!==void 0&&(n|=s.p1.op(c),this.emit(n))}assembleLodSwInstr(r,e){let s=r.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let n=s.op;if(!e.p1||!s.p1){this.addError("Parameter required",e.loc);return}let c=this.checkRegister(e.p1,s.p1);c!==void 0&&(n|=s.p1.op(c),this.emit(n))}assembleSetInstr(r,e){if(!e.p1||!e.p2){this.addError("Two parameters required",e.loc);return}if(!r.ops[0]||!r.ops[0].p1||!r.ops[1]||!r.ops[1].p1){this.addError("Internal opcode definition error",e.loc);return}let s=this.checkRegister(e.p1,r.ops[0].p1,r.ops[1].p1);if(s===void 0)return;let n=this.hasRegister(e.p1,r.ops[1].p1),c=n?r.ops[1]:r.ops[0];if(!c.p1){this.addError("Internal opcode definition error",e.loc);return}let u=c.op;if(u|=c.p1.op(s),n){let p=this.evalExpr(e.p2);if(J(p))return;if(typeof p.value!="number"){this.addError(`Expecting branch label to evaluate to integer, got ${Z(p.value)}`,e.p2.loc);return}let{value:x}=p;if(x>65535){this.addError("Value out of range (must be between 0x0000 and 0xFFFF)",e.p2.loc);return}this.emit(u),this.emit((x&65280)>>8),this.emit(x&255)}else{if(!c.p2){this.addError("Internal opcode definition error",e.loc);return}let p=this.checkLiteral(e.p2,-16,15);if(p===void 0)return;u|=c.p2.op(p),this.emit(u)}}assembleLoadStoreInstr(r,e){let s=r.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let n=s.op;if(!e.p1||!s.p1){this.addError("Parameter required",e.loc);return}let c=this.checkRegister(e.p1,s.p1);c!==void 0&&(n|=s.p1.op(c),this.emit(n))}checkRegister(r,e,s=void 0){if(r.type!=="register")this.addError("Register required",r.loc);else{let n=e.cs?.[r.value]??s?.cs?.[r.value];return n===void 0&&(e.cs?s&&s.cs?this.addError(`Invalid register - choose one of [${Object.keys(e.cs).join("|")}] or [${Object.keys(s.cs).join("|")}]`,r.loc):this.addError(`Invalid register - choose one of [${Object.keys(e.cs).join("|")}]`,r.loc):this.addError("Invalid register",r.loc)),n}}hasRegister(r,e){return r.type!=="register"?!1:e.cs?.[r.value]!==void 0}checkLiteral(r,e,s,n="d"){let c=this.evalExprToInt(r,"value");if(!J(c)){let u=c.value;if(u<e||u>s){let p="";switch(n){case"b":{let x=s.toString(2);p=`${("0".repeat(x.length)+e.toString(2)).slice(-x.length)}b and ${x}b`;break}case"h":{let x=s.toString(16).toUpperCase();p=`0x${("0".repeat(x.length)+e.toString(16).toUpperCase()).slice(-x.length)} and 0x${x}`;break}default:p=`${e} and ${s}`}this.addError(`Literal out of range (must be between ${p})`,r.loc)}else return u}}assembleBranch(r,e){let s=r.ops[0];if(e.p2&&this.addWarning("Parameter not required",e.p2.loc),!e.p1){this.addError("Parameter required",e.loc);return}let n=this.evalExpr(e.p1);if(J(n))return;if(typeof n.value!="number"){this.addError(`Expecting branch label to evaluate to integer, got ${Z(n.value)}`,e.p1.loc);return}let{value:c}=n;this.emit(s.op),this.emit((c&65280)>>8),this.emit(c&255)}handleSetPC(r){let e=this.evalExprToInt(r,"pc");if(!J(e)){let{value:s,completeFirstPass:n}=e;if(!n){this.addError("Value for new program counter must evaluate to a value in the first pass",r.loc);return}!this.curSegment.empty()&&this.curSegment.currentPC()>s&&this.addError(`Cannot set program counter to a smaller value than current (current: $${R(this.curSegment.currentPC())}, trying to set $${R(s)})`,r.loc);let c=this.curSegment.setCurrentPC(s);c!==void 0&&this.addError(c,r.loc)}}emit8or16(r,e){if(e===8){this.emit(r);return}this.emit16(r)}emitData(r,e){let s=Math.pow(2,e);for(let n=0;n<r.length;n++){let c=this.evalExpr(r[n]);if(J(c))continue;let{value:u}=c;if(typeof u=="number")u>=s?this.addError(`Data out of range for ${e} bits`,r[n].loc):this.emit8or16(u,e);else if(typeof u=="string"){let p=u.split("").map(x=>x.charCodeAt(0));p.find(x=>x>=s)?this.addError(`Data contains character out of range for ${e} bits`,r[n].loc):p.forEach(x=>this.emit8or16(x,e))}else this.addError(`Only literal types can be emitted. Got ${Z(u)}`,r[n].loc)}}fillBytes(r){let e=this.evalExprToInt(r.numBytes,"dfs num_bytes"),s=this.evalExprToInt(r.fillValue,"dfs value");if(J(e,s))return;let{value:n}=s;if(n<0||n>=256){this.addError(`dfs value to repeat must be in 8-bit range, '${n}' given`,r.fillValue.loc);return}let c=e.value;if(c<0){this.addError(`dfs repeat count must be >= 0, got ${c}`,r.numBytes.loc);return}for(let u=0;u<c;u++)this.emit(n)}checkDirectives(r,e){switch(r.type){case"data":{this.emitData(r.values,r.dataSize===pe.Byte?8:16);break}case"fill":{this.fillBytes(r);break}case"setpc":{this.handleSetPC(r.pc);break}default:this.addError(`unknown directive ${r.type}`,r.loc);return}}assembleLines(r){if(r===null||r.length===0||r.length===0)return;let e=n=>{for(let c=0;c<n.length;c++)this.debugInfo.startLine(n[c].loc,this.getPC(),this.curSegment),this.assembleLine(n[c]),this.debugInfo.endLine(this.getPC(),this.curSegment)},s=0;for(;s<r.length;){let{label:n,stmt:c}=r[s];if(n===null&&c===null)s++;else break}if(!(s>=r.length))return e(r)}checkAndDeclareLabel(r){this.scopes.symbolSeen(r.name)?this.addError(`Symbol '${r.name}' already defined`,r.loc):this.scopes.declareLabelSymbol(r,this.getPC(),this.curSegment)&&(this.needPass=!0)}assembleLine(r){if(this.lineLoc=r.loc,r.label===null&&r.stmt===null||(r.label!==null&&this.checkAndDeclareLabel(r.label),r.stmt===null))return;if(r.stmt.type!=="insn"){this.checkDirectives(r.stmt,r.label===null?null:r.label.name);return}let e=r.stmt,s=Ar[e.mnemonic.toLocaleLowerCase()];s!==void 0?(c=>{let u=this.getPC();c();let p=this.getPC();this.debugInfo.markAsInstruction(u,p)})(()=>{switch(s.mt){case C.Direct:this.assembleNonInstr(s,e);break;case C.Alu:this.assembleAluInstr(s,e);break;case C.Clear:this.assembleClrInstr(s,e);break;case C.Move:this.assembleMovInstr(s,e);break;case C.LitOpc:this.assembleLitOpc(s,e);break;case C.LodSw:this.assembleLodSwInstr(s,e);break;case C.Set:this.assembleSetInstr(s,e);break;case C.LoadStore:this.assembleLoadStoreInstr(s,e);break;case C.Goto:this.assembleBranch(s,e);break;default:this.addError(`Couldn't encode instruction '${e.mnemonic} '`,r.loc)}}):this.addError(`Unknown mnemonic '${e.mnemonic}'`,e.loc)}assemble(r){try{let e=Ir.parse(r.toString());e!==void 0&&e.lines&&this.assembleLines(e.lines)}catch(e){if("name"in e&&e.name==="SyntaxError")this.addError(`Syntax error: ${e.message}`,{...e.location});else{if("name"in e&&e.name==="semantic")return;throw e}}}dumpLabels(){return this.scopes.dumpLabels(this.getPC(),this.segments)}collectSegmentInfo(){return Lr(this.segments)}};function wt(t){try{return Ir.parse(t.toString())}catch{return}}function xt(t){let r=new mt,e=0;do{if(r.startPass(e),r.assemble(t),e>0&&r.anyErrors())return{prg:Uint8Array.from([]),labels:[],segments:[],debugInfo:void 0,errors:r.errors(),warnings:r.warnings()};e+=1}while(r.needPass);return{prg:r.prg(),errors:r.errors(),warnings:r.warnings(),labels:r.dumpLabels(),segments:r.collectSegmentInfo(),debugInfo:r.debugInfo}}var O;(function(t){t[t.Program=0]="Program",t[t.Line=1]="Line",t[t.Label=2]="Label",t[t.LabelRef=3]="LabelRef",t[t.Instruction=4]="Instruction",t[t.Literal=5]="Literal",t[t.Register=6]="Register",t[t.SetPC=7]="SetPC",t[t.Expr=8]="Expr",t[t.Data=9]="Data"})(O||(O={}));var me;(function(t){t[t.Label=0]="Label"})(me||(me={}));function Fe(t,r){let e=null;return!t||r<t.offset||r>t.end?null:(t.accept(s=>s.offset===-1&&s.length===-1?!0:s.offset<=r&&s.end>=r?(e?s.length<=e.length&&(e=s):e=s,!0):!1),e)}function Or(t,r){let e=Fe(t,r),s=[];for(;e;)s.unshift(e),e=e.parent;return s}var j=class{get end(){return this.offset+this.length}constructor(r,e){this.nodeType=e,this.parent=null,this.offset=r?.loc.start.offset??0,this.length=(r?.loc.end.offset??0)-this.offset}get type(){return this.nodeType}getTextProvider(){let r=this;for(;r&&!r.textProvider;)r=r.parent;return r?r.textProvider:()=>"unknown"}getText(){return this.getTextProvider()(this.offset,this.length)}matches(r){return this.length===r.length&&this.getTextProvider()(this.offset,this.length)===r}accept(r){if(r(this)&&this.children)for(let e of this.children)e.accept(r)}acceptVisitor(r){this.accept(r.visitNode.bind(r))}adoptChild(r){r.parent=this;let e=this.children;return e||(e=this.children=[]),e.push(r),r}};var Me=class extends j{constructor(r){super(r,O.Program),r?.lines?.forEach(e=>this.adoptChild(new yt(e)))}},yt=class extends j{constructor(r){if(super(r,O.Line),r.label&&this.adoptChild(new q(r.label)),r.stmt)switch(r.stmt.type){case"insn":this.adoptChild(new ye(r.stmt));break;case"setpc":this.adoptChild(new we(r.stmt));break;case"data":this.adoptChild(new xe(r.stmt))}}},q=class extends j{constructor(r){super(r,O.Label),this.length--}},we=class extends j{constructor(r){super(r,O.SetPC),this.pcExpr=this.adoptChild(new vt(r.pc))}},xe=class extends j{constructor(r){super(r,O.Data)}},vt=class extends j{constructor(r){super(r,O.Expr)}},ye=class extends j{constructor(r){super(r,O.Instruction);let e=s=>{switch(s.type){case"literal":return this.adoptChild(new ve(s));case"register":return this.adoptChild(new be(s));case"qualified-ident":return this.adoptChild(new Y(s));default:return}};this.mnemonic=r.mnemonic.toLowerCase(),r.p1&&(this.p1=e(r.p1)),r.p2&&(this.p2=e(r.p2))}},Y=class extends j{constructor(r){super(r,O.LabelRef)}},ve=class extends j{constructor(r){super(r,O.Literal),this.value=r.lit}},be=class extends j{constructor(r){super(r,O.Register),this.value=r.value.toUpperCase()}};var Be=class{parseProgram(r){let e=r.version,s=r.getText(),n=wt(r.getText()),c=new Me(n),u=(p,x)=>{if(r.version!==e)throw new Error("Underlying model has changed, AST is no longer valid");return s.substr(p,x)};return c.textProvider=u,c}};var Mr={version:1,mnemonics:[{name:"add",class:"ALU",summary:"Arithmetic Add",description:"Adds the contents of register B and C (B+C) placing the result in register A or D.",synopsis:"{0} = B + C",syntax:"[ a | d ]"},{name:"and",class:"ALU",summary:"Logic And",description:"Performs a bitwise AND operation on register B and C (B&C) placing the result in register A or D.",synopsis:"{0} = B & C",syntax:"[ a | d ]"},{name:"bcs",class:"GOTO",summary:"Branch if Carry Set",snippet:"bcs ${1:label}",description:"Jumps to the given address if the carry flag is set.",synopsis:"PC = {0} [if CY]",syntax:"<label>"},{name:"beq",class:"GOTO",summary:"Branch if Equal/Zero",snippet:"beq ${1:label}",description:"Jumps to the given address if the zero flag is set (equal).",synopsis:"PC = {0} [if Z]",syntax:"<label>"},{name:"ble",class:"GOTO",summary:"Branch if Less Than or Equal (Sign+Zero)",snippet:"ble ${1:label}",description:"Jumps to the given address if the sign or zero flag is set (less than or equal).",synopsis:"PC = {0} [if S or Z]",syntax:"<label>"},{name:"blt",class:"GOTO",summary:"Branch if Less Than (Sign)",snippet:"blt ${1:label}",description:"Jumps to the given address if the sign flag is set (less than).",synopsis:"PC = {0} [if S]",syntax:"<label>"},{name:"bmi",class:"GOTO",summary:"Branch if Minus/Sign",snippet:"bmi ${1:label}",description:"Jumps to the given address if the sign flag is set (negative).",synopsis:"PC = {0} [if S]",syntax:"<label>"},{name:"bne",class:"GOTO",summary:"Branch if Not Equal/Zero",snippet:"bne ${1:label}",description:"Jumps to the given address if the zero flag is not set (not equal).",synopsis:"PC = {0} [if not Z]",syntax:"<label>"},{name:"clr",class:"MOV8",summary:"Zero Value",description:"Clears the content (=0) of a given register.",synopsis:"{0} = 0",syntax:"<target>{a,d|m1|m2|x|y|xy}"},{name:"cmp",class:"ALU",summary:"Compare (Logic Xor)",description:"Compares the values in register B and C setting the zero flag if the same (affects register A or D) (equivalent to eor).",synopsis:"{0} = B != C",syntax:"[ a | d ]"},{name:"eor",class:"ALU",summary:"Logic Xor",description:"Performs a bitwise XOR operation on register B and C (B^C) placing the result in register A or D.",synopsis:"{0} = B ^ C",syntax:"[ a | d ]"},{name:"inc",class:"ALU",summary:"Increment",description:"Increments contents of register B placing the result in register A or D",synopsis:"{0} = B + 1",syntax:"[ a | d ]"},{name:"hlt",class:"MISC",summary:"Halt",description:"Halts execution of the program",synopsis:"PC = PC + 1",syntax:"<label>"},{name:"hlr",class:"MISC",summary:"Halt and Reload",description:"Halts execution of the program and sets the program counter from the address switches",synopsis:"PC = AS",syntax:"<label>"},{name:"ixy",class:"INCXY",summary:"Increments contents of 16-bit register XY",synopsis:"XY = XY + 1"},{name:"lds",class:"MISC",summary:"Load Switches",description:"Takes the 8-bit value on the main switches and loads register A or D.",synopsis:"{0} = DS",syntax:"[ a | d ]"},{name:"ldr",class:"LOAD",summary:"Load Register from Memory",snippet:"ldr ${1:a}",description:"Loads the contents of memory at the address in register M into register A-D.",synopsis:"{0} = (M)",syntax:"[ a | b | c | d ]"},{name:"jmp",class:"GOTO",summary:"Jump to Label",snippet:"jmp ${1:label}",description:"Unconditionally jumps to the given address.",synopsis:"PC = {0}",syntax:"<label>"},{name:"jsr",class:"GOTO",summary:"Call Subroutine (Jump and Link)",snippet:"jsr ${1:label}",description:"Calls the subroutine at the given address.",synopsis:"XY = PC, PC = {0}",syntax:"<label>"},{name:"rts",class:"MOV16",summary:"Return from Subroutine",description:"Jumps back from a jsr call.",synopsis:"PC = XY"},{name:"ldi",class:"SETAB",summary:"Load Immediate",snippet:"ldi ${1:a},${2:0}",description:"Loads an 8-bit value in to register A/B or a 16-bit value in to register M/J.",synopsis:"{0} = {1}",syntax:"[ <target>{a|b} , <value>{-16,15} ] | [ <target>{m|j} , [ <value>{0x0000,0xFFFF} | <label> ] ]"},{name:"mov",class:"MOV8|MOV16",summary:"Copy Register to Register",snippet:"mov ${1:b},${2:a}",description:"Copies the content of one register to another.",synopsis:"{0} = {1}",syntax:"[ <destination>{a,d|m1|m2|x|y} , <source>{a,d|m1|m2|x|y} | <destination>{xy|pc} , <source>{m|xy|j|as} ]"},{name:"not",class:"ALU",summary:"Logic Not",description:"Performs a bitwise NOT operation on register B (~B) placing the result in register A or D.",synopsis:"{0} = ~B",syntax:"[ a | d ]"},{name:"opc",class:"PSEUDO",summary:"Literal Opcode",snippet:"opc ${1:opcode}",description:"Performs the given machine opcode directly.",syntax:"[ <opcode>{0x00,0xFF} | <opcode>{0b00000000,0b11111111} ]"},{name:"orr",class:"ALU",summary:"Logic Or",description:"Performs a bitwise OR operation on register B and C (B|C) placing the result in register A or D.",synopsis:"{0} = B | C",syntax:"[ a | d ]"},{name:"rol",class:"ALU",summary:"Bitwise Circular Shift Left",description:"Performs a bitwise left rotation on register B (<<B) placing the result in register A or D.",synopsis:"{0} = <<B",syntax:"[ a | d ]"},{name:"str",class:"STORE",summary:"Store Register into Memory",snippet:"str ${1:a}",description:"Stores the contents register A-D into memory at the address in register M.",synopsis:"(M) = {0}",syntax:"[ a | b | c | d ]"},{name:"org",class:"PSEUDO",summary:"Set Program Counter",description:"Sets the program counter to the given address such that the following instructions start from that location.",synopsis:"PC = {0}",syntax:"<value>{0x0000,0xFFFF}"},{name:"dfb",class:"PSEUDO",summary:"Define Byte Data",description:"Writes the given 8-bit values directly into the output starting from current location.",syntax:"<value>{0x00,0xFF} [ ,...n ]"},{name:"dfw",class:"PSEUDO",summary:"Define Word Data",description:"Writes the given 16-bit values directly into the output starting from current location.",syntax:"<value>{0x0000,0xFFFF} [ ,...n ]"},{name:"dfs",class:"PSEUDO",summary:"Define Fill Space",description:"Writes the given 8-bit value n times directly into the output starting from current location.",syntax:"<value>{0x00,0xFF} , <count>{0,255}"}]};function Fr(t){return Object.keys(t).map(r=>t[r])}function ne(t){return typeof t<"u"}var je=class{constructor(r){this.dataProviders=r,this._mnemonicSet={},this._mnemonics=[],this.collectData()}collectData(){this.dataProviders.forEach(r=>{r.provideMnemonics().forEach(e=>{this._mnemonicSet[e.name]||(this._mnemonicSet[e.name]=e)})}),this._mnemonics=Fr(this._mnemonicSet)}getMnemonic(r){return this._mnemonicSet[r]}getMnemonics(){return this._mnemonics}};var Ue=class{constructor(r){this._mnemonics=[],this.addData(r)}provideMnemonics(){return this._mnemonics}addData(r){r.mnemonics&&(this._mnemonics=this._mnemonics.concat(r.mnemonics))}};function We(t,r){return r?{kind:"markdown",value:Jo(t)}:{kind:"plaintext",value:Xo(t)}}function Xo(t){if(!t.description||t.description==="")return"";if(typeof t.description!="string")return t.description.value;let r="";return r+=t.description,"syntax"in t&&(r+=`

Syntax: ${t.syntax}`),r}function Jo(t){if(!t.description||t.description==="")return"";let r="";return typeof t.description=="string"?r+=t.description:r=t.description.value,"syntax"in t&&(r+=`

Syntax: \`${t.syntax}\``),r}function bt(t,r,e){return e?{kind:"markdown",value:Rr(Yo(t),r)}:{kind:"plaintext",value:Rr(Zo(t),r)}}function Rr(t,r){if(!r||r.length===0)return t;for(let e=0;e<r.length;e++)t=t.replace(`{${e}}`,r[e]);return t}function Zo(t){if(!t.synopsis||t.synopsis==="")return"";let r="";return t.summary&&(t.class?r+=`${t.summary} [${t.class}]

`:r+=`${t.summary}

`),r+=t.synopsis,r}function Yo(t){if(!t.synopsis||t.synopsis==="")return"";let r="";return t.summary&&(t.class?r+=`${t.summary} [${t.class}]

`:r+=`${t.summary}

`),r+="`"+t.synopsis+"`",r}var se=new je([new Ue(Mr)]);var jr;(function(t){function r(e){return typeof e=="string"}t.is=r})(jr||(jr={}));var $t;(function(t){function r(e){return typeof e=="string"}t.is=r})($t||($t={}));var Ur;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647;function r(e){return typeof e=="number"&&t.MIN_VALUE<=e&&e<=t.MAX_VALUE}t.is=r})(Ur||(Ur={}));var Ne;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647;function r(e){return typeof e=="number"&&t.MIN_VALUE<=e&&e<=t.MAX_VALUE}t.is=r})(Ne||(Ne={}));var M;(function(t){function r(s,n){return s===Number.MAX_VALUE&&(s=Ne.MAX_VALUE),n===Number.MAX_VALUE&&(n=Ne.MAX_VALUE),{line:s,character:n}}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&d.uinteger(n.line)&&d.uinteger(n.character)}t.is=e})(M||(M={}));var k;(function(t){function r(s,n,c,u){if(d.uinteger(s)&&d.uinteger(n)&&d.uinteger(c)&&d.uinteger(u))return{start:M.create(s,n),end:M.create(c,u)};if(M.is(s)&&M.is(n))return{start:s,end:n};throw new Error(`Range#create called with invalid arguments[${s}, ${n}, ${c}, ${u}]`)}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&M.is(n.start)&&M.is(n.end)}t.is=e})(k||(k={}));var Q;(function(t){function r(s,n){return{uri:s,range:n}}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&k.is(n.range)&&(d.string(n.uri)||d.undefined(n.uri))}t.is=e})(Q||(Q={}));var Wr;(function(t){function r(s,n,c,u){return{targetUri:s,targetRange:n,targetSelectionRange:c,originSelectionRange:u}}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&k.is(n.targetRange)&&d.string(n.targetUri)&&k.is(n.targetSelectionRange)&&(k.is(n.originSelectionRange)||d.undefined(n.originSelectionRange))}t.is=e})(Wr||(Wr={}));var At;(function(t){function r(s,n,c,u){return{red:s,green:n,blue:c,alpha:u}}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&d.numberRange(n.red,0,1)&&d.numberRange(n.green,0,1)&&d.numberRange(n.blue,0,1)&&d.numberRange(n.alpha,0,1)}t.is=e})(At||(At={}));var Nr;(function(t){function r(s,n){return{range:s,color:n}}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&k.is(n.range)&&At.is(n.color)}t.is=e})(Nr||(Nr={}));var Tr;(function(t){function r(s,n,c){return{label:s,textEdit:n,additionalTextEdits:c}}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&d.string(n.label)&&(d.undefined(n.textEdit)||H.is(n))&&(d.undefined(n.additionalTextEdits)||d.typedArray(n.additionalTextEdits,H.is))}t.is=e})(Tr||(Tr={}));var Vr;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(Vr||(Vr={}));var zr;(function(t){function r(s,n,c,u,p,x){let g={startLine:s,endLine:n};return d.defined(c)&&(g.startCharacter=c),d.defined(u)&&(g.endCharacter=u),d.defined(p)&&(g.kind=p),d.defined(x)&&(g.collapsedText=x),g}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&d.uinteger(n.startLine)&&d.uinteger(n.startLine)&&(d.undefined(n.startCharacter)||d.uinteger(n.startCharacter))&&(d.undefined(n.endCharacter)||d.uinteger(n.endCharacter))&&(d.undefined(n.kind)||d.string(n.kind))}t.is=e})(zr||(zr={}));var Ct;(function(t){function r(s,n){return{location:s,message:n}}t.create=r;function e(s){let n=s;return d.defined(n)&&Q.is(n.location)&&d.string(n.message)}t.is=e})(Ct||(Ct={}));var ie;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(ie||(ie={}));var qr;(function(t){t.Unnecessary=1,t.Deprecated=2})(qr||(qr={}));var Hr;(function(t){function r(e){let s=e;return d.objectLiteral(s)&&d.string(s.href)}t.is=r})(Hr||(Hr={}));var $e;(function(t){function r(s,n,c,u,p,x){let g={range:s,message:n};return d.defined(c)&&(g.severity=c),d.defined(u)&&(g.code=u),d.defined(p)&&(g.source=p),d.defined(x)&&(g.relatedInformation=x),g}t.create=r;function e(s){var n;let c=s;return d.defined(c)&&k.is(c.range)&&d.string(c.message)&&(d.number(c.severity)||d.undefined(c.severity))&&(d.integer(c.code)||d.string(c.code)||d.undefined(c.code))&&(d.undefined(c.codeDescription)||d.string((n=c.codeDescription)===null||n===void 0?void 0:n.href))&&(d.string(c.source)||d.undefined(c.source))&&(d.undefined(c.relatedInformation)||d.typedArray(c.relatedInformation,Ct.is))}t.is=e})($e||($e={}));var oe;(function(t){function r(s,n,...c){let u={title:s,command:n};return d.defined(c)&&c.length>0&&(u.arguments=c),u}t.create=r;function e(s){let n=s;return d.defined(n)&&d.string(n.title)&&d.string(n.command)}t.is=e})(oe||(oe={}));var H;(function(t){function r(c,u){return{range:c,newText:u}}t.replace=r;function e(c,u){return{range:{start:c,end:c},newText:u}}t.insert=e;function s(c){return{range:c,newText:""}}t.del=s;function n(c){let u=c;return d.objectLiteral(u)&&d.string(u.newText)&&k.is(u.range)}t.is=n})(H||(H={}));var St;(function(t){function r(s,n,c){let u={label:s};return n!==void 0&&(u.needsConfirmation=n),c!==void 0&&(u.description=c),u}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&d.string(n.label)&&(d.boolean(n.needsConfirmation)||n.needsConfirmation===void 0)&&(d.string(n.description)||n.description===void 0)}t.is=e})(St||(St={}));var ae;(function(t){function r(e){let s=e;return d.string(s)}t.is=r})(ae||(ae={}));var Gr;(function(t){function r(c,u,p){return{range:c,newText:u,annotationId:p}}t.replace=r;function e(c,u,p){return{range:{start:c,end:c},newText:u,annotationId:p}}t.insert=e;function s(c,u){return{range:c,newText:"",annotationId:u}}t.del=s;function n(c){let u=c;return H.is(u)&&(St.is(u.annotationId)||ae.is(u.annotationId))}t.is=n})(Gr||(Gr={}));var Lt;(function(t){function r(s,n){return{textDocument:s,edits:n}}t.create=r;function e(s){let n=s;return d.defined(n)&&It.is(n.textDocument)&&Array.isArray(n.edits)}t.is=e})(Lt||(Lt={}));var Et;(function(t){function r(s,n,c){let u={kind:"create",uri:s};return n!==void 0&&(n.overwrite!==void 0||n.ignoreIfExists!==void 0)&&(u.options=n),c!==void 0&&(u.annotationId=c),u}t.create=r;function e(s){let n=s;return n&&n.kind==="create"&&d.string(n.uri)&&(n.options===void 0||(n.options.overwrite===void 0||d.boolean(n.options.overwrite))&&(n.options.ignoreIfExists===void 0||d.boolean(n.options.ignoreIfExists)))&&(n.annotationId===void 0||ae.is(n.annotationId))}t.is=e})(Et||(Et={}));var kt;(function(t){function r(s,n,c,u){let p={kind:"rename",oldUri:s,newUri:n};return c!==void 0&&(c.overwrite!==void 0||c.ignoreIfExists!==void 0)&&(p.options=c),u!==void 0&&(p.annotationId=u),p}t.create=r;function e(s){let n=s;return n&&n.kind==="rename"&&d.string(n.oldUri)&&d.string(n.newUri)&&(n.options===void 0||(n.options.overwrite===void 0||d.boolean(n.options.overwrite))&&(n.options.ignoreIfExists===void 0||d.boolean(n.options.ignoreIfExists)))&&(n.annotationId===void 0||ae.is(n.annotationId))}t.is=e})(kt||(kt={}));var Pt;(function(t){function r(s,n,c){let u={kind:"delete",uri:s};return n!==void 0&&(n.recursive!==void 0||n.ignoreIfNotExists!==void 0)&&(u.options=n),c!==void 0&&(u.annotationId=c),u}t.create=r;function e(s){let n=s;return n&&n.kind==="delete"&&d.string(n.uri)&&(n.options===void 0||(n.options.recursive===void 0||d.boolean(n.options.recursive))&&(n.options.ignoreIfNotExists===void 0||d.boolean(n.options.ignoreIfNotExists)))&&(n.annotationId===void 0||ae.is(n.annotationId))}t.is=e})(Pt||(Pt={}));var _t;(function(t){function r(e){let s=e;return s&&(s.changes!==void 0||s.documentChanges!==void 0)&&(s.documentChanges===void 0||s.documentChanges.every(n=>d.string(n.kind)?Et.is(n)||kt.is(n)||Pt.is(n):Lt.is(n)))}t.is=r})(_t||(_t={}));var Xr;(function(t){function r(s){return{uri:s}}t.create=r;function e(s){let n=s;return d.defined(n)&&d.string(n.uri)}t.is=e})(Xr||(Xr={}));var Jr;(function(t){function r(s,n){return{uri:s,version:n}}t.create=r;function e(s){let n=s;return d.defined(n)&&d.string(n.uri)&&d.integer(n.version)}t.is=e})(Jr||(Jr={}));var It;(function(t){function r(s,n){return{uri:s,version:n}}t.create=r;function e(s){let n=s;return d.defined(n)&&d.string(n.uri)&&(n.version===null||d.integer(n.version))}t.is=e})(It||(It={}));var Zr;(function(t){function r(s,n,c,u){return{uri:s,languageId:n,version:c,text:u}}t.create=r;function e(s){let n=s;return d.defined(n)&&d.string(n.uri)&&d.string(n.languageId)&&d.integer(n.version)&&d.string(n.text)}t.is=e})(Zr||(Zr={}));var U;(function(t){t.PlainText="plaintext",t.Markdown="markdown";function r(e){let s=e;return s===t.PlainText||s===t.Markdown}t.is=r})(U||(U={}));var ce;(function(t){function r(e){let s=e;return d.objectLiteral(e)&&U.is(s.kind)&&d.string(s.value)}t.is=r})(ce||(ce={}));var Te;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(Te||(Te={}));var Ae;(function(t){t.PlainText=1,t.Snippet=2})(Ae||(Ae={}));var Yr;(function(t){t.Deprecated=1})(Yr||(Yr={}));var Qr;(function(t){function r(s,n,c){return{newText:s,insert:n,replace:c}}t.create=r;function e(s){let n=s;return n&&d.string(n.newText)&&k.is(n.insert)&&k.is(n.replace)}t.is=e})(Qr||(Qr={}));var Kr;(function(t){t.asIs=1,t.adjustIndentation=2})(Kr||(Kr={}));var en;(function(t){function r(e){let s=e;return s&&(d.string(s.detail)||s.detail===void 0)&&(d.string(s.description)||s.description===void 0)}t.is=r})(en||(en={}));var tn;(function(t){function r(e){return{label:e}}t.create=r})(tn||(tn={}));var Dt;(function(t){function r(e,s){return{items:e||[],isIncomplete:!!s}}t.create=r})(Dt||(Dt={}));var Ce;(function(t){function r(s){return s.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}t.fromPlainText=r;function e(s){let n=s;return d.string(n)||d.objectLiteral(n)&&d.string(n.language)&&d.string(n.value)}t.is=e})(Ce||(Ce={}));var Ot;(function(t){function r(e){let s=e;return!!s&&d.objectLiteral(s)&&(ce.is(s.contents)||Ce.is(s.contents)||d.typedArray(s.contents,Ce.is))&&(e.range===void 0||k.is(e.range))}t.is=r})(Ot||(Ot={}));var rn;(function(t){function r(e,s){return s?{label:e,documentation:s}:{label:e}}t.create=r})(rn||(rn={}));var nn;(function(t){function r(e,s,...n){let c={label:e};return d.defined(s)&&(c.documentation=s),d.defined(n)?c.parameters=n:c.parameters=[],c}t.create=r})(nn||(nn={}));var le;(function(t){t.Text=1,t.Read=2,t.Write=3})(le||(le={}));var Mt;(function(t){function r(e,s){let n={range:e};return d.number(s)&&(n.kind=s),n}t.create=r})(Mt||(Mt={}));var ue;(function(t){t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(ue||(ue={}));var sn;(function(t){t.Deprecated=1})(sn||(sn={}));var Ft;(function(t){function r(e,s,n,c,u){let p={name:e,kind:s,location:{uri:c,range:n}};return u&&(p.containerName=u),p}t.create=r})(Ft||(Ft={}));var on;(function(t){function r(e,s,n,c){return c!==void 0?{name:e,kind:s,location:{uri:n,range:c}}:{name:e,kind:s,location:{uri:n}}}t.create=r})(on||(on={}));var an;(function(t){function r(s,n,c,u,p,x){let g={name:s,detail:n,kind:c,range:u,selectionRange:p};return x!==void 0&&(g.children=x),g}t.create=r;function e(s){let n=s;return n&&d.string(n.name)&&d.number(n.kind)&&k.is(n.range)&&k.is(n.selectionRange)&&(n.detail===void 0||d.string(n.detail))&&(n.deprecated===void 0||d.boolean(n.deprecated))&&(n.children===void 0||Array.isArray(n.children))&&(n.tags===void 0||Array.isArray(n.tags))}t.is=e})(an||(an={}));var cn;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(cn||(cn={}));var Ve;(function(t){t.Invoked=1,t.Automatic=2})(Ve||(Ve={}));var ln;(function(t){function r(s,n,c){let u={diagnostics:s};return n!=null&&(u.only=n),c!=null&&(u.triggerKind=c),u}t.create=r;function e(s){let n=s;return d.defined(n)&&d.typedArray(n.diagnostics,$e.is)&&(n.only===void 0||d.typedArray(n.only,d.string))&&(n.triggerKind===void 0||n.triggerKind===Ve.Invoked||n.triggerKind===Ve.Automatic)}t.is=e})(ln||(ln={}));var un;(function(t){function r(s,n,c){let u={title:s},p=!0;return typeof n=="string"?(p=!1,u.kind=n):oe.is(n)?u.command=n:u.edit=n,p&&c!==void 0&&(u.kind=c),u}t.create=r;function e(s){let n=s;return n&&d.string(n.title)&&(n.diagnostics===void 0||d.typedArray(n.diagnostics,$e.is))&&(n.kind===void 0||d.string(n.kind))&&(n.edit!==void 0||n.command!==void 0)&&(n.command===void 0||oe.is(n.command))&&(n.isPreferred===void 0||d.boolean(n.isPreferred))&&(n.edit===void 0||_t.is(n.edit))}t.is=e})(un||(un={}));var fn;(function(t){function r(s,n){let c={range:s};return d.defined(n)&&(c.data=n),c}t.create=r;function e(s){let n=s;return d.defined(n)&&k.is(n.range)&&(d.undefined(n.command)||oe.is(n.command))}t.is=e})(fn||(fn={}));var dn;(function(t){function r(s,n){return{tabSize:s,insertSpaces:n}}t.create=r;function e(s){let n=s;return d.defined(n)&&d.uinteger(n.tabSize)&&d.boolean(n.insertSpaces)}t.is=e})(dn||(dn={}));var hn;(function(t){function r(s,n,c){return{range:s,target:n,data:c}}t.create=r;function e(s){let n=s;return d.defined(n)&&k.is(n.range)&&(d.undefined(n.target)||d.string(n.target))}t.is=e})(hn||(hn={}));var pn;(function(t){function r(s,n){return{range:s,parent:n}}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&k.is(n.range)&&(n.parent===void 0||t.is(n.parent))}t.is=e})(pn||(pn={}));var gn;(function(t){t.namespace="namespace",t.type="type",t.class="class",t.enum="enum",t.interface="interface",t.struct="struct",t.typeParameter="typeParameter",t.parameter="parameter",t.variable="variable",t.property="property",t.enumMember="enumMember",t.event="event",t.function="function",t.method="method",t.macro="macro",t.keyword="keyword",t.modifier="modifier",t.comment="comment",t.string="string",t.number="number",t.regexp="regexp",t.operator="operator",t.decorator="decorator"})(gn||(gn={}));var mn;(function(t){t.declaration="declaration",t.definition="definition",t.readonly="readonly",t.static="static",t.deprecated="deprecated",t.abstract="abstract",t.async="async",t.modification="modification",t.documentation="documentation",t.defaultLibrary="defaultLibrary"})(mn||(mn={}));var wn;(function(t){function r(e){let s=e;return d.objectLiteral(s)&&(s.resultId===void 0||typeof s.resultId=="string")&&Array.isArray(s.data)&&(s.data.length===0||typeof s.data[0]=="number")}t.is=r})(wn||(wn={}));var xn;(function(t){function r(s,n){return{range:s,text:n}}t.create=r;function e(s){let n=s;return n!=null&&k.is(n.range)&&d.string(n.text)}t.is=e})(xn||(xn={}));var yn;(function(t){function r(s,n,c){return{range:s,variableName:n,caseSensitiveLookup:c}}t.create=r;function e(s){let n=s;return n!=null&&k.is(n.range)&&d.boolean(n.caseSensitiveLookup)&&(d.string(n.variableName)||n.variableName===void 0)}t.is=e})(yn||(yn={}));var vn;(function(t){function r(s,n){return{range:s,expression:n}}t.create=r;function e(s){let n=s;return n!=null&&k.is(n.range)&&(d.string(n.expression)||n.expression===void 0)}t.is=e})(vn||(vn={}));var bn;(function(t){function r(s,n){return{frameId:s,stoppedLocation:n}}t.create=r;function e(s){let n=s;return d.defined(n)&&k.is(s.stoppedLocation)}t.is=e})(bn||(bn={}));var Rt;(function(t){t.Type=1,t.Parameter=2;function r(e){return e===1||e===2}t.is=r})(Rt||(Rt={}));var Bt;(function(t){function r(s){return{value:s}}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&(n.tooltip===void 0||d.string(n.tooltip)||ce.is(n.tooltip))&&(n.location===void 0||Q.is(n.location))&&(n.command===void 0||oe.is(n.command))}t.is=e})(Bt||(Bt={}));var $n;(function(t){function r(s,n,c){let u={position:s,label:n};return c!==void 0&&(u.kind=c),u}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&M.is(n.position)&&(d.string(n.label)||d.typedArray(n.label,Bt.is))&&(n.kind===void 0||Rt.is(n.kind))&&n.textEdits===void 0||d.typedArray(n.textEdits,H.is)&&(n.tooltip===void 0||d.string(n.tooltip)||ce.is(n.tooltip))&&(n.paddingLeft===void 0||d.boolean(n.paddingLeft))&&(n.paddingRight===void 0||d.boolean(n.paddingRight))}t.is=e})($n||($n={}));var An;(function(t){function r(e){return{kind:"snippet",value:e}}t.createSnippet=r})(An||(An={}));var Cn;(function(t){function r(e,s,n,c){return{insertText:e,filterText:s,range:n,command:c}}t.create=r})(Cn||(Cn={}));var Sn;(function(t){function r(e){return{items:e}}t.create=r})(Sn||(Sn={}));var Ln;(function(t){t.Invoked=0,t.Automatic=1})(Ln||(Ln={}));var En;(function(t){function r(e,s){return{range:e,text:s}}t.create=r})(En||(En={}));var kn;(function(t){function r(e,s){return{triggerKind:e,selectedCompletionInfo:s}}t.create=r})(kn||(kn={}));var Pn;(function(t){function r(e){let s=e;return d.objectLiteral(s)&&$t.is(s.uri)&&d.string(s.name)}t.is=r})(Pn||(Pn={}));var _n;(function(t){function r(c,u,p,x){return new jt(c,u,p,x)}t.create=r;function e(c){let u=c;return!!(d.defined(u)&&d.string(u.uri)&&(d.undefined(u.languageId)||d.string(u.languageId))&&d.uinteger(u.lineCount)&&d.func(u.getText)&&d.func(u.positionAt)&&d.func(u.offsetAt))}t.is=e;function s(c,u){let p=c.getText(),x=n(u,(w,v)=>{let L=w.range.start.line-v.range.start.line;return L===0?w.range.start.character-v.range.start.character:L}),g=p.length;for(let w=x.length-1;w>=0;w--){let v=x[w],L=c.offsetAt(v.range.start),A=c.offsetAt(v.range.end);if(A<=g)p=p.substring(0,L)+v.newText+p.substring(A,p.length);else throw new Error("Overlapping edit");g=L}return p}t.applyEdits=s;function n(c,u){if(c.length<=1)return c;let p=c.length/2|0,x=c.slice(0,p),g=c.slice(p);n(x,u),n(g,u);let w=0,v=0,L=0;for(;w<x.length&&v<g.length;)u(x[w],g[v])<=0?c[L++]=x[w++]:c[L++]=g[v++];for(;w<x.length;)c[L++]=x[w++];for(;v<g.length;)c[L++]=g[v++];return c}})(_n||(_n={}));var jt=class{constructor(r,e,s,n){this._uri=r,this._languageId=e,this._version=s,this._content=n,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(r){if(r){let e=this.offsetAt(r.start),s=this.offsetAt(r.end);return this._content.substring(e,s)}return this._content}update(r,e){this._content=r.text,this._version=e,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let r=[],e=this._content,s=!0;for(let n=0;n<e.length;n++){s&&(r.push(n),s=!1);let c=e.charAt(n);s=c==="\r"||c===`
`,c==="\r"&&n+1<e.length&&e.charAt(n+1)===`
`&&n++}s&&e.length>0&&r.push(e.length),this._lineOffsets=r}return this._lineOffsets}positionAt(r){r=Math.max(Math.min(r,this._content.length),0);let e=this.getLineOffsets(),s=0,n=e.length;if(n===0)return M.create(0,r);for(;s<n;){let u=Math.floor((s+n)/2);e[u]>r?n=u:s=u+1}let c=s-1;return M.create(c,r-e[c])}offsetAt(r){let e=this.getLineOffsets();if(r.line>=e.length)return this._content.length;if(r.line<0)return 0;let s=e[r.line],n=r.line+1<e.length?e[r.line+1]:this._content.length;return Math.max(Math.min(s+r.character,n),s)}get lineCount(){return this.getLineOffsets().length}},d;(function(t){let r=Object.prototype.toString;function e(A){return typeof A<"u"}t.defined=e;function s(A){return typeof A>"u"}t.undefined=s;function n(A){return A===!0||A===!1}t.boolean=n;function c(A){return r.call(A)==="[object String]"}t.string=c;function u(A){return r.call(A)==="[object Number]"}t.number=u;function p(A,fe,Ze){return r.call(A)==="[object Number]"&&fe<=A&&A<=Ze}t.numberRange=p;function x(A){return r.call(A)==="[object Number]"&&-2147483648<=A&&A<=2147483647}t.integer=x;function g(A){return r.call(A)==="[object Number]"&&0<=A&&A<=2147483647}t.uinteger=g;function w(A){return r.call(A)==="[object Function]"}t.func=w;function v(A){return A!==null&&typeof A=="object"}t.objectLiteral=v;function L(A,fe){return Array.isArray(A)&&A.every(fe)}t.typedArray=L})(d||(d={}));var K=class{constructor(r,e,s,n){this._uri=r,this._languageId=e,this._version=s,this._content=n,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(r){if(r){let e=this.offsetAt(r.start),s=this.offsetAt(r.end);return this._content.substring(e,s)}return this._content}update(r,e){for(let s of r)if(K.isIncremental(s)){let n=On(s.range),c=this.offsetAt(n.start),u=this.offsetAt(n.end);this._content=this._content.substring(0,c)+s.text+this._content.substring(u,this._content.length);let p=Math.max(n.start.line,0),x=Math.max(n.end.line,0),g=this._lineOffsets,w=In(s.text,!1,c);if(x-p===w.length)for(let L=0,A=w.length;L<A;L++)g[L+p+1]=w[L];else w.length<1e4?g.splice(p+1,x-p,...w):this._lineOffsets=g=g.slice(0,p+1).concat(w,g.slice(x+1));let v=s.text.length-(u-c);if(v!==0)for(let L=p+1+w.length,A=g.length;L<A;L++)g[L]=g[L]+v}else if(K.isFull(s))this._content=s.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=e}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=In(this._content,!0)),this._lineOffsets}positionAt(r){r=Math.max(Math.min(r,this._content.length),0);let e=this.getLineOffsets(),s=0,n=e.length;if(n===0)return{line:0,character:r};for(;s<n;){let u=Math.floor((s+n)/2);e[u]>r?n=u:s=u+1}let c=s-1;return r=this.ensureBeforeEOL(r,e[c]),{line:c,character:r-e[c]}}offsetAt(r){let e=this.getLineOffsets();if(r.line>=e.length)return this._content.length;if(r.line<0)return 0;let s=e[r.line];if(r.character<=0)return s;let n=r.line+1<e.length?e[r.line+1]:this._content.length,c=Math.min(s+r.character,n);return this.ensureBeforeEOL(c,s)}ensureBeforeEOL(r,e){for(;r>e&&Dn(this._content.charCodeAt(r-1));)r--;return r}get lineCount(){return this.getLineOffsets().length}static isIncremental(r){let e=r;return e!=null&&typeof e.text=="string"&&e.range!==void 0&&(e.rangeLength===void 0||typeof e.rangeLength=="number")}static isFull(r){let e=r;return e!=null&&typeof e.text=="string"&&e.range===void 0&&e.rangeLength===void 0}},Se;(function(t){function r(n,c,u,p){return new K(n,c,u,p)}t.create=r;function e(n,c,u){if(n instanceof K)return n.update(c,u),n;throw new Error("TextDocument.update: document must be created by TextDocument.create")}t.update=e;function s(n,c){let u=n.getText(),p=Ut(c.map(Qo),(w,v)=>{let L=w.range.start.line-v.range.start.line;return L===0?w.range.start.character-v.range.start.character:L}),x=0,g=[];for(let w of p){let v=n.offsetAt(w.range.start);if(v<x)throw new Error("Overlapping edit");v>x&&g.push(u.substring(x,v)),w.newText.length&&g.push(w.newText),x=n.offsetAt(w.range.end)}return g.push(u.substr(x)),g.join("")}t.applyEdits=s})(Se||(Se={}));function Ut(t,r){if(t.length<=1)return t;let e=t.length/2|0,s=t.slice(0,e),n=t.slice(e);Ut(s,r),Ut(n,r);let c=0,u=0,p=0;for(;c<s.length&&u<n.length;)r(s[c],n[u])<=0?t[p++]=s[c++]:t[p++]=n[u++];for(;c<s.length;)t[p++]=s[c++];for(;u<n.length;)t[p++]=n[u++];return t}function In(t,r,e=0){let s=r?[e]:[];for(let n=0;n<t.length;n++){let c=t.charCodeAt(n);Dn(c)&&(c===13&&n+1<t.length&&t.charCodeAt(n+1)===10&&n++,s.push(e+n+1))}return s}function Dn(t){return t===13||t===10}function On(t){let r=t.start,e=t.end;return r.line>e.line||r.line===e.line&&r.character>e.character?{start:e,end:r}:t}function Qo(t){let r=On(t.range);return r!==t.range?{newText:t.newText,range:r}:t}var Mn;(function(t){t.LATEST={textDocument:{completion:{completionItem:{documentationFormat:[U.Markdown,U.PlainText]}},hover:{contentFormat:[U.Markdown,U.PlainText]}}}})(Mn||(Mn={}));var ze=class{constructor(r){this.clientCapabilities=r}doComplete(r,e,s){this.offset=r.offsetAt(e),this.position=e,this.currentWord=Ko(r,this.offset),this.defaultReplaceRange=k.create(M.create(this.position.line,this.position.character-this.currentWord.length),this.position),this.textDocument=r,this.program=s;try{let c={isIncomplete:!1,items:[]};var n=r.getText(k.create(M.create(this.position.line,0),this.position));return n.match(/^([a-z]+:)?([ \t]+)?([a-z]{0,3})$/i)&&this.getCompletionsForMnemonic(c),c}finally{this.position=null,this.currentWord=null,this.textDocument=null,this.program=null,this.defaultReplaceRange=null}}getCompletionsForMnemonic(r){return se.getMnemonics().forEach(s=>{let n,c;n=this.getCompletionRange(null),c=s.snippet??s.name;let u={label:s.name,detail:s.class?`${s.summary} [${s.class}]`:s.summary,documentation:We(s,this.doesSupportMarkdown()),textEdit:H.replace(n,c),insertTextFormat:Ae.Snippet,kind:Te.Function};r.items.push(u)}),r}doesSupportMarkdown(){if(!ne(this.supportsMarkdown)){if(!ne(this.clientCapabilities))return this.supportsMarkdown=!0,this.supportsMarkdown;let r=this.clientCapabilities&&this.clientCapabilities.textDocument&&this.clientCapabilities.textDocument.hover;this.supportsMarkdown=r&&r.contentFormat&&Array.isArray(r.contentFormat)&&r.contentFormat.indexOf(U.Markdown)!==-1}return this.supportsMarkdown}getCompletionRange(r){if(r&&r.offset<=this.offset&&this.offset<=r.end){let e=r.end!==-1?this.textDocument.positionAt(r.end):this.position,s=this.textDocument.positionAt(r.offset);if(s.line===e.line)return k.create(s,e)}return this.defaultReplaceRange}};function Ko(t,r){let e=r-1,s=t.getText();for(;e>=0&&` 	
\r:,`.indexOf(s.charAt(e))===-1;)e--;return s.substring(e+1,r)}var qe=class{constructor(r){this.clientCapabilities=r}doHover(r,e,s){function n(x){return k.create(r.positionAt(x.offset),r.positionAt(x.end))}let c=r.offsetAt(e),u=Or(s,c),p=null;for(let x=0;x<u.length;x++){let g=u[x];if(g instanceof ye){let w=g.mnemonic,v=se.getMnemonic(w);if(v){let L=this.getParamNames(v,g);p={contents:bt(v,L,this.doesSupportMarkdown()),range:n(g)}}}if(g instanceof we){let w=se.getMnemonic("org");if(w){let v=[g.pcExpr.getText()];p={contents:bt(w,v,this.doesSupportMarkdown()),range:n(g)}}}if(g instanceof xe){let w=g.getText().slice(0,3).toLowerCase(),v=se.getMnemonic(w);v&&(p={contents:We(v,this.doesSupportMarkdown()),range:n(g)})}}return p&&(p.contents=this.convertContents(p.contents)),p}getParamNames(r,e){let s=[];return e.p1?s.push(this.getParamName(e.p1,e.mnemonic)):r.class==="ALU"?s.push("A"):s.push("?"),e.p2?s.push(this.getParamName(e.p2,e.mnemonic)):s.push("?"),s}getParamName(r,e){return r instanceof be?r.value:r instanceof Y?`(${r.getText()})`:r instanceof ve?e.toLowerCase()==="ldi"&&+r.value>15?`0x${r.value.toString(16).toUpperCase()}`:r.value.toString():"?"}convertContents(r){return this.doesSupportMarkdown()||typeof r=="string"?r:"kind"in r?{kind:"plaintext",value:r.value}:Array.isArray(r)?r.map(e=>typeof e=="string"?e:e.value):r.value}doesSupportMarkdown(){if(!ne(this.supportsMarkdown)){if(!ne(this.clientCapabilities))return this.supportsMarkdown=!0,this.supportsMarkdown;let r=this.clientCapabilities.textDocument&&this.clientCapabilities.textDocument.hover;this.supportsMarkdown=r&&r.contentFormat&&Array.isArray(r.contentFormat)&&r.contentFormat.indexOf(U.Markdown)!==-1}return this.supportsMarkdown}};var Wt=class{constructor(r,e){this.symbols=[]}addSymbol(r){this.symbols.push(r)}getSymbol(r,e){for(let s=0;s<this.symbols.length;s++){let n=this.symbols[s];if(n.name===r&&n.type===e)return n}return null}},Nt=class extends Wt{constructor(){super(0,Number.MAX_VALUE)}},Tt=class{constructor(r,e,s,n){this.name=r,this.value=e,this.node=s,this.type=n}},Vt=class{constructor(r){this.scope=r}addSymbol(r,e,s,n){r.offset!==-1&&this.scope.addSymbol(new Tt(e,s,r,n))}visitNode(r){switch(r.type){case O.Label:return this.addSymbol(r,r.getText(),void 0,me.Label),!0}return!0}},Le=class{constructor(r){this.global=new Nt,r.acceptVisitor(new Vt(this.global))}internalFindSymbol(r,e){let s=r.getText(),n=this.global;for(let c=0;c<e.length;c++){let u=e[c],p=n.getSymbol(s,u);if(p)return p}return null}evaluateReferenceTypes(r){return r instanceof Y||r instanceof q?[me.Label]:null}findSymbolFromNode(r){if(!r)return null;let e=this.evaluateReferenceTypes(r);return e?this.internalFindSymbol(r,e):null}matchesSymbol(r,e){if(!r||!r.matches(e.name))return!1;let s=this.evaluateReferenceTypes(r);return!s||s.indexOf(e.type)===-1?!1:this.internalFindSymbol(r,s)===e}};var Ge=class{findDefinition(r,e,s){let n=new Le(s),c=r.offsetAt(e),u=Fe(s,c);if(!u)return null;let p=n.findSymbolFromNode(u);return p?{uri:r.uri,range:He(p.node,r)}:null}findReferences(r,e,s){return this.findDocumentHighlights(r,e,s).map(c=>({uri:r.uri,range:c.range}))}findDocumentHighlights(r,e,s){let n=[],c=r.offsetAt(e),u=Fe(s,c);if(!u||u.type!==O.Label&&u.type!==O.LabelRef)return n;let p=new Le(s),x=p.findSymbolFromNode(u),g=u.getText();return s.accept(w=>{if(x){if(p.matchesSymbol(w,x))return n.push({kind:Fn(w),range:He(w,r)}),!1}else u&&u.type===w.type&&w.matches(g)&&n.push({kind:Fn(w),range:He(w,r)});return!0}),n}findDocumentSymbols(r,e){let s=[];return e.accept(n=>{let c={name:null,kind:ue.Class,location:null},u=n;return n instanceof q&&(c.name=n.getText(),c.kind=ue.Variable),c.name&&(c.location=Q.create(r.uri,He(u,r)),s.push(c)),!0}),s}};function Fn(t){return t instanceof q?le.Write:le.Read}function He(t,r){return k.create(r.positionAt(t.offset),r.positionAt(t.end))}var Xe=class{constructor(){}configure(r){this.settings=r}doValidation(r,e=this.settings){if(e&&e.validate===!1)return[];let{errors:s,warnings:n}=xt(r.getText()),c=(p,x)=>({severity:x,range:{start:r.positionAt(p.loc.start.offset),end:r.positionAt(p.loc.end.offset)},message:p.msg,source:r.languageId}),u=[];return u.push(...s.map(p=>c(p,ie.Error))),u.push(...n.map(p=>c(p,ie.Warning))),u}};function Rn(t){let r=new Be,e=new qe(t&&t.clientCapabilities),s=new ze(t&&t.clientCapabilities),n=new Ge,c=new Xe;return{doValidation:c.doValidation.bind(c),parseProgram:r.parseProgram.bind(r),doComplete:s.doComplete.bind(s),doHover:e.doHover.bind(e),findDefinition:n.findDefinition.bind(n),findReferences:n.findReferences.bind(n),findDocumentHighlights:n.findDocumentHighlights.bind(n),findDocumentSymbols:n.findDocumentSymbols.bind(n)}}var Je=class{_ctx;_languageService;_languageId;constructor(r,e){this._ctx=r,this._languageId=e.languageId,this._languageService=Rn({})}async doValidation(r){let e=this._getTextDocument(r);if(e){let s=this._languageService.doValidation(e);return Promise.resolve(s)}return Promise.resolve([])}async doComplete(r,e){let s=this._getTextDocument(r);if(!s)return null;let n=this._languageService.parseProgram(s),c=this._languageService.doComplete(s,e,n);return Promise.resolve(c)}async doHover(r,e){let s=this._getTextDocument(r);if(!s)return null;let n=this._languageService.parseProgram(s),c=this._languageService.doHover(s,e,n);return Promise.resolve(c)}async findDefinition(r,e){let s=this._getTextDocument(r);if(!s)return null;let n=this._languageService.parseProgram(s),c=this._languageService.findDefinition(s,e,n);return Promise.resolve(c)}async findReferences(r,e){let s=this._getTextDocument(r);if(!s)return[];let n=this._languageService.parseProgram(s),c=this._languageService.findReferences(s,e,n);return Promise.resolve(c)}async findDocumentHighlights(r,e){let s=this._getTextDocument(r);if(!s)return[];let n=this._languageService.parseProgram(s),c=this._languageService.findDocumentHighlights(s,e,n);return Promise.resolve(c)}async findDocumentSymbols(r){let e=this._getTextDocument(r);if(!e)return[];let s=this._languageService.parseProgram(e),n=this._languageService.findDocumentSymbols(e,s);return Promise.resolve(n)}_getTextDocument(r){let e=this._ctx.getMirrorModels();for(let s of e)if(s.uri.toString()===r)return Se.create(r,this._languageId,s.version,s.getValue());return null}};function ta(t,r){return new Je(t,r)}return br(ra);})();
return moduleExports;
});
