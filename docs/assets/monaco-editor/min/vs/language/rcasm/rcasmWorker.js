/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.50.0(cfceb029dc52d8f5a1d29e141c56ebdee3479b85)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/
define("vs/language/rcasm/rcasmWorker", ["require","require"],(require)=>{
"use strict";var moduleExports=(()=>{var dt=Object.defineProperty;var Po=Object.getOwnPropertyDescriptor;var Io=Object.getOwnPropertyNames;var Do=Object.prototype.hasOwnProperty;var Fo=(t,r)=>()=>(t&&(r=t(t=0)),r);var kr=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports),_r=(t,r)=>{for(var e in r)dt(t,e,{get:r[e],enumerable:!0})},Oo=(t,r,e,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of Io(r))!Do.call(t,s)&&s!==e&&dt(t,s,{get:()=>r[s],enumerable:!(n=Po(r,s))||n.enumerable});return t};var Pr=t=>Oo(dt({},"__esModule",{value:!0}),t);var pt={};_r(pt,{DataSize:()=>we,mkAlign:()=>Jo,mkAsmLine:()=>Vo,mkBinaryOp:()=>ea,mkData:()=>Xo,mkFill:()=>Zo,mkGetCurPC:()=>qo,mkInsn:()=>Go,mkLabel:()=>No,mkLiteral:()=>Yo,mkProgram:()=>zo,mkRegister:()=>Qo,mkScopeQualifiedIdent:()=>Ko,mkSetPC:()=>Ho});function zo(t,r){return{lines:t,loc:r}}function Vo(t,r,e,n){return{label:t,stmt:r,scopedStmts:e,loc:n}}function No(t,r){return{name:t,loc:r}}function Ho(t,r){return{type:"setpc",pc:t,loc:r}}function qo(t){return{type:"getcurpc",loc:t}}function Go(t,r,e,n){return{type:"insn",mnemonic:t,p1:r,p2:e,loc:n}}function Xo(t,r,e){return{type:"data",values:r,dataSize:t,loc:e}}function Zo(t,r,e){return{type:"fill",numBytes:t,fillValue:r,loc:e}}function Jo(t,r){return{type:"align",alignBytes:t,loc:r}}function Yo(t,r,e){return{type:"literal",lit:t,ot:r,loc:e}}function Qo(t,r){return{type:"register",value:t,loc:r}}function Ko(t,r,e){return{type:"qualified-ident",path:t,absolute:r,loc:e}}function ea(t,r,e,n){return{type:"binary",op:t,left:r,right:e,loc:n}}var we,gt=Fo(()=>{(function(t){t[t.Byte=0]="Byte",t[t.Word=1]="Word"})(we||(we={}))});var jr=kr((Ia,Rr)=>{"use strict";function L(t){if(this.words=[],t)if(Symbol&&Symbol.iterator&&t[Symbol.iterator]!==void 0){let r=t[Symbol.iterator](),e=r.next();for(;!e.done;)this.add(e.value),e=r.next()}else for(let r=0;r<t.length;r++)this.add(t[r])}L.fromWords=function(t){let r=Object.create(L.prototype);return r.words=t,r};L.prototype.add=function(t){this.resize(t),this.words[t>>>5]|=1<<t};L.prototype.flip=function(t){this.resize(t),this.words[t>>>5]^=1<<t};L.prototype.clear=function(){this.words.length=0};L.prototype.remove=function(t){this.resize(t),this.words[t>>>5]&=~(1<<t)};L.prototype.isEmpty=function(t){let r=this.words.length;for(let e=0;e<r;e++)if(this.words[e]!==0)return!1;return!0};L.prototype.has=function(t){return(this.words[t>>>5]&1<<t)!==0};L.prototype.checkedAdd=function(t){this.resize(t);let r=this.words[t>>>5],e=r|1<<t;return this.words[t>>>5]=e,(e^r)>>>t};L.prototype.trim=function(t){let r=this.words.length;for(;r>0&&this.words[r-1]===0;)r--;this.words.length=r};L.prototype.resize=function(t){let r=t+32>>>5;for(let e=this.words.length;e<r;e++)this.words[e]=0};L.prototype.hammingWeight=function(t){return t-=t>>>1&1431655765,t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24};L.prototype.hammingWeight4=function(t,r,e,n){return t-=t>>>1&1431655765,r-=r>>>1&1431655765,e-=e>>>1&1431655765,n-=n>>>1&1431655765,t=(t&858993459)+(t>>>2&858993459),r=(r&858993459)+(r>>>2&858993459),e=(e&858993459)+(e>>>2&858993459),n=(n&858993459)+(n>>>2&858993459),t=t+(t>>>4)&252645135,r=r+(r>>>4)&252645135,e=e+(e>>>4)&252645135,n=n+(n>>>4)&252645135,(t+r+e+n)*16843009>>>24};L.prototype.size=function(){let t=0,r=this.words.length,e=this.words;for(let n=0;n<r;n++)t+=this.hammingWeight(e[n]);return t};L.prototype.array=function(){let t=new Array(this.size()),r=0,e=this.words.length;for(let n=0;n<e;++n){let s=this.words[n];for(;s!=0;){let c=s&-s;t[r++]=(n<<5)+this.hammingWeight(c-1|0),s^=c}}return t};L.prototype.forEach=function(t){let r=this.words.length;for(let e=0;e<r;++e){let n=this.words[e];for(;n!=0;){let s=n&-n;t((e<<5)+this.hammingWeight(s-1|0)),n^=s}}};L.prototype[Symbol.iterator]=function(){let t=this.words.length,r=0,e=this.words[r],n=this.hammingWeight,s=this.words;return{[Symbol.iterator](){return this},next(){for(;r<t;)if(e!==0){let c=e&-e,u=(r<<5)+n(c-1|0);return e^=c,{done:!1,value:u}}else r++,r<t&&(e=s[r]);return{done:!0,value:void 0}}}};L.prototype.clone=function(){let t=Object.create(L.prototype);return t.words=this.words.slice(),t};L.prototype.intersects=function(t){let r=Math.min(this.words.length,t.words.length);for(let e=0;e<r;++e)if(this.words[e]&t.words[e])return!0;return!1};L.prototype.intersection=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]&=t.words[e],this.words[e+1]&=t.words[e+1],this.words[e+2]&=t.words[e+2],this.words[e+3]&=t.words[e+3],this.words[e+4]&=t.words[e+4],this.words[e+5]&=t.words[e+5],this.words[e+6]&=t.words[e+6],this.words[e+7]&=t.words[e+7];for(;e<r;++e)this.words[e]&=t.words[e];let n=this.words.length;for(e=r;e<n;++e)this.words[e]=0;return this};L.prototype.intersection_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(let n=0;n<r;++n)e+=this.hammingWeight(this.words[n]&t.words[n]);return e};L.prototype.new_intersection=function(t){let r=Object.create(L.prototype),e=Math.min(this.words.length,t.words.length);r.words=new Array(e);let n=0;for(;n+7<e;n+=8)r.words[n]=this.words[n]&t.words[n],r.words[n+1]=this.words[n+1]&t.words[n+1],r.words[n+2]=this.words[n+2]&t.words[n+2],r.words[n+3]=this.words[n+3]&t.words[n+3],r.words[n+4]=this.words[n+4]&t.words[n+4],r.words[n+5]=this.words[n+5]&t.words[n+5],r.words[n+6]=this.words[n+6]&t.words[n+6],r.words[n+7]=this.words[n+7]&t.words[n+7];for(;n<e;++n)r.words[n]=this.words[n]&t.words[n];return r};L.prototype.equals=function(t){let r=Math.min(this.words.length,t.words.length);for(let e=0;e<r;++e)if(this.words[e]!=t.words[e])return!1;if(this.words.length<t.words.length){let e=t.words.length;for(let n=this.words.length;n<e;++n)if(t.words[n]!=0)return!1}else if(t.words.length<this.words.length){let e=this.words.length;for(let n=t.words.length;n<e;++n)if(this.words[n]!=0)return!1}return!0};L.prototype.difference=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]&=~t.words[e],this.words[e+1]&=~t.words[e+1],this.words[e+2]&=~t.words[e+2],this.words[e+3]&=~t.words[e+3],this.words[e+4]&=~t.words[e+4],this.words[e+5]&=~t.words[e+5],this.words[e+6]&=~t.words[e+6],this.words[e+7]&=~t.words[e+7];for(;e<r;++e)this.words[e]&=~t.words[e];return this};L.prototype.new_difference=function(t){return this.clone().difference(t)};L.prototype.difference2=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)t.words[e]=this.words[e]&~t.words[e],t.words[e+1]=this.words[e+1]&~t.words[e+1],t.words[e+2]=this.words[e+2]&~t.words[e+2],t.words[e+3]=this.words[e+3]&~t.words[e+3],t.words[e+4]=this.words[e+4]&~t.words[e+4],t.words[e+5]=this.words[e+5]&~t.words[e+5],t.words[e+6]=this.words[e+6]&~t.words[e+6],t.words[e+7]=this.words[e+7]&~t.words[e+7];for(;e<r;++e)t.words[e]=this.words[e]&~t.words[e];for(e=this.words.length-1;e>=r;--e)t.words[e]=this.words[e];return t.words.length=this.words.length,t};L.prototype.difference_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0,n=0;for(;n<r;++n)e+=this.hammingWeight(this.words[n]&~t.words[n]);let s=this.words.length;for(;n<s;++n)e+=this.hammingWeight(this.words[n]);return e};L.prototype.change=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]^=t.words[e],this.words[e+1]^=t.words[e+1],this.words[e+2]^=t.words[e+2],this.words[e+3]^=t.words[e+3],this.words[e+4]^=t.words[e+4],this.words[e+5]^=t.words[e+5],this.words[e+6]^=t.words[e+6],this.words[e+7]^=t.words[e+7];for(;e<r;++e)this.words[e]^=t.words[e];for(e=t.words.length-1;e>=r;--e)this.words[e]=t.words[e];return this};L.prototype.new_change=function(t){let r=Object.create(L.prototype),e=Math.max(this.words.length,t.words.length);r.words=new Array(e);let n=Math.min(this.words.length,t.words.length),s=0;for(;s+7<n;s+=8)r.words[s]=this.words[s]^t.words[s],r.words[s+1]=this.words[s+1]^t.words[s+1],r.words[s+2]=this.words[s+2]^t.words[s+2],r.words[s+3]=this.words[s+3]^t.words[s+3],r.words[s+4]=this.words[s+4]^t.words[s+4],r.words[s+5]=this.words[s+5]^t.words[s+5],r.words[s+6]=this.words[s+6]^t.words[s+6],r.words[s+7]=this.words[s+7]^t.words[s+7];for(;s<n;++s)r.words[s]=this.words[s]^t.words[s];let c=this.words.length;for(s=n;s<c;++s)r.words[s]=this.words[s];let u=t.words.length;for(s=n;s<u;++s)r.words[s]=t.words[s];return r};L.prototype.change_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0,n=0;for(;n<r;++n)e+=this.hammingWeight(this.words[n]^t.words[n]);let s=this.words.length>t.words.length?this:t,c=s.words.length;for(;n<c;++n)e+=this.hammingWeight(s.words[n]);return e};L.prototype.toString=function(){return"{"+this.array().join(",")+"}"};L.prototype.union=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]|=t.words[e],this.words[e+1]|=t.words[e+1],this.words[e+2]|=t.words[e+2],this.words[e+3]|=t.words[e+3],this.words[e+4]|=t.words[e+4],this.words[e+5]|=t.words[e+5],this.words[e+6]|=t.words[e+6],this.words[e+7]|=t.words[e+7];for(;e<r;++e)this.words[e]|=t.words[e];if(this.words.length<t.words.length){this.resize((t.words.length<<5)-1);let n=t.words.length;for(let s=r;s<n;++s)this.words[s]=t.words[s]}return this};L.prototype.new_union=function(t){let r=Object.create(L.prototype),e=Math.max(this.words.length,t.words.length);r.words=new Array(e);let n=Math.min(this.words.length,t.words.length),s=0;for(;s+7<n;s+=8)r.words[s]=this.words[s]|t.words[s],r.words[s+1]=this.words[s+1]|t.words[s+1],r.words[s+2]=this.words[s+2]|t.words[s+2],r.words[s+3]=this.words[s+3]|t.words[s+3],r.words[s+4]=this.words[s+4]|t.words[s+4],r.words[s+5]=this.words[s+5]|t.words[s+5],r.words[s+6]=this.words[s+6]|t.words[s+6],r.words[s+7]=this.words[s+7]|t.words[s+7];for(;s<n;++s)r.words[s]=this.words[s]|t.words[s];let c=this.words.length;for(s=n;s<c;++s)r.words[s]=this.words[s];let u=t.words.length;for(s=n;s<u;++s)r.words[s]=t.words[s];return r};L.prototype.union_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(let n=0;n<r;++n)e+=this.hammingWeight(this.words[n]|t.words[n]);if(this.words.length<t.words.length){let n=t.words.length;for(let s=this.words.length;s<n;++s)e+=this.hammingWeight(t.words[s]|0)}else{let n=this.words.length;for(let s=t.words.length;s<n;++s)e+=this.hammingWeight(this.words[s]|0)}return e};Rr.exports=L});var Ur=kr((Fa,Br)=>{"use strict";function ra(t,r){function e(){this.constructor=t}e.prototype=r.prototype,t.prototype=new e}function J(t,r,e,n){this.message=t,this.expected=r,this.found=e,this.location=n,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,J)}ra(J,Error);J.buildMessage=function(t,r){var e={literal:function(g){return'"'+s(g.text)+'"'},class:function(g){var m="",b;for(b=0;b<g.parts.length;b++)m+=g.parts[b]instanceof Array?c(g.parts[b][0])+"-"+c(g.parts[b][1]):c(g.parts[b]);return"["+(g.inverted?"^":"")+m+"]"},any:function(g){return"any character"},end:function(g){return"end of input"},other:function(g){return g.description}};function n(g){return g.charCodeAt(0).toString(16).toUpperCase()}function s(g){return g.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+n(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+n(m)})}function c(g){return g.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+n(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+n(m)})}function u(g){return e[g.type](g)}function h(g){var m=new Array(g.length),b,S;for(b=0;b<g.length;b++)m[b]=u(g[b]);if(m.sort(),m.length>0){for(b=1,S=1;b<m.length;b++)m[b-1]!==m[b]&&(m[S]=m[b],S++);m.length=S}switch(m.length){case 1:return m[0];case 2:return m[0]+" or "+m[1];default:return m.slice(0,-1).join(", ")+", or "+m[m.length-1]}}function x(g){return g?'"'+s(g)+'"':"end of input"}return"Expected "+h(t)+" but "+x(r)+" found."};function sa(t,r){r=r!==void 0?r:{};var e={},n={Program:fr},s=fr,c=function(i){return _.mkProgram(i,I())},u=function(i,o){return ft(i,o,1)},h=function(i){return i},x=function(i,o){return _.mkAsmLine(i,null,o,I())},g=function(i,o){return _.mkAsmLine(i,o,null,I())},m=function(i){return _.mkAsmLine(i,null,null,I())},b=function(i){return _.mkAsmLine(null,i,null,I())},S=function(i){return _.mkAsmLine(null,i,null,I())},A=function(){return _.mkAsmLine(null,null,null,I())},R=function(i){return i},X=function(i){return i},Vs=j("directive"),Ns=function(i,o){let l=i=="byte"?_.DataSize.Byte:_.DataSize.Word;return _.mkData(l,o,I())},Hs=function(i,o){return _.mkFill(i,o,I())},qs=function(i){return _.mkAlign(i,I())},Gs=function(i,o,l){return _.mkInsn(i,o,l,I())},Xs=function(i,o){return _.mkInsn(i,o,null,I())},Zs=function(i){return _.mkInsn(i,null,null,I())},Js=function(i,o){return o.reduce(function(l,f){return _.mkBinaryOp(f[0],l,f[1],I())},i)},Ys=/^[a-zA-Z_]/,Qs=z([["a","z"],["A","Z"],"_"],!1,!1),Ks=/^[a-zA-Z_0-9]/,en=z([["a","z"],["A","Z"],"_",["0","9"]],!1,!1),Xt=/^[0-9a-f]/i,Zt=z([["0","9"],["a","f"]],!1,!0),Jt=/^[0-1]/,Yt=z([["0","1"]],!1,!1),tn=/^[+\-]/,rn=z(["+","-"],!1,!1),Qt=/^[0-9]/,Kt=z([["0","9"]],!1,!1),er=/^[a-z]/i,tr=z([["a","z"]],!1,!0),rr=/^[0-9a-z_]/i,sr=z([["0","9"],["a","z"],"_"],!1,!0),sn="a",nn=E("a",!0),on="b",an=E("b",!0),cn="c",ln=E("c",!0),un="d",fn=E("d",!0),dn="g",hn=E("g",!0),pn="h",gn=E("h",!0),mn="j",wn=E("j",!0),xn="m",yn=E("m",!0),bn="o",vn=E("o",!0),$n="p",Sn=E("p",!0),An="r",Cn=E("r",!0),Ln="s",En=E("s",!0),kn="x",_n=E("x",!0),Pn="y",In=E("y",!0),Dn="0",Fn=E("0",!1),On="1",Mn=E("1",!1),Rn="2",jn=E("2",!1),Bn=",",Un=E(",",!1),Z=function(i){return i},Wn="{",Tn=E("{",!1),zn="}",Vn=E("}",!1),Nn="-",Hn=E("-",!1),qn="+",Gn=E("+",!1),Xn="\xA7",Zn=E("\xA7",!1),Jn="*",Yn=E("*",!1),nr="!align",Qn=E("!align",!1),ir="!byte",Kn=E("!byte",!1),ei=function(){return"byte"},or="!word",ti=E("!word",!1),ri=function(){return"word"},ar="!fill",si=E("!fill",!1),ni=function(i){return parseInt(i,2)},ii=function(i){return parseInt(i,16)},oi=function(i){return parseInt(i)},Ke='"',et=E('"',!1),ai=function(i){return i.join("")},tt=Ji(),ci=function(i){return i},li=function(){return Xi()},cr=j("whitespace"),ui="	",fi=E("	",!1),di="\v",hi=E("\v",!1),pi="\f",gi=E("\f",!1),mi=" ",wi=E(" ",!1),xi="\xA0",yi=E("\xA0",!1),bi="\uFEFF",vi=E("\uFEFF",!1),$i=j("end of line"),Si=/^[\n\r]/,Ai=z([`
`,"\r"],!1,!1),Ci=j("comment"),Li=";",Ei=E(";",!1),ki=j("label"),_i=":",Pi=E(":",!1),Ii=function(i){return _.mkLabel(i,I())},Di=j("ORG"),Fi=function(i){return _.mkSetPC(i,I())},Oi=j("mnemonic"),Mi=function(i){return i},Ri=j("literal"),ji=function(i){return _.mkLiteral(i,"b",I())},Bi=function(i){return _.mkLiteral(i,"h",I())},Ui=function(i){return _.mkLiteral(i,"d",I())},Wi=function(i){return _.mkLiteral(i,"s",I())},Ti=j("identifier"),W="::",ge=E("::",!1),zi=function(i,o){return _.mkScopeQualifiedIdent(ft(i,o,1),!1,I())},Vi=function(i,o){return _.mkScopeQualifiedIdent(ft(i,o,1),!0,I())},Ni=j("register"),Hi=function(i){return _.mkRegister(i.toLowerCase(),I())},qi=j("current-pc"),Gi=function(){return _.mkGetCurPC(I())},a=0,$=0,Me=[{line:1,column:1}],T=0,rt=[],w=0,Re;if("startRule"in r){if(!(r.startRule in n))throw new Error(`Can't start parsing from rule "`+r.startRule+'".');s=n[r.startRule]}function Xi(){return t.substring($,a)}function Zi(){return me($,a)}function Sa(i,o){throw o=o!==void 0?o:me($,a),ur([j(i)],t.substring($,a),o)}function Aa(i,o){throw o=o!==void 0?o:me($,a),Qi(i,o)}function E(i,o){return{type:"literal",text:i,ignoreCase:o}}function z(i,o,l){return{type:"class",parts:i,inverted:o,ignoreCase:l}}function Ji(){return{type:"any"}}function Yi(){return{type:"end"}}function j(i){return{type:"other",description:i}}function lr(i){var o=Me[i],l;if(o)return o;for(l=i-1;!Me[l];)l--;for(o=Me[l],o={line:o.line,column:o.column};l<i;)t.charCodeAt(l)===10?(o.line++,o.column=1):o.column++,l++;return Me[i]=o,o}function me(i,o){var l=lr(i),f=lr(o);return{start:{offset:i,line:l.line,column:l.column},end:{offset:o,line:f.line,column:f.column}}}function y(i){a<T||(a>T&&(T=a,rt=[]),rt.push(i))}function Qi(i,o){return new J(i,null,null,o)}function ur(i,o,l){return new J(J.buildMessage(i,o),i,o,l)}function fr(){var i,o;return i=a,o=dr(),o!==e&&($=i,o=c(o)),i=o,i}function dr(){var i,o,l,f,p,v;if(i=a,o=st(),o!==e){for(l=[],f=a,p=Be(),p!==e?(v=st(),v!==e?(p=[p,v],f=p):(a=f,f=e)):(a=f,f=e);f!==e;)l.push(f),f=a,p=Be(),p!==e?(v=st(),v!==e?(p=[p,v],f=p):(a=f,f=e)):(a=f,f=e);l!==e?($=i,o=u(o,l),i=o):(a=i,i=e)}else a=i,i=e;return i}function st(){var i,o,l,f;return i=a,o=P(),o!==e?(l=Ki(),l!==e?(f=Ao(),f===e&&(f=null),f!==e?($=i,o=h(l),i=o):(a=i,i=e)):(a=i,i=e)):(a=i,i=e),i}function Ki(){var i,o,l,f,p;return i=a,o=lt(),o!==e?(l=ho(),l!==e?(f=dr(),f!==e?(p=po(),p!==e?($=i,o=x(o,f),i=o):(a=i,i=e)):(a=i,i=e)):(a=i,i=e)):(a=i,i=e),i===e&&(i=a,o=lt(),o!==e?(l=hr(),l!==e?($=i,o=g(o,l),i=o):(a=i,i=e)):(a=i,i=e),i===e&&(i=a,o=lt(),o!==e&&($=i,o=m(o)),i=o,i===e&&(i=a,o=Co(),o!==e&&($=i,o=b(o)),i=o,i===e&&(i=a,o=hr(),o!==e&&($=i,o=S(o)),i=o,i===e&&(i=a,o=P(),o!==e&&($=i,o=A()),i=o))))),i}function hr(){var i,o;return i=a,o=eo(),o!==e&&($=i,o=R(o)),i=o,i===e&&(i=a,o=ro(),o!==e&&($=i,o=X(o)),i=o),i}function eo(){var i,o,l,f,p;return w++,i=a,o=wo(),o===e&&(o=xo()),o!==e?(l=to(),l!==e?($=i,o=Ns(o,l),i=o):(a=i,i=e)):(a=i,i=e),i===e&&(i=a,o=yo(),o!==e?(l=V(),l!==e?(f=je(),f!==e?(p=V(),p!==e?($=i,o=Hs(l,p),i=o):(a=i,i=e)):(a=i,i=e)):(a=i,i=e)):(a=i,i=e),i===e&&(i=a,o=mo(),o!==e?(l=V(),l!==e?($=i,o=qs(l),i=o):(a=i,i=e)):(a=i,i=e))),w--,i===e&&(o=e,w===0&&y(Vs)),i}function to(){var i,o,l,f,p,v;if(i=a,o=V(),o!==e){for(l=[],f=a,p=je(),p!==e?(v=V(),v!==e?(p=[p,v],f=p):(a=f,f=e)):(a=f,f=e);f!==e;)l.push(f),f=a,p=je(),p!==e?(v=V(),v!==e?(p=[p,v],f=p):(a=f,f=e)):(a=f,f=e);l!==e?($=i,o=u(o,l),i=o):(a=i,i=e)}else a=i,i=e;return i}function ro(){var i,o,l,f,p;return i=a,o=ut(),o!==e?(l=V(),l!==e?(f=je(),f!==e?(p=V(),p!==e?($=i,o=Gs(o,l,p),i=o):(a=i,i=e)):(a=i,i=e)):(a=i,i=e)):(a=i,i=e),i===e&&(i=a,o=ut(),o!==e?(l=V(),l!==e?($=i,o=Xs(o,l),i=o):(a=i,i=e)):(a=i,i=e),i===e&&(i=a,o=ut(),o!==e&&($=i,o=Zs(o)),i=o)),i}function V(){var i,o,l,f,p,v;if(i=a,o=nt(),o!==e){for(l=[],f=a,p=Sr(),p===e&&(p=$r(),p===e&&(p=Ar())),p!==e?(v=nt(),v!==e?(p=[p,v],f=p):(a=f,f=e)):(a=f,f=e);f!==e;)l.push(f),f=a,p=Sr(),p===e&&(p=$r(),p===e&&(p=Ar())),p!==e?(v=nt(),v!==e?(p=[p,v],f=p):(a=f,f=e)):(a=f,f=e);l!==e?($=i,o=Js(o,l),i=o):(a=i,i=e)}else a=i,i=e;return i}function nt(){var i;return i=Er(),i===e&&(i=Eo(),i===e&&(i=Lo(),i===e&&(i=ko()))),i}function it(){var i;return Ys.test(t.charAt(a))?(i=t.charAt(a),a++):(i=e,w===0&&y(Qs)),i}function pr(){var i;return Ks.test(t.charAt(a))?(i=t.charAt(a),a++):(i=e,w===0&&y(en)),i}function so(){var i,o;if(i=[],Xt.test(t.charAt(a))?(o=t.charAt(a),a++):(o=e,w===0&&y(Zt)),o!==e)for(;o!==e;)i.push(o),Xt.test(t.charAt(a))?(o=t.charAt(a),a++):(o=e,w===0&&y(Zt));else i=e;return i}function no(){var i,o;if(i=[],Jt.test(t.charAt(a))?(o=t.charAt(a),a++):(o=e,w===0&&y(Yt)),o!==e)for(;o!==e;)i.push(o),Jt.test(t.charAt(a))?(o=t.charAt(a),a++):(o=e,w===0&&y(Yt));else i=e;return i}function io(){var i,o,l,f;if(i=a,tn.test(t.charAt(a))?(o=t.charAt(a),a++):(o=e,w===0&&y(rn)),o===e&&(o=null),o!==e){if(l=[],Qt.test(t.charAt(a))?(f=t.charAt(a),a++):(f=e,w===0&&y(Kt)),f!==e)for(;f!==e;)l.push(f),Qt.test(t.charAt(a))?(f=t.charAt(a),a++):(f=e,w===0&&y(Kt));else l=e;l!==e?(o=[o,l],i=o):(a=i,i=e)}else a=i,i=e;return i}function Ca(){var i,o,l,f;if(i=a,o=[],er.test(t.charAt(a))?(l=t.charAt(a),a++):(l=e,w===0&&y(tr)),l!==e)for(;l!==e;)o.push(l),er.test(t.charAt(a))?(l=t.charAt(a),a++):(l=e,w===0&&y(tr));else o=e;if(o!==e){for(l=[],rr.test(t.charAt(a))?(f=t.charAt(a),a++):(f=e,w===0&&y(sr));f!==e;)l.push(f),rr.test(t.charAt(a))?(f=t.charAt(a),a++):(f=e,w===0&&y(sr));l!==e?(o=[o,l],i=o):(a=i,i=e)}else a=i,i=e;return i}function gr(){var i;return t.substr(a,1).toLowerCase()===sn?(i=t.charAt(a),a++):(i=e,w===0&&y(nn)),i}function mr(){var i;return t.substr(a,1).toLowerCase()===on?(i=t.charAt(a),a++):(i=e,w===0&&y(an)),i}function wr(){var i;return t.substr(a,1).toLowerCase()===cn?(i=t.charAt(a),a++):(i=e,w===0&&y(ln)),i}function xr(){var i;return t.substr(a,1).toLowerCase()===un?(i=t.charAt(a),a++):(i=e,w===0&&y(fn)),i}function oo(){var i;return t.substr(a,1).toLowerCase()===dn?(i=t.charAt(a),a++):(i=e,w===0&&y(hn)),i}function La(){var i;return t.substr(a,1).toLowerCase()===pn?(i=t.charAt(a),a++):(i=e,w===0&&y(gn)),i}function ot(){var i;return t.substr(a,1).toLowerCase()===mn?(i=t.charAt(a),a++):(i=e,w===0&&y(wn)),i}function at(){var i;return t.substr(a,1).toLowerCase()===xn?(i=t.charAt(a),a++):(i=e,w===0&&y(yn)),i}function ao(){var i;return t.substr(a,1).toLowerCase()===bn?(i=t.charAt(a),a++):(i=e,w===0&&y(vn)),i}function co(){var i;return t.substr(a,1).toLowerCase()===$n?(i=t.charAt(a),a++):(i=e,w===0&&y(Sn)),i}function lo(){var i;return t.substr(a,1).toLowerCase()===An?(i=t.charAt(a),a++):(i=e,w===0&&y(Cn)),i}function uo(){var i;return t.substr(a,1).toLowerCase()===Ln?(i=t.charAt(a),a++):(i=e,w===0&&y(En)),i}function ct(){var i;return t.substr(a,1).toLowerCase()===kn?(i=t.charAt(a),a++):(i=e,w===0&&y(_n)),i}function yr(){var i;return t.substr(a,1).toLowerCase()===Pn?(i=t.charAt(a),a++):(i=e,w===0&&y(In)),i}function fo(){var i;return t.charCodeAt(a)===48?(i=Dn,a++):(i=e,w===0&&y(Fn)),i}function br(){var i;return t.charCodeAt(a)===49?(i=On,a++):(i=e,w===0&&y(Mn)),i}function vr(){var i;return t.charCodeAt(a)===50?(i=Rn,a++):(i=e,w===0&&y(jn)),i}function je(){var i,o,l;return i=a,t.charCodeAt(a)===44?(o=Bn,a++):(o=e,w===0&&y(Un)),o!==e?(l=P(),l!==e?($=i,o=Z(o),i=o):(a=i,i=e)):(a=i,i=e),i}function ho(){var i,o,l;return i=a,t.charCodeAt(a)===123?(o=Wn,a++):(o=e,w===0&&y(Tn)),o!==e?(l=P(),l!==e?($=i,o=Z(o),i=o):(a=i,i=e)):(a=i,i=e),i}function po(){var i,o,l;return i=a,t.charCodeAt(a)===125?(o=zn,a++):(o=e,w===0&&y(Vn)),o!==e?(l=P(),l!==e?($=i,o=Z(o),i=o):(a=i,i=e)):(a=i,i=e),i}function $r(){var i,o,l;return i=a,t.charCodeAt(a)===45?(o=Nn,a++):(o=e,w===0&&y(Hn)),o!==e?(l=P(),l!==e?($=i,o=Z(o),i=o):(a=i,i=e)):(a=i,i=e),i}function Sr(){var i,o,l;return i=a,t.charCodeAt(a)===43?(o=qn,a++):(o=e,w===0&&y(Gn)),o!==e?(l=P(),l!==e?($=i,o=Z(o),i=o):(a=i,i=e)):(a=i,i=e),i}function Ar(){var i,o,l;return i=a,t.charCodeAt(a)===167?(o=Xn,a++):(o=e,w===0&&y(Zn)),o!==e?(l=P(),l!==e?($=i,o=Z(o),i=o):(a=i,i=e)):(a=i,i=e),i}function go(){var i,o,l;return i=a,t.charCodeAt(a)===42?(o=Jn,a++):(o=e,w===0&&y(Yn)),o!==e?(l=P(),l!==e?($=i,o=Z(o),i=o):(a=i,i=e)):(a=i,i=e),i}function mo(){var i,o,l;return i=a,t.substr(a,6)===nr?(o=nr,a+=6):(o=e,w===0&&y(Qn)),o!==e?(l=P(),l!==e?(o=[o,l],i=o):(a=i,i=e)):(a=i,i=e),i}function wo(){var i,o,l;return i=a,t.substr(a,5)===ir?(o=ir,a+=5):(o=e,w===0&&y(Kn)),o!==e?(l=P(),l!==e?($=i,o=ei(),i=o):(a=i,i=e)):(a=i,i=e),i}function xo(){var i,o,l;return i=a,t.substr(a,5)===or?(o=or,a+=5):(o=e,w===0&&y(ti)),o!==e?(l=P(),l!==e?($=i,o=ri(),i=o):(a=i,i=e)):(a=i,i=e),i}function yo(){var i,o,l;return i=a,t.substr(a,5)===ar?(o=ar,a+=5):(o=e,w===0&&y(si)),o!==e?(l=P(),l!==e?(o=[o,l],i=o):(a=i,i=e)):(a=i,i=e),i}function bo(){var i,o,l;return i=a,o=a,l=no(),l!==e?o=t.substring(o,a):o=l,o!==e?(l=mr(),l!==e?($=i,o=ni(o),i=o):(a=i,i=e)):(a=i,i=e),i}function vo(){var i,o,l,f,p;return i=a,o=fo(),o!==e?(l=ct(),l!==e?(f=a,p=so(),p!==e?f=t.substring(f,a):f=p,f!==e?($=i,o=ii(f),i=o):(a=i,i=e)):(a=i,i=e)):(a=i,i=e),i}function $o(){var i,o,l;return i=a,o=a,l=io(),l!==e?o=t.substring(o,a):o=l,o!==e?(l=xr(),l===e&&(l=null),l!==e?($=i,o=oi(o),i=o):(a=i,i=e)):(a=i,i=e),i}function So(){var i,o,l,f;if(i=a,t.charCodeAt(a)===34?(o=Ke,a++):(o=e,w===0&&y(et)),o!==e){for(l=[],f=Cr();f!==e;)l.push(f),f=Cr();l!==e?(t.charCodeAt(a)===34?(f=Ke,a++):(f=e,w===0&&y(et)),f!==e?($=i,o=ai(l),i=o):(a=i,i=e)):(a=i,i=e)}else a=i,i=e;return i}function Cr(){var i,o,l;return i=a,o=a,w++,t.charCodeAt(a)===34?(l=Ke,a++):(l=e,w===0&&y(et)),w--,l===e?o=void 0:(a=o,o=e),o!==e?(t.length>a?(l=t.charAt(a),a++):(l=e,w===0&&y(tt)),l!==e?($=i,o=ci(l),i=o):(a=i,i=e)):(a=i,i=e),i}function H(){var i,o,l,f,p;if(i=a,o=a,l=[],f=it(),f!==e)for(;f!==e;)l.push(f),f=it();else l=e;if(l!==e){for(f=[],p=pr();p!==e;)f.push(p),p=pr();f!==e?(l=[l,f],o=l):(a=o,o=e)}else a=o,o=e;return o!==e&&($=i,o=li()),i=o,i}function P(){var i,o;for(w++,i=[],o=Lr();o!==e;)i.push(o),o=Lr();return w--,i===e&&(o=e,w===0&&y(cr)),i}function Lr(){var i,o;return w++,t.charCodeAt(a)===9?(i=ui,a++):(i=e,w===0&&y(fi)),i===e&&(t.charCodeAt(a)===11?(i=di,a++):(i=e,w===0&&y(hi)),i===e&&(t.charCodeAt(a)===12?(i=pi,a++):(i=e,w===0&&y(gi)),i===e&&(t.charCodeAt(a)===32?(i=mi,a++):(i=e,w===0&&y(wi)),i===e&&(t.charCodeAt(a)===160?(i=xi,a++):(i=e,w===0&&y(yi)),i===e&&(t.charCodeAt(a)===65279?(i=bi,a++):(i=e,w===0&&y(vi))))))),w--,i===e&&(o=e,w===0&&y(cr)),i}function Be(){var i,o;return w++,Si.test(t.charAt(a))?(i=t.charAt(a),a++):(i=e,w===0&&y(Ai)),w--,i===e&&(o=e,w===0&&y($i)),i}function Ao(){var i,o,l,f,p,v;if(w++,i=a,t.charCodeAt(a)===59?(o=Li,a++):(o=e,w===0&&y(Ei)),o!==e){for(l=[],f=a,p=a,w++,v=Be(),w--,v===e?p=void 0:(a=p,p=e),p!==e?(t.length>a?(v=t.charAt(a),a++):(v=e,w===0&&y(tt)),v!==e?(p=[p,v],f=p):(a=f,f=e)):(a=f,f=e);f!==e;)l.push(f),f=a,p=a,w++,v=Be(),w--,v===e?p=void 0:(a=p,p=e),p!==e?(t.length>a?(v=t.charAt(a),a++):(v=e,w===0&&y(tt)),v!==e?(p=[p,v],f=p):(a=f,f=e)):(a=f,f=e);l!==e?(o=[o,l],i=o):(a=i,i=e)}else a=i,i=e;return w--,i===e&&(o=e,w===0&&y(Ci)),i}function lt(){var i,o,l,f;return w++,i=a,o=H(),o!==e?(t.charCodeAt(a)===58?(l=_i,a++):(l=e,w===0&&y(Pi)),l!==e?(f=P(),f!==e?($=i,o=Ii(o),i=o):(a=i,i=e)):(a=i,i=e)):(a=i,i=e),w--,i===e&&(o=e,w===0&&y(ki)),i}function Co(){var i,o,l,f,p,v,N;return w++,i=a,o=ao(),o!==e?(l=lo(),l!==e?(f=oo(),f!==e?(p=P(),p!==e?(v=Er(),v!==e?(N=P(),N!==e?($=i,o=Fi(v),i=o):(a=i,i=e)):(a=i,i=e)):(a=i,i=e)):(a=i,i=e)):(a=i,i=e)):(a=i,i=e),w--,i===e&&(o=e,w===0&&y(Di)),i}function ut(){var i,o,l;return w++,i=a,o=H(),o!==e?(l=P(),l!==e?($=i,o=Mi(o),i=o):(a=i,i=e)):(a=i,i=e),w--,i===e&&(o=e,w===0&&y(Oi)),i}function Er(){var i,o,l;return w++,i=a,o=bo(),o!==e?(l=P(),l!==e?($=i,o=ji(o),i=o):(a=i,i=e)):(a=i,i=e),i===e&&(i=a,o=vo(),o!==e?(l=P(),l!==e?($=i,o=Bi(o),i=o):(a=i,i=e)):(a=i,i=e),i===e&&(i=a,o=$o(),o!==e?(l=P(),l!==e?($=i,o=Ui(o),i=o):(a=i,i=e)):(a=i,i=e),i===e&&(i=a,o=So(),o!==e?(l=P(),l!==e?($=i,o=Wi(o),i=o):(a=i,i=e)):(a=i,i=e)))),w--,i===e&&(o=e,w===0&&y(Ri)),i}function Lo(){var i,o,l,f,p,v,N;if(w++,i=a,o=H(),o!==e){for(l=[],f=a,t.substr(a,2)===W?(p=W,a+=2):(p=e,w===0&&y(ge)),p!==e?(v=H(),v!==e?(p=[p,v],f=p):(a=f,f=e)):(a=f,f=e);f!==e;)l.push(f),f=a,t.substr(a,2)===W?(p=W,a+=2):(p=e,w===0&&y(ge)),p!==e?(v=H(),v!==e?(p=[p,v],f=p):(a=f,f=e)):(a=f,f=e);l!==e?(f=P(),f!==e?($=i,o=zi(o,l),i=o):(a=i,i=e)):(a=i,i=e)}else a=i,i=e;if(i===e)if(i=a,t.substr(a,2)===W?(o=W,a+=2):(o=e,w===0&&y(ge)),o!==e)if(l=H(),l!==e){for(f=[],p=a,t.substr(a,2)===W?(v=W,a+=2):(v=e,w===0&&y(ge)),v!==e?(N=H(),N!==e?(v=[v,N],p=v):(a=p,p=e)):(a=p,p=e);p!==e;)f.push(p),p=a,t.substr(a,2)===W?(v=W,a+=2):(v=e,w===0&&y(ge)),v!==e?(N=H(),N!==e?(v=[v,N],p=v):(a=p,p=e)):(a=p,p=e);f!==e?(p=P(),p!==e?($=i,o=Vi(l,f),i=o):(a=i,i=e)):(a=i,i=e)}else a=i,i=e;else a=i,i=e;return w--,i===e&&(o=e,w===0&&y(Ti)),i}function Eo(){var i,o,l,f,p;return w++,i=a,o=a,l=a,f=gr(),f!==e?(p=uo(),p!==e?(f=[f,p],l=f):(a=l,l=e)):(a=l,l=e),l===e&&(l=gr(),l===e&&(l=mr(),l===e&&(l=wr(),l===e&&(l=xr(),l===e&&(l=a,f=at(),f!==e?(p=vr(),p!==e?(f=[f,p],l=f):(a=l,l=e)):(a=l,l=e),l===e&&(l=a,f=at(),f!==e?(p=br(),p!==e?(f=[f,p],l=f):(a=l,l=e)):(a=l,l=e),l===e&&(l=at(),l===e&&(l=a,f=co(),f!==e?(p=wr(),p!==e?(f=[f,p],l=f):(a=l,l=e)):(a=l,l=e),l===e&&(l=a,f=ct(),f!==e?(p=yr(),p!==e?(f=[f,p],l=f):(a=l,l=e)):(a=l,l=e),l===e&&(l=ct(),l===e&&(l=yr(),l===e&&(l=a,f=ot(),f!==e?(p=br(),p!==e?(f=[f,p],l=f):(a=l,l=e)):(a=l,l=e),l===e&&(l=a,f=ot(),f!==e?(p=vr(),p!==e?(f=[f,p],l=f):(a=l,l=e)):(a=l,l=e),l===e&&(l=ot())))))))))))))),l!==e?o=t.substring(o,a):o=l,o!==e?(l=a,w++,f=it(),w--,f===e?l=void 0:(a=l,l=e),l!==e?(f=P(),f!==e?($=i,o=Hi(o),i=o):(a=i,i=e)):(a=i,i=e)):(a=i,i=e),w--,i===e&&(o=e,w===0&&y(Ni)),i}function ko(){var i,o;return w++,i=a,o=go(),o!==e&&($=i,o=Gi()),i=o,w--,i===e&&(o=e,w===0&&y(qi)),i}var _=(gt(),Pr(pt));function _o(i,o){return i.map(function(l){return l[o]})}function ft(i,o,l){return[i].concat(_o(o,l))}function I(){return{...Zi()}}if(Re=s(),Re!==e&&a===t.length)return Re;throw Re!==e&&a<t.length&&y(Yi()),ur(rt,T<t.length?t.charAt(T):null,T<t.length?me(T,T+1):me(T,T))}Br.exports={SyntaxError:J,parse:sa}});var $a={};_r($a,{RCASMWorker:()=>Qe,create:()=>va});var q={a:0,d:1},Mo={a:0,d:1},Ro={a:0,b:1},jo={m:0,j:1},ht={a:0,b:1,c:2,d:3,m1:4,m2:5,x:6,y:7},Bo={xy:0,pc:1},Uo={m:0,xy:1,j:2,as:3},Wo={xy:1},Ir={a:0,b:1,c:2,d:3},C;(function(t){t[t.Direct=0]="Direct",t[t.Alu=1]="Alu",t[t.Clear=2]="Clear",t[t.Goto=3]="Goto",t[t.LodSw=4]="LodSw",t[t.LitOpc=5]="LitOpc",t[t.Move=6]="Move",t[t.Set=7]="Set",t[t.LoadStore=8]="LoadStore"})(C||(C={}));var Dr={add:{mt:C.Alu,ops:[{op:129,p1:{cs:q,op:t=>t<<3},p2:null}]},inc:{mt:C.Alu,ops:[{op:130,p1:{cs:q,op:t=>t<<3},p2:null}]},and:{mt:C.Alu,ops:[{op:131,p1:{cs:q,op:t=>t<<3},p2:null}]},orr:{mt:C.Alu,ops:[{op:132,p1:{cs:q,op:t=>t<<3},p2:null}]},eor:{mt:C.Alu,ops:[{op:133,p1:{cs:q,op:t=>t<<3},p2:null}]},cmp:{mt:C.Alu,ops:[{op:133,p1:{cs:q,op:t=>t<<3},p2:null}]},not:{mt:C.Alu,ops:[{op:134,p1:{cs:q,op:t=>t<<3},p2:null}]},rol:{mt:C.Alu,ops:[{op:135,p1:{cs:q,op:t=>t<<3},p2:null}]},mov:{mt:C.Move,ops:[{op:0,p1:{cs:ht,op:t=>t<<3},p2:{cs:ht,op:t=>t}},{op:160,p1:{cs:Bo,op:t=>t<<2},p2:{cs:Uo,op:t=>t}}]},clr:{mt:C.Clear,ops:[{op:0,p1:{cs:ht,op:t=>t<<3|t},p2:null},{op:160,p1:{cs:Wo,op:t=>t},p2:null}]},rts:{mt:C.Direct,ops:[{op:165,p1:null,p2:null}]},ldr:{mt:C.LoadStore,ops:[{op:144,p1:{cs:Ir,op:t=>t},p2:null}]},str:{mt:C.LoadStore,ops:[{op:152,p1:{cs:Ir,op:t=>t},p2:null}]},ldi:{mt:C.Set,ops:[{op:64,p1:{cs:Ro,op:t=>t<<5},p2:{cs:null,op:t=>t&31}},{op:192,p1:{cs:jo,op:t=>t<<5},p2:null}]},hlt:{mt:C.Direct,ops:[{op:174,p1:null,p2:null}]},hlr:{mt:C.Direct,ops:[{op:175,p1:null,p2:null}]},lds:{mt:C.LodSw,ops:[{op:172,p1:{cs:Mo,op:t=>t},p2:null}]},ixy:{mt:C.Direct,ops:[{op:176,p1:null,p2:null}]},jmp:{mt:C.Goto,ops:[{op:230,p1:null,p2:null}]},jsr:{mt:C.Goto,ops:[{op:231,p1:null,p2:null}]},bne:{mt:C.Goto,ops:[{op:226,p1:null,p2:null}]},beq:{mt:C.Goto,ops:[{op:228,p1:null,p2:null}]},bcs:{mt:C.Goto,ops:[{op:232,p1:null,p2:null}]},bmi:{mt:C.Goto,ops:[{op:240,p1:null,p2:null}]},blt:{mt:C.Goto,ops:[{op:240,p1:null,p2:null}]},ble:{mt:C.Goto,ops:[{op:244,p1:null,p2:null}]},opc:{mt:C.LitOpc,ops:[{op:0,p1:{cs:null,op:t=>t},p2:null}]}};function M(t){return t.toString(16).padStart(4,"0")}gt();var ne=class{constructor(r,e,n,s){this.start=r,this.end=e,this.inferStart=n,this.id=s,this.blocks=[{start:r,binary:[]}],this.curBlock=this.blocks[0]}setCurrentPC(r){let e;if(this.inferStart&&this.blocks.length===1&&this.blocks[0].binary.length===0)this.start=r;else{let c=this.end!==void 0?`$${M(this.end)}`:"",u=`Segment address range: $${M(this.start)}-${c}`;r<this.start?e=`${u}.  Cannot set program counter to a lower address $${M(r)}.`:this.end!==void 0&&r>this.end?e=`${u}.  Trying to set program counter to $${M(r)} -- it is past segment end ${c}.`:this.blocks.length===1&&this.blocks[0].binary.length===0&&(this.start=r)}let n={start:r,binary:[]},s=this.blocks.push(n);return this.curBlock=this.blocks[s-1],e}empty(){return this.blocks.every(r=>r.binary.length===0)}currentPC(){return this.curBlock.start+this.curBlock.binary.length}emit(r){if(this.currentPC()<this.start||this.end!==void 0&&this.currentPC()>this.end){let e=this.end!==void 0?`$${M(this.end)}`:"",n=this.start!==void 0?`$${M(this.start)}`:"";return`Segment overflow at $${M(this.currentPC())}.  Segment address range: ${n}-${e}`}this.curBlock.binary.push(r)}formatRange(){let r=this.end!==void 0?`$${M(this.end)}`:"";return`${this.start!==void 0?`$${M(this.start)}`:""}-${r}`}overlaps(r){let e=this.start,n=r.start,s=this.end!==void 0?this.end:this.currentPC(),c=r.end!==void 0?r.end:r.currentPC();return e<n?n<=s:c>=e}};function Fr(t){let r=[];for(let[e,n]of t){let s=n.blocks.filter(c=>c.binary.length!==0).sort((c,u)=>c.start-u.start);if(s.length!==0){let c=new ne(n.start,n.end,n.inferStart,r.length-1);c.blocks=s,c.curBlock=s[s.length-1],r.push([e,c])}}return r}function Or(t){let r=Fr(t);if(r.length===0)return{startPC:0,binary:Uint8Array.from([])};let[,e]=r[0],n=e.blocks[0],s=e.blocks[e.blocks.length-1],c=n.start,u=s.start+s.binary.length;for(let x=1;x<r.length;x++){let g=r[x][1],m=g.blocks[0].start,b=g.curBlock.start+g.curBlock.binary.length;c=Math.min(m,c),u=Math.max(b,u)}let h=new Uint8Array(u);for(let[,x]of r)for(let g of x.blocks)for(let m=0;m<g.binary.length;m++)h[g.start+m]=g.binary[m];return{startPC:c,binary:h.slice(c)}}function Mr(t){return Fr(t).sort((e,n)=>e[1].start-n[1].start).map(([e,n])=>{let s=n.blocks.map(c=>({start:c.start,end:c.start+c.binary.length-1}));return{name:e,blocks:s}})}var ta=jr(),xe=class{constructor(){this.lineStack=[],this.pcToLocs={},this.insnBitset=new ta}startLine(r,e,n){let s={lineNo:r.start.line,segmentId:n.id,numBytes:0};this.lineStack.push({loc:s,pc:e,segmentId:n.id})}endLine(r,e){let n=this.lineStack.pop();if(!n)throw new Error("internal compiler error, mismatching start/end lines in debugInfo");let s=r-n.pc;if(s>0&&e.id===n.segmentId){let c={...n.loc,numBytes:s};this.pcToLocs[n.pc]===void 0?this.pcToLocs[n.pc]=[c]:this.pcToLocs[n.pc].push(c)}}markAsInstruction(r,e){for(let n=r;n<e;n++)this.insnBitset.add(n)}info(){let r=this.insnBitset.clone(),e=n=>r.has(n);return{pcToLocs:this.pcToLocs,isInstruction:e}}};var Wr=Ur();function Y(t){return{value:t,errors:!0,completeFirstPass:!1}}function ie(t,r){return{value:t,errors:!1,completeFirstPass:r}}function G(...t){return t.some(r=>r!==void 0&&r.errors)}function na(...t){return t.every(r=>r!==void 0&&r.completeFirstPass)}var wt=class t{constructor(r,e){this.syms=new Map,this.parent=null,this.children=new Map,this.parent=r,this.name=e}newScope(r,e){let n=this.children.get(r);if(n!==void 0)return n;let s=new t(e,r);return this.children.set(r,s),s}findSymbol(r){for(let e=this;e!==null;e=e.parent){let n=e.syms.get(r);if(n!==void 0)return n}}findSymbolPath(r){if(r.length===1)return this.findSymbol(r[0]);let e=this;for(;e.children.get(r[0])===void 0;)if(e=e.parent,e===null)return;for(let n=0;n<r.length-1;n++)if(e=e.children.get(r[n]),e===void 0)return;return e.syms.get(r[r.length-1])}addSymbol(r,e,n){this.syms.set(r,{...e,seen:n})}updateSymbol(r,e,n){for(let s=this;s!==null;s=s.parent)if(s.syms.get(r)!==void 0){s.syms.set(r,{...e,seen:n});return}}},xt=class{constructor(){this.passCount=0,this.root=new wt(null,""),this.curSymtab=this.root,this.anonScopeCount=0}startPass(r){this.curSymtab=this.root,this.anonScopeCount=0,this.passCount=r}withLabelScope(r,e,n){let s=this.curSymtab;this.curSymtab=this.curSymtab.newScope(r,n||s),e(),this.curSymtab=s}findPath(r,e){return e?this.root.findSymbolPath(r):this.curSymtab.findSymbolPath(r)}findQualifiedSym(r,e){return this.findPath(r,e)}symbolSeen(r){let e=this.curSymtab.syms.get(r);return e!==void 0?e.seen===this.passCount:!1}declareLabelSymbol(r,e,n){let{name:s,loc:c}=r,u=this.curSymtab.syms.get(s);if(u===void 0){let x={type:"label",segment:n,data:ie({addr:e,loc:c},!1)};return this.curSymtab.addSymbol(s,x,this.passCount),!1}if(u.type!=="label")throw new Error("ICE: declareLabelSymbol should be called only on labels");if(u.data.value.addr!==e){let x={type:"label",segment:n,data:{...u.data,value:{...u.data.value,addr:e}}};return this.curSymtab.updateSymbol(s,x,this.passCount),!0}return this.curSymtab.updateSymbol(s,u,this.passCount),!1}dumpLabels(r,e){let n={};for(let[g,m]of e)n[m.id]=g;let s=[],c=(g,m)=>{if(g!==void 0){let b=[...g,m.name];s.push({path:b,sym:m})}else s.push({path:[],sym:m})};c(void 0,this.root);let u=[];for(;s.length>0;){let g=s.pop();if(g){for(let[m,b]of g.sym.syms)b.type==="label"&&u.push({path:[...g.path,m],addr:b.data.value.addr,size:0,segmentName:n[b.segment.id]});for(let[,m]of g.sym.children)c(g.path,m)}}let h=u.sort((g,m)=>g.addr-m.addr),x=h.length;if(x>0){for(let m=1;m<x;m++)h[m-1].size=h[m].addr-h[m-1].addr;let g=h[x-1];g.size=r-g.addr}return h.map(({path:g,addr:m,size:b,segmentName:S})=>({name:g.join("::"),addr:m,size:b,segmentName:S}))}};function Q(t){let r=typeof t;return r==="object"&&t instanceof Array?"array":r}function ia(t){return`${t.absolute?"::":""}${t.path.join("::")}`}var mt=(t,r,e)=>{let n=e(t.value,r.value),s=na(t,r);return ie(typeof n=="boolean"?n?1:0:n,s)},yt=class{constructor(){this.curSegmentName="",this.curSegment=new ne(0,0,!1,0),this.pass=0,this.needPass=!1,this.scopes=new xt,this.segments=[],this.errorList=[],this.warningList=[],this.debugInfo=new xe,this.errors=()=>this.formatErrors(this.errorList,"error"),this.warnings=()=>this.formatErrors(this.warningList,"warning")}prg(){let{startPC:r,binary:e}=Or(this.segments),n=r&255,s=r>>8&255;return Uint8Array.from([n,s,...e])}anyErrors(){return this.errorList.length!==0}formatErrors(r,e){return[...new Set(r.map(s=>JSON.stringify(s)))].map(s=>{let{loc:c,msg:u}=JSON.parse(s),h=`<unknown>:1:1: ${e}: ${u}`;return c&&(h=`${c.start.line}:${c.start.column}: ${e}: ${u}`),{loc:c,msg:u,formatted:h}})}addError(r,e){this.errorList.push({msg:r,loc:e})}addWarning(r,e){this.warningList.push({msg:r,loc:e})}startPass(r){this.pass=r,this.needPass=!1,this.errorList=[],this.scopes.startPass(r),this.debugInfo=new xe,this.segments=[];let e=this.newSegment("default",0,void 0,!0);this.setCurrentSegment({type:"segment",data:e},"default")}setCurrentSegment(r,e){this.curSegmentName=e,this.curSegment=r.data}newSegment(r,e,n,s){let c=new ne(e,n,s,this.segments.length-1);return this.segments.push([r,c]),c}getPC(){return this.curSegment.currentPC()}evalExprType(r,e,n){let s=this.evalExpr(r),{errors:c,value:u,completeFirstPass:h}=s;return!c&&typeof u!==e?(this.addError(`Expecting ${n} to be '${e}' type, got '${Q(u)}'`,r.loc),{errors:!0,completeFirstPass:h,value:u}):s}evalExprToInt(r,e){return this.evalExprType(r,"number",e)}evalExpr(r){switch(r.type){case"binary":{let e=this.evalExpr(r.left),n=this.evalExpr(r.right);if(G(e,n))return Y(0);if(typeof e.value!=typeof n.value)return this.addError(`Binary expression operands are expected to be of the same type.  Got: '${Q(e.value)}' (left), '${Q(n.value)}' (right)`,r.loc),Y(0);if(typeof e.value!="string"&&typeof e.value!="number")return this.addError(`Binary expression operands can only operator on numbers or strings.  Got: '${Q(e.value)}'`,r.loc),Y(0);if(typeof e.value=="string"){let s=["+"];if(s.indexOf(r.op)<0)return this.addError(`'${r.op}' operator is not supported for strings.  Valid operators for strings are: ${s.join(", ")}`,r.loc),Y(0)}switch(r.op){case"+":return mt(e,n,(s,c)=>s+c);case"-":return mt(e,n,(s,c)=>s-c);case"\xA7":return mt(e,n,(s,c)=>(s&255)<<8|c&255);default:throw new Error(`Unhandled binary operator ${r.op}`)}}case"literal":return ie(r.lit,!0);case"register":return this.addError("Unexpected register",r.loc),Y(0);case"ident":throw new Error("should not see an ident here -- if you do, it is probably a wrong type node in parser");case"qualified-ident":{let e=this.scopes.findQualifiedSym(r.path,r.absolute);if(e===void 0)return this.pass>=1?(this.addError(`Undefined symbol '${ia(r)}'`,r.loc),Y(0)):(this.needPass=!0,ie(0,!1));switch(e.type){case"label":return{errors:e.data.errors,value:e.data.value.addr,completeFirstPass:e.seen===this.pass}}break}case"getcurpc":return ie(this.getPC(),!0);default:break}throw new Error(`should be unreachable on ${r}`)}emit(r){let e=this.curSegment.emit(r);e!==void 0&&this.addError(e,this.lineLoc)}emit16(r){this.emit(r>>8&255),this.emit(r&255)}assembleNonInstr(r,e){let n=r.ops[0];e.p1&&this.addWarning("Parameter not required",e.p1.loc),e.p2&&this.addWarning("Parameter not required",e.p2.loc),this.emit(n.op)}assembleAluInstr(r,e){let n=r.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let s=n.op;if(e.p1&&n.p1){let c=this.checkRegister(e.p1,n.p1);if(c===void 0)return;s|=n.p1.op(c)}this.emit(s)}assembleClrInstr(r,e){if(!e.p1){this.addError("Parameter required",e.loc);return}if(e.p2&&this.addWarning("Parameter not required",e.p2.loc),!r.ops[0]||!r.ops[0].p1||!r.ops[1]||!r.ops[1].p1){this.addError("Internal opcode definition error",e.loc);return}let n=this.checkRegister(e.p1,r.ops[0].p1,r.ops[1].p1);if(n===void 0)return;let s=this.hasRegister(e.p1,r.ops[1].p1)?r.ops[1]:r.ops[0];if(!s.p1){this.addError("Internal opcode definition error",e.loc);return}let c=s.op;c|=s.p1.op(n),this.emit(c)}assembleMovInstr(r,e){if(!e.p1||!e.p2){this.addError("Two parameters required",e.loc);return}if(!r.ops[0]||!r.ops[0].p1||!r.ops[1]||!r.ops[1].p1){this.addError("Internal opcode definition error",e.loc);return}let n=this.checkRegister(e.p1,r.ops[0].p1,r.ops[1].p1);if(n===void 0)return;let s=this.hasRegister(e.p1,r.ops[1].p1)?r.ops[1]:r.ops[0];if(!e.p1||!s.p1||!e.p2||!s.p2){this.addError("Two parameters required",e.loc);return}let c=s.op;c|=s.p1.op(n);let u=this.checkRegister(e.p2,s.p2);u!==void 0&&(c|=s.p2.op(u),this.emit(c))}assembleLitOpc(r,e){let n=r.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let s=n.op;if(!e.p1||!n.p1){this.addError("Parameter required",e.loc);return}let c=this.checkLiteral(e.p1,0,255,"h");c!==void 0&&(s|=n.p1.op(c),this.emit(s))}assembleLodSwInstr(r,e){let n=r.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let s=n.op;if(!e.p1||!n.p1){this.addError("Parameter required",e.loc);return}let c=this.checkRegister(e.p1,n.p1);c!==void 0&&(s|=n.p1.op(c),this.emit(s))}assembleSetInstr(r,e){if(!e.p1||!e.p2){this.addError("Two parameters required",e.loc);return}if(!r.ops[0]||!r.ops[0].p1||!r.ops[1]||!r.ops[1].p1){this.addError("Internal opcode definition error",e.loc);return}let n=this.checkRegister(e.p1,r.ops[0].p1,r.ops[1].p1);if(n===void 0)return;let s=this.hasRegister(e.p1,r.ops[1].p1),c=s?r.ops[1]:r.ops[0];if(!c.p1){this.addError("Internal opcode definition error",e.loc);return}let u=c.op;if(u|=c.p1.op(n),s){let h=this.evalExpr(e.p2);if(G(h))return;if(typeof h.value!="number"){this.addError(`Expecting branch label to evaluate to integer, got ${Q(h.value)}`,e.p2.loc);return}let{value:x}=h;if(x>65535){this.addError("Value out of range (must be between 0x0000 and 0xFFFF)",e.p2.loc);return}this.emit(u),this.emit((x&65280)>>8),this.emit(x&255)}else{if(!c.p2){this.addError("Internal opcode definition error",e.loc);return}let h=this.checkLiteral(e.p2,-16,15);if(h===void 0)return;u|=c.p2.op(h),this.emit(u)}}assembleLoadStoreInstr(r,e){let n=r.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let s=n.op;if(!e.p1||!n.p1){this.addError("Parameter required",e.loc);return}let c=this.checkRegister(e.p1,n.p1);c!==void 0&&(s|=n.p1.op(c),this.emit(s))}checkRegister(r,e,n=void 0){if(r.type!=="register")this.addError("Register required",r.loc);else{let s=e.cs?.[r.value]??n?.cs?.[r.value];return s===void 0&&(e.cs?n&&n.cs?this.addError(`Invalid register - choose one of [${Object.keys(e.cs).join("|")}] or [${Object.keys(n.cs).join("|")}]`,r.loc):this.addError(`Invalid register - choose one of [${Object.keys(e.cs).join("|")}]`,r.loc):this.addError("Invalid register",r.loc)),s}}hasRegister(r,e){return r.type!=="register"?!1:e.cs?.[r.value]!==void 0}checkLiteral(r,e,n,s="d"){let c=this.evalExprToInt(r,"value");if(!G(c)){let u=c.value;if(u<e||u>n){let h="";switch(s){case"b":{let x=n.toString(2);h=`${("0".repeat(x.length)+e.toString(2)).slice(-x.length)}b and ${x}b`;break}case"h":{let x=n.toString(16).toUpperCase();h=`0x${("0".repeat(x.length)+e.toString(16).toUpperCase()).slice(-x.length)} and 0x${x}`;break}default:h=`${e} and ${n}`}this.addError(`Literal out of range (must be between ${h})`,r.loc)}else return u}}assembleBranch(r,e){let n=r.ops[0];if(e.p2&&this.addWarning("Parameter not required",e.p2.loc),!e.p1){this.addError("Parameter required",e.loc);return}let s=this.evalExpr(e.p1);if(G(s))return;if(typeof s.value!="number"){this.addError(`Expecting branch label to evaluate to integer, got ${Q(s.value)}`,e.p1.loc);return}let{value:c}=s;this.emit(n.op),this.emit((c&65280)>>8),this.emit(c&255)}handleSetPC(r){let e=this.evalExprToInt(r,"pc");if(!G(e)){let{value:n,completeFirstPass:s}=e;if(!s){this.addError("Value for new program counter must evaluate to a value in the first pass",r.loc);return}!this.curSegment.empty()&&this.curSegment.currentPC()>n&&this.addError(`Cannot set program counter to a smaller value than current (current: $${M(this.curSegment.currentPC())}, trying to set $${M(n)})`,r.loc);let c=this.curSegment.setCurrentPC(n);c!==void 0&&this.addError(c,r.loc)}}emit8or16(r,e){if(e===8){this.emit(r);return}this.emit16(r)}emitData(r,e){let n=Math.pow(2,e);for(let s=0;s<r.length;s++){let c=this.evalExpr(r[s]);if(G(c))continue;let{value:u}=c;if(typeof u=="number")u>=n?this.addError(`Data out of range for ${e} bits`,r[s].loc):this.emit8or16(u,e);else if(typeof u=="string"){let h=u.split("").map(x=>x.charCodeAt(0));h.find(x=>x>=n)?this.addError(`Data contains character out of range for ${e} bits`,r[s].loc):h.forEach(x=>this.emit8or16(x,e))}else this.addError(`Only literal types can be emitted. Got ${Q(u)}`,r[s].loc)}}fillBytes(r){let e=this.evalExprToInt(r.numBytes,"!fill num_bytes"),n=this.evalExprToInt(r.fillValue,"!fill value");if(G(e,n))return;let{value:s}=n;if(s<0||s>=256){this.addError(`!fill value to repeat must be in 8-bit range, '${s}' given`,r.fillValue.loc);return}let c=e.value;if(c<0){this.addError(`!fill repeat count must be >= 0, got ${c}`,r.numBytes.loc);return}for(let u=0;u<c;u++)this.emit(s)}alignBytes(r){let e=this.evalExprToInt(r.alignBytes,"alignment");if(G(e))return;let{value:n}=e;if(n<1){this.addError(`Alignment must be a positive integer, ${n} given`,r.alignBytes.loc);return}if(n&n-1){this.addError(`Alignment must be a power of two, ${n} given`,r.loc);return}for(;this.getPC()&n-1;)this.emit(0)}withLabelScope(r,e,n){this.scopes.withLabelScope(r,e)}checkDirectives(r,e){switch(r.type){case"data":{this.emitData(r.values,r.dataSize===we.Byte?8:16);break}case"fill":{this.fillBytes(r);break}case"align":{this.alignBytes(r);break}case"setpc":{this.handleSetPC(r.pc);break}default:this.addError(`unknown directive ${r.type}`,r.loc);return}}assembleLines(r){if(r===null||r.length===0||r.length===0)return;let e=s=>{for(let c=0;c<s.length;c++)this.debugInfo.startLine(s[c].loc,this.getPC(),this.curSegment),this.assembleLine(s[c]),this.debugInfo.endLine(this.getPC(),this.curSegment)},n=0;for(;n<r.length;){let{label:s,stmt:c}=r[n];if(s===null&&c===null)n++;else break}if(!(n>=r.length))return e(r)}checkAndDeclareLabel(r){this.scopes.symbolSeen(r.name)?this.addError(`Symbol '${r.name}' already defined`,r.loc):this.scopes.declareLabelSymbol(r,this.getPC(),this.curSegment)&&(this.needPass=!0)}assembleLine(r){if(this.lineLoc=r.loc,r.label===null&&r.stmt===null&&r.scopedStmts===null)return;r.label!==null&&this.checkAndDeclareLabel(r.label);let e=r.scopedStmts;if(e!=null){if(!r.label)throw new Error("ICE: line.label cannot be undefined");this.withLabelScope(r.label.name,()=>{this.assembleLines(e)});return}if(r.stmt===null)return;if(r.stmt.type!=="insn"){this.checkDirectives(r.stmt,r.label===null?null:r.label.name);return}let n=r.stmt,s=Dr[n.mnemonic.toLocaleLowerCase()];s!==void 0?(u=>{let h=this.getPC();u();let x=this.getPC();this.debugInfo.markAsInstruction(h,x)})(()=>{switch(s.mt){case C.Direct:this.assembleNonInstr(s,n);break;case C.Alu:this.assembleAluInstr(s,n);break;case C.Clear:this.assembleClrInstr(s,n);break;case C.Move:this.assembleMovInstr(s,n);break;case C.LitOpc:this.assembleLitOpc(s,n);break;case C.LodSw:this.assembleLodSwInstr(s,n);break;case C.Set:this.assembleSetInstr(s,n);break;case C.LoadStore:this.assembleLoadStoreInstr(s,n);break;case C.Goto:this.assembleBranch(s,n);break;default:this.addError(`Couldn't encode instruction '${n.mnemonic} '`,r.loc)}}):this.addError(`Unknown mnemonic '${n.mnemonic}'`,n.loc)}assemble(r){try{let e=Wr.parse(r.toString());e!==void 0&&e.lines&&this.assembleLines(e.lines)}catch(e){if("name"in e&&e.name==="SyntaxError")this.addError(`Syntax error: ${e.message}`,{...e.location});else{if("name"in e&&e.name==="semantic")return;throw e}}}dumpLabels(){return this.scopes.dumpLabels(this.getPC(),this.segments)}collectSegmentInfo(){return Mr(this.segments)}};function bt(t){try{return Wr.parse(t.toString())}catch{return}}function vt(t){let r=new yt,e=0;do{if(r.startPass(e),r.assemble(t),e>0&&r.anyErrors())return{prg:Uint8Array.from([]),labels:[],segments:[],debugInfo:void 0,errors:r.errors(),warnings:r.warnings()};e+=1}while(r.needPass);return{prg:r.prg(),errors:r.errors(),warnings:r.warnings(),labels:r.dumpLabels(),segments:r.collectSegmentInfo(),debugInfo:r.debugInfo}}var D;(function(t){t[t.Program=0]="Program",t[t.Line=1]="Line",t[t.Label=2]="Label",t[t.LabelRef=3]="LabelRef",t[t.Instruction=4]="Instruction",t[t.Literal=5]="Literal",t[t.Register=6]="Register",t[t.SetPC=7]="SetPC",t[t.Expr=8]="Expr",t[t.Directive=9]="Directive",t[t.Fill=10]="Fill",t[t.Scope=11]="Scope",t[t.Expression=12]="Expression"})(D||(D={}));var ye;(function(t){t[t.Label=0]="Label"})(ye||(ye={}));function ke(t,r){let e=null;return!t||r<t.offset||r>t.end?null:(t.accept(n=>n.offset===-1&&n.length===-1?!0:n.offset<=r&&n.end>=r?(e?n.length<=e.length&&(e=n):e=n,!0):!1),e)}function zr(t,r){let e=ke(t,r),n=[];for(;e;)n.unshift(e),e=e.parent;return n}var F=class{get end(){return this.offset+this.length}constructor(r,e){this.nodeType=e,this.parent=null,this.offset=r?.loc.start.offset??0,this.length=(r?.loc.end.offset??0)-this.offset}get type(){return this.nodeType}getTextProvider(){let r=this;for(;r&&!r.textProvider;)r=r.parent;return r?r.textProvider:()=>"unknown"}getText(){return this.getTextProvider()(this.offset,this.length)}matches(r){return this.length===r.length&&this.getTextProvider()(this.offset,this.length)===r}accept(r){if(r(this)&&this.children)for(let e of this.children)e.accept(r)}acceptVisitor(r){this.accept(r.visitNode.bind(r))}adoptChild(r){r.parent=this;let e=this.children;return e||(e=this.children=[]),e.push(r),r}};var Ue=class extends F{constructor(r){super(r,D.Program),r?.lines?.forEach(e=>this.adoptChild(new We(e)))}},We=class extends F{constructor(r){if(super(r,D.Line),r.label&&this.adoptChild(new K(r.label)),r.scopedStmts&&this.adoptChild(new be(r)),r.stmt)switch(r.stmt.type){case"insn":this.adoptChild(new Ce(r.stmt));break;case"setpc":this.adoptChild(new ve(r.stmt));break;case"data":this.adoptChild(new $e(r.stmt));break;case"fill":this.adoptChild(new Se(r.stmt));break;case"align":this.adoptChild(new Ae(r.stmt))}}},K=class extends F{constructor(r){super(r,D.Label),this.length=r.name.length}getName(){return this.getText()}},be=class extends F{constructor(r){super(r,D.Scope),r.scopedStmts.forEach(e=>{this.adoptChild(new We(e))})}},ve=class extends F{constructor(r){super(r,D.SetPC),this.pcExpr=this.adoptChild(new oe(r.pc))}},$e=class extends F{constructor(r){super(r,D.Directive)}},Se=class extends F{constructor(r){super(r,D.Directive)}},Ae=class extends F{constructor(r){super(r,D.Directive)}},Ce=class extends F{constructor(r){super(r,D.Instruction);let e=n=>{switch(n.type){case"literal":return this.adoptChild(new Le(n));case"register":return this.adoptChild(new Ee(n));case"qualified-ident":return this.adoptChild(new ee(n));default:return this.adoptChild(new oe(n))}};this.mnemonic=r.mnemonic.toLowerCase(),r.p1&&(this.p1=e(r.p1)),r.p2&&(this.p2=e(r.p2))}},ee=class extends F{constructor(r){super(r,D.LabelRef),this.length=r.path.at(-1).length}},Le=class extends F{constructor(r){super(r,D.Literal),this.value=r.lit}},oe=class extends F{constructor(r){super(r,D.Expression)}},Ee=class extends F{constructor(r){super(r,D.Register),this.value=r.value.toUpperCase()}};var Te=class{parseProgram(r){let e=r.version,n=r.getText(),s=bt(r.getText()),c=new Ue(s),u=(h,x)=>{if(r.version!==e)throw new Error("Underlying model has changed, AST is no longer valid");return n.substring(h,h+x)};return c.textProvider=u,c}};function ae(t,r){let e;if(r?e={kind:"markdown",value:aa(t)}:e={kind:"plaintext",value:oa(t)},e.value!=="")return e}function oa(t){if(!t.description||t.description==="")return"";let r=`${t.summary}

${t.description}`;return"syntax"in t&&(r+=`

Syntax: ${t.syntax}`),"variants"in t&&t.variants&&t.variants.forEach(e=>{r+=`


${t.summary}

${e.description}`,"syntax"in e&&(r+=`

Syntax: ${e.syntax}`)}),r}function aa(t){if(!t.description||t.description==="")return"";let r=`__${t.summary}__  
${t.description}`;return"syntax"in t&&(r+=`  
Syntax: \`${t.syntax}\``),"variants"in t&&t.variants&&t.variants.forEach(e=>{r+=`
___
__${e.summary}__  
${e.description}`,"syntax"in e&&(r+=`  
Syntax: \`${e.syntax}\``)}),r}function $t(t,r,e){let n;if(e?n={kind:"markdown",value:Vr(la(t,r),r)}:n={kind:"plaintext",value:Vr(ca(t,r),r)},n.value!=="")return n}function Vr(t,r){if(!r||r.length===0)return t;for(let e=0;e<r.length;e++)t=t.replace(`{${e}}`,r[e]);return t}function Nr(t,r){if(!(!t.variants||t.variants.length===0||!r||r.length===0))for(let n=0;n<t.variants.length;n++){var e=t.variants[n].whenFirstParamIs.indexOf(r[0].toLowerCase());if(e!==-1)return t.variants[n]}}function ca(t,r){if(!("synopsis"in t)||!t.synopsis||t.synopsis==="")return"";let e=Nr(t,r),n=e?e.summary:t.summary,s=e?e.class:t.class,c=e?e.cycles:t.cycles,u=e?e.description:t.description;return`${n} ${s} ${c}

${u}

Synopsis: ${t.synopsis}`}function la(t,r){if(!("synopsis"in t)||!t.synopsis||t.synopsis==="")return"";let e=Nr(t,r),n=e?e.summary:t.summary,s=e?e.class:t.class,c=e?e.cycles:t.cycles,u=e?e.description:t.description;return`__${n}__ ${s} ${c}  
${u}  
Synopsis: \`${t.synopsis}\``}var qr;(function(t){function r(e){return typeof e=="string"}t.is=r})(qr||(qr={}));var St;(function(t){function r(e){return typeof e=="string"}t.is=r})(St||(St={}));var Gr;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647;function r(e){return typeof e=="number"&&t.MIN_VALUE<=e&&e<=t.MAX_VALUE}t.is=r})(Gr||(Gr={}));var ze;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647;function r(e){return typeof e=="number"&&t.MIN_VALUE<=e&&e<=t.MAX_VALUE}t.is=r})(ze||(ze={}));var O;(function(t){function r(n,s){return n===Number.MAX_VALUE&&(n=ze.MAX_VALUE),s===Number.MAX_VALUE&&(s=ze.MAX_VALUE),{line:n,character:s}}t.create=r;function e(n){let s=n;return d.objectLiteral(s)&&d.uinteger(s.line)&&d.uinteger(s.character)}t.is=e})(O||(O={}));var k;(function(t){function r(n,s,c,u){if(d.uinteger(n)&&d.uinteger(s)&&d.uinteger(c)&&d.uinteger(u))return{start:O.create(n,s),end:O.create(c,u)};if(O.is(n)&&O.is(s))return{start:n,end:s};throw new Error(`Range#create called with invalid arguments[${n}, ${s}, ${c}, ${u}]`)}t.create=r;function e(n){let s=n;return d.objectLiteral(s)&&O.is(s.start)&&O.is(s.end)}t.is=e})(k||(k={}));var te;(function(t){function r(n,s){return{uri:n,range:s}}t.create=r;function e(n){let s=n;return d.objectLiteral(s)&&k.is(s.range)&&(d.string(s.uri)||d.undefined(s.uri))}t.is=e})(te||(te={}));var Xr;(function(t){function r(n,s,c,u){return{targetUri:n,targetRange:s,targetSelectionRange:c,originSelectionRange:u}}t.create=r;function e(n){let s=n;return d.objectLiteral(s)&&k.is(s.targetRange)&&d.string(s.targetUri)&&k.is(s.targetSelectionRange)&&(k.is(s.originSelectionRange)||d.undefined(s.originSelectionRange))}t.is=e})(Xr||(Xr={}));var At;(function(t){function r(n,s,c,u){return{red:n,green:s,blue:c,alpha:u}}t.create=r;function e(n){let s=n;return d.objectLiteral(s)&&d.numberRange(s.red,0,1)&&d.numberRange(s.green,0,1)&&d.numberRange(s.blue,0,1)&&d.numberRange(s.alpha,0,1)}t.is=e})(At||(At={}));var Zr;(function(t){function r(n,s){return{range:n,color:s}}t.create=r;function e(n){let s=n;return d.objectLiteral(s)&&k.is(s.range)&&At.is(s.color)}t.is=e})(Zr||(Zr={}));var Jr;(function(t){function r(n,s,c){return{label:n,textEdit:s,additionalTextEdits:c}}t.create=r;function e(n){let s=n;return d.objectLiteral(s)&&d.string(s.label)&&(d.undefined(s.textEdit)||B.is(s))&&(d.undefined(s.additionalTextEdits)||d.typedArray(s.additionalTextEdits,B.is))}t.is=e})(Jr||(Jr={}));var Ct;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(Ct||(Ct={}));var Lt;(function(t){function r(n,s,c,u,h,x){let g={startLine:n,endLine:s};return d.defined(c)&&(g.startCharacter=c),d.defined(u)&&(g.endCharacter=u),d.defined(h)&&(g.kind=h),d.defined(x)&&(g.collapsedText=x),g}t.create=r;function e(n){let s=n;return d.objectLiteral(s)&&d.uinteger(s.startLine)&&d.uinteger(s.startLine)&&(d.undefined(s.startCharacter)||d.uinteger(s.startCharacter))&&(d.undefined(s.endCharacter)||d.uinteger(s.endCharacter))&&(d.undefined(s.kind)||d.string(s.kind))}t.is=e})(Lt||(Lt={}));var Et;(function(t){function r(n,s){return{location:n,message:s}}t.create=r;function e(n){let s=n;return d.defined(s)&&te.is(s.location)&&d.string(s.message)}t.is=e})(Et||(Et={}));var ce;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(ce||(ce={}));var Yr;(function(t){t.Unnecessary=1,t.Deprecated=2})(Yr||(Yr={}));var Qr;(function(t){function r(e){let n=e;return d.objectLiteral(n)&&d.string(n.href)}t.is=r})(Qr||(Qr={}));var Pe;(function(t){function r(n,s,c,u,h,x){let g={range:n,message:s};return d.defined(c)&&(g.severity=c),d.defined(u)&&(g.code=u),d.defined(h)&&(g.source=h),d.defined(x)&&(g.relatedInformation=x),g}t.create=r;function e(n){var s;let c=n;return d.defined(c)&&k.is(c.range)&&d.string(c.message)&&(d.number(c.severity)||d.undefined(c.severity))&&(d.integer(c.code)||d.string(c.code)||d.undefined(c.code))&&(d.undefined(c.codeDescription)||d.string((s=c.codeDescription)===null||s===void 0?void 0:s.href))&&(d.string(c.source)||d.undefined(c.source))&&(d.undefined(c.relatedInformation)||d.typedArray(c.relatedInformation,Et.is))}t.is=e})(Pe||(Pe={}));var re;(function(t){function r(n,s,...c){let u={title:n,command:s};return d.defined(c)&&c.length>0&&(u.arguments=c),u}t.create=r;function e(n){let s=n;return d.defined(s)&&d.string(s.title)&&d.string(s.command)}t.is=e})(re||(re={}));var B;(function(t){function r(c,u){return{range:c,newText:u}}t.replace=r;function e(c,u){return{range:{start:c,end:c},newText:u}}t.insert=e;function n(c){return{range:c,newText:""}}t.del=n;function s(c){let u=c;return d.objectLiteral(u)&&d.string(u.newText)&&k.is(u.range)}t.is=s})(B||(B={}));var kt;(function(t){function r(n,s,c){let u={label:n};return s!==void 0&&(u.needsConfirmation=s),c!==void 0&&(u.description=c),u}t.create=r;function e(n){let s=n;return d.objectLiteral(s)&&d.string(s.label)&&(d.boolean(s.needsConfirmation)||s.needsConfirmation===void 0)&&(d.string(s.description)||s.description===void 0)}t.is=e})(kt||(kt={}));var le;(function(t){function r(e){let n=e;return d.string(n)}t.is=r})(le||(le={}));var Kr;(function(t){function r(c,u,h){return{range:c,newText:u,annotationId:h}}t.replace=r;function e(c,u,h){return{range:{start:c,end:c},newText:u,annotationId:h}}t.insert=e;function n(c,u){return{range:c,newText:"",annotationId:u}}t.del=n;function s(c){let u=c;return B.is(u)&&(kt.is(u.annotationId)||le.is(u.annotationId))}t.is=s})(Kr||(Kr={}));var _t;(function(t){function r(n,s){return{textDocument:n,edits:s}}t.create=r;function e(n){let s=n;return d.defined(s)&&Ft.is(s.textDocument)&&Array.isArray(s.edits)}t.is=e})(_t||(_t={}));var Pt;(function(t){function r(n,s,c){let u={kind:"create",uri:n};return s!==void 0&&(s.overwrite!==void 0||s.ignoreIfExists!==void 0)&&(u.options=s),c!==void 0&&(u.annotationId=c),u}t.create=r;function e(n){let s=n;return s&&s.kind==="create"&&d.string(s.uri)&&(s.options===void 0||(s.options.overwrite===void 0||d.boolean(s.options.overwrite))&&(s.options.ignoreIfExists===void 0||d.boolean(s.options.ignoreIfExists)))&&(s.annotationId===void 0||le.is(s.annotationId))}t.is=e})(Pt||(Pt={}));var It;(function(t){function r(n,s,c,u){let h={kind:"rename",oldUri:n,newUri:s};return c!==void 0&&(c.overwrite!==void 0||c.ignoreIfExists!==void 0)&&(h.options=c),u!==void 0&&(h.annotationId=u),h}t.create=r;function e(n){let s=n;return s&&s.kind==="rename"&&d.string(s.oldUri)&&d.string(s.newUri)&&(s.options===void 0||(s.options.overwrite===void 0||d.boolean(s.options.overwrite))&&(s.options.ignoreIfExists===void 0||d.boolean(s.options.ignoreIfExists)))&&(s.annotationId===void 0||le.is(s.annotationId))}t.is=e})(It||(It={}));var Dt;(function(t){function r(n,s,c){let u={kind:"delete",uri:n};return s!==void 0&&(s.recursive!==void 0||s.ignoreIfNotExists!==void 0)&&(u.options=s),c!==void 0&&(u.annotationId=c),u}t.create=r;function e(n){let s=n;return s&&s.kind==="delete"&&d.string(s.uri)&&(s.options===void 0||(s.options.recursive===void 0||d.boolean(s.options.recursive))&&(s.options.ignoreIfNotExists===void 0||d.boolean(s.options.ignoreIfNotExists)))&&(s.annotationId===void 0||le.is(s.annotationId))}t.is=e})(Dt||(Dt={}));var Ve;(function(t){function r(e){let n=e;return n&&(n.changes!==void 0||n.documentChanges!==void 0)&&(n.documentChanges===void 0||n.documentChanges.every(s=>d.string(s.kind)?Pt.is(s)||It.is(s)||Dt.is(s):_t.is(s)))}t.is=r})(Ve||(Ve={}));var es;(function(t){function r(n){return{uri:n}}t.create=r;function e(n){let s=n;return d.defined(s)&&d.string(s.uri)}t.is=e})(es||(es={}));var ts;(function(t){function r(n,s){return{uri:n,version:s}}t.create=r;function e(n){let s=n;return d.defined(s)&&d.string(s.uri)&&d.integer(s.version)}t.is=e})(ts||(ts={}));var Ft;(function(t){function r(n,s){return{uri:n,version:s}}t.create=r;function e(n){let s=n;return d.defined(s)&&d.string(s.uri)&&(s.version===null||d.integer(s.version))}t.is=e})(Ft||(Ft={}));var rs;(function(t){function r(n,s,c,u){return{uri:n,languageId:s,version:c,text:u}}t.create=r;function e(n){let s=n;return d.defined(s)&&d.string(s.uri)&&d.string(s.languageId)&&d.integer(s.version)&&d.string(s.text)}t.is=e})(rs||(rs={}));var U;(function(t){t.PlainText="plaintext",t.Markdown="markdown";function r(e){let n=e;return n===t.PlainText||n===t.Markdown}t.is=r})(U||(U={}));var ue;(function(t){function r(e){let n=e;return d.objectLiteral(e)&&U.is(n.kind)&&d.string(n.value)}t.is=r})(ue||(ue={}));var fe;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(fe||(fe={}));var de;(function(t){t.PlainText=1,t.Snippet=2})(de||(de={}));var ss;(function(t){t.Deprecated=1})(ss||(ss={}));var ns;(function(t){function r(n,s,c){return{newText:n,insert:s,replace:c}}t.create=r;function e(n){let s=n;return s&&d.string(s.newText)&&k.is(s.insert)&&k.is(s.replace)}t.is=e})(ns||(ns={}));var is;(function(t){t.asIs=1,t.adjustIndentation=2})(is||(is={}));var os;(function(t){function r(e){let n=e;return n&&(d.string(n.detail)||n.detail===void 0)&&(d.string(n.description)||n.description===void 0)}t.is=r})(os||(os={}));var as;(function(t){function r(e){return{label:e}}t.create=r})(as||(as={}));var Ot;(function(t){function r(e,n){return{items:e||[],isIncomplete:!!n}}t.create=r})(Ot||(Ot={}));var Ie;(function(t){function r(n){return n.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}t.fromPlainText=r;function e(n){let s=n;return d.string(s)||d.objectLiteral(s)&&d.string(s.language)&&d.string(s.value)}t.is=e})(Ie||(Ie={}));var Mt;(function(t){function r(e){let n=e;return!!n&&d.objectLiteral(n)&&(ue.is(n.contents)||Ie.is(n.contents)||d.typedArray(n.contents,Ie.is))&&(e.range===void 0||k.is(e.range))}t.is=r})(Mt||(Mt={}));var cs;(function(t){function r(e,n){return n?{label:e,documentation:n}:{label:e}}t.create=r})(cs||(cs={}));var ls;(function(t){function r(e,n,...s){let c={label:e};return d.defined(n)&&(c.documentation=n),d.defined(s)?c.parameters=s:c.parameters=[],c}t.create=r})(ls||(ls={}));var he;(function(t){t.Text=1,t.Read=2,t.Write=3})(he||(he={}));var Rt;(function(t){function r(e,n){let s={range:e};return d.number(n)&&(s.kind=n),s}t.create=r})(Rt||(Rt={}));var De;(function(t){t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(De||(De={}));var us;(function(t){t.Deprecated=1})(us||(us={}));var jt;(function(t){function r(e,n,s,c,u){let h={name:e,kind:n,location:{uri:c,range:s}};return u&&(h.containerName=u),h}t.create=r})(jt||(jt={}));var fs;(function(t){function r(e,n,s,c){return c!==void 0?{name:e,kind:n,location:{uri:s,range:c}}:{name:e,kind:n,location:{uri:s}}}t.create=r})(fs||(fs={}));var Bt;(function(t){function r(n,s,c,u,h,x){let g={name:n,detail:s,kind:c,range:u,selectionRange:h};return x!==void 0&&(g.children=x),g}t.create=r;function e(n){let s=n;return s&&d.string(s.name)&&d.number(s.kind)&&k.is(s.range)&&k.is(s.selectionRange)&&(s.detail===void 0||d.string(s.detail))&&(s.deprecated===void 0||d.boolean(s.deprecated))&&(s.children===void 0||Array.isArray(s.children))&&(s.tags===void 0||Array.isArray(s.tags))}t.is=e})(Bt||(Bt={}));var ds;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(ds||(ds={}));var Ne;(function(t){t.Invoked=1,t.Automatic=2})(Ne||(Ne={}));var hs;(function(t){function r(n,s,c){let u={diagnostics:n};return s!=null&&(u.only=s),c!=null&&(u.triggerKind=c),u}t.create=r;function e(n){let s=n;return d.defined(s)&&d.typedArray(s.diagnostics,Pe.is)&&(s.only===void 0||d.typedArray(s.only,d.string))&&(s.triggerKind===void 0||s.triggerKind===Ne.Invoked||s.triggerKind===Ne.Automatic)}t.is=e})(hs||(hs={}));var ps;(function(t){function r(n,s,c){let u={title:n},h=!0;return typeof s=="string"?(h=!1,u.kind=s):re.is(s)?u.command=s:u.edit=s,h&&c!==void 0&&(u.kind=c),u}t.create=r;function e(n){let s=n;return s&&d.string(s.title)&&(s.diagnostics===void 0||d.typedArray(s.diagnostics,Pe.is))&&(s.kind===void 0||d.string(s.kind))&&(s.edit!==void 0||s.command!==void 0)&&(s.command===void 0||re.is(s.command))&&(s.isPreferred===void 0||d.boolean(s.isPreferred))&&(s.edit===void 0||Ve.is(s.edit))}t.is=e})(ps||(ps={}));var gs;(function(t){function r(n,s){let c={range:n};return d.defined(s)&&(c.data=s),c}t.create=r;function e(n){let s=n;return d.defined(s)&&k.is(s.range)&&(d.undefined(s.command)||re.is(s.command))}t.is=e})(gs||(gs={}));var ms;(function(t){function r(n,s){return{tabSize:n,insertSpaces:s}}t.create=r;function e(n){let s=n;return d.defined(s)&&d.uinteger(s.tabSize)&&d.boolean(s.insertSpaces)}t.is=e})(ms||(ms={}));var ws;(function(t){function r(n,s,c){return{range:n,target:s,data:c}}t.create=r;function e(n){let s=n;return d.defined(s)&&k.is(s.range)&&(d.undefined(s.target)||d.string(s.target))}t.is=e})(ws||(ws={}));var xs;(function(t){function r(n,s){return{range:n,parent:s}}t.create=r;function e(n){let s=n;return d.objectLiteral(s)&&k.is(s.range)&&(s.parent===void 0||t.is(s.parent))}t.is=e})(xs||(xs={}));var ys;(function(t){t.namespace="namespace",t.type="type",t.class="class",t.enum="enum",t.interface="interface",t.struct="struct",t.typeParameter="typeParameter",t.parameter="parameter",t.variable="variable",t.property="property",t.enumMember="enumMember",t.event="event",t.function="function",t.method="method",t.macro="macro",t.keyword="keyword",t.modifier="modifier",t.comment="comment",t.string="string",t.number="number",t.regexp="regexp",t.operator="operator",t.decorator="decorator"})(ys||(ys={}));var bs;(function(t){t.declaration="declaration",t.definition="definition",t.readonly="readonly",t.static="static",t.deprecated="deprecated",t.abstract="abstract",t.async="async",t.modification="modification",t.documentation="documentation",t.defaultLibrary="defaultLibrary"})(bs||(bs={}));var vs;(function(t){function r(e){let n=e;return d.objectLiteral(n)&&(n.resultId===void 0||typeof n.resultId=="string")&&Array.isArray(n.data)&&(n.data.length===0||typeof n.data[0]=="number")}t.is=r})(vs||(vs={}));var $s;(function(t){function r(n,s){return{range:n,text:s}}t.create=r;function e(n){let s=n;return s!=null&&k.is(s.range)&&d.string(s.text)}t.is=e})($s||($s={}));var Ss;(function(t){function r(n,s,c){return{range:n,variableName:s,caseSensitiveLookup:c}}t.create=r;function e(n){let s=n;return s!=null&&k.is(s.range)&&d.boolean(s.caseSensitiveLookup)&&(d.string(s.variableName)||s.variableName===void 0)}t.is=e})(Ss||(Ss={}));var As;(function(t){function r(n,s){return{range:n,expression:s}}t.create=r;function e(n){let s=n;return s!=null&&k.is(s.range)&&(d.string(s.expression)||s.expression===void 0)}t.is=e})(As||(As={}));var Cs;(function(t){function r(n,s){return{frameId:n,stoppedLocation:s}}t.create=r;function e(n){let s=n;return d.defined(s)&&k.is(n.stoppedLocation)}t.is=e})(Cs||(Cs={}));var Ut;(function(t){t.Type=1,t.Parameter=2;function r(e){return e===1||e===2}t.is=r})(Ut||(Ut={}));var Wt;(function(t){function r(n){return{value:n}}t.create=r;function e(n){let s=n;return d.objectLiteral(s)&&(s.tooltip===void 0||d.string(s.tooltip)||ue.is(s.tooltip))&&(s.location===void 0||te.is(s.location))&&(s.command===void 0||re.is(s.command))}t.is=e})(Wt||(Wt={}));var Ls;(function(t){function r(n,s,c){let u={position:n,label:s};return c!==void 0&&(u.kind=c),u}t.create=r;function e(n){let s=n;return d.objectLiteral(s)&&O.is(s.position)&&(d.string(s.label)||d.typedArray(s.label,Wt.is))&&(s.kind===void 0||Ut.is(s.kind))&&s.textEdits===void 0||d.typedArray(s.textEdits,B.is)&&(s.tooltip===void 0||d.string(s.tooltip)||ue.is(s.tooltip))&&(s.paddingLeft===void 0||d.boolean(s.paddingLeft))&&(s.paddingRight===void 0||d.boolean(s.paddingRight))}t.is=e})(Ls||(Ls={}));var Es;(function(t){function r(e){return{kind:"snippet",value:e}}t.createSnippet=r})(Es||(Es={}));var ks;(function(t){function r(e,n,s,c){return{insertText:e,filterText:n,range:s,command:c}}t.create=r})(ks||(ks={}));var _s;(function(t){function r(e){return{items:e}}t.create=r})(_s||(_s={}));var Ps;(function(t){t.Invoked=0,t.Automatic=1})(Ps||(Ps={}));var Is;(function(t){function r(e,n){return{range:e,text:n}}t.create=r})(Is||(Is={}));var Ds;(function(t){function r(e,n){return{triggerKind:e,selectedCompletionInfo:n}}t.create=r})(Ds||(Ds={}));var Fs;(function(t){function r(e){let n=e;return d.objectLiteral(n)&&St.is(n.uri)&&d.string(n.name)}t.is=r})(Fs||(Fs={}));var Os;(function(t){function r(c,u,h,x){return new Tt(c,u,h,x)}t.create=r;function e(c){let u=c;return!!(d.defined(u)&&d.string(u.uri)&&(d.undefined(u.languageId)||d.string(u.languageId))&&d.uinteger(u.lineCount)&&d.func(u.getText)&&d.func(u.positionAt)&&d.func(u.offsetAt))}t.is=e;function n(c,u){let h=c.getText(),x=s(u,(m,b)=>{let S=m.range.start.line-b.range.start.line;return S===0?m.range.start.character-b.range.start.character:S}),g=h.length;for(let m=x.length-1;m>=0;m--){let b=x[m],S=c.offsetAt(b.range.start),A=c.offsetAt(b.range.end);if(A<=g)h=h.substring(0,S)+b.newText+h.substring(A,h.length);else throw new Error("Overlapping edit");g=S}return h}t.applyEdits=n;function s(c,u){if(c.length<=1)return c;let h=c.length/2|0,x=c.slice(0,h),g=c.slice(h);s(x,u),s(g,u);let m=0,b=0,S=0;for(;m<x.length&&b<g.length;)u(x[m],g[b])<=0?c[S++]=x[m++]:c[S++]=g[b++];for(;m<x.length;)c[S++]=x[m++];for(;b<g.length;)c[S++]=g[b++];return c}})(Os||(Os={}));var Tt=class{constructor(r,e,n,s){this._uri=r,this._languageId=e,this._version=n,this._content=s,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(r){if(r){let e=this.offsetAt(r.start),n=this.offsetAt(r.end);return this._content.substring(e,n)}return this._content}update(r,e){this._content=r.text,this._version=e,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let r=[],e=this._content,n=!0;for(let s=0;s<e.length;s++){n&&(r.push(s),n=!1);let c=e.charAt(s);n=c==="\r"||c===`
`,c==="\r"&&s+1<e.length&&e.charAt(s+1)===`
`&&s++}n&&e.length>0&&r.push(e.length),this._lineOffsets=r}return this._lineOffsets}positionAt(r){r=Math.max(Math.min(r,this._content.length),0);let e=this.getLineOffsets(),n=0,s=e.length;if(s===0)return O.create(0,r);for(;n<s;){let u=Math.floor((n+s)/2);e[u]>r?s=u:n=u+1}let c=n-1;return O.create(c,r-e[c])}offsetAt(r){let e=this.getLineOffsets();if(r.line>=e.length)return this._content.length;if(r.line<0)return 0;let n=e[r.line],s=r.line+1<e.length?e[r.line+1]:this._content.length;return Math.max(Math.min(n+r.character,s),n)}get lineCount(){return this.getLineOffsets().length}},d;(function(t){let r=Object.prototype.toString;function e(A){return typeof A<"u"}t.defined=e;function n(A){return typeof A>"u"}t.undefined=n;function s(A){return A===!0||A===!1}t.boolean=s;function c(A){return r.call(A)==="[object String]"}t.string=c;function u(A){return r.call(A)==="[object Number]"}t.number=u;function h(A,R,X){return r.call(A)==="[object Number]"&&R<=A&&A<=X}t.numberRange=h;function x(A){return r.call(A)==="[object Number]"&&-2147483648<=A&&A<=2147483647}t.integer=x;function g(A){return r.call(A)==="[object Number]"&&0<=A&&A<=2147483647}t.uinteger=g;function m(A){return r.call(A)==="[object Function]"}t.func=m;function b(A){return A!==null&&typeof A=="object"}t.objectLiteral=b;function S(A,R){return Array.isArray(A)&&A.every(R)}t.typedArray=S})(d||(d={}));var He=class t{constructor(r,e,n,s){this._uri=r,this._languageId=e,this._version=n,this._content=s,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(r){if(r){let e=this.offsetAt(r.start),n=this.offsetAt(r.end);return this._content.substring(e,n)}return this._content}update(r,e){for(let n of r)if(t.isIncremental(n)){let s=js(n.range),c=this.offsetAt(s.start),u=this.offsetAt(s.end);this._content=this._content.substring(0,c)+n.text+this._content.substring(u,this._content.length);let h=Math.max(s.start.line,0),x=Math.max(s.end.line,0),g=this._lineOffsets,m=Ms(n.text,!1,c);if(x-h===m.length)for(let S=0,A=m.length;S<A;S++)g[S+h+1]=m[S];else m.length<1e4?g.splice(h+1,x-h,...m):this._lineOffsets=g=g.slice(0,h+1).concat(m,g.slice(x+1));let b=n.text.length-(u-c);if(b!==0)for(let S=h+1+m.length,A=g.length;S<A;S++)g[S]=g[S]+b}else if(t.isFull(n))this._content=n.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=e}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=Ms(this._content,!0)),this._lineOffsets}positionAt(r){r=Math.max(Math.min(r,this._content.length),0);let e=this.getLineOffsets(),n=0,s=e.length;if(s===0)return{line:0,character:r};for(;n<s;){let u=Math.floor((n+s)/2);e[u]>r?s=u:n=u+1}let c=n-1;return r=this.ensureBeforeEOL(r,e[c]),{line:c,character:r-e[c]}}offsetAt(r){let e=this.getLineOffsets();if(r.line>=e.length)return this._content.length;if(r.line<0)return 0;let n=e[r.line];if(r.character<=0)return n;let s=r.line+1<e.length?e[r.line+1]:this._content.length,c=Math.min(n+r.character,s);return this.ensureBeforeEOL(c,n)}ensureBeforeEOL(r,e){for(;r>e&&Rs(this._content.charCodeAt(r-1));)r--;return r}get lineCount(){return this.getLineOffsets().length}static isIncremental(r){let e=r;return e!=null&&typeof e.text=="string"&&e.range!==void 0&&(e.rangeLength===void 0||typeof e.rangeLength=="number")}static isFull(r){let e=r;return e!=null&&typeof e.text=="string"&&e.range===void 0&&e.rangeLength===void 0}},Fe;(function(t){function r(s,c,u,h){return new He(s,c,u,h)}t.create=r;function e(s,c,u){if(s instanceof He)return s.update(c,u),s;throw new Error("TextDocument.update: document must be created by TextDocument.create")}t.update=e;function n(s,c){let u=s.getText(),h=zt(c.map(ua),(m,b)=>{let S=m.range.start.line-b.range.start.line;return S===0?m.range.start.character-b.range.start.character:S}),x=0,g=[];for(let m of h){let b=s.offsetAt(m.range.start);if(b<x)throw new Error("Overlapping edit");b>x&&g.push(u.substring(x,b)),m.newText.length&&g.push(m.newText),x=s.offsetAt(m.range.end)}return g.push(u.substr(x)),g.join("")}t.applyEdits=n})(Fe||(Fe={}));function zt(t,r){if(t.length<=1)return t;let e=t.length/2|0,n=t.slice(0,e),s=t.slice(e);zt(n,r),zt(s,r);let c=0,u=0,h=0;for(;c<n.length&&u<s.length;)r(n[c],s[u])<=0?t[h++]=n[c++]:t[h++]=s[u++];for(;c<n.length;)t[h++]=n[c++];for(;u<s.length;)t[h++]=s[u++];return t}function Ms(t,r,e=0){let n=r?[e]:[];for(let s=0;s<t.length;s++){let c=t.charCodeAt(s);Rs(c)&&(c===13&&s+1<t.length&&t.charCodeAt(s+1)===10&&s++,n.push(e+s+1))}return n}function Rs(t){return t===13||t===10}function js(t){let r=t.start,e=t.end;return r.line>e.line||r.line===e.line&&r.character>e.character?{start:e,end:r}:t}function ua(t){let r=js(t.range);return r!==t.range?{newText:t.newText,range:r}:t}var Bs;(function(t){t.LATEST={textDocument:{completion:{completionItem:{documentationFormat:[U.Markdown,U.PlainText]}},hover:{contentFormat:[U.Markdown,U.PlainText]}}}})(Bs||(Bs={}));function Vt(t){return Object.keys(t).map(r=>t[r])}function pe(t){return typeof t<"u"}var qe=class{constructor(r,e){this.clientCapabilities=r,this.rcasmDataManager=e}doComplete(r,e,n){this.offset=r.offsetAt(e),this.position=e,this.currentWord=da(r,this.offset),this.defaultReplaceRange=k.create(O.create(this.position.line,this.position.character-this.currentWord.length),this.position),this.textDocument=r,this.program=n;try{let c={isIncomplete:!1,items:[]};var s=r.getText(k.create(O.create(this.position.line,0),this.position));return s.match(/^([a-z]+:)?([ \t]+)?([a-z]{0,3})$/i)&&this.getCompletionsForMnemonic(c),s.match(/^([a-z]+:)?([ \t]+)?([\!]?[a-z]*)$/i)&&this.getCompletionsForDirective(c),c}finally{this.position=null,this.currentWord=null,this.textDocument=null,this.program=null,this.defaultReplaceRange=null}}getCompletionsForMnemonic(r){return this.rcasmDataManager.getMnemonics().forEach(n=>{let s,c;s=this.getCompletionRange(null),c=n.snippet??n.name;let u={label:n.name,detail:n.summary,documentation:ae(n,this.doesSupportMarkdown()),textEdit:B.replace(s,c),insertTextFormat:de.Snippet,kind:fe.Method};r.items.push(u)}),r}getCompletionsForDirective(r){return this.rcasmDataManager.getDirectives().forEach(n=>{let s,c;s=this.getCompletionRange(null),c=n.snippet??n.name;let u={label:n.name,detail:n.summary,documentation:ae(n,this.doesSupportMarkdown()),textEdit:B.replace(s,c),insertTextFormat:de.Snippet,kind:fe.Property,sortText:n.name.substring(1)};r.items.push(u)}),r}doesSupportMarkdown(){if(!pe(this.supportsMarkdown)){if(!pe(this.clientCapabilities))return this.supportsMarkdown=!0,this.supportsMarkdown;let r=this.clientCapabilities&&this.clientCapabilities.textDocument&&this.clientCapabilities.textDocument.hover;this.supportsMarkdown=r&&r.contentFormat&&Array.isArray(r.contentFormat)&&r.contentFormat.indexOf(U.Markdown)!==-1}return this.supportsMarkdown}getCompletionRange(r){if(r&&r.offset<=this.offset&&this.offset<=r.end){let e=r.end!==-1?this.textDocument.positionAt(r.end):this.position,n=this.textDocument.positionAt(r.offset);if(n.line===e.line)return k.create(n,e)}return this.defaultReplaceRange}};function da(t,r){let e=r-1,n=t.getText();for(;e>=0&&` 	
\r:,`.indexOf(n.charAt(e))===-1;)e--;return n.substring(e+1,r)}var Ge=class{constructor(r,e){this.clientCapabilities=r,this.rcasmDataManager=e}doHover(r,e,n){function s(x){return k.create(r.positionAt(x.offset),r.positionAt(x.end))}let c=r.offsetAt(e),u=zr(n,c),h=null;for(let x=0;x<u.length;x++){let g=u[x];if(g instanceof Ce){let m=g.mnemonic,b=this.rcasmDataManager.getMnemonic(m);if(b){let S=this.getParamNames(b,g),A=$t(b,S,this.doesSupportMarkdown());A?h={contents:A,range:s(g)}:h=null}break}if(g instanceof ve){let m=this.rcasmDataManager.getMnemonic("org");if(m){let b=[g.pcExpr.getText()],S=$t(m,b,this.doesSupportMarkdown());S?h={contents:S,range:s(g)}:h=null}break}if(g instanceof $e||g instanceof Se){let m=g.getText().slice(0,5).toLowerCase(),b=this.rcasmDataManager.getDirective(m);if(b){let S=ae(b,this.doesSupportMarkdown());S?h={contents:S,range:s(g)}:h=null}break}if(g instanceof Ae){let m=g.getText().slice(0,6).toLowerCase(),b=this.rcasmDataManager.getDirective(m);if(b){let S=ae(b,this.doesSupportMarkdown());S?h={contents:S,range:s(g)}:h=null}break}}return h&&(h.contents=this.convertContents(h.contents)),h}getParamNames(r,e){let n=[];return e.p1?n.push(this.getParamName(r,e.p1,e.mnemonic)):r.class==="ALU"?n.push("A"):n.push("?"),e.p2?n.push(this.getParamName(r,e.p2,e.mnemonic)):n.push("?"),n}getParamName(r,e,n){return e instanceof Ee?e.value:e instanceof ee?`(${e.getText().trim()})`:e instanceof oe?e.getText().trim():e instanceof Le?n.toLowerCase()==="ldi"&&+e.value>15?`0x${e.value.toString(16).toUpperCase()}`:r.class==="GOTO"?`0x${e.value.toString(16).toUpperCase()}`:e.value.toString():"?"}convertContents(r){return this.doesSupportMarkdown()||typeof r=="string"?r:"kind"in r?{kind:"plaintext",value:r.value}:Array.isArray(r)?r.map(e=>typeof e=="string"?e:e.value):r.value}doesSupportMarkdown(){if(!pe(this.supportsMarkdown)){if(!pe(this.clientCapabilities))return this.supportsMarkdown=!0,this.supportsMarkdown;let r=this.clientCapabilities.textDocument&&this.clientCapabilities.textDocument.hover;this.supportsMarkdown=r&&r.contentFormat&&Array.isArray(r.contentFormat)&&r.contentFormat.indexOf(U.Markdown)!==-1}return this.supportsMarkdown}};var Nt=class{constructor(r,e){this.symbols=[]}addSymbol(r){this.symbols.push(r)}getSymbol(r,e){for(let n=0;n<this.symbols.length;n++){let s=this.symbols[n];if(s.name===r&&s.type===e)return s}return null}},Ht=class extends Nt{constructor(){super(0,Number.MAX_VALUE)}},qt=class{constructor(r,e,n,s){this.name=r,this.value=e,this.node=n,this.type=s}},Gt=class{constructor(r){this.scope=r}addSymbol(r,e,n,s){r.offset!==-1&&this.scope.addSymbol(new qt(e,n,r,s))}visitNode(r){switch(r.type){case D.Label:return this.addSymbol(r,r.getText(),void 0,ye.Label),!0}return!0}},Oe=class{constructor(r){this.global=new Ht,r.acceptVisitor(new Gt(this.global))}internalFindSymbol(r,e){let n=r.getText(),s=this.global;for(let c=0;c<e.length;c++){let u=e[c],h=s.getSymbol(n,u);if(h)return h}return null}evaluateReferenceTypes(r){return r instanceof ee||r instanceof K?[ye.Label]:null}findSymbolFromNode(r){if(!r)return null;let e=this.evaluateReferenceTypes(r);return e?this.internalFindSymbol(r,e):null}matchesSymbol(r,e){if(!r||!r.matches(e.name))return!1;let n=this.evaluateReferenceTypes(r);return!n||n.indexOf(e.type)===-1?!1:this.internalFindSymbol(r,n)===e}};var Xe=class{findDefinition(r,e,n){let s=new Oe(n),c=r.offsetAt(e),u=ke(n,c);if(!u)return null;let h=s.findSymbolFromNode(u);return h?{uri:r.uri,range:se(h.node,r)}:null}findReferences(r,e,n){return this.findDocumentHighlights(r,e,n).map(c=>({uri:r.uri,range:c.range}))}getHighlightNode(r,e,n){let s=r.offsetAt(e),c=ke(n,s);if(!(!c||c.type!==D.Label&&c.type!==D.LabelRef))return c}findDocumentHighlights(r,e,n){let s=[],c=r.offsetAt(e),u=ke(n,c);if(!u||u.type!==D.Label&&u.type!==D.LabelRef)return s;let h=new Oe(n),x=h.findSymbolFromNode(u),g=u.getText();return n.accept(m=>{if(x){if(h.matchesSymbol(m,x))return s.push({kind:Us(m),range:se(m,r)}),!1}else u&&u.type===m.type&&m.matches(g)&&s.push({kind:Us(m),range:se(m,r)});return!0}),s}findSymbolInformations(r,e){let n=[],s=(c,u,h)=>{let x=h instanceof F?se(h,r):h,g={name:c,kind:u,location:te.create(r.uri,x)};n.push(g)};return this.collectDocumentSymbols(r,e,s),n}findDocumentSymbols(r,e){let n=[],s=[],c=(u,h,x,g,m)=>{let b=x instanceof F?se(x,r):x,S=(g instanceof F?se(g,r):g)??k.create(b.start,b.start),A={name:u,kind:h,range:b,selectionRange:S},R=s.pop();for(;R&&!ha(R[1],b);)R=s.pop();if(R){let X=R[0];X.children||(X.children=[]),X.children.push(A),s.push(R)}else n.push(A);m&&s.push([A,se(m,r)])};return this.collectDocumentSymbols(r,e,c),n}collectDocumentSymbols(r,e,n){e.accept(s=>(s instanceof K&&n(s.getName(),De.Variable,s,s,void 0),!0))}prepareRename(r,e,n){let s=this.getHighlightNode(r,e,n);if(s)return k.create(r.positionAt(s.offset),r.positionAt(s.end))}doRename(r,e,n,s){let u=this.findDocumentHighlights(r,e,s).map(h=>B.replace(h.range,n));return{changes:{[r.uri]:u}}}};function se(t,r){return k.create(r.positionAt(t.offset),r.positionAt(t.end))}function ha(t,r){let e=r.start.line,n=r.end.line,s=t.start.line,c=t.end.line;return!(e<s||n<s||e>c||n>c||e===s&&r.start.character<t.start.character||n===c&&r.end.character>t.end.character)}function Us(t){return t.type===D.Label?he.Write:he.Read}var Ze=class{constructor(){}configure(r){this.settings=r}doValidation(r,e=this.settings){if(e&&e.validate===!1)return[];let{errors:n,warnings:s}=vt(r.getText()),c=(h,x)=>({severity:x,range:{start:r.positionAt(h.loc.start.offset),end:r.positionAt(h.loc.end.offset)},message:h.msg,source:r.languageId}),u=[];return u.push(...n.map(h=>c(h,ce.Error))),u.push(...s.map(h=>c(h,ce.Warning))),u}};function Ws(t,r,e){let n=pa(t,r);return ga(n,e)}function pa(t,r){function e(s){return k.create(t.positionAt(s.offset),t.positionAt(s.end))}let n=[];return r.accept(s=>{if(s instanceof be){let c=e(s);return n.push({startLine:c.start.line,endLine:c.end.line,kind:"region"}),!1}return!0}),n}function ga(t,r){let e=r&&r.rangeLimit||Number.MAX_VALUE,n=t.sort((u,h)=>{let x=u.startLine-h.startLine;return x===0&&(x=u.endLine-h.endLine),x}),s=[],c=-1;return n.forEach(u=>{u.startLine<c&&c<u.endLine||(s.push(u),c=u.endLine)}),s.length<e?s:s.slice(0,e)}var Ts={version:1,mnemonics:[{name:"add",class:"ALU",cycles:8,summary:"Arithmetic Add",description:"Adds the contents of register b and c placing the result in dst (a or d). If dst is not specified then register a is assumed. Affects Z (zero), S (sign) and C (carry) flags.",synopsis:"{0} = B + C",syntax:"add [<dest>{a|d}]"},{name:"and",class:"ALU",cycles:8,summary:"Logic And",description:"Performs a bitwise AND on register b and c placing the result in dst (a or d). If dst is not specified then register a is assumed. Affects Z (zero) and S (sign) flags.",synopsis:"{0} = B & C",syntax:"and [<dest>{a|d}]"},{name:"bcs",class:"GOTO",cycles:24,summary:"Branch if Carry Set",snippet:"bcs ${1:label}",description:"Jumps to label if C is set (last ALU operation resulted in a carry).",synopsis:"PC = {0} [if CY]",syntax:"bcs <label>"},{name:"beq",class:"GOTO",cycles:24,summary:"Branch if Equal (zero)",snippet:"beq ${1:label}",description:"Jumps to label if Z flag is set (last ALU operation result was 0).",synopsis:"PC = {0} [if Z]",syntax:"beq <label>"},{name:"ble",class:"GOTO",cycles:24,summary:"Branch if Less Than or Equal (sign or zero)",snippet:"ble ${1:label}",description:"Jumps to label if S or Z is set (last ALU operation resulted in a zero or negative value).",synopsis:"PC = {0} [if S or Z]",syntax:"ble <label>"},{name:"blt",class:"GOTO",cycles:24,summary:"Branch if Less Than (sign set)",snippet:"blt ${1:label}",description:"Jumps to label if S is set (last ALU operation has most significant bit set / is negative). Synonym of `bmi`.",synopsis:"PC = {0} [if S]",syntax:"blt <label>"},{name:"bmi",class:"GOTO",cycles:24,summary:"Branch if Minus/Sign",snippet:"bmi ${1:label}",description:"Jumps to label if S is set (last ALU operation has most significant bit set / is negative). Synonym of `blt`.",synopsis:"PC = {0} [if S]",syntax:"bmi <label>"},{name:"bne",class:"GOTO",cycles:24,summary:"Branch if Not Equal (not zero)",snippet:"bne ${1:label}",description:"Jumps to label if Z is not set (last ALU operation result was not 0).",synopsis:"PC = {0} [if not Z]",syntax:"bne <label>"},{name:"clr",class:"MOV8",cycles:8,summary:"8-bit Register Clear",description:"Clears (sets to 0) general purpose 8-bit register dst. This is the equivalent of `mov dst,dst`.",synopsis:"{0} = 0",syntax:"clr <dst>{a|b|c|d|m1|m2|x|y}",variants:[{class:"MOV16",cycles:10,summary:"16-bit Register Clear",description:"Clears (sets to 0) 16-bit register xy. This is the equivalent of `mov xy,xy`.",syntax:"clr xy",whenFirstParamIs:["xy"]}]},{name:"cmp",class:"ALU",cycles:8,summary:"Compare (Logic Xor)",description:"Compares the values in register b and c setting condition flag Z (zero) if the values are the same. Overwrites dst (a or d). If dst is not specified then register a is assumed. Affects Z (zero) and S (sign) flags. Synonym of `eor`.",synopsis:"{0} = B ^ C",syntax:"cmp [<dest>{a|d}]"},{name:"eor",class:"ALU",cycles:8,summary:"Logic Xor",description:"Performs a bitwise XOR (exlusive OR) on register b and c placing the result in dst (a or d). If dst is not specified then register a is assumed. Affects Z (zero) and S (sign) flags. Synonym of `cmp`.",synopsis:"{0} = B ^ C",syntax:"eor [<dest>{a|d}]"},{name:"inc",class:"ALU",cycles:8,summary:"Increment",description:"Adds one to the contents of register b (register c is ignored) placing the result in dst (a or d). If dst is not specified then register a is assumed. Affects Z (zero), S (sign) and C (carry) flags.",synopsis:"{0} = B + 1",syntax:"inc [<dest>{a|d}]"},{name:"hlt",class:"MISC",cycles:10,summary:"Halt",description:"Halts execution of the program.",synopsis:"HALT (PC = PC + 1)"},{name:"hlr",class:"MISC",cycles:10,summary:"Halt and Reload",description:"Halts execution of the program and sets the program counter to the value on the primary switches.",synopsis:"HALT (PC = AS)"},{name:"ixy",class:"INCXY",cycles:14,summary:"XY Increment",description:"Increments the 16-bit value in the xy register by 1.",synopsis:"XY = XY + 1"},{name:"lds",class:"MISC",cycles:10,summary:"Load Register from Switches",description:"Loads register dst (a or d) from the front panel switches",synopsis:"{0} = DS",snippet:"lds ${1:a}",syntax:"lds <dst>{a|d}"},{name:"ldr",class:"LOAD",cycles:12,summary:"Load Register from Memory",snippet:"ldr ${1:b}",description:"Loads register dst (a, b, c or d) with the byte in memory currently referenced by register m.",synopsis:"{0} = (M)",syntax:"ldr <dst>{a|b|c|d}"},{name:"jmp",class:"GOTO",cycles:24,summary:"Unconditional Jump",snippet:"jmp ${1:label}",description:"Unconditionally jumps to label (via register j).",synopsis:"PC = {0}",syntax:"jmp <label>"},{name:"jsr",class:"GOTO",cycles:24,summary:"Jump Subroutine",snippet:"jsr ${1:label}",description:"Saves the address of the next instruction into register xy and then unconditionally jumps to label (via register j). Notionally behaves as a 'call subroutine' operation.",synopsis:"XY = PC, PC = {0}",syntax:"jsr <label>"},{name:"rts",class:"MOV16",cycles:10,summary:"Return from Subroutine",description:"Copies the value in register xy to the program counter pc. Notionally behaves as a 'return' operation to a previous jsr call.",synopsis:"PC = XY"},{name:"ldi",class:"SETAB",cycles:8,summary:"8-bit Load Immediate",snippet:"ldi ${1:a},${2:0}",description:"Loads an 8-bit constant value into dst (register a or b), value must be between -16 and 15.",synopsis:"{0} = {1}",syntax:"ldi <dst>{a|b} , <value>{-16,15}",variants:[{class:"GOTO",cycles:24,summary:"16-bit Load Immediate",description:"Loads a 16-bit constant value into dst (register m or j), value can be between 0x0000 and 0xFFFF.",syntax:"ldi <dst>{m|j} , [ <value>{0x0000,0xFFFF} | <label> ]",whenFirstParamIs:["m","j"]}]},{name:"mov",class:"MOV8",cycles:8,summary:"8-bit Register to Register Copy",snippet:"mov ${1:b},${2:a}",description:"Copies a value from src to dst between any of the eight general purpose 8-bit registers. If dst and src are the same then dst will be set to 0.",synopsis:"{0} = {1}",syntax:"mov <dst>{a-d|m1|m2|x|y} , <src>{a-d|m1|m2|x|y}",variants:[{class:"MOV16",cycles:10,summary:"16-bit Register to Register Copy",description:"Copies a value between the 16-bit src registers (m, xy or j) and dst (xy or the program counter pc). If dst and src are the same then dst will be set to 0.",syntax:"mov <dst>{xy|pc} , <src>{m|xy|j|as}",whenFirstParamIs:["xy","pc"]}]},{name:"not",class:"ALU",cycles:8,summary:"Logic Not",description:"Performs a bitwise NOT on register b (register c is ignored) placing the result in dst (a or d). If dst is not specified then register a is assumed. Affects Z (zero) and S (sign) flags.",synopsis:"{0} = ~B",syntax:"not [<dest>{a|d}]"},{name:"orr",class:"ALU",cycles:8,summary:"Logic Or",description:"Performs a bitwise OR on register b and c placing the result in dst (a or d). If dst is not specified then register a is assumed. Affects Z (zero) and S (sign) flags.",synopsis:"{0} = B | C",syntax:"orr [<dest>{a|d}]"},{name:"rol",class:"ALU",cycles:8,summary:"Bitwise Circular Shift Left",description:"Performs a bitwise left-rotation on register b (register c is ignored) placing the result in dst (a or d). If dst is not specified then register a is assumed. Every bit shifts one place to the left with the left most bit rotated around to right. Affects Z (zero) and S (sign) flags.",synopsis:"{0} = <<<B",syntax:"rol [<dest>{a|d}]"},{name:"str",class:"STORE",cycles:12,summary:"Store Register into Memory",snippet:"str ${1:a}",description:"Stores register src (a, b, c or d) into the byte of memory currently referenced by register m.",synopsis:"(M) = {0}",syntax:"str <src>{a|b|c|d}"}],directives:[{name:"!align",summary:"Define Align",description:"Writes 8-bit zeros into the output until the current location is a multiple of the given value.",snippet:"!align ${1:8}",syntax:"<value>{2,4,8,16...}"},{name:"!byte",summary:"Define Byte Data",description:"Writes the given 8-bit values directly into the output starting from current location.",snippet:"!byte ${1:0x00}",syntax:"<value>{0x00,0xFF} [ ,...n ]"},{name:"!word",summary:"Define Word Data",description:"Writes the given 16-bit values directly into the output starting from current location.",snippet:"!word ${1:0x0000}",syntax:"<value>{0x0000,0xFFFF} [ ,...n ]"},{name:"!fill",summary:"Define Fill Space",description:"Writes the given 8-bit value n times directly into the output starting from current location.",snippet:"!fill ${1:8},${2:0x00}",syntax:"<count>{0,255}, <value>{0x00,0xFF}"}]};var Je=class{constructor(r){this._mnemonics=[],this._directives=[],this.addData(r)}provideMnemonics(){return this._mnemonics}provideDirectives(){return this._directives}addData(r){if(r.mnemonics&&(this._mnemonics=this._mnemonics.concat(r.mnemonics)),Array.isArray(r.mnemonics))for(let e of r.mnemonics)ma(e)&&this._mnemonics.push(e);if(Array.isArray(r.directives))for(let e of r.directives)wa(e)&&this._directives.push(e)}};function ma(t){return typeof t.name=="string"}function wa(t){return typeof t.name=="string"}var Ye=class{constructor(r){this.dataProviders=[],this._mnemonicSet={},this._directiveSet={},this._mnemonics=[],this._directives=[],this.setDataProviders(r?.useDefaultDataProvider!==!1,r?.customDataProviders||[])}setDataProviders(r,e){this.dataProviders=[],r&&this.dataProviders.push(new Je(Ts)),this.dataProviders.push(...e),this.collectData()}collectData(){this._mnemonicSet={},this._directiveSet={},this.dataProviders.forEach(r=>{r.provideMnemonics().forEach(e=>{this._mnemonicSet[e.name]||(this._mnemonicSet[e.name]=e)}),r.provideDirectives().forEach(e=>{this._directiveSet[e.name]||(this._directiveSet[e.name]=e)})}),this._mnemonics=Vt(this._mnemonicSet),this._directives=Vt(this._directiveSet)}getMnemonic(r){return this._mnemonicSet[r]}getDirective(r){return this._directiveSet[r]}getMnemonics(){return this._mnemonics}getDirectives(){return this._directives}};function xa(t,r,e,n,s,c){return{configure:u=>{s.configure(u)},setDataProviders:c.setDataProviders.bind(c),doValidation:s.doValidation.bind(s),parseProgram:t.parseProgram.bind(t),doComplete:r.doComplete.bind(r),doHover:e.doHover.bind(e),findDefinition:n.findDefinition.bind(n),findReferences:n.findReferences.bind(n),findDocumentHighlights:n.findDocumentHighlights.bind(n),findDocumentSymbols:n.findSymbolInformations.bind(n),findDocumentSymbols2:n.findDocumentSymbols.bind(n),prepareRename:n.prepareRename.bind(n),doRename:n.doRename.bind(n),getFoldingRanges:Ws}}var ya={};function zs(t=ya){let r=new Ye(t);return xa(new Te,new qe(t&&t.clientCapabilities,r),new Ge(t&&t.clientCapabilities,r),new Xe,new Ze,r)}var Qe=class{constructor(r,e){this._ctx=r,this._languageId=e.languageId,this._languageService=zs({})}async doValidation(r){let e=this._getTextDocument(r);if(e){let n=this._languageService.doValidation(e);return Promise.resolve(n)}return Promise.resolve([])}async doComplete(r,e){let n=this._getTextDocument(r);if(!n)return null;let s=this._languageService.parseProgram(n),c=this._languageService.doComplete(n,e,s);return Promise.resolve(c)}async doHover(r,e){let n=this._getTextDocument(r);if(!n)return null;let s=this._languageService.parseProgram(n),c=this._languageService.doHover(n,e,s);return Promise.resolve(c)}async findDefinition(r,e){let n=this._getTextDocument(r);if(!n)return null;let s=this._languageService.parseProgram(n),c=this._languageService.findDefinition(n,e,s);return Promise.resolve(c)}async findReferences(r,e){let n=this._getTextDocument(r);if(!n)return[];let s=this._languageService.parseProgram(n),c=this._languageService.findReferences(n,e,s);return Promise.resolve(c)}async findDocumentHighlights(r,e){let n=this._getTextDocument(r);if(!n)return[];let s=this._languageService.parseProgram(n),c=this._languageService.findDocumentHighlights(n,e,s);return Promise.resolve(c)}async findDocumentSymbols(r){let e=this._getTextDocument(r);if(!e)return[];let n=this._languageService.parseProgram(e),s=this._languageService.findDocumentSymbols(e,n);return Promise.resolve(s)}async getFoldingRanges(r,e){let n=this._getTextDocument(r);if(!n)return[];let s=this._languageService.parseProgram(n),c=this._languageService.getFoldingRanges(n,s,e);return Promise.resolve(c)}async doRename(r,e,n){let s=this._getTextDocument(r);if(!s)return null;let c=this._languageService.parseProgram(s),u=this._languageService.doRename(s,e,n,c);return Promise.resolve(u)}_getTextDocument(r){let e=this._ctx.getMirrorModels();for(let n of e)if(n.uri.toString()===r)return Fe.create(r,this._languageId,n.version,n.getValue());return null}};function va(t,r){return new Qe(t,r)}return Pr($a);})();
return moduleExports;
});
