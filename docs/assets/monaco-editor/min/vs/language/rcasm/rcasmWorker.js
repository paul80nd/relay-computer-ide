/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.50.0(10517d799fb613d069ab531d3b2dd4304c2dd40a)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/
define("vs/language/rcasm/rcasmWorker", ["require","require"],(require)=>{
"use strict";var moduleExports=(()=>{var It=Object.defineProperty;var rc=Object.getOwnPropertyDescriptor;var nc=Object.getOwnPropertyNames;var ic=Object.prototype.hasOwnProperty;var oc=(t,s)=>()=>(t&&(s=t(t=0)),s);var pr=(t,s)=>()=>(s||t((s={exports:{}}).exports,s),s.exports),hr=(t,s)=>{for(var e in s)It(t,e,{get:s[e],enumerable:!0})},ac=(t,s,e,i)=>{if(s&&typeof s=="object"||typeof s=="function")for(let n of nc(s))!ic.call(t,n)&&n!==e&&It(t,n,{get:()=>s[n],enumerable:!(i=rc(s,n))||i.enumerable});return t};var gr=t=>ac(It({},"__esModule",{value:!0}),t);var Ot={};hr(Ot,{DataSize:()=>_e,mkAlign:()=>Sc,mkAsmLine:()=>mc,mkBinaryOp:()=>Fc,mkCallFunc:()=>kc,mkData:()=>vc,mkError:()=>Ac,mkFill:()=>$c,mkFor:()=>Cc,mkGetCurPC:()=>yc,mkIdent:()=>Ic,mkIfElse:()=>Ec,mkInsn:()=>bc,mkLabel:()=>wc,mkLet:()=>Lc,mkLiteral:()=>_c,mkProgram:()=>gc,mkRegister:()=>Pc,mkScopeQualifiedIdent:()=>Dc,mkSetPC:()=>xc});function gc(t,s){return{lines:t,loc:s}}function mc(t,s,e,i){return{label:t,stmt:s,scopedStmts:e,loc:i}}function wc(t,s){return{name:t,loc:s}}function xc(t,s){return{type:"setpc",pc:t,loc:s}}function yc(t){return{type:"getcurpc",loc:t}}function bc(t,s,e,i){return{type:"insn",mnemonic:t,p1:s,p2:e,loc:i}}function vc(t,s,e){return{type:"data",values:s,dataSize:t,loc:e}}function $c(t,s,e){return{type:"fill",numBytes:t,fillValue:s,loc:e}}function Sc(t,s){return{type:"align",alignBytes:t,loc:s}}function Ec(t,s,e){return{type:"if",cases:t,elseBranch:s!==null?s:[],loc:e}}function Ac(t,s){return{type:"error",error:t,loc:s}}function Cc(t,s,e,i){return{type:"for",index:t,list:s,body:e,loc:i}}function Lc(t,s,e){return{type:"let",name:t,value:s,loc:e}}function kc(t,s,e){return{type:"callfunc",callee:t,args:s??[],loc:e}}function _c(t,s,e){return{type:"literal",lit:t,ot:s,loc:e}}function Pc(t,s){return{type:"register",value:t,loc:s}}function Dc(t,s,e){return{type:"qualified-ident",path:t,absolute:s,loc:e}}function Ic(t,s){return{type:"ident",name:t,loc:s}}function Fc(t,s,e,i){return{type:"binary",op:t,left:s,right:e,loc:i}}var _e,Rt=oc(()=>{(function(t){t[t.Byte=0]="Byte",t[t.Word=1]="Word"})(_e||(_e={}))});var $r=pr((cl,vr)=>{"use strict";function k(t){if(this.words=[],t)if(Symbol&&Symbol.iterator&&t[Symbol.iterator]!==void 0){let s=t[Symbol.iterator](),e=s.next();for(;!e.done;)this.add(e.value),e=s.next()}else for(let s=0;s<t.length;s++)this.add(t[s])}k.fromWords=function(t){let s=Object.create(k.prototype);return s.words=t,s};k.prototype.add=function(t){this.resize(t),this.words[t>>>5]|=1<<t};k.prototype.flip=function(t){this.resize(t),this.words[t>>>5]^=1<<t};k.prototype.clear=function(){this.words.length=0};k.prototype.remove=function(t){this.resize(t),this.words[t>>>5]&=~(1<<t)};k.prototype.isEmpty=function(t){let s=this.words.length;for(let e=0;e<s;e++)if(this.words[e]!==0)return!1;return!0};k.prototype.has=function(t){return(this.words[t>>>5]&1<<t)!==0};k.prototype.checkedAdd=function(t){this.resize(t);let s=this.words[t>>>5],e=s|1<<t;return this.words[t>>>5]=e,(e^s)>>>t};k.prototype.trim=function(t){let s=this.words.length;for(;s>0&&this.words[s-1]===0;)s--;this.words.length=s};k.prototype.resize=function(t){let s=t+32>>>5;for(let e=this.words.length;e<s;e++)this.words[e]=0};k.prototype.hammingWeight=function(t){return t-=t>>>1&1431655765,t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24};k.prototype.hammingWeight4=function(t,s,e,i){return t-=t>>>1&1431655765,s-=s>>>1&1431655765,e-=e>>>1&1431655765,i-=i>>>1&1431655765,t=(t&858993459)+(t>>>2&858993459),s=(s&858993459)+(s>>>2&858993459),e=(e&858993459)+(e>>>2&858993459),i=(i&858993459)+(i>>>2&858993459),t=t+(t>>>4)&252645135,s=s+(s>>>4)&252645135,e=e+(e>>>4)&252645135,i=i+(i>>>4)&252645135,(t+s+e+i)*16843009>>>24};k.prototype.size=function(){let t=0,s=this.words.length,e=this.words;for(let i=0;i<s;i++)t+=this.hammingWeight(e[i]);return t};k.prototype.array=function(){let t=new Array(this.size()),s=0,e=this.words.length;for(let i=0;i<e;++i){let n=this.words[i];for(;n!=0;){let c=n&-n;t[s++]=(i<<5)+this.hammingWeight(c-1|0),n^=c}}return t};k.prototype.forEach=function(t){let s=this.words.length;for(let e=0;e<s;++e){let i=this.words[e];for(;i!=0;){let n=i&-i;t((e<<5)+this.hammingWeight(n-1|0)),i^=n}}};k.prototype[Symbol.iterator]=function(){let t=this.words.length,s=0,e=this.words[s],i=this.hammingWeight,n=this.words;return{[Symbol.iterator](){return this},next(){for(;s<t;)if(e!==0){let c=e&-e,f=(s<<5)+i(c-1|0);return e^=c,{done:!1,value:f}}else s++,s<t&&(e=n[s]);return{done:!0,value:void 0}}}};k.prototype.clone=function(){let t=Object.create(k.prototype);return t.words=this.words.slice(),t};k.prototype.intersects=function(t){let s=Math.min(this.words.length,t.words.length);for(let e=0;e<s;++e)if(this.words[e]&t.words[e])return!0;return!1};k.prototype.intersection=function(t){let s=Math.min(this.words.length,t.words.length),e=0;for(;e+7<s;e+=8)this.words[e]&=t.words[e],this.words[e+1]&=t.words[e+1],this.words[e+2]&=t.words[e+2],this.words[e+3]&=t.words[e+3],this.words[e+4]&=t.words[e+4],this.words[e+5]&=t.words[e+5],this.words[e+6]&=t.words[e+6],this.words[e+7]&=t.words[e+7];for(;e<s;++e)this.words[e]&=t.words[e];let i=this.words.length;for(e=s;e<i;++e)this.words[e]=0;return this};k.prototype.intersection_size=function(t){let s=Math.min(this.words.length,t.words.length),e=0;for(let i=0;i<s;++i)e+=this.hammingWeight(this.words[i]&t.words[i]);return e};k.prototype.new_intersection=function(t){let s=Object.create(k.prototype),e=Math.min(this.words.length,t.words.length);s.words=new Array(e);let i=0;for(;i+7<e;i+=8)s.words[i]=this.words[i]&t.words[i],s.words[i+1]=this.words[i+1]&t.words[i+1],s.words[i+2]=this.words[i+2]&t.words[i+2],s.words[i+3]=this.words[i+3]&t.words[i+3],s.words[i+4]=this.words[i+4]&t.words[i+4],s.words[i+5]=this.words[i+5]&t.words[i+5],s.words[i+6]=this.words[i+6]&t.words[i+6],s.words[i+7]=this.words[i+7]&t.words[i+7];for(;i<e;++i)s.words[i]=this.words[i]&t.words[i];return s};k.prototype.equals=function(t){let s=Math.min(this.words.length,t.words.length);for(let e=0;e<s;++e)if(this.words[e]!=t.words[e])return!1;if(this.words.length<t.words.length){let e=t.words.length;for(let i=this.words.length;i<e;++i)if(t.words[i]!=0)return!1}else if(t.words.length<this.words.length){let e=this.words.length;for(let i=t.words.length;i<e;++i)if(this.words[i]!=0)return!1}return!0};k.prototype.difference=function(t){let s=Math.min(this.words.length,t.words.length),e=0;for(;e+7<s;e+=8)this.words[e]&=~t.words[e],this.words[e+1]&=~t.words[e+1],this.words[e+2]&=~t.words[e+2],this.words[e+3]&=~t.words[e+3],this.words[e+4]&=~t.words[e+4],this.words[e+5]&=~t.words[e+5],this.words[e+6]&=~t.words[e+6],this.words[e+7]&=~t.words[e+7];for(;e<s;++e)this.words[e]&=~t.words[e];return this};k.prototype.new_difference=function(t){return this.clone().difference(t)};k.prototype.difference2=function(t){let s=Math.min(this.words.length,t.words.length),e=0;for(;e+7<s;e+=8)t.words[e]=this.words[e]&~t.words[e],t.words[e+1]=this.words[e+1]&~t.words[e+1],t.words[e+2]=this.words[e+2]&~t.words[e+2],t.words[e+3]=this.words[e+3]&~t.words[e+3],t.words[e+4]=this.words[e+4]&~t.words[e+4],t.words[e+5]=this.words[e+5]&~t.words[e+5],t.words[e+6]=this.words[e+6]&~t.words[e+6],t.words[e+7]=this.words[e+7]&~t.words[e+7];for(;e<s;++e)t.words[e]=this.words[e]&~t.words[e];for(e=this.words.length-1;e>=s;--e)t.words[e]=this.words[e];return t.words.length=this.words.length,t};k.prototype.difference_size=function(t){let s=Math.min(this.words.length,t.words.length),e=0,i=0;for(;i<s;++i)e+=this.hammingWeight(this.words[i]&~t.words[i]);let n=this.words.length;for(;i<n;++i)e+=this.hammingWeight(this.words[i]);return e};k.prototype.change=function(t){let s=Math.min(this.words.length,t.words.length),e=0;for(;e+7<s;e+=8)this.words[e]^=t.words[e],this.words[e+1]^=t.words[e+1],this.words[e+2]^=t.words[e+2],this.words[e+3]^=t.words[e+3],this.words[e+4]^=t.words[e+4],this.words[e+5]^=t.words[e+5],this.words[e+6]^=t.words[e+6],this.words[e+7]^=t.words[e+7];for(;e<s;++e)this.words[e]^=t.words[e];for(e=t.words.length-1;e>=s;--e)this.words[e]=t.words[e];return this};k.prototype.new_change=function(t){let s=Object.create(k.prototype),e=Math.max(this.words.length,t.words.length);s.words=new Array(e);let i=Math.min(this.words.length,t.words.length),n=0;for(;n+7<i;n+=8)s.words[n]=this.words[n]^t.words[n],s.words[n+1]=this.words[n+1]^t.words[n+1],s.words[n+2]=this.words[n+2]^t.words[n+2],s.words[n+3]=this.words[n+3]^t.words[n+3],s.words[n+4]=this.words[n+4]^t.words[n+4],s.words[n+5]=this.words[n+5]^t.words[n+5],s.words[n+6]=this.words[n+6]^t.words[n+6],s.words[n+7]=this.words[n+7]^t.words[n+7];for(;n<i;++n)s.words[n]=this.words[n]^t.words[n];let c=this.words.length;for(n=i;n<c;++n)s.words[n]=this.words[n];let f=t.words.length;for(n=i;n<f;++n)s.words[n]=t.words[n];return s};k.prototype.change_size=function(t){let s=Math.min(this.words.length,t.words.length),e=0,i=0;for(;i<s;++i)e+=this.hammingWeight(this.words[i]^t.words[i]);let n=this.words.length>t.words.length?this:t,c=n.words.length;for(;i<c;++i)e+=this.hammingWeight(n.words[i]);return e};k.prototype.toString=function(){return"{"+this.array().join(",")+"}"};k.prototype.union=function(t){let s=Math.min(this.words.length,t.words.length),e=0;for(;e+7<s;e+=8)this.words[e]|=t.words[e],this.words[e+1]|=t.words[e+1],this.words[e+2]|=t.words[e+2],this.words[e+3]|=t.words[e+3],this.words[e+4]|=t.words[e+4],this.words[e+5]|=t.words[e+5],this.words[e+6]|=t.words[e+6],this.words[e+7]|=t.words[e+7];for(;e<s;++e)this.words[e]|=t.words[e];if(this.words.length<t.words.length){this.resize((t.words.length<<5)-1);let i=t.words.length;for(let n=s;n<i;++n)this.words[n]=t.words[n]}return this};k.prototype.new_union=function(t){let s=Object.create(k.prototype),e=Math.max(this.words.length,t.words.length);s.words=new Array(e);let i=Math.min(this.words.length,t.words.length),n=0;for(;n+7<i;n+=8)s.words[n]=this.words[n]|t.words[n],s.words[n+1]=this.words[n+1]|t.words[n+1],s.words[n+2]=this.words[n+2]|t.words[n+2],s.words[n+3]=this.words[n+3]|t.words[n+3],s.words[n+4]=this.words[n+4]|t.words[n+4],s.words[n+5]=this.words[n+5]|t.words[n+5],s.words[n+6]=this.words[n+6]|t.words[n+6],s.words[n+7]=this.words[n+7]|t.words[n+7];for(;n<i;++n)s.words[n]=this.words[n]|t.words[n];let c=this.words.length;for(n=i;n<c;++n)s.words[n]=this.words[n];let f=t.words.length;for(n=i;n<f;++n)s.words[n]=t.words[n];return s};k.prototype.union_size=function(t){let s=Math.min(this.words.length,t.words.length),e=0;for(let i=0;i<s;++i)e+=this.hammingWeight(this.words[i]|t.words[i]);if(this.words.length<t.words.length){let i=t.words.length;for(let n=this.words.length;n<i;++n)e+=this.hammingWeight(t.words[n]|0)}else{let i=this.words.length;for(let n=t.words.length;n<i;++n)e+=this.hammingWeight(this.words[n]|0)}return e};vr.exports=k});var Er=pr((ul,Sr)=>{"use strict";function Rc(t,s){function e(){this.constructor=t}e.prototype=s.prototype,t.prototype=new e}function re(t,s,e,i){this.message=t,this.expected=s,this.found=e,this.location=i,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,re)}Rc(re,Error);re.buildMessage=function(t,s){var e={literal:function(g){return'"'+n(g.text)+'"'},class:function(g){var w="",v;for(v=0;v<g.parts.length;v++)w+=g.parts[v]instanceof Array?c(g.parts[v][0])+"-"+c(g.parts[v][1]):c(g.parts[v]);return"["+(g.inverted?"^":"")+w+"]"},any:function(g){return"any character"},end:function(g){return"end of input"},other:function(g){return g.description}};function i(g){return g.charCodeAt(0).toString(16).toUpperCase()}function n(g){return g.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(w){return"\\x0"+i(w)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(w){return"\\x"+i(w)})}function c(g){return g.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(w){return"\\x0"+i(w)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(w){return"\\x"+i(w)})}function f(g){return e[g.type](g)}function h(g){var w=new Array(g.length),v,E;for(v=0;v<g.length;v++)w[v]=f(g[v]);if(w.sort(),w.length>0){for(v=1,E=1;v<w.length;v++)w[v-1]!==w[v]&&(w[E]=w[v],E++);w.length=E}switch(w.length){case 1:return w[0];case 2:return w[0]+" or "+w[1];default:return w.slice(0,-1).join(", ")+", or "+w[w.length-1]}}function x(g){return g?'"'+n(g)+'"':"end of input"}return"Expected "+h(t)+" but "+x(s)+" found."};function Mc(t,s){s=s!==void 0?s:{};var e={},i={Program:Ws},n=Ws,c=function(r){return P.mkProgram(r,D())},f=function(r,o){return Dt(r,o,1)},h=function(r){return r},x=function(r,o){return P.mkAsmLine(r,null,o,D())},g=function(r,o){return P.mkAsmLine(r,o,null,D())},w=function(r){return P.mkAsmLine(r,null,null,D())},v=function(r){return P.mkAsmLine(null,r,null,D())},E=function(r){return P.mkAsmLine(null,r,null,D())},A=function(){return P.mkAsmLine(null,null,null,D())},T=function(r){return r},se=function(r){return r},Pn=W("directive"),Dn=function(r,o){let l=r=="byte"?P.DataSize.Byte:P.DataSize.Word;return P.mkData(l,o,D())},In=function(r,o){return P.mkFill(r,o,D())},Fn=function(r,o,l,u){let d=[r,...l.map(B=>B.condition)],b=[o,...l.map(B=>B.trueBranch)],O=d.map((B,ee)=>[B,b[ee]]);return P.mkIfElse(O,u,D())},hs="in",On=S("in",!1),Rn=function(r,o,l){return P.mkFor(r,o,l,D())},Mn=function(r,o){return P.mkLet(r,o,D())},jn=function(r){return P.mkError(r,D())},Bn=function(r){return P.mkAlign(r,D())},Un=function(r,o){return{condition:r,trueBranch:o}},Tn=function(r){return r},Wn=function(r,o,l){return P.mkInsn(r,o,l,D())},Vn=function(r,o){return P.mkInsn(r,o,null,D())},zn=function(r){return P.mkInsn(r,null,null,D())},Ze=function(r,o){return o.reduce(function(l,u){return P.mkBinaryOp(u[0],l,u[1],D())},r)},Nn=function(r,o){return P.mkCallFunc(r,o,D())},qn=function(r){return r},Gn=/^[a-zA-Z_]/,Hn=K([["a","z"],["A","Z"],"_"],!1,!1),Xn=/^[a-zA-Z_0-9]/,Zn=K([["a","z"],["A","Z"],"_",["0","9"]],!1,!1),gs=/^[0-9a-f]/i,ms=K([["0","9"],["a","f"]],!1,!0),ws=/^[0-1]/,xs=K([["0","1"]],!1,!1),Qn=/^[+\-]/,Jn=K(["+","-"],!1,!1),ys=/^[0-9]/,bs=K([["0","9"]],!1,!1),Yn="a",Kn=S("a",!0),ei="b",ti=S("b",!0),si="c",ri=S("c",!0),ni="d",ii=S("d",!0),oi="g",ai=S("g",!0),ci="h",li=S("h",!0),ui="j",fi=S("j",!0),di="m",pi=S("m",!0),hi="o",gi=S("o",!0),mi="p",wi=S("p",!0),xi="r",yi=S("r",!0),bi="s",vi=S("s",!0),$i="x",Si=S("x",!0),Ei="y",Ai=S("y",!0),Ci="0",Li=S("0",!1),ki="1",_i=S("1",!1),Pi="2",Di=S("2",!1),Ii=",",Fi=S(",",!1),R=function(r){return r},Oi="/",Ri=S("/",!1),Mi="=",ji=S("=",!1),Bi="%",Ui=S("%",!1),Ti="<",Wi=S("<",!1),vs=/^[=]/,$s=K(["="],!1,!1),Vi=">",zi=S(">",!1),Ss="<=",Ni=S("<=",!1),Es=">=",qi=S(">=",!1),As="==",Gi=S("==",!1),Cs="!=",Hi=S("!=",!1),Xi="(",Zi=S("(",!1),Qi=")",Ji=S(")",!1),Yi="{",Ki=S("{",!1),eo="}",to=S("}",!1),so="-",ro=S("-",!1),no="+",io=S("+",!1),oo="\xA7",ao=S("\xA7",!1),co="*",lo=S("*",!1),Ls="!align",uo=S("!align",!1),ks="!byte",fo=S("!byte",!1),po=function(){return"byte"},_s="!word",ho=S("!word",!1),go=function(){return"word"},Ps="!for",mo=S("!for",!1),Ds="!let",wo=S("!let",!1),Is="!if",xo=S("!if",!1),Fs="else",yo=S("else",!1),Os="elif",bo=S("elif",!1),Rs="!error",vo=S("!error",!1),Ms="!fill",$o=S("!fill",!1),So=function(r){return parseInt(r,2)},Eo=function(r){return parseInt(r,16)},Ao=function(r){return parseInt(r)},Se='"',Ee=S('"',!1),Co=function(r){return r.join("")},Lo=function(r){return P.mkLiteral(r.join(""),D())},mt=wa(),ko=function(r){return r},_o=function(){return ga()},Po=function(r){return r},js=W("whitespace"),Do="	",Io=S("	",!1),Fo="\v",Oo=S("\v",!1),Ro="\f",Mo=S("\f",!1),jo=" ",Bo=S(" ",!1),Uo="\xA0",To=S("\xA0",!1),Wo="\uFEFF",Vo=S("\uFEFF",!1),zo=W("end of line"),No=/^[\n\r]/,qo=K([`
`,"\r"],!1,!1),Go=W("comment"),Ho=";",Xo=S(";",!1),Zo=W("label"),Qo=":",Jo=S(":",!1),Yo=function(r){return P.mkLabel(r,D())},Ko=W("ORG"),ea=function(r){return P.mkSetPC(r,D())},ta=W("mnemonic"),sa=function(r){return r},ra=W("literal"),na=function(r){return P.mkLiteral(r,"b",D())},ia=function(r){return P.mkLiteral(r,"h",D())},oa=function(r){return P.mkLiteral(r,"d",D())},aa=function(r){return P.mkLiteral(r,"s",D())},Bs=W("identifier"),H="::",Ae=S("::",!1),ca=function(r,o){return P.mkScopeQualifiedIdent(Dt(r,o,1),!1,D())},la=function(r,o){return P.mkScopeQualifiedIdent(Dt(r,o,1),!0,D())},ua=function(r){return P.mkIdent(r,D())},fa=W("register"),da=function(r){return P.mkRegister(r.toLowerCase(),D())},pa=W("current-pc"),ha=function(){return P.mkGetCurPC(D())},a=0,$=0,Qe=[{line:1,column:1}],X=0,wt=[],m=0,Je;if("startRule"in s){if(!(s.startRule in i))throw new Error(`Can't start parsing from rule "`+s.startRule+'".');n=i[s.startRule]}function ga(){return t.substring($,a)}function ma(){return Ce($,a)}function tl(r,o){throw o=o!==void 0?o:Ce($,a),Ts([W(r)],t.substring($,a),o)}function sl(r,o){throw o=o!==void 0?o:Ce($,a),ya(r,o)}function S(r,o){return{type:"literal",text:r,ignoreCase:o}}function K(r,o,l){return{type:"class",parts:r,inverted:o,ignoreCase:l}}function wa(){return{type:"any"}}function xa(){return{type:"end"}}function W(r){return{type:"other",description:r}}function Us(r){var o=Qe[r],l;if(o)return o;for(l=r-1;!Qe[l];)l--;for(o=Qe[l],o={line:o.line,column:o.column};l<r;)t.charCodeAt(l)===10?(o.line++,o.column=1):o.column++,l++;return Qe[r]=o,o}function Ce(r,o){var l=Us(r),u=Us(o);return{start:{offset:r,line:l.line,column:l.column},end:{offset:o,line:u.line,column:u.column}}}function y(r){a<X||(a>X&&(X=a,wt=[]),wt.push(r))}function ya(r,o){return new re(r,null,null,o)}function Ts(r,o,l){return new re(re.buildMessage(r,o),r,o,l)}function Ws(){var r,o;return r=a,o=pe(),o!==e&&($=r,o=c(o)),r=o,r}function pe(){var r,o,l,u,d,b;if(r=a,o=xt(),o!==e){for(l=[],u=a,d=st(),d!==e?(b=xt(),b!==e?(d=[d,b],u=d):(a=u,u=e)):(a=u,u=e);u!==e;)l.push(u),u=a,d=st(),d!==e?(b=xt(),b!==e?(d=[d,b],u=d):(a=u,u=e)):(a=u,u=e);l!==e?($=r,o=f(o,l),r=o):(a=r,r=e)}else a=r,r=e;return r}function xt(){var r,o,l,u;return r=a,o=C(),o!==e?(l=ba(),l!==e?(u=Ja(),u===e&&(u=null),u!==e?($=r,o=h(l),r=o):(a=r,r=e)):(a=r,r=e)):(a=r,r=e),r}function ba(){var r,o,l,u,d;return r=a,o=_t(),o!==e?(l=Le(),l!==e?(u=pe(),u!==e?(d=ke(),d!==e?($=r,o=x(o,u),r=o):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)):(a=r,r=e),r===e&&(r=a,o=_t(),o!==e?(l=Vs(),l!==e?($=r,o=g(o,l),r=o):(a=r,r=e)):(a=r,r=e),r===e&&(r=a,o=_t(),o!==e&&($=r,o=w(o)),r=o,r===e&&(r=a,o=Ya(),o!==e&&($=r,o=v(o)),r=o,r===e&&(r=a,o=Vs(),o!==e&&($=r,o=E(o)),r=o,r===e&&(r=a,o=C(),o!==e&&($=r,o=A()),r=o))))),r}function Vs(){var r,o;return r=a,o=va(),o!==e&&($=r,o=T(o)),r=o,r===e&&(r=a,o=Sa(),o!==e&&($=r,o=se(o)),r=o),r}function va(){var r,o,l,u,d,b,O,B,ee,Q;if(m++,r=a,o=Ma(),o===e&&(o=ja()),o!==e?(l=Ns(),l!==e?($=r,o=Dn(o,l),r=o):(a=r,r=e)):(a=r,r=e),r===e&&(r=a,o=Na(),o!==e?(l=j(),l!==e?(u=Ye(),u!==e?(d=j(),d!==e?($=r,o=In(l,d),r=o):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)):(a=r,r=e),r===e)){if(r=a,o=Ta(),o!==e)if(l=Ke(),l!==e)if(u=j(),u!==e)if(d=et(),d!==e)if(b=Le(),b!==e)if(O=pe(),O!==e)if(B=ke(),B!==e){for(ee=[],Q=zs();Q!==e;)ee.push(Q),Q=zs();ee!==e?(Q=$a(),Q===e&&(Q=null),Q!==e?($=r,o=Fn(u,O,ee,Q),r=o):(a=r,r=e)):(a=r,r=e)}else a=r,r=e;else a=r,r=e;else a=r,r=e;else a=r,r=e;else a=r,r=e;else a=r,r=e;else a=r,r=e;r===e&&(r=a,o=Ba(),o!==e?(l=dr(),l!==e?(t.substr(a,2)===hs?(u=hs,a+=2):(u=e,m===0&&y(On)),u!==e?(d=C(),d!==e?(b=j(),b!==e?(O=Le(),O!==e?(B=pe(),B!==e?(ee=ke(),ee!==e?($=r,o=Rn(l,b,B),r=o):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)):(a=r,r=e),r===e&&(r=a,o=Ua(),o!==e?(l=dr(),l!==e?(u=Oa(),u!==e?(d=j(),d!==e?($=r,o=Mn(l,d),r=o):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)):(a=r,r=e),r===e&&(r=a,o=za(),o!==e?(l=Za(),l!==e?($=r,o=jn(l),r=o):(a=r,r=e)):(a=r,r=e),r===e&&(r=a,o=Ra(),o!==e?(l=j(),l!==e?($=r,o=Bn(l),r=o):(a=r,r=e)):(a=r,r=e)))))}return m--,r===e&&(o=e,m===0&&y(Pn)),r}function zs(){var r,o,l,u,d,b,O,B;return r=a,o=Va(),o!==e?(l=Ke(),l!==e?(u=j(),u!==e?(d=et(),d!==e?(b=Le(),b!==e?(O=pe(),O!==e?(B=ke(),B!==e?($=r,o=Un(u,O),r=o):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)):(a=r,r=e),r}function $a(){var r,o,l,u,d;return r=a,o=Wa(),o!==e?(l=Le(),l!==e?(u=pe(),u!==e?(d=ke(),d!==e?($=r,o=Tn(u),r=o):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)):(a=r,r=e),r}function Ns(){var r,o,l,u,d,b;if(r=a,o=j(),o!==e){for(l=[],u=a,d=Ye(),d!==e?(b=j(),b!==e?(d=[d,b],u=d):(a=u,u=e)):(a=u,u=e);u!==e;)l.push(u),u=a,d=Ye(),d!==e?(b=j(),b!==e?(d=[d,b],u=d):(a=u,u=e)):(a=u,u=e);l!==e?($=r,o=f(o,l),r=o):(a=r,r=e)}else a=r,r=e;return r}function Sa(){var r,o,l,u,d;return r=a,o=Pt(),o!==e?(l=j(),l!==e?(u=Ye(),u!==e?(d=j(),d!==e?($=r,o=Wn(o,l,d),r=o):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)):(a=r,r=e),r===e&&(r=a,o=Pt(),o!==e?(l=j(),l!==e?($=r,o=Vn(o,l),r=o):(a=r,r=e)):(a=r,r=e),r===e&&(r=a,o=Pt(),o!==e&&($=r,o=zn(o)),r=o)),r}function yt(){var r,o,l,u,d,b;if(r=a,o=$t(),o!==e){for(l=[],u=a,d=kt(),d===e&&(d=Ks(),d===e&&(d=er())),d!==e?(b=$t(),b!==e?(d=[d,b],u=d):(a=u,u=e)):(a=u,u=e);u!==e;)l.push(u),u=a,d=kt(),d===e&&(d=Ks(),d===e&&(d=er())),d!==e?(b=$t(),b!==e?(d=[d,b],u=d):(a=u,u=e)):(a=u,u=e);l!==e?($=r,o=Ze(o,l),r=o):(a=r,r=e)}else a=r,r=e;return r===e&&(r=St()),r}function bt(){var r,o,l,u,d,b;if(r=a,o=yt(),o!==e){for(l=[],u=a,d=cr(),d===e&&(d=ar(),d===e&&(d=lr())),d!==e?(b=yt(),b!==e?(d=[d,b],u=d):(a=u,u=e)):(a=u,u=e);u!==e;)l.push(u),u=a,d=cr(),d===e&&(d=ar(),d===e&&(d=lr())),d!==e?(b=yt(),b!==e?(d=[d,b],u=d):(a=u,u=e)):(a=u,u=e);l!==e?($=r,o=Ze(o,l),r=o):(a=r,r=e)}else a=r,r=e;return r}function vt(){var r,o,l,u,d,b;if(r=a,o=bt(),o!==e){for(l=[],u=a,d=rr(),d===e&&(d=nr(),d===e&&(d=tr(),d===e&&(d=sr()))),d!==e?(b=bt(),b!==e?(d=[d,b],u=d):(a=u,u=e)):(a=u,u=e);u!==e;)l.push(u),u=a,d=rr(),d===e&&(d=nr(),d===e&&(d=tr(),d===e&&(d=sr()))),d!==e?(b=bt(),b!==e?(d=[d,b],u=d):(a=u,u=e)):(a=u,u=e);l!==e?($=r,o=Ze(o,l),r=o):(a=r,r=e)}else a=r,r=e;return r}function j(){var r,o,l,u,d,b;if(r=a,o=vt(),o!==e){for(l=[],u=a,d=ir(),d===e&&(d=or()),d!==e?(b=vt(),b!==e?(d=[d,b],u=d):(a=u,u=e)):(a=u,u=e);u!==e;)l.push(u),u=a,d=ir(),d===e&&(d=or()),d!==e?(b=vt(),b!==e?(d=[d,b],u=d):(a=u,u=e)):(a=u,u=e);l!==e?($=r,o=Ze(o,l),r=o):(a=r,r=e)}else a=r,r=e;return r}function $t(){var r;return r=Ea(),r===e&&(r=St()),r}function Ea(){var r,o,l,u,d;return r=a,o=St(),o!==e?(l=Ke(),l!==e?(u=Ns(),u===e&&(u=null),u!==e?(d=et(),d!==e?($=r,o=Nn(o,u),r=o):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)):(a=r,r=e),r}function St(){var r,o,l,u;return r=fr(),r===e&&(r=ec(),r===e&&(r=Ka(),r===e&&(r=tc(),r===e&&(r=a,o=Ke(),o!==e?(l=j(),l!==e?(u=et(),u!==e?($=r,o=qn(l),r=o):(a=r,r=e)):(a=r,r=e)):(a=r,r=e))))),r}function Et(){var r;return Gn.test(t.charAt(a))?(r=t.charAt(a),a++):(r=e,m===0&&y(Hn)),r}function qs(){var r;return Xn.test(t.charAt(a))?(r=t.charAt(a),a++):(r=e,m===0&&y(Zn)),r}function Aa(){var r,o;if(r=[],gs.test(t.charAt(a))?(o=t.charAt(a),a++):(o=e,m===0&&y(ms)),o!==e)for(;o!==e;)r.push(o),gs.test(t.charAt(a))?(o=t.charAt(a),a++):(o=e,m===0&&y(ms));else r=e;return r}function Ca(){var r,o;if(r=[],ws.test(t.charAt(a))?(o=t.charAt(a),a++):(o=e,m===0&&y(xs)),o!==e)for(;o!==e;)r.push(o),ws.test(t.charAt(a))?(o=t.charAt(a),a++):(o=e,m===0&&y(xs));else r=e;return r}function La(){var r,o,l,u;if(r=a,Qn.test(t.charAt(a))?(o=t.charAt(a),a++):(o=e,m===0&&y(Jn)),o===e&&(o=null),o!==e){if(l=[],ys.test(t.charAt(a))?(u=t.charAt(a),a++):(u=e,m===0&&y(bs)),u!==e)for(;u!==e;)l.push(u),ys.test(t.charAt(a))?(u=t.charAt(a),a++):(u=e,m===0&&y(bs));else l=e;l!==e?(o=[o,l],r=o):(a=r,r=e)}else a=r,r=e;return r}function Gs(){var r;return t.substr(a,1).toLowerCase()===Yn?(r=t.charAt(a),a++):(r=e,m===0&&y(Kn)),r}function Hs(){var r;return t.substr(a,1).toLowerCase()===ei?(r=t.charAt(a),a++):(r=e,m===0&&y(ti)),r}function Xs(){var r;return t.substr(a,1).toLowerCase()===si?(r=t.charAt(a),a++):(r=e,m===0&&y(ri)),r}function Zs(){var r;return t.substr(a,1).toLowerCase()===ni?(r=t.charAt(a),a++):(r=e,m===0&&y(ii)),r}function ka(){var r;return t.substr(a,1).toLowerCase()===oi?(r=t.charAt(a),a++):(r=e,m===0&&y(ai)),r}function rl(){var r;return t.substr(a,1).toLowerCase()===ci?(r=t.charAt(a),a++):(r=e,m===0&&y(li)),r}function At(){var r;return t.substr(a,1).toLowerCase()===ui?(r=t.charAt(a),a++):(r=e,m===0&&y(fi)),r}function Ct(){var r;return t.substr(a,1).toLowerCase()===di?(r=t.charAt(a),a++):(r=e,m===0&&y(pi)),r}function _a(){var r;return t.substr(a,1).toLowerCase()===hi?(r=t.charAt(a),a++):(r=e,m===0&&y(gi)),r}function Pa(){var r;return t.substr(a,1).toLowerCase()===mi?(r=t.charAt(a),a++):(r=e,m===0&&y(wi)),r}function Da(){var r;return t.substr(a,1).toLowerCase()===xi?(r=t.charAt(a),a++):(r=e,m===0&&y(yi)),r}function Ia(){var r;return t.substr(a,1).toLowerCase()===bi?(r=t.charAt(a),a++):(r=e,m===0&&y(vi)),r}function Lt(){var r;return t.substr(a,1).toLowerCase()===$i?(r=t.charAt(a),a++):(r=e,m===0&&y(Si)),r}function Qs(){var r;return t.substr(a,1).toLowerCase()===Ei?(r=t.charAt(a),a++):(r=e,m===0&&y(Ai)),r}function Fa(){var r;return t.charCodeAt(a)===48?(r=Ci,a++):(r=e,m===0&&y(Li)),r}function Js(){var r;return t.charCodeAt(a)===49?(r=ki,a++):(r=e,m===0&&y(_i)),r}function Ys(){var r;return t.charCodeAt(a)===50?(r=Pi,a++):(r=e,m===0&&y(Di)),r}function Ye(){var r,o,l;return r=a,t.charCodeAt(a)===44?(o=Ii,a++):(o=e,m===0&&y(Fi)),o!==e?(l=C(),l!==e?($=r,o=R(o),r=o):(a=r,r=e)):(a=r,r=e),r}function Ks(){var r,o,l;return r=a,t.charCodeAt(a)===47?(o=Oi,a++):(o=e,m===0&&y(Ri)),o!==e?(l=C(),l!==e?($=r,o=R(o),r=o):(a=r,r=e)):(a=r,r=e),r}function Oa(){var r,o,l;return r=a,t.charCodeAt(a)===61?(o=Mi,a++):(o=e,m===0&&y(ji)),o!==e?(l=C(),l!==e?($=r,o=R(o),r=o):(a=r,r=e)):(a=r,r=e),r}function er(){var r,o,l;return r=a,t.charCodeAt(a)===37?(o=Bi,a++):(o=e,m===0&&y(Ui)),o!==e?(l=C(),l!==e?($=r,o=R(o),r=o):(a=r,r=e)):(a=r,r=e),r}function tr(){var r,o,l,u;return r=a,t.charCodeAt(a)===60?(o=Ti,a++):(o=e,m===0&&y(Wi)),o!==e?(l=a,m++,vs.test(t.charAt(a))?(u=t.charAt(a),a++):(u=e,m===0&&y($s)),m--,u===e?l=void 0:(a=l,l=e),l!==e?(u=C(),u!==e?($=r,o=R(o),r=o):(a=r,r=e)):(a=r,r=e)):(a=r,r=e),r}function sr(){var r,o,l,u;return r=a,t.charCodeAt(a)===62?(o=Vi,a++):(o=e,m===0&&y(zi)),o!==e?(l=a,m++,vs.test(t.charAt(a))?(u=t.charAt(a),a++):(u=e,m===0&&y($s)),m--,u===e?l=void 0:(a=l,l=e),l!==e?(u=C(),u!==e?($=r,o=R(o),r=o):(a=r,r=e)):(a=r,r=e)):(a=r,r=e),r}function rr(){var r,o,l;return r=a,t.substr(a,2)===Ss?(o=Ss,a+=2):(o=e,m===0&&y(Ni)),o!==e?(l=C(),l!==e?($=r,o=R(o),r=o):(a=r,r=e)):(a=r,r=e),r}function nr(){var r,o,l;return r=a,t.substr(a,2)===Es?(o=Es,a+=2):(o=e,m===0&&y(qi)),o!==e?(l=C(),l!==e?($=r,o=R(o),r=o):(a=r,r=e)):(a=r,r=e),r}function ir(){var r,o,l;return r=a,t.substr(a,2)===As?(o=As,a+=2):(o=e,m===0&&y(Gi)),o!==e?(l=C(),l!==e?($=r,o=R(o),r=o):(a=r,r=e)):(a=r,r=e),r}function or(){var r,o,l;return r=a,t.substr(a,2)===Cs?(o=Cs,a+=2):(o=e,m===0&&y(Hi)),o!==e?(l=C(),l!==e?($=r,o=R(o),r=o):(a=r,r=e)):(a=r,r=e),r}function Ke(){var r,o,l;return r=a,t.charCodeAt(a)===40?(o=Xi,a++):(o=e,m===0&&y(Zi)),o!==e?(l=C(),l!==e?($=r,o=R(o),r=o):(a=r,r=e)):(a=r,r=e),r}function et(){var r,o,l;return r=a,t.charCodeAt(a)===41?(o=Qi,a++):(o=e,m===0&&y(Ji)),o!==e?(l=C(),l!==e?($=r,o=R(o),r=o):(a=r,r=e)):(a=r,r=e),r}function Le(){var r,o,l;return r=a,t.charCodeAt(a)===123?(o=Yi,a++):(o=e,m===0&&y(Ki)),o!==e?(l=C(),l!==e?($=r,o=R(o),r=o):(a=r,r=e)):(a=r,r=e),r}function ke(){var r,o,l;return r=a,t.charCodeAt(a)===125?(o=eo,a++):(o=e,m===0&&y(to)),o!==e?(l=C(),l!==e?($=r,o=R(o),r=o):(a=r,r=e)):(a=r,r=e),r}function ar(){var r,o,l;return r=a,t.charCodeAt(a)===45?(o=so,a++):(o=e,m===0&&y(ro)),o!==e?(l=C(),l!==e?($=r,o=R(o),r=o):(a=r,r=e)):(a=r,r=e),r}function cr(){var r,o,l;return r=a,t.charCodeAt(a)===43?(o=no,a++):(o=e,m===0&&y(io)),o!==e?(l=C(),l!==e?($=r,o=R(o),r=o):(a=r,r=e)):(a=r,r=e),r}function lr(){var r,o,l;return r=a,t.charCodeAt(a)===167?(o=oo,a++):(o=e,m===0&&y(ao)),o!==e?(l=C(),l!==e?($=r,o=R(o),r=o):(a=r,r=e)):(a=r,r=e),r}function kt(){var r,o,l;return r=a,t.charCodeAt(a)===42?(o=co,a++):(o=e,m===0&&y(lo)),o!==e?(l=C(),l!==e?($=r,o=R(o),r=o):(a=r,r=e)):(a=r,r=e),r}function Ra(){var r,o,l;return r=a,t.substr(a,6)===Ls?(o=Ls,a+=6):(o=e,m===0&&y(uo)),o!==e?(l=C(),l!==e?(o=[o,l],r=o):(a=r,r=e)):(a=r,r=e),r}function Ma(){var r,o,l;return r=a,t.substr(a,5)===ks?(o=ks,a+=5):(o=e,m===0&&y(fo)),o!==e?(l=C(),l!==e?($=r,o=po(),r=o):(a=r,r=e)):(a=r,r=e),r}function ja(){var r,o,l;return r=a,t.substr(a,5)===_s?(o=_s,a+=5):(o=e,m===0&&y(ho)),o!==e?(l=C(),l!==e?($=r,o=go(),r=o):(a=r,r=e)):(a=r,r=e),r}function Ba(){var r,o,l;return r=a,t.substr(a,4)===Ps?(o=Ps,a+=4):(o=e,m===0&&y(mo)),o!==e?(l=C(),l!==e?(o=[o,l],r=o):(a=r,r=e)):(a=r,r=e),r}function Ua(){var r,o,l;return r=a,t.substr(a,4)===Ds?(o=Ds,a+=4):(o=e,m===0&&y(wo)),o!==e?(l=C(),l!==e?(o=[o,l],r=o):(a=r,r=e)):(a=r,r=e),r}function Ta(){var r,o,l;return r=a,t.substr(a,3)===Is?(o=Is,a+=3):(o=e,m===0&&y(xo)),o!==e?(l=C(),l!==e?(o=[o,l],r=o):(a=r,r=e)):(a=r,r=e),r}function Wa(){var r,o,l;return r=a,t.substr(a,4)===Fs?(o=Fs,a+=4):(o=e,m===0&&y(yo)),o!==e?(l=C(),l!==e?(o=[o,l],r=o):(a=r,r=e)):(a=r,r=e),r}function Va(){var r,o,l;return r=a,t.substr(a,4)===Os?(o=Os,a+=4):(o=e,m===0&&y(bo)),o!==e?(l=C(),l!==e?(o=[o,l],r=o):(a=r,r=e)):(a=r,r=e),r}function za(){var r,o,l;return r=a,t.substr(a,6)===Rs?(o=Rs,a+=6):(o=e,m===0&&y(vo)),o!==e?(l=C(),l!==e?(o=[o,l],r=o):(a=r,r=e)):(a=r,r=e),r}function Na(){var r,o,l;return r=a,t.substr(a,5)===Ms?(o=Ms,a+=5):(o=e,m===0&&y($o)),o!==e?(l=C(),l!==e?(o=[o,l],r=o):(a=r,r=e)):(a=r,r=e),r}function qa(){var r,o,l;return r=a,o=a,l=Ca(),l!==e?o=t.substring(o,a):o=l,o!==e?(l=Hs(),l!==e?($=r,o=So(o),r=o):(a=r,r=e)):(a=r,r=e),r}function Ga(){var r,o,l,u,d;return r=a,o=Fa(),o!==e?(l=Lt(),l!==e?(u=a,d=Aa(),d!==e?u=t.substring(u,a):u=d,u!==e?($=r,o=Eo(u),r=o):(a=r,r=e)):(a=r,r=e)):(a=r,r=e),r}function Ha(){var r,o,l;return r=a,o=a,l=La(),l!==e?o=t.substring(o,a):o=l,o!==e?(l=Zs(),l===e&&(l=null),l!==e?($=r,o=Ao(o),r=o):(a=r,r=e)):(a=r,r=e),r}function Xa(){var r,o,l,u;if(r=a,t.charCodeAt(a)===34?(o=Se,a++):(o=e,m===0&&y(Ee)),o!==e){for(l=[],u=tt();u!==e;)l.push(u),u=tt();l!==e?(t.charCodeAt(a)===34?(u=Se,a++):(u=e,m===0&&y(Ee)),u!==e?($=r,o=Co(l),r=o):(a=r,r=e)):(a=r,r=e)}else a=r,r=e;return r}function Za(){var r,o,l,u,d;if(r=a,t.charCodeAt(a)===34?(o=Se,a++):(o=e,m===0&&y(Ee)),o!==e){for(l=[],u=tt();u!==e;)l.push(u),u=tt();l!==e?(t.charCodeAt(a)===34?(u=Se,a++):(u=e,m===0&&y(Ee)),u!==e?(d=C(),d!==e?($=r,o=Lo(l),r=o):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)}else a=r,r=e;return r}function tt(){var r,o,l;return r=a,o=a,m++,t.charCodeAt(a)===34?(l=Se,a++):(l=e,m===0&&y(Ee)),m--,l===e?o=void 0:(a=o,o=e),o!==e?(t.length>a?(l=t.charAt(a),a++):(l=e,m===0&&y(mt)),l!==e?($=r,o=ko(l),r=o):(a=r,r=e)):(a=r,r=e),r}function Z(){var r,o,l,u,d;if(r=a,o=a,l=[],u=Et(),u!==e)for(;u!==e;)l.push(u),u=Et();else l=e;if(l!==e){for(u=[],d=qs();d!==e;)u.push(d),d=qs();u!==e?(l=[l,u],o=l):(a=o,o=e)}else a=o,o=e;return o!==e&&($=r,o=_o()),r=o,r}function Qa(){var r,o,l;return r=a,o=Z(),o!==e?(l=C(),l!==e?($=r,o=Po(o),r=o):(a=r,r=e)):(a=r,r=e),r}function C(){var r,o;for(m++,r=[],o=ur();o!==e;)r.push(o),o=ur();return m--,r===e&&(o=e,m===0&&y(js)),r}function ur(){var r,o;return m++,t.charCodeAt(a)===9?(r=Do,a++):(r=e,m===0&&y(Io)),r===e&&(t.charCodeAt(a)===11?(r=Fo,a++):(r=e,m===0&&y(Oo)),r===e&&(t.charCodeAt(a)===12?(r=Ro,a++):(r=e,m===0&&y(Mo)),r===e&&(t.charCodeAt(a)===32?(r=jo,a++):(r=e,m===0&&y(Bo)),r===e&&(t.charCodeAt(a)===160?(r=Uo,a++):(r=e,m===0&&y(To)),r===e&&(t.charCodeAt(a)===65279?(r=Wo,a++):(r=e,m===0&&y(Vo))))))),m--,r===e&&(o=e,m===0&&y(js)),r}function st(){var r,o;return m++,No.test(t.charAt(a))?(r=t.charAt(a),a++):(r=e,m===0&&y(qo)),m--,r===e&&(o=e,m===0&&y(zo)),r}function Ja(){var r,o,l,u,d,b;if(m++,r=a,t.charCodeAt(a)===59?(o=Ho,a++):(o=e,m===0&&y(Xo)),o!==e){for(l=[],u=a,d=a,m++,b=st(),m--,b===e?d=void 0:(a=d,d=e),d!==e?(t.length>a?(b=t.charAt(a),a++):(b=e,m===0&&y(mt)),b!==e?(d=[d,b],u=d):(a=u,u=e)):(a=u,u=e);u!==e;)l.push(u),u=a,d=a,m++,b=st(),m--,b===e?d=void 0:(a=d,d=e),d!==e?(t.length>a?(b=t.charAt(a),a++):(b=e,m===0&&y(mt)),b!==e?(d=[d,b],u=d):(a=u,u=e)):(a=u,u=e);l!==e?(o=[o,l],r=o):(a=r,r=e)}else a=r,r=e;return m--,r===e&&(o=e,m===0&&y(Go)),r}function _t(){var r,o,l,u;return m++,r=a,o=Z(),o!==e?(t.charCodeAt(a)===58?(l=Qo,a++):(l=e,m===0&&y(Jo)),l!==e?(u=C(),u!==e?($=r,o=Yo(o),r=o):(a=r,r=e)):(a=r,r=e)):(a=r,r=e),m--,r===e&&(o=e,m===0&&y(Zo)),r}function Ya(){var r,o,l,u,d,b,O;return m++,r=a,o=_a(),o!==e?(l=Da(),l!==e?(u=ka(),u!==e?(d=C(),d!==e?(b=fr(),b!==e?(O=C(),O!==e?($=r,o=ea(b),r=o):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)):(a=r,r=e)):(a=r,r=e),m--,r===e&&(o=e,m===0&&y(Ko)),r}function Pt(){var r,o,l;return m++,r=a,o=Z(),o!==e?(l=C(),l!==e?($=r,o=sa(o),r=o):(a=r,r=e)):(a=r,r=e),m--,r===e&&(o=e,m===0&&y(ta)),r}function fr(){var r,o,l;return m++,r=a,o=qa(),o!==e?(l=C(),l!==e?($=r,o=na(o),r=o):(a=r,r=e)):(a=r,r=e),r===e&&(r=a,o=Ga(),o!==e?(l=C(),l!==e?($=r,o=ia(o),r=o):(a=r,r=e)):(a=r,r=e),r===e&&(r=a,o=Ha(),o!==e?(l=C(),l!==e?($=r,o=oa(o),r=o):(a=r,r=e)):(a=r,r=e),r===e&&(r=a,o=Xa(),o!==e?(l=C(),l!==e?($=r,o=aa(o),r=o):(a=r,r=e)):(a=r,r=e)))),m--,r===e&&(o=e,m===0&&y(ra)),r}function Ka(){var r,o,l,u,d,b,O;if(m++,r=a,o=Z(),o!==e){for(l=[],u=a,t.substr(a,2)===H?(d=H,a+=2):(d=e,m===0&&y(Ae)),d!==e?(b=Z(),b!==e?(d=[d,b],u=d):(a=u,u=e)):(a=u,u=e);u!==e;)l.push(u),u=a,t.substr(a,2)===H?(d=H,a+=2):(d=e,m===0&&y(Ae)),d!==e?(b=Z(),b!==e?(d=[d,b],u=d):(a=u,u=e)):(a=u,u=e);l!==e?(u=C(),u!==e?($=r,o=ca(o,l),r=o):(a=r,r=e)):(a=r,r=e)}else a=r,r=e;if(r===e)if(r=a,t.substr(a,2)===H?(o=H,a+=2):(o=e,m===0&&y(Ae)),o!==e)if(l=Z(),l!==e){for(u=[],d=a,t.substr(a,2)===H?(b=H,a+=2):(b=e,m===0&&y(Ae)),b!==e?(O=Z(),O!==e?(b=[b,O],d=b):(a=d,d=e)):(a=d,d=e);d!==e;)u.push(d),d=a,t.substr(a,2)===H?(b=H,a+=2):(b=e,m===0&&y(Ae)),b!==e?(O=Z(),O!==e?(b=[b,O],d=b):(a=d,d=e)):(a=d,d=e);u!==e?(d=C(),d!==e?($=r,o=la(l,u),r=o):(a=r,r=e)):(a=r,r=e)}else a=r,r=e;else a=r,r=e;return m--,r===e&&(o=e,m===0&&y(Bs)),r}function dr(){var r,o;return m++,r=a,o=Qa(),o!==e&&($=r,o=ua(o)),r=o,m--,r===e&&(o=e,m===0&&y(Bs)),r}function ec(){var r,o,l,u,d;return m++,r=a,o=a,l=a,u=Gs(),u!==e?(d=Ia(),d!==e?(u=[u,d],l=u):(a=l,l=e)):(a=l,l=e),l===e&&(l=Gs(),l===e&&(l=Hs(),l===e&&(l=Xs(),l===e&&(l=Zs(),l===e&&(l=a,u=Ct(),u!==e?(d=Ys(),d!==e?(u=[u,d],l=u):(a=l,l=e)):(a=l,l=e),l===e&&(l=a,u=Ct(),u!==e?(d=Js(),d!==e?(u=[u,d],l=u):(a=l,l=e)):(a=l,l=e),l===e&&(l=Ct(),l===e&&(l=a,u=Pa(),u!==e?(d=Xs(),d!==e?(u=[u,d],l=u):(a=l,l=e)):(a=l,l=e),l===e&&(l=a,u=Lt(),u!==e?(d=Qs(),d!==e?(u=[u,d],l=u):(a=l,l=e)):(a=l,l=e),l===e&&(l=Lt(),l===e&&(l=Qs(),l===e&&(l=a,u=At(),u!==e?(d=Js(),d!==e?(u=[u,d],l=u):(a=l,l=e)):(a=l,l=e),l===e&&(l=a,u=At(),u!==e?(d=Ys(),d!==e?(u=[u,d],l=u):(a=l,l=e)):(a=l,l=e),l===e&&(l=At())))))))))))))),l!==e?o=t.substring(o,a):o=l,o!==e?(l=a,m++,u=Et(),m--,u===e?l=void 0:(a=l,l=e),l!==e?(u=C(),u!==e?($=r,o=da(o),r=o):(a=r,r=e)):(a=r,r=e)):(a=r,r=e),m--,r===e&&(o=e,m===0&&y(fa)),r}function tc(){var r,o;return m++,r=a,o=kt(),o!==e&&($=r,o=ha()),r=o,m--,r===e&&(o=e,m===0&&y(pa)),r}var P=(Rt(),gr(Ot));function sc(r,o){return r.map(function(l){return l[o]})}function Dt(r,o,l){return[r].concat(sc(o,l))}function D(){return{...ma()}}if(Je=n(),Je!==e&&a===t.length)return Je;throw Je!==e&&a<t.length&&y(xa()),Ts(wt,X<t.length?t.charAt(X):null,X<t.length?Ce(X,X+1):Ce(X,X))}Sr.exports={SyntaxError:re,parse:Mc}});var el={};hr(el,{RCASMWorker:()=>gt,create:()=>Kc});var te={a:0,d:1},cc={a:0,d:1},lc={a:0,b:1},uc={m:0,j:1},Ft={a:0,b:1,c:2,d:3,m1:4,m2:5,x:6,y:7},fc={xy:0,pc:1},dc={m:0,xy:1,j:2,as:3},pc={xy:1},mr={a:0,b:1,c:2,d:3},L;(function(t){t[t.Direct=0]="Direct",t[t.Alu=1]="Alu",t[t.Clear=2]="Clear",t[t.Goto=3]="Goto",t[t.LodSw=4]="LodSw",t[t.LitOpc=5]="LitOpc",t[t.Move=6]="Move",t[t.Set=7]="Set",t[t.LoadStore=8]="LoadStore"})(L||(L={}));var wr={add:{mt:L.Alu,ops:[{op:129,p1:{cs:te,op:t=>t<<3},p2:null}]},inc:{mt:L.Alu,ops:[{op:130,p1:{cs:te,op:t=>t<<3},p2:null}]},and:{mt:L.Alu,ops:[{op:131,p1:{cs:te,op:t=>t<<3},p2:null}]},orr:{mt:L.Alu,ops:[{op:132,p1:{cs:te,op:t=>t<<3},p2:null}]},eor:{mt:L.Alu,ops:[{op:133,p1:{cs:te,op:t=>t<<3},p2:null}]},cmp:{mt:L.Alu,ops:[{op:133,p1:{cs:te,op:t=>t<<3},p2:null}]},not:{mt:L.Alu,ops:[{op:134,p1:{cs:te,op:t=>t<<3},p2:null}]},rol:{mt:L.Alu,ops:[{op:135,p1:{cs:te,op:t=>t<<3},p2:null}]},mov:{mt:L.Move,ops:[{op:0,p1:{cs:Ft,op:t=>t<<3},p2:{cs:Ft,op:t=>t}},{op:160,p1:{cs:fc,op:t=>t<<2},p2:{cs:dc,op:t=>t}}]},clr:{mt:L.Clear,ops:[{op:0,p1:{cs:Ft,op:t=>t<<3|t},p2:null},{op:160,p1:{cs:pc,op:t=>t},p2:null}]},rts:{mt:L.Direct,ops:[{op:165,p1:null,p2:null}]},ldr:{mt:L.LoadStore,ops:[{op:144,p1:{cs:mr,op:t=>t},p2:null}]},str:{mt:L.LoadStore,ops:[{op:152,p1:{cs:mr,op:t=>t},p2:null}]},ldi:{mt:L.Set,ops:[{op:64,p1:{cs:lc,op:t=>t<<5},p2:{cs:null,op:t=>t&31}},{op:192,p1:{cs:uc,op:t=>t<<5},p2:null}]},hlt:{mt:L.Direct,ops:[{op:174,p1:null,p2:null}]},hlr:{mt:L.Direct,ops:[{op:175,p1:null,p2:null}]},lds:{mt:L.LodSw,ops:[{op:172,p1:{cs:cc,op:t=>t},p2:null}]},ixy:{mt:L.Direct,ops:[{op:176,p1:null,p2:null}]},jmp:{mt:L.Goto,ops:[{op:230,p1:null,p2:null}]},jsr:{mt:L.Goto,ops:[{op:231,p1:null,p2:null}]},bne:{mt:L.Goto,ops:[{op:226,p1:null,p2:null}]},beq:{mt:L.Goto,ops:[{op:228,p1:null,p2:null}]},bcs:{mt:L.Goto,ops:[{op:232,p1:null,p2:null}]},bmi:{mt:L.Goto,ops:[{op:240,p1:null,p2:null}]},blt:{mt:L.Goto,ops:[{op:240,p1:null,p2:null}]},ble:{mt:L.Goto,ops:[{op:244,p1:null,p2:null}]},opc:{mt:L.LitOpc,ops:[{op:0,p1:{cs:null,op:t=>t},p2:null}]}};function U(t){return t.toString(16).padStart(4,"0")}Rt();var he=class{constructor(s,e,i,n){this.start=s,this.end=e,this.inferStart=i,this.id=n,this.blocks=[{start:s,binary:[]}],this.curBlock=this.blocks[0]}setCurrentPC(s){let e;if(this.inferStart&&this.blocks.length===1&&this.blocks[0].binary.length===0)this.start=s;else{let c=this.end!==void 0?`$${U(this.end)}`:"",f=`Segment address range: $${U(this.start)}-${c}`;s<this.start?e=`${f}.  Cannot set program counter to a lower address $${U(s)}.`:this.end!==void 0&&s>this.end?e=`${f}.  Trying to set program counter to $${U(s)} -- it is past segment end ${c}.`:this.blocks.length===1&&this.blocks[0].binary.length===0&&(this.start=s)}let i={start:s,binary:[]},n=this.blocks.push(i);return this.curBlock=this.blocks[n-1],e}empty(){return this.blocks.every(s=>s.binary.length===0)}currentPC(){return this.curBlock.start+this.curBlock.binary.length}emit(s){if(this.currentPC()<this.start||this.end!==void 0&&this.currentPC()>this.end){let e=this.end!==void 0?`$${U(this.end)}`:"",i=this.start!==void 0?`$${U(this.start)}`:"";return`Segment overflow at $${U(this.currentPC())}.  Segment address range: ${i}-${e}`}this.curBlock.binary.push(s)}formatRange(){let s=this.end!==void 0?`$${U(this.end)}`:"";return`${this.start!==void 0?`$${U(this.start)}`:""}-${s}`}overlaps(s){let e=this.start,i=s.start,n=this.end!==void 0?this.end:this.currentPC(),c=s.end!==void 0?s.end:s.currentPC();return e<i?i<=n:c>=e}};function xr(t){let s=[];for(let[e,i]of t){let n=i.blocks.filter(c=>c.binary.length!==0).sort((c,f)=>c.start-f.start);if(n.length!==0){let c=new he(i.start,i.end,i.inferStart,s.length-1);c.blocks=n,c.curBlock=n[n.length-1],s.push([e,c])}}return s}function yr(t){let s=xr(t);if(s.length===0)return{startPC:0,binary:Uint8Array.from([])};let[,e]=s[0],i=e.blocks[0],n=e.blocks[e.blocks.length-1],c=i.start,f=n.start+n.binary.length;for(let x=1;x<s.length;x++){let g=s[x][1],w=g.blocks[0].start,v=g.curBlock.start+g.curBlock.binary.length;c=Math.min(w,c),f=Math.max(v,f)}let h=new Uint8Array(f);for(let[,x]of s)for(let g of x.blocks)for(let w=0;w<g.binary.length;w++)h[g.start+w]=g.binary[w];return{startPC:c,binary:h.slice(c)}}function br(t){return xr(t).sort((e,i)=>e[1].start-i[1].start).map(([e,i])=>{let n=i.blocks.map(c=>({start:c.start,end:c.start+c.binary.length-1}));return{name:e,blocks:n}})}var Oc=$r(),Pe=class{constructor(){this.lineStack=[],this.pcToLocs={},this.insnBitset=new Oc}startLine(s,e,i){let n={lineNo:s.start.line,segmentId:i.id,numBytes:0};this.lineStack.push({loc:n,pc:e,segmentId:i.id})}endLine(s,e){let i=this.lineStack.pop();if(!i)throw new Error("internal compiler error, mismatching start/end lines in debugInfo");let n=s-i.pc;if(n>0&&e.id===i.segmentId){let c={...i.loc,numBytes:n};this.pcToLocs[i.pc]===void 0?this.pcToLocs[i.pc]=[c]:this.pcToLocs[i.pc].push(c)}}markAsInstruction(s,e){for(let i=s;i<e;i++)this.insnBitset.add(i)}info(){let s=this.insnBitset.clone(),e=i=>s.has(i);return{pcToLocs:this.pcToLocs,isInstruction:e}}};var Ar=Er();function G(t){return{value:t,errors:!0,completeFirstPass:!1}}function Y(t,s){return{value:t,errors:!1,completeFirstPass:s}}function V(...t){return t.some(s=>s!==void 0&&s.errors)}function Cr(...t){return t.every(s=>s!==void 0&&s.completeFirstPass)}var jt=class t{constructor(s,e){this.syms=new Map,this.parent=null,this.children=new Map,this.parent=s,this.name=e}newScope(s,e){let i=this.children.get(s);if(i!==void 0)return i;let n=new t(e,s);return this.children.set(s,n),n}findSymbol(s){for(let e=this;e!==null;e=e.parent){let i=e.syms.get(s);if(i!==void 0)return i}}findSymbolPath(s){if(s.length===1)return this.findSymbol(s[0]);let e=this;for(;e.children.get(s[0])===void 0;)if(e=e.parent,e===null)return;for(let i=0;i<s.length-1;i++)if(e=e.children.get(s[i]),e===void 0)return;return e.syms.get(s[s.length-1])}addSymbol(s,e,i){this.syms.set(s,{...e,seen:i})}updateSymbol(s,e,i){for(let n=this;n!==null;n=n.parent)if(n.syms.get(s)!==void 0){n.syms.set(s,{...e,seen:i});return}}},Bt=class{constructor(){this.passCount=0,this.root=new jt(null,""),this.curSymtab=this.root,this.anonScopeCount=0}startPass(s){this.curSymtab=this.root,this.anonScopeCount=0,this.passCount=s}withAnonScope(s,e){let i=`__anon_scope_${this.anonScopeCount}`;this.anonScopeCount++,this.withLabelScope(i,s,e)}withLabelScope(s,e,i){let n=this.curSymtab;this.curSymtab=this.curSymtab.newScope(s,i||n),e(),this.curSymtab=n}findPath(s,e){return e?this.root.findSymbolPath(s):this.curSymtab.findSymbolPath(s)}findQualifiedSym(s,e){return this.findPath(s,e)}symbolSeen(s){let e=this.curSymtab.syms.get(s);return e!==void 0?e.seen===this.passCount:!1}declareLabelSymbol(s,e,i){let{name:n,loc:c}=s,f=this.curSymtab.syms.get(n);if(f===void 0){let x={type:"label",segment:i,data:Y({addr:e,loc:c},!1)};return this.curSymtab.addSymbol(n,x,this.passCount),!1}if(f.type!=="label")throw new Error("ICE: declareLabelSymbol should be called only on labels");if(f.data.value.addr!==e){let x={type:"label",segment:i,data:{...f.data,value:{...f.data.value,addr:e}}};return this.curSymtab.updateSymbol(n,x,this.passCount),!0}return this.curSymtab.updateSymbol(n,f,this.passCount),!1}declareVar(s,e){this.curSymtab.addSymbol(s,{type:"var",data:e},this.passCount)}dumpLabels(s,e){let i={};for(let[g,w]of e)i[w.id]=g;let n=[],c=(g,w)=>{if(g!==void 0){let v=[...g,w.name];n.push({path:v,sym:w})}else n.push({path:[],sym:w})};c(void 0,this.root);let f=[];for(;n.length>0;){let g=n.pop();if(g){for(let[w,v]of g.sym.syms)v.type==="label"&&f.push({path:[...g.path,w],addr:v.data.value.addr,size:0,segmentName:i[v.segment.id]});for(let[,w]of g.sym.children)c(g.path,w)}}let h=f.sort((g,w)=>g.addr-w.addr),x=h.length;if(x>0){for(let w=1;w<x;w++)h[w-1].size=h[w].addr-h[w-1].addr;let g=h[x-1];g.size=s-g.addr}return h.map(({path:g,addr:w,size:v,segmentName:E})=>({name:g.join("::"),addr:w,size:v,segmentName:E}))}};function jc(t){return t===!0||t!=0}function J(t){let s=typeof t;return s==="object"&&t instanceof Array?"array":s}function Mt(t){return`${t.absolute?"::":""}${t.path.join("::")}`}var z=(t,s,e)=>{let i=e(t.value,s.value),n=Cr(t,s);return Y(typeof i=="boolean"?i?1:0:i,n)},Ut=class{constructor(){this.curSegmentName="",this.curSegment=new he(0,0,!1,0),this.pass=0,this.needPass=!1,this.scopes=new Bt,this.segments=[],this.errorList=[],this.warningList=[],this.debugInfo=new Pe,this.errors=()=>this.formatErrors(this.errorList,"error"),this.warnings=()=>this.formatErrors(this.warningList,"warning")}prg(){let{startPC:s,binary:e}=yr(this.segments),i=s&255,n=s>>8&255;return Uint8Array.from([i,n,...e])}anyErrors(){return this.errorList.length!==0}formatErrors(s,e){return[...new Set(s.map(n=>JSON.stringify(n)))].map(n=>{let{loc:c,msg:f}=JSON.parse(n),h=`<unknown>:1:1: ${e}: ${f}`;return c&&(h=`${c.start.line}:${c.start.column}: ${e}: ${f}`),{loc:c,msg:f,formatted:h}})}addError(s,e){this.errorList.push({msg:s,loc:e})}addWarning(s,e){this.warningList.push({msg:s,loc:e})}startPass(s){this.pass=s,this.needPass=!1,this.errorList=[],this.scopes.startPass(s),this.debugInfo=new Pe,this.segments=[];let e=this.newSegment("default",0,void 0,!0);this.setCurrentSegment({type:"segment",data:e},"default")}setCurrentSegment(s,e){this.curSegmentName=e,this.curSegment=s.data}newSegment(s,e,i,n){let c=new he(e,i,n,this.segments.length-1);return this.segments.push([s,c]),c}getPC(){return this.curSegment.currentPC()}evalExprType(s,e,i){let n=this.evalExpr(s),{errors:c,value:f,completeFirstPass:h}=n;return!c&&typeof f!==e?(this.addError(`Expecting ${i} to be '${e}' type, got '${J(f)}'`,s.loc),{errors:!0,completeFirstPass:h,value:f}):n}evalExprToInt(s,e){return this.evalExprType(s,"number",e)}evalExprToString(s,e){return this.evalExprType(s,"string",e)}evalExpr(s){switch(s.type){case"binary":{let e=this.evalExpr(s.left),i=this.evalExpr(s.right);if(V(e,i))return G(0);if(typeof e.value!=typeof i.value)return this.addError(`Binary expression operands are expected to be of the same type.  Got: '${J(e.value)}' (left), '${J(i.value)}' (right)`,s.loc),G(0);if(typeof e.value!="string"&&typeof e.value!="number")return this.addError(`Binary expression operands can only operator on numbers or strings.  Got: '${J(e.value)}'`,s.loc),G(0);if(typeof e.value=="string"){let n=["+","==","<","<=",">",">="];if(n.indexOf(s.op)<0)return this.addError(`'${s.op}' operator is not supported for strings.  Valid operators for strings are: ${n.join(", ")}`,s.loc),G(0)}switch(s.op){case"+":return z(e,i,(n,c)=>n+c);case"-":return z(e,i,(n,c)=>n-c);case"*":return z(e,i,(n,c)=>n*c);case"/":return z(e,i,(n,c)=>n/c);case"%":return z(e,i,(n,c)=>n%c);case"\xA7":return z(e,i,(n,c)=>(n&255)<<8|c&255);case"==":return z(e,i,(n,c)=>n==c);case"!=":return z(e,i,(n,c)=>n!=c);case"<":return z(e,i,(n,c)=>n<c);case"<=":return z(e,i,(n,c)=>n<=c);case">":return z(e,i,(n,c)=>n>c);case">=":return z(e,i,(n,c)=>n>=c);default:throw new Error(`Unhandled binary operator ${s.op}`)}}case"literal":return Y(s.lit,!0);case"register":return this.addError("Unexpected register",s.loc),G(0);case"ident":throw new Error("should not see an ident here -- if you do, it is probably a wrong type node in parser");case"qualified-ident":{let e=this.scopes.findQualifiedSym(s.path,s.absolute);if(e===void 0)return this.pass>=1?(this.addError(`Undefined symbol '${Mt(s)}'`,s.loc),G(0)):(this.needPass=!0,Y(0,!1));switch(e.type){case"label":return{errors:e.data.errors,value:e.data.value.addr,completeFirstPass:e.seen===this.pass};case"var":return e.seen<this.pass&&this.addError(`Undeclared variable '${Mt(s)}'`,s.loc),e.data}break}case"callfunc":{let e=this.evalExpr(s.callee),i=s.args.map(n=>this.evalExpr(n));if(e.errors)return G(0);if(typeof e.value!="function")return this.addError(`Callee must be a function type.  Got '${J(e)}'`,s.loc),G(0);if(V(...i))return G(0);try{let n=e.completeFirstPass&&Cr(...i);return Y(e.value(...i.map(c=>c.value)),n)}catch(n){return s.callee.type=="qualified-ident"?this.addError(`Call to '${Mt(s.callee)}' failed with an error: ${n.message}`,s.loc):(this.addError("Unexpected error calling function",s.loc),this.addError(`Plugin call failed with an error: ${n.message}`,s.loc)),G(0)}break}case"getcurpc":return Y(this.getPC(),!0);default:break}throw new Error(`should be unreachable on ${s.type}`)}emit(s){let e=this.curSegment.emit(s);e!==void 0&&this.addError(e,this.lineLoc)}emit16(s){this.emit(s>>8&255),this.emit(s&255)}assembleNonInstr(s,e){let i=s.ops[0];e.p1&&this.addWarning("Parameter not required",e.p1.loc),e.p2&&this.addWarning("Parameter not required",e.p2.loc),this.emit(i.op)}assembleAluInstr(s,e){let i=s.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let n=i.op;if(e.p1&&i.p1){let c=this.checkRegister(e.p1,i.p1);if(c===void 0)return;n|=i.p1.op(c)}this.emit(n)}assembleClrInstr(s,e){if(!e.p1){this.addError("Parameter required",e.loc);return}if(e.p2&&this.addWarning("Parameter not required",e.p2.loc),!s.ops[0]||!s.ops[0].p1||!s.ops[1]||!s.ops[1].p1){this.addError("Internal opcode definition error",e.loc);return}let i=this.checkRegister(e.p1,s.ops[0].p1,s.ops[1].p1);if(i===void 0)return;let n=this.hasRegister(e.p1,s.ops[1].p1)?s.ops[1]:s.ops[0];if(!n.p1){this.addError("Internal opcode definition error",e.loc);return}let c=n.op;c|=n.p1.op(i),this.emit(c)}assembleMovInstr(s,e){if(!e.p1||!e.p2){this.addError("Two parameters required",e.loc);return}if(!s.ops[0]||!s.ops[0].p1||!s.ops[1]||!s.ops[1].p1){this.addError("Internal opcode definition error",e.loc);return}let i=this.checkRegister(e.p1,s.ops[0].p1,s.ops[1].p1);if(i===void 0)return;let n=this.hasRegister(e.p1,s.ops[1].p1)?s.ops[1]:s.ops[0];if(!e.p1||!n.p1||!e.p2||!n.p2){this.addError("Two parameters required",e.loc);return}let c=n.op;c|=n.p1.op(i);let f=this.checkRegister(e.p2,n.p2);f!==void 0&&(c|=n.p2.op(f),this.emit(c))}assembleLitOpc(s,e){let i=s.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let n=i.op;if(!e.p1||!i.p1){this.addError("Parameter required",e.loc);return}let c=this.checkLiteral(e.p1,0,255,"h");c!==void 0&&(n|=i.p1.op(c),this.emit(n))}assembleLodSwInstr(s,e){let i=s.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let n=i.op;if(!e.p1||!i.p1){this.addError("Parameter required",e.loc);return}let c=this.checkRegister(e.p1,i.p1);c!==void 0&&(n|=i.p1.op(c),this.emit(n))}assembleSetInstr(s,e){if(!e.p1||!e.p2){this.addError("Two parameters required",e.loc);return}if(!s.ops[0]||!s.ops[0].p1||!s.ops[1]||!s.ops[1].p1){this.addError("Internal opcode definition error",e.loc);return}let i=this.checkRegister(e.p1,s.ops[0].p1,s.ops[1].p1);if(i===void 0)return;let n=this.hasRegister(e.p1,s.ops[1].p1),c=n?s.ops[1]:s.ops[0];if(!c.p1){this.addError("Internal opcode definition error",e.loc);return}let f=c.op;if(f|=c.p1.op(i),n){let h=this.evalExpr(e.p2);if(V(h))return;if(typeof h.value!="number"){this.addError(`Expecting branch label to evaluate to integer, got ${J(h.value)}`,e.p2.loc);return}let{value:x}=h;if(x>65535){this.addError("Value out of range (must be between 0x0000 and 0xFFFF)",e.p2.loc);return}this.emit(f),this.emit((x&65280)>>8),this.emit(x&255)}else{if(!c.p2){this.addError("Internal opcode definition error",e.loc);return}let h=this.checkLiteral(e.p2,-16,15);if(h===void 0)return;f|=c.p2.op(h),this.emit(f)}}assembleLoadStoreInstr(s,e){let i=s.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let n=i.op;if(!e.p1||!i.p1){this.addError("Parameter required",e.loc);return}let c=this.checkRegister(e.p1,i.p1);c!==void 0&&(n|=i.p1.op(c),this.emit(n))}checkRegister(s,e,i=void 0){if(s.type!=="register")this.addError("Register required",s.loc);else{let n=e.cs?.[s.value]??i?.cs?.[s.value];return n===void 0&&(e.cs?i&&i.cs?this.addError(`Invalid register - choose one of [${Object.keys(e.cs).join("|")}] or [${Object.keys(i.cs).join("|")}]`,s.loc):this.addError(`Invalid register - choose one of [${Object.keys(e.cs).join("|")}]`,s.loc):this.addError("Invalid register",s.loc)),n}}hasRegister(s,e){return s.type!=="register"?!1:e.cs?.[s.value]!==void 0}checkLiteral(s,e,i,n="d"){let c=this.evalExprToInt(s,"value");if(!V(c)){let f=c.value;if(f<e||f>i){let h="";switch(n){case"b":{let x=i.toString(2);h=`${("0".repeat(x.length)+e.toString(2)).slice(-x.length)}b and ${x}b`;break}case"h":{let x=i.toString(16).toUpperCase();h=`0x${("0".repeat(x.length)+e.toString(16).toUpperCase()).slice(-x.length)} and 0x${x}`;break}default:h=`${e} and ${i}`}this.addError(`Literal out of range (must be between ${h})`,s.loc)}else return f}}assembleBranch(s,e){let i=s.ops[0];if(e.p2&&this.addWarning("Parameter not required",e.p2.loc),!e.p1){this.addError("Parameter required",e.loc);return}let n=this.evalExpr(e.p1);if(V(n))return;if(typeof n.value!="number"){this.addError(`Expecting branch label to evaluate to integer, got ${J(n.value)}`,e.p1.loc);return}let{value:c}=n;this.emit(i.op),this.emit((c&65280)>>8),this.emit(c&255)}handleSetPC(s){let e=this.evalExprToInt(s,"pc");if(!V(e)){let{value:i,completeFirstPass:n}=e;if(!n){this.addError("Value for new program counter must evaluate to a value in the first pass",s.loc);return}!this.curSegment.empty()&&this.curSegment.currentPC()>i&&this.addError(`Cannot set program counter to a smaller value than current (current: $${U(this.curSegment.currentPC())}, trying to set $${U(i)})`,s.loc);let c=this.curSegment.setCurrentPC(i);c!==void 0&&this.addError(c,s.loc)}}emit8or16(s,e){if(e===8){this.emit(s);return}this.emit16(s)}emitData(s,e){let i=Math.pow(2,e);for(let n=0;n<s.length;n++){let c=this.evalExpr(s[n]);if(V(c))continue;let{value:f}=c;if(typeof f=="number")f>=i?this.addError(`Data out of range for ${e} bits`,s[n].loc):this.emit8or16(f,e);else if(typeof f=="string"){let h=f.split("").map(x=>x.charCodeAt(0));h.find(x=>x>=i)?this.addError(`Data contains character out of range for ${e} bits`,s[n].loc):h.forEach(x=>this.emit8or16(x,e))}else this.addError(`Only literal types can be emitted. Got ${J(f)}`,s[n].loc)}}fillBytes(s){let e=this.evalExprToInt(s.numBytes,"!fill num_bytes"),i=this.evalExprToInt(s.fillValue,"!fill value");if(V(e,i))return;let{value:n}=i;if(n<0||n>=256){this.addError(`!fill value to repeat must be in 8-bit range, '${n}' given`,s.fillValue.loc);return}let c=e.value;if(c<0){this.addError(`!fill repeat count must be >= 0, got ${c}`,s.numBytes.loc);return}for(let f=0;f<c;f++)this.emit(n)}alignBytes(s){let e=this.evalExprToInt(s.alignBytes,"alignment");if(V(e))return;let{value:i}=e;if(i<1){this.addError(`Alignment must be a positive integer, ${i} given`,s.alignBytes.loc);return}if(i&i-1){this.addError(`Alignment must be a power of two, ${i} given`,s.loc);return}for(;this.getPC()&i-1;)this.emit(0)}withAnonScope(s,e,i){if(s!==null)return this.withLabelScope(s,e,i);this.scopes.withAnonScope(e,i)}withLabelScope(s,e,i){this.scopes.withLabelScope(s,e)}checkDirectives(s,e){switch(s.type){case"data":{this.emitData(s.values,s.dataSize===_e.Byte?8:16);break}case"fill":{this.fillBytes(s);break}case"align":{this.alignBytes(s);break}case"setpc":{this.handleSetPC(s.pc);break}case"error":{let i=this.evalExprToString(s.error,"error message");if(!V(i)){this.addError(i.value,s.loc);return}break}case"if":{let{cases:i,elseBranch:n}=s;for(let c in i){let[f,h]=i[c],x=this.evalExpr(f);if(!V(x)&&jc(x.value))return this.withAnonScope(e,()=>{this.assembleLines(h)})}return this.withAnonScope(e,()=>{this.assembleLines(n)})}case"for":{let{index:i,list:n,body:c}=s,f=this.evalExpr(n);if(V(f))return;let{value:h}=f;if(!(h instanceof Array)){this.addError("for-loop range must be an array expression (e.g., a range() or an array)",n.loc);return}for(let x=0;x<h.length;x++){let g=null;e!==null&&(g=`${e}__${x}`),this.withAnonScope(g,()=>(this.scopes.declareVar(i.name,Y(h[x],f.completeFirstPass)),this.assembleLines(c)))}break}case"let":{let i=s.name,n=this.scopes.findQualifiedSym([i.name],!1),c=this.evalExpr(s.value);if(n!==void 0&&this.scopes.symbolSeen(i.name)){this.addError(`Variable '${i.name}' already defined`,s.loc);return}this.scopes.declareVar(i.name,c);break}default:this.addError(`unknown directive ${s.type}`,s.loc);return}}assembleLines(s){if(s===null||s.length===0||s.length===0)return;let e=n=>{for(let c=0;c<n.length;c++)this.debugInfo.startLine(n[c].loc,this.getPC(),this.curSegment),this.assembleLine(n[c]),this.debugInfo.endLine(this.getPC(),this.curSegment)},i=0;for(;i<s.length;){let{label:n,stmt:c}=s[i];if(n===null&&c===null)i++;else break}if(!(i>=s.length))return e(s)}checkAndDeclareLabel(s){this.scopes.symbolSeen(s.name)?this.addError(`Symbol '${s.name}' already defined`,s.loc):this.scopes.declareLabelSymbol(s,this.getPC(),this.curSegment)&&(this.needPass=!0)}assembleLine(s){if(this.lineLoc=s.loc,s.label===null&&s.stmt===null&&s.scopedStmts===null)return;s.label!==null&&this.checkAndDeclareLabel(s.label);let e=s.scopedStmts;if(e!=null){if(!s.label)throw new Error("ICE: line.label cannot be undefined");this.withLabelScope(s.label.name,()=>{this.assembleLines(e)});return}if(s.stmt===null)return;if(s.stmt.type!=="insn"){this.checkDirectives(s.stmt,s.label===null?null:s.label.name);return}let i=s.stmt,n=wr[i.mnemonic.toLocaleLowerCase()];n!==void 0?(f=>{let h=this.getPC();f();let x=this.getPC();this.debugInfo.markAsInstruction(h,x)})(()=>{switch(n.mt){case L.Direct:this.assembleNonInstr(n,i);break;case L.Alu:this.assembleAluInstr(n,i);break;case L.Clear:this.assembleClrInstr(n,i);break;case L.Move:this.assembleMovInstr(n,i);break;case L.LitOpc:this.assembleLitOpc(n,i);break;case L.LodSw:this.assembleLodSwInstr(n,i);break;case L.Set:this.assembleSetInstr(n,i);break;case L.LoadStore:this.assembleLoadStoreInstr(n,i);break;case L.Goto:this.assembleBranch(n,i);break;default:this.addError(`Couldn't encode instruction '${i.mnemonic} '`,s.loc)}}):this.addError(`Unknown mnemonic '${i.mnemonic}'`,i.loc)}assemble(s){try{let e=Ar.parse(s.toString());e!==void 0&&e.lines&&this.assembleLines(e.lines)}catch(e){if("name"in e&&e.name==="SyntaxError")this.addError(`Syntax error: ${e.message}`,{...e.location});else{if("name"in e&&e.name==="semantic")return;throw e}}}_requireType(s,e){if(typeof s==e)return s;this.addError(`Expecting a ${e} value, got ${J(s)}`,s.loc)}requireNumber(s){return this._requireType(s,"number")}registerPlugins(){((i,n)=>{this.scopes.declareVar(i,Y(n,!1))})("range",(...i)=>{let n=0,c;if(i.length==1)c=this.requireNumber(i[0]);else if(i.length==2)n=this.requireNumber(i[0]),c=this.requireNumber(i[1]);else throw new Error("Invalid number of args to 'range'.  Expecting 1 or 2 arguments.");if(c==n)return[];if(c<n)throw new Error("range 'end' must be larger or equal to 'start'");return Array(c-n).fill(null).map((f,h)=>h+n)})}dumpLabels(){return this.scopes.dumpLabels(this.getPC(),this.segments)}collectSegmentInfo(){return br(this.segments)}};function Tt(t){try{return Ar.parse(t.toString())}catch{return}}function Wt(t){let s=new Ut,e=0;do{if(s.startPass(e),s.registerPlugins(),s.assemble(t),e>0&&s.anyErrors())return{prg:Uint8Array.from([]),labels:[],segments:[],debugInfo:void 0,errors:s.errors(),warnings:s.warnings()};e+=1}while(s.needPass);return{prg:s.prg(),errors:s.errors(),warnings:s.warnings(),labels:s.dumpLabels(),segments:s.collectSegmentInfo(),debugInfo:s.debugInfo}}var I;(function(t){t[t.Program=0]="Program",t[t.Line=1]="Line",t[t.Label=2]="Label",t[t.LabelRef=3]="LabelRef",t[t.Instruction=4]="Instruction",t[t.Literal=5]="Literal",t[t.Register=6]="Register",t[t.SetPC=7]="SetPC",t[t.Expr=8]="Expr",t[t.Directive=9]="Directive",t[t.Fill=10]="Fill",t[t.Scope=11]="Scope",t[t.Expression=12]="Expression"})(I||(I={}));var De;(function(t){t[t.Label=0]="Label"})(De||(De={}));function Ve(t,s){let e=null;return!t||s<t.offset||s>t.end?null:(t.accept(i=>i.offset===-1&&i.length===-1?!0:i.offset<=s&&i.end>=s?(e?i.length<=e.length&&(e=i):e=i,!0):!1),e)}function kr(t,s){let e=Ve(t,s),i=[];for(;e;)i.unshift(e),e=e.parent;return i}var F=class{get end(){return this.offset+this.length}constructor(s,e){this.nodeType=e,this.parent=null,this.offset=s?.loc.start.offset??0,this.length=(s?.loc.end.offset??0)-this.offset}get type(){return this.nodeType}getTextProvider(){let s=this;for(;s&&!s.textProvider;)s=s.parent;return s?s.textProvider:()=>"unknown"}getText(){return this.getTextProvider()(this.offset,this.length)}matches(s){return this.length===s.length&&this.getTextProvider()(this.offset,this.length)===s}accept(s){if(s(this)&&this.children)for(let e of this.children)e.accept(s)}acceptVisitor(s){this.accept(s.visitNode.bind(s))}adoptChild(s){s.parent=this;let e=this.children;return e||(e=this.children=[]),e.push(s),s}};var rt=class extends F{constructor(s){super(s,I.Program),s?.lines?.forEach(e=>this.adoptChild(new ne(e)))}},ne=class extends F{constructor(s){if(super(s,I.Line),s.label&&this.adoptChild(new ie(s.label)),s.scopedStmts&&this.adoptChild(new Ie(s)),s.stmt)switch(s.stmt.type){case"insn":this.adoptChild(new Ue(s.stmt));break;case"setpc":this.adoptChild(new Fe(s.stmt));break;case"data":this.adoptChild(new Oe(s.stmt));break;case"fill":this.adoptChild(new Re(s.stmt));break;case"align":this.adoptChild(new Me(s.stmt));break;case"for":this.adoptChild(new oe(s.stmt));break;case"if":this.adoptChild(new ae(s.stmt));break;case"let":this.adoptChild(new je(s.stmt));break;case"error":this.adoptChild(new Be(s.stmt));break}}},ie=class extends F{constructor(s){super(s,I.Label),this.length=s.name.length}getName(){return this.getText()}},Ie=class extends F{constructor(s){super(s,I.Scope),s.scopedStmts.forEach(e=>{this.adoptChild(new ne(e))})}},Fe=class extends F{constructor(s){super(s,I.SetPC),this.pcExpr=this.adoptChild(new ge(s.pc))}},Oe=class extends F{constructor(s){super(s,I.Directive)}},Re=class extends F{constructor(s){super(s,I.Directive)}},Me=class extends F{constructor(s){super(s,I.Directive)}},je=class extends F{constructor(s){super(s,I.Directive)}},Be=class extends F{constructor(s){super(s,I.Directive)}},oe=class extends F{constructor(s){super(s,I.Directive),s.body.forEach(e=>{this.adoptChild(new ne(e))})}},ae=class extends F{constructor(s){super(s,I.Directive),s.cases.forEach(e=>{e[1].forEach(i=>{this.adoptChild(new ne(i))})}),s.elseBranch?.forEach(e=>{this.adoptChild(new ne(e))})}},Ue=class extends F{constructor(s){super(s,I.Instruction);let e=i=>{switch(i.type){case"literal":return this.adoptChild(new Te(i));case"register":return this.adoptChild(new We(i));case"qualified-ident":return this.adoptChild(new ce(i));default:return this.adoptChild(new ge(i))}};this.mnemonic=s.mnemonic.toLowerCase(),s.p1&&(this.p1=e(s.p1)),s.p2&&(this.p2=e(s.p2))}},ce=class extends F{constructor(s){super(s,I.LabelRef),this.length=s.path.at(-1).length}},Te=class extends F{constructor(s){super(s,I.Literal),this.value=s.lit}},ge=class extends F{constructor(s){super(s,I.Expression)}},We=class extends F{constructor(s){super(s,I.Register),this.value=s.value.toUpperCase()}};var nt=class{parseProgram(s){let e=s.version,i=s.getText(),n=Tt(s.getText()),c=new rt(n),f=(h,x)=>{if(s.version!==e)throw new Error("Underlying model has changed, AST is no longer valid");return i.substring(h,h+x)};return c.textProvider=f,c}};function le(t,s){let e;if(s?e={kind:"markdown",value:Uc(t)}:e={kind:"plaintext",value:Bc(t)},e.value!=="")return e}function Bc(t){if(!t.description||t.description==="")return"";let s=`${t.summary}

${t.description}`;return"syntax"in t&&(s+=`

Syntax: ${t.syntax}`),"variants"in t&&t.variants&&t.variants.forEach(e=>{s+=`


${t.summary}

${e.description}`,"syntax"in e&&(s+=`

Syntax: ${e.syntax}`)}),s}function Uc(t){if(!t.description||t.description==="")return"";let s=`__${t.summary}__  
${t.description}`;return"syntax"in t&&(s+=`  
Syntax: \`${t.syntax}\``),"variants"in t&&t.variants&&t.variants.forEach(e=>{s+=`
___
__${e.summary}__  
${e.description}`,"syntax"in e&&(s+=`  
Syntax: \`${e.syntax}\``)}),s}function Vt(t,s,e){let i;if(e?i={kind:"markdown",value:_r(Wc(t,s),s)}:i={kind:"plaintext",value:_r(Tc(t,s),s)},i.value!=="")return i}function _r(t,s){if(!s||s.length===0)return t;for(let e=0;e<s.length;e++)t=t.replace(`{${e}}`,s[e]);return t}function Pr(t,s){if(!(!t.variants||t.variants.length===0||!s||s.length===0))for(let i=0;i<t.variants.length;i++){var e=t.variants[i].whenFirstParamIs.indexOf(s[0].toLowerCase());if(e!==-1)return t.variants[i]}}function Tc(t,s){if(!("synopsis"in t)||!t.synopsis||t.synopsis==="")return"";let e=Pr(t,s),i=e?e.summary:t.summary,n=e?e.class:t.class,c=e?e.cycles:t.cycles,f=e?e.description:t.description;return`${i} ${n} ${c}

${f}

Synopsis: ${t.synopsis}`}function Wc(t,s){if(!("synopsis"in t)||!t.synopsis||t.synopsis==="")return"";let e=Pr(t,s),i=e?e.summary:t.summary,n=e?e.class:t.class,c=e?e.cycles:t.cycles,f=e?e.description:t.description;return`__${i}__ ${n} ${c}  
${f}  
Synopsis: \`${t.synopsis}\``}var Ir;(function(t){function s(e){return typeof e=="string"}t.is=s})(Ir||(Ir={}));var zt;(function(t){function s(e){return typeof e=="string"}t.is=s})(zt||(zt={}));var Fr;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647;function s(e){return typeof e=="number"&&t.MIN_VALUE<=e&&e<=t.MAX_VALUE}t.is=s})(Fr||(Fr={}));var it;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647;function s(e){return typeof e=="number"&&t.MIN_VALUE<=e&&e<=t.MAX_VALUE}t.is=s})(it||(it={}));var M;(function(t){function s(i,n){return i===Number.MAX_VALUE&&(i=it.MAX_VALUE),n===Number.MAX_VALUE&&(n=it.MAX_VALUE),{line:i,character:n}}t.create=s;function e(i){let n=i;return p.objectLiteral(n)&&p.uinteger(n.line)&&p.uinteger(n.character)}t.is=e})(M||(M={}));var _;(function(t){function s(i,n,c,f){if(p.uinteger(i)&&p.uinteger(n)&&p.uinteger(c)&&p.uinteger(f))return{start:M.create(i,n),end:M.create(c,f)};if(M.is(i)&&M.is(n))return{start:i,end:n};throw new Error(`Range#create called with invalid arguments[${i}, ${n}, ${c}, ${f}]`)}t.create=s;function e(i){let n=i;return p.objectLiteral(n)&&M.is(n.start)&&M.is(n.end)}t.is=e})(_||(_={}));var ue;(function(t){function s(i,n){return{uri:i,range:n}}t.create=s;function e(i){let n=i;return p.objectLiteral(n)&&_.is(n.range)&&(p.string(n.uri)||p.undefined(n.uri))}t.is=e})(ue||(ue={}));var Or;(function(t){function s(i,n,c,f){return{targetUri:i,targetRange:n,targetSelectionRange:c,originSelectionRange:f}}t.create=s;function e(i){let n=i;return p.objectLiteral(n)&&_.is(n.targetRange)&&p.string(n.targetUri)&&_.is(n.targetSelectionRange)&&(_.is(n.originSelectionRange)||p.undefined(n.originSelectionRange))}t.is=e})(Or||(Or={}));var Nt;(function(t){function s(i,n,c,f){return{red:i,green:n,blue:c,alpha:f}}t.create=s;function e(i){let n=i;return p.objectLiteral(n)&&p.numberRange(n.red,0,1)&&p.numberRange(n.green,0,1)&&p.numberRange(n.blue,0,1)&&p.numberRange(n.alpha,0,1)}t.is=e})(Nt||(Nt={}));var Rr;(function(t){function s(i,n){return{range:i,color:n}}t.create=s;function e(i){let n=i;return p.objectLiteral(n)&&_.is(n.range)&&Nt.is(n.color)}t.is=e})(Rr||(Rr={}));var Mr;(function(t){function s(i,n,c){return{label:i,textEdit:n,additionalTextEdits:c}}t.create=s;function e(i){let n=i;return p.objectLiteral(n)&&p.string(n.label)&&(p.undefined(n.textEdit)||N.is(n))&&(p.undefined(n.additionalTextEdits)||p.typedArray(n.additionalTextEdits,N.is))}t.is=e})(Mr||(Mr={}));var qt;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(qt||(qt={}));var Gt;(function(t){function s(i,n,c,f,h,x){let g={startLine:i,endLine:n};return p.defined(c)&&(g.startCharacter=c),p.defined(f)&&(g.endCharacter=f),p.defined(h)&&(g.kind=h),p.defined(x)&&(g.collapsedText=x),g}t.create=s;function e(i){let n=i;return p.objectLiteral(n)&&p.uinteger(n.startLine)&&p.uinteger(n.startLine)&&(p.undefined(n.startCharacter)||p.uinteger(n.startCharacter))&&(p.undefined(n.endCharacter)||p.uinteger(n.endCharacter))&&(p.undefined(n.kind)||p.string(n.kind))}t.is=e})(Gt||(Gt={}));var Ht;(function(t){function s(i,n){return{location:i,message:n}}t.create=s;function e(i){let n=i;return p.defined(n)&&ue.is(n.location)&&p.string(n.message)}t.is=e})(Ht||(Ht={}));var me;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(me||(me={}));var jr;(function(t){t.Unnecessary=1,t.Deprecated=2})(jr||(jr={}));var Br;(function(t){function s(e){let i=e;return p.objectLiteral(i)&&p.string(i.href)}t.is=s})(Br||(Br={}));var Ne;(function(t){function s(i,n,c,f,h,x){let g={range:i,message:n};return p.defined(c)&&(g.severity=c),p.defined(f)&&(g.code=f),p.defined(h)&&(g.source=h),p.defined(x)&&(g.relatedInformation=x),g}t.create=s;function e(i){var n;let c=i;return p.defined(c)&&_.is(c.range)&&p.string(c.message)&&(p.number(c.severity)||p.undefined(c.severity))&&(p.integer(c.code)||p.string(c.code)||p.undefined(c.code))&&(p.undefined(c.codeDescription)||p.string((n=c.codeDescription)===null||n===void 0?void 0:n.href))&&(p.string(c.source)||p.undefined(c.source))&&(p.undefined(c.relatedInformation)||p.typedArray(c.relatedInformation,Ht.is))}t.is=e})(Ne||(Ne={}));var fe;(function(t){function s(i,n,...c){let f={title:i,command:n};return p.defined(c)&&c.length>0&&(f.arguments=c),f}t.create=s;function e(i){let n=i;return p.defined(n)&&p.string(n.title)&&p.string(n.command)}t.is=e})(fe||(fe={}));var N;(function(t){function s(c,f){return{range:c,newText:f}}t.replace=s;function e(c,f){return{range:{start:c,end:c},newText:f}}t.insert=e;function i(c){return{range:c,newText:""}}t.del=i;function n(c){let f=c;return p.objectLiteral(f)&&p.string(f.newText)&&_.is(f.range)}t.is=n})(N||(N={}));var Xt;(function(t){function s(i,n,c){let f={label:i};return n!==void 0&&(f.needsConfirmation=n),c!==void 0&&(f.description=c),f}t.create=s;function e(i){let n=i;return p.objectLiteral(n)&&p.string(n.label)&&(p.boolean(n.needsConfirmation)||n.needsConfirmation===void 0)&&(p.string(n.description)||n.description===void 0)}t.is=e})(Xt||(Xt={}));var we;(function(t){function s(e){let i=e;return p.string(i)}t.is=s})(we||(we={}));var Ur;(function(t){function s(c,f,h){return{range:c,newText:f,annotationId:h}}t.replace=s;function e(c,f,h){return{range:{start:c,end:c},newText:f,annotationId:h}}t.insert=e;function i(c,f){return{range:c,newText:"",annotationId:f}}t.del=i;function n(c){let f=c;return N.is(f)&&(Xt.is(f.annotationId)||we.is(f.annotationId))}t.is=n})(Ur||(Ur={}));var Zt;(function(t){function s(i,n){return{textDocument:i,edits:n}}t.create=s;function e(i){let n=i;return p.defined(n)&&Kt.is(n.textDocument)&&Array.isArray(n.edits)}t.is=e})(Zt||(Zt={}));var Qt;(function(t){function s(i,n,c){let f={kind:"create",uri:i};return n!==void 0&&(n.overwrite!==void 0||n.ignoreIfExists!==void 0)&&(f.options=n),c!==void 0&&(f.annotationId=c),f}t.create=s;function e(i){let n=i;return n&&n.kind==="create"&&p.string(n.uri)&&(n.options===void 0||(n.options.overwrite===void 0||p.boolean(n.options.overwrite))&&(n.options.ignoreIfExists===void 0||p.boolean(n.options.ignoreIfExists)))&&(n.annotationId===void 0||we.is(n.annotationId))}t.is=e})(Qt||(Qt={}));var Jt;(function(t){function s(i,n,c,f){let h={kind:"rename",oldUri:i,newUri:n};return c!==void 0&&(c.overwrite!==void 0||c.ignoreIfExists!==void 0)&&(h.options=c),f!==void 0&&(h.annotationId=f),h}t.create=s;function e(i){let n=i;return n&&n.kind==="rename"&&p.string(n.oldUri)&&p.string(n.newUri)&&(n.options===void 0||(n.options.overwrite===void 0||p.boolean(n.options.overwrite))&&(n.options.ignoreIfExists===void 0||p.boolean(n.options.ignoreIfExists)))&&(n.annotationId===void 0||we.is(n.annotationId))}t.is=e})(Jt||(Jt={}));var Yt;(function(t){function s(i,n,c){let f={kind:"delete",uri:i};return n!==void 0&&(n.recursive!==void 0||n.ignoreIfNotExists!==void 0)&&(f.options=n),c!==void 0&&(f.annotationId=c),f}t.create=s;function e(i){let n=i;return n&&n.kind==="delete"&&p.string(n.uri)&&(n.options===void 0||(n.options.recursive===void 0||p.boolean(n.options.recursive))&&(n.options.ignoreIfNotExists===void 0||p.boolean(n.options.ignoreIfNotExists)))&&(n.annotationId===void 0||we.is(n.annotationId))}t.is=e})(Yt||(Yt={}));var ot;(function(t){function s(e){let i=e;return i&&(i.changes!==void 0||i.documentChanges!==void 0)&&(i.documentChanges===void 0||i.documentChanges.every(n=>p.string(n.kind)?Qt.is(n)||Jt.is(n)||Yt.is(n):Zt.is(n)))}t.is=s})(ot||(ot={}));var Tr;(function(t){function s(i){return{uri:i}}t.create=s;function e(i){let n=i;return p.defined(n)&&p.string(n.uri)}t.is=e})(Tr||(Tr={}));var Wr;(function(t){function s(i,n){return{uri:i,version:n}}t.create=s;function e(i){let n=i;return p.defined(n)&&p.string(n.uri)&&p.integer(n.version)}t.is=e})(Wr||(Wr={}));var Kt;(function(t){function s(i,n){return{uri:i,version:n}}t.create=s;function e(i){let n=i;return p.defined(n)&&p.string(n.uri)&&(n.version===null||p.integer(n.version))}t.is=e})(Kt||(Kt={}));var Vr;(function(t){function s(i,n,c,f){return{uri:i,languageId:n,version:c,text:f}}t.create=s;function e(i){let n=i;return p.defined(n)&&p.string(n.uri)&&p.string(n.languageId)&&p.integer(n.version)&&p.string(n.text)}t.is=e})(Vr||(Vr={}));var q;(function(t){t.PlainText="plaintext",t.Markdown="markdown";function s(e){let i=e;return i===t.PlainText||i===t.Markdown}t.is=s})(q||(q={}));var xe;(function(t){function s(e){let i=e;return p.objectLiteral(e)&&q.is(i.kind)&&p.string(i.value)}t.is=s})(xe||(xe={}));var ye;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(ye||(ye={}));var be;(function(t){t.PlainText=1,t.Snippet=2})(be||(be={}));var zr;(function(t){t.Deprecated=1})(zr||(zr={}));var Nr;(function(t){function s(i,n,c){return{newText:i,insert:n,replace:c}}t.create=s;function e(i){let n=i;return n&&p.string(n.newText)&&_.is(n.insert)&&_.is(n.replace)}t.is=e})(Nr||(Nr={}));var qr;(function(t){t.asIs=1,t.adjustIndentation=2})(qr||(qr={}));var Gr;(function(t){function s(e){let i=e;return i&&(p.string(i.detail)||i.detail===void 0)&&(p.string(i.description)||i.description===void 0)}t.is=s})(Gr||(Gr={}));var Hr;(function(t){function s(e){return{label:e}}t.create=s})(Hr||(Hr={}));var es;(function(t){function s(e,i){return{items:e||[],isIncomplete:!!i}}t.create=s})(es||(es={}));var qe;(function(t){function s(i){return i.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}t.fromPlainText=s;function e(i){let n=i;return p.string(n)||p.objectLiteral(n)&&p.string(n.language)&&p.string(n.value)}t.is=e})(qe||(qe={}));var ts;(function(t){function s(e){let i=e;return!!i&&p.objectLiteral(i)&&(xe.is(i.contents)||qe.is(i.contents)||p.typedArray(i.contents,qe.is))&&(e.range===void 0||_.is(e.range))}t.is=s})(ts||(ts={}));var Xr;(function(t){function s(e,i){return i?{label:e,documentation:i}:{label:e}}t.create=s})(Xr||(Xr={}));var Zr;(function(t){function s(e,i,...n){let c={label:e};return p.defined(i)&&(c.documentation=i),p.defined(n)?c.parameters=n:c.parameters=[],c}t.create=s})(Zr||(Zr={}));var ve;(function(t){t.Text=1,t.Read=2,t.Write=3})(ve||(ve={}));var ss;(function(t){function s(e,i){let n={range:e};return p.number(i)&&(n.kind=i),n}t.create=s})(ss||(ss={}));var Ge;(function(t){t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(Ge||(Ge={}));var Qr;(function(t){t.Deprecated=1})(Qr||(Qr={}));var rs;(function(t){function s(e,i,n,c,f){let h={name:e,kind:i,location:{uri:c,range:n}};return f&&(h.containerName=f),h}t.create=s})(rs||(rs={}));var Jr;(function(t){function s(e,i,n,c){return c!==void 0?{name:e,kind:i,location:{uri:n,range:c}}:{name:e,kind:i,location:{uri:n}}}t.create=s})(Jr||(Jr={}));var ns;(function(t){function s(i,n,c,f,h,x){let g={name:i,detail:n,kind:c,range:f,selectionRange:h};return x!==void 0&&(g.children=x),g}t.create=s;function e(i){let n=i;return n&&p.string(n.name)&&p.number(n.kind)&&_.is(n.range)&&_.is(n.selectionRange)&&(n.detail===void 0||p.string(n.detail))&&(n.deprecated===void 0||p.boolean(n.deprecated))&&(n.children===void 0||Array.isArray(n.children))&&(n.tags===void 0||Array.isArray(n.tags))}t.is=e})(ns||(ns={}));var Yr;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(Yr||(Yr={}));var at;(function(t){t.Invoked=1,t.Automatic=2})(at||(at={}));var Kr;(function(t){function s(i,n,c){let f={diagnostics:i};return n!=null&&(f.only=n),c!=null&&(f.triggerKind=c),f}t.create=s;function e(i){let n=i;return p.defined(n)&&p.typedArray(n.diagnostics,Ne.is)&&(n.only===void 0||p.typedArray(n.only,p.string))&&(n.triggerKind===void 0||n.triggerKind===at.Invoked||n.triggerKind===at.Automatic)}t.is=e})(Kr||(Kr={}));var en;(function(t){function s(i,n,c){let f={title:i},h=!0;return typeof n=="string"?(h=!1,f.kind=n):fe.is(n)?f.command=n:f.edit=n,h&&c!==void 0&&(f.kind=c),f}t.create=s;function e(i){let n=i;return n&&p.string(n.title)&&(n.diagnostics===void 0||p.typedArray(n.diagnostics,Ne.is))&&(n.kind===void 0||p.string(n.kind))&&(n.edit!==void 0||n.command!==void 0)&&(n.command===void 0||fe.is(n.command))&&(n.isPreferred===void 0||p.boolean(n.isPreferred))&&(n.edit===void 0||ot.is(n.edit))}t.is=e})(en||(en={}));var tn;(function(t){function s(i,n){let c={range:i};return p.defined(n)&&(c.data=n),c}t.create=s;function e(i){let n=i;return p.defined(n)&&_.is(n.range)&&(p.undefined(n.command)||fe.is(n.command))}t.is=e})(tn||(tn={}));var sn;(function(t){function s(i,n){return{tabSize:i,insertSpaces:n}}t.create=s;function e(i){let n=i;return p.defined(n)&&p.uinteger(n.tabSize)&&p.boolean(n.insertSpaces)}t.is=e})(sn||(sn={}));var rn;(function(t){function s(i,n,c){return{range:i,target:n,data:c}}t.create=s;function e(i){let n=i;return p.defined(n)&&_.is(n.range)&&(p.undefined(n.target)||p.string(n.target))}t.is=e})(rn||(rn={}));var nn;(function(t){function s(i,n){return{range:i,parent:n}}t.create=s;function e(i){let n=i;return p.objectLiteral(n)&&_.is(n.range)&&(n.parent===void 0||t.is(n.parent))}t.is=e})(nn||(nn={}));var on;(function(t){t.namespace="namespace",t.type="type",t.class="class",t.enum="enum",t.interface="interface",t.struct="struct",t.typeParameter="typeParameter",t.parameter="parameter",t.variable="variable",t.property="property",t.enumMember="enumMember",t.event="event",t.function="function",t.method="method",t.macro="macro",t.keyword="keyword",t.modifier="modifier",t.comment="comment",t.string="string",t.number="number",t.regexp="regexp",t.operator="operator",t.decorator="decorator"})(on||(on={}));var an;(function(t){t.declaration="declaration",t.definition="definition",t.readonly="readonly",t.static="static",t.deprecated="deprecated",t.abstract="abstract",t.async="async",t.modification="modification",t.documentation="documentation",t.defaultLibrary="defaultLibrary"})(an||(an={}));var cn;(function(t){function s(e){let i=e;return p.objectLiteral(i)&&(i.resultId===void 0||typeof i.resultId=="string")&&Array.isArray(i.data)&&(i.data.length===0||typeof i.data[0]=="number")}t.is=s})(cn||(cn={}));var ln;(function(t){function s(i,n){return{range:i,text:n}}t.create=s;function e(i){let n=i;return n!=null&&_.is(n.range)&&p.string(n.text)}t.is=e})(ln||(ln={}));var un;(function(t){function s(i,n,c){return{range:i,variableName:n,caseSensitiveLookup:c}}t.create=s;function e(i){let n=i;return n!=null&&_.is(n.range)&&p.boolean(n.caseSensitiveLookup)&&(p.string(n.variableName)||n.variableName===void 0)}t.is=e})(un||(un={}));var fn;(function(t){function s(i,n){return{range:i,expression:n}}t.create=s;function e(i){let n=i;return n!=null&&_.is(n.range)&&(p.string(n.expression)||n.expression===void 0)}t.is=e})(fn||(fn={}));var dn;(function(t){function s(i,n){return{frameId:i,stoppedLocation:n}}t.create=s;function e(i){let n=i;return p.defined(n)&&_.is(i.stoppedLocation)}t.is=e})(dn||(dn={}));var is;(function(t){t.Type=1,t.Parameter=2;function s(e){return e===1||e===2}t.is=s})(is||(is={}));var os;(function(t){function s(i){return{value:i}}t.create=s;function e(i){let n=i;return p.objectLiteral(n)&&(n.tooltip===void 0||p.string(n.tooltip)||xe.is(n.tooltip))&&(n.location===void 0||ue.is(n.location))&&(n.command===void 0||fe.is(n.command))}t.is=e})(os||(os={}));var pn;(function(t){function s(i,n,c){let f={position:i,label:n};return c!==void 0&&(f.kind=c),f}t.create=s;function e(i){let n=i;return p.objectLiteral(n)&&M.is(n.position)&&(p.string(n.label)||p.typedArray(n.label,os.is))&&(n.kind===void 0||is.is(n.kind))&&n.textEdits===void 0||p.typedArray(n.textEdits,N.is)&&(n.tooltip===void 0||p.string(n.tooltip)||xe.is(n.tooltip))&&(n.paddingLeft===void 0||p.boolean(n.paddingLeft))&&(n.paddingRight===void 0||p.boolean(n.paddingRight))}t.is=e})(pn||(pn={}));var hn;(function(t){function s(e){return{kind:"snippet",value:e}}t.createSnippet=s})(hn||(hn={}));var gn;(function(t){function s(e,i,n,c){return{insertText:e,filterText:i,range:n,command:c}}t.create=s})(gn||(gn={}));var mn;(function(t){function s(e){return{items:e}}t.create=s})(mn||(mn={}));var wn;(function(t){t.Invoked=0,t.Automatic=1})(wn||(wn={}));var xn;(function(t){function s(e,i){return{range:e,text:i}}t.create=s})(xn||(xn={}));var yn;(function(t){function s(e,i){return{triggerKind:e,selectedCompletionInfo:i}}t.create=s})(yn||(yn={}));var bn;(function(t){function s(e){let i=e;return p.objectLiteral(i)&&zt.is(i.uri)&&p.string(i.name)}t.is=s})(bn||(bn={}));var vn;(function(t){function s(c,f,h,x){return new as(c,f,h,x)}t.create=s;function e(c){let f=c;return!!(p.defined(f)&&p.string(f.uri)&&(p.undefined(f.languageId)||p.string(f.languageId))&&p.uinteger(f.lineCount)&&p.func(f.getText)&&p.func(f.positionAt)&&p.func(f.offsetAt))}t.is=e;function i(c,f){let h=c.getText(),x=n(f,(w,v)=>{let E=w.range.start.line-v.range.start.line;return E===0?w.range.start.character-v.range.start.character:E}),g=h.length;for(let w=x.length-1;w>=0;w--){let v=x[w],E=c.offsetAt(v.range.start),A=c.offsetAt(v.range.end);if(A<=g)h=h.substring(0,E)+v.newText+h.substring(A,h.length);else throw new Error("Overlapping edit");g=E}return h}t.applyEdits=i;function n(c,f){if(c.length<=1)return c;let h=c.length/2|0,x=c.slice(0,h),g=c.slice(h);n(x,f),n(g,f);let w=0,v=0,E=0;for(;w<x.length&&v<g.length;)f(x[w],g[v])<=0?c[E++]=x[w++]:c[E++]=g[v++];for(;w<x.length;)c[E++]=x[w++];for(;v<g.length;)c[E++]=g[v++];return c}})(vn||(vn={}));var as=class{constructor(s,e,i,n){this._uri=s,this._languageId=e,this._version=i,this._content=n,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(s){if(s){let e=this.offsetAt(s.start),i=this.offsetAt(s.end);return this._content.substring(e,i)}return this._content}update(s,e){this._content=s.text,this._version=e,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let s=[],e=this._content,i=!0;for(let n=0;n<e.length;n++){i&&(s.push(n),i=!1);let c=e.charAt(n);i=c==="\r"||c===`
`,c==="\r"&&n+1<e.length&&e.charAt(n+1)===`
`&&n++}i&&e.length>0&&s.push(e.length),this._lineOffsets=s}return this._lineOffsets}positionAt(s){s=Math.max(Math.min(s,this._content.length),0);let e=this.getLineOffsets(),i=0,n=e.length;if(n===0)return M.create(0,s);for(;i<n;){let f=Math.floor((i+n)/2);e[f]>s?n=f:i=f+1}let c=i-1;return M.create(c,s-e[c])}offsetAt(s){let e=this.getLineOffsets();if(s.line>=e.length)return this._content.length;if(s.line<0)return 0;let i=e[s.line],n=s.line+1<e.length?e[s.line+1]:this._content.length;return Math.max(Math.min(i+s.character,n),i)}get lineCount(){return this.getLineOffsets().length}},p;(function(t){let s=Object.prototype.toString;function e(A){return typeof A<"u"}t.defined=e;function i(A){return typeof A>"u"}t.undefined=i;function n(A){return A===!0||A===!1}t.boolean=n;function c(A){return s.call(A)==="[object String]"}t.string=c;function f(A){return s.call(A)==="[object Number]"}t.number=f;function h(A,T,se){return s.call(A)==="[object Number]"&&T<=A&&A<=se}t.numberRange=h;function x(A){return s.call(A)==="[object Number]"&&-2147483648<=A&&A<=2147483647}t.integer=x;function g(A){return s.call(A)==="[object Number]"&&0<=A&&A<=2147483647}t.uinteger=g;function w(A){return s.call(A)==="[object Function]"}t.func=w;function v(A){return A!==null&&typeof A=="object"}t.objectLiteral=v;function E(A,T){return Array.isArray(A)&&A.every(T)}t.typedArray=E})(p||(p={}));var ct=class t{constructor(s,e,i,n){this._uri=s,this._languageId=e,this._version=i,this._content=n,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(s){if(s){let e=this.offsetAt(s.start),i=this.offsetAt(s.end);return this._content.substring(e,i)}return this._content}update(s,e){for(let i of s)if(t.isIncremental(i)){let n=En(i.range),c=this.offsetAt(n.start),f=this.offsetAt(n.end);this._content=this._content.substring(0,c)+i.text+this._content.substring(f,this._content.length);let h=Math.max(n.start.line,0),x=Math.max(n.end.line,0),g=this._lineOffsets,w=$n(i.text,!1,c);if(x-h===w.length)for(let E=0,A=w.length;E<A;E++)g[E+h+1]=w[E];else w.length<1e4?g.splice(h+1,x-h,...w):this._lineOffsets=g=g.slice(0,h+1).concat(w,g.slice(x+1));let v=i.text.length-(f-c);if(v!==0)for(let E=h+1+w.length,A=g.length;E<A;E++)g[E]=g[E]+v}else if(t.isFull(i))this._content=i.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=e}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=$n(this._content,!0)),this._lineOffsets}positionAt(s){s=Math.max(Math.min(s,this._content.length),0);let e=this.getLineOffsets(),i=0,n=e.length;if(n===0)return{line:0,character:s};for(;i<n;){let f=Math.floor((i+n)/2);e[f]>s?n=f:i=f+1}let c=i-1;return s=this.ensureBeforeEOL(s,e[c]),{line:c,character:s-e[c]}}offsetAt(s){let e=this.getLineOffsets();if(s.line>=e.length)return this._content.length;if(s.line<0)return 0;let i=e[s.line];if(s.character<=0)return i;let n=s.line+1<e.length?e[s.line+1]:this._content.length,c=Math.min(i+s.character,n);return this.ensureBeforeEOL(c,i)}ensureBeforeEOL(s,e){for(;s>e&&Sn(this._content.charCodeAt(s-1));)s--;return s}get lineCount(){return this.getLineOffsets().length}static isIncremental(s){let e=s;return e!=null&&typeof e.text=="string"&&e.range!==void 0&&(e.rangeLength===void 0||typeof e.rangeLength=="number")}static isFull(s){let e=s;return e!=null&&typeof e.text=="string"&&e.range===void 0&&e.rangeLength===void 0}},He;(function(t){function s(n,c,f,h){return new ct(n,c,f,h)}t.create=s;function e(n,c,f){if(n instanceof ct)return n.update(c,f),n;throw new Error("TextDocument.update: document must be created by TextDocument.create")}t.update=e;function i(n,c){let f=n.getText(),h=cs(c.map(Vc),(w,v)=>{let E=w.range.start.line-v.range.start.line;return E===0?w.range.start.character-v.range.start.character:E}),x=0,g=[];for(let w of h){let v=n.offsetAt(w.range.start);if(v<x)throw new Error("Overlapping edit");v>x&&g.push(f.substring(x,v)),w.newText.length&&g.push(w.newText),x=n.offsetAt(w.range.end)}return g.push(f.substr(x)),g.join("")}t.applyEdits=i})(He||(He={}));function cs(t,s){if(t.length<=1)return t;let e=t.length/2|0,i=t.slice(0,e),n=t.slice(e);cs(i,s),cs(n,s);let c=0,f=0,h=0;for(;c<i.length&&f<n.length;)s(i[c],n[f])<=0?t[h++]=i[c++]:t[h++]=n[f++];for(;c<i.length;)t[h++]=i[c++];for(;f<n.length;)t[h++]=n[f++];return t}function $n(t,s,e=0){let i=s?[e]:[];for(let n=0;n<t.length;n++){let c=t.charCodeAt(n);Sn(c)&&(c===13&&n+1<t.length&&t.charCodeAt(n+1)===10&&n++,i.push(e+n+1))}return i}function Sn(t){return t===13||t===10}function En(t){let s=t.start,e=t.end;return s.line>e.line||s.line===e.line&&s.character>e.character?{start:e,end:s}:t}function Vc(t){let s=En(t.range);return s!==t.range?{newText:t.newText,range:s}:t}var An;(function(t){t.LATEST={textDocument:{completion:{completionItem:{documentationFormat:[q.Markdown,q.PlainText]}},hover:{contentFormat:[q.Markdown,q.PlainText]}}}})(An||(An={}));function ls(t){return Object.keys(t).map(s=>t[s])}function $e(t){return typeof t<"u"}var lt=class{constructor(s,e){this.clientCapabilities=s,this.rcasmDataManager=e}doComplete(s,e,i){this.offset=s.offsetAt(e),this.position=e,this.currentWord=Nc(s,this.offset),this.defaultReplaceRange=_.create(M.create(this.position.line,this.position.character-this.currentWord.length),this.position),this.textDocument=s,this.program=i;try{let c={isIncomplete:!1,items:[]};var n=s.getText(_.create(M.create(this.position.line,0),this.position));return n.match(/^([a-z]+:)?([ \t]+)?([a-z]{0,3})$/i)&&this.getCompletionsForMnemonic(c),n.match(/^([a-z]+:)?([ \t]+)?([\!]?[a-z]*)$/i)&&this.getCompletionsForDirective(c),c}finally{this.position=null,this.currentWord=null,this.textDocument=null,this.program=null,this.defaultReplaceRange=null}}getCompletionsForMnemonic(s){return this.rcasmDataManager.getMnemonics().forEach(i=>{let n,c;n=this.getCompletionRange(null),c=i.snippet??i.name;let f={label:i.name,detail:i.summary,documentation:le(i,this.doesSupportMarkdown()),textEdit:N.replace(n,c),insertTextFormat:be.Snippet,kind:ye.Method};s.items.push(f)}),s}getCompletionsForDirective(s){return this.rcasmDataManager.getDirectives().forEach(i=>{let n,c;n=this.getCompletionRange(null),c=i.snippet??i.name;let f={label:i.name,detail:i.summary,documentation:le(i,this.doesSupportMarkdown()),textEdit:N.replace(n,c),insertTextFormat:be.Snippet,kind:ye.Property,sortText:i.name.substring(1)};s.items.push(f)}),s}doesSupportMarkdown(){if(!$e(this.supportsMarkdown)){if(!$e(this.clientCapabilities))return this.supportsMarkdown=!0,this.supportsMarkdown;let s=this.clientCapabilities&&this.clientCapabilities.textDocument&&this.clientCapabilities.textDocument.hover;this.supportsMarkdown=s&&s.contentFormat&&Array.isArray(s.contentFormat)&&s.contentFormat.indexOf(q.Markdown)!==-1}return this.supportsMarkdown}getCompletionRange(s){if(s&&s.offset<=this.offset&&this.offset<=s.end){let e=s.end!==-1?this.textDocument.positionAt(s.end):this.position,i=this.textDocument.positionAt(s.offset);if(i.line===e.line)return _.create(i,e)}return this.defaultReplaceRange}};function Nc(t,s){let e=s-1,i=t.getText();for(;e>=0&&` 	
\r:,`.indexOf(i.charAt(e))===-1;)e--;return i.substring(e+1,s)}var ut=class{constructor(s,e){this.clientCapabilities=s,this.rcasmDataManager=e}doHover(s,e,i){function n(x){return _.create(s.positionAt(x.offset),s.positionAt(x.end))}let c=s.offsetAt(e),f=kr(i,c),h=null;for(let x=0;x<f.length;x++){let g=f[x];if(g instanceof Ue){let w=g.mnemonic,v=this.rcasmDataManager.getMnemonic(w);if(v){let E=this.getParamNames(v,g),A=Vt(v,E,this.doesSupportMarkdown());A?h={contents:A,range:n(g)}:h=null}break}if(g instanceof Fe){let w=this.rcasmDataManager.getMnemonic("org");if(w){let v=[g.pcExpr.getText()],E=Vt(w,v,this.doesSupportMarkdown());E?h={contents:E,range:n(g)}:h=null}break}if(g instanceof oe||g instanceof ae||g instanceof je||g instanceof Be){let w=n(g);if(e.line!==w.start.line)continue;let v=g.getText().slice(0,4).toLowerCase().trim(),E=this.rcasmDataManager.getDirective(v);if(E){let A=le(E,this.doesSupportMarkdown());A?h={contents:A,range:n(g)}:h=null}break}if(g instanceof Oe||g instanceof Re){let w=g.getText().slice(0,5).toLowerCase(),v=this.rcasmDataManager.getDirective(w);if(v){let E=le(v,this.doesSupportMarkdown());E?h={contents:E,range:n(g)}:h=null}break}if(g instanceof Me){let w=g.getText().slice(0,6).toLowerCase(),v=this.rcasmDataManager.getDirective(w);if(v){let E=le(v,this.doesSupportMarkdown());E?h={contents:E,range:n(g)}:h=null}break}}return h&&(h.contents=this.convertContents(h.contents)),h}getParamNames(s,e){let i=[];return e.p1?i.push(this.getParamName(s,e.p1,e.mnemonic)):s.class==="ALU"?i.push("A"):i.push("?"),e.p2?i.push(this.getParamName(s,e.p2,e.mnemonic)):i.push("?"),i}getParamName(s,e,i){return e instanceof We?e.value:e instanceof ce?`(${e.getText().trim()})`:e instanceof ge?e.getText().trim():e instanceof Te?i.toLowerCase()==="ldi"&&+e.value>15?`0x${e.value.toString(16).toUpperCase()}`:s.class==="GOTO"?`0x${e.value.toString(16).toUpperCase()}`:e.value.toString():"?"}convertContents(s){return this.doesSupportMarkdown()||typeof s=="string"?s:"kind"in s?{kind:"plaintext",value:s.value}:Array.isArray(s)?s.map(e=>typeof e=="string"?e:e.value):s.value}doesSupportMarkdown(){if(!$e(this.supportsMarkdown)){if(!$e(this.clientCapabilities))return this.supportsMarkdown=!0,this.supportsMarkdown;let s=this.clientCapabilities.textDocument&&this.clientCapabilities.textDocument.hover;this.supportsMarkdown=s&&s.contentFormat&&Array.isArray(s.contentFormat)&&s.contentFormat.indexOf(q.Markdown)!==-1}return this.supportsMarkdown}};var us=class{constructor(s,e){this.symbols=[]}addSymbol(s){this.symbols.push(s)}getSymbol(s,e){for(let i=0;i<this.symbols.length;i++){let n=this.symbols[i];if(n.name===s&&n.type===e)return n}return null}},fs=class extends us{constructor(){super(0,Number.MAX_VALUE)}},ds=class{constructor(s,e,i,n){this.name=s,this.value=e,this.node=i,this.type=n}},ps=class{constructor(s){this.scope=s}addSymbol(s,e,i,n){s.offset!==-1&&this.scope.addSymbol(new ds(e,i,s,n))}visitNode(s){switch(s.type){case I.Label:return this.addSymbol(s,s.getText(),void 0,De.Label),!0}return!0}},Xe=class{constructor(s){this.global=new fs,s.acceptVisitor(new ps(this.global))}internalFindSymbol(s,e){let i=s.getText(),n=this.global;for(let c=0;c<e.length;c++){let f=e[c],h=n.getSymbol(i,f);if(h)return h}return null}evaluateReferenceTypes(s){return s instanceof ce||s instanceof ie?[De.Label]:null}findSymbolFromNode(s){if(!s)return null;let e=this.evaluateReferenceTypes(s);return e?this.internalFindSymbol(s,e):null}matchesSymbol(s,e){if(!s||!s.matches(e.name))return!1;let i=this.evaluateReferenceTypes(s);return!i||i.indexOf(e.type)===-1?!1:this.internalFindSymbol(s,i)===e}};var ft=class{findDefinition(s,e,i){let n=new Xe(i),c=s.offsetAt(e),f=Ve(i,c);if(!f)return null;let h=n.findSymbolFromNode(f);return h?{uri:s.uri,range:de(h.node,s)}:null}findReferences(s,e,i){return this.findDocumentHighlights(s,e,i).map(c=>({uri:s.uri,range:c.range}))}getHighlightNode(s,e,i){let n=s.offsetAt(e),c=Ve(i,n);if(!(!c||c.type!==I.Label&&c.type!==I.LabelRef))return c}findDocumentHighlights(s,e,i){let n=[],c=s.offsetAt(e),f=Ve(i,c);if(!f||f.type!==I.Label&&f.type!==I.LabelRef)return n;let h=new Xe(i),x=h.findSymbolFromNode(f),g=f.getText();return i.accept(w=>{if(x){if(h.matchesSymbol(w,x))return n.push({kind:Cn(w),range:de(w,s)}),!1}else f&&f.type===w.type&&w.matches(g)&&n.push({kind:Cn(w),range:de(w,s)});return!0}),n}findSymbolInformations(s,e){let i=[],n=(c,f,h)=>{let x=h instanceof F?de(h,s):h,g={name:c,kind:f,location:ue.create(s.uri,x)};i.push(g)};return this.collectDocumentSymbols(s,e,n),i}findDocumentSymbols(s,e){let i=[],n=[],c=(f,h,x,g,w)=>{let v=x instanceof F?de(x,s):x,E=(g instanceof F?de(g,s):g)??_.create(v.start,v.start),A={name:f,kind:h,range:v,selectionRange:E},T=n.pop();for(;T&&!qc(T[1],v);)T=n.pop();if(T){let se=T[0];se.children||(se.children=[]),se.children.push(A),n.push(T)}else i.push(A);w&&n.push([A,de(w,s)])};return this.collectDocumentSymbols(s,e,c),i}collectDocumentSymbols(s,e,i){e.accept(n=>(n instanceof ie&&i(n.getName(),Ge.Variable,n,n,void 0),!0))}prepareRename(s,e,i){let n=this.getHighlightNode(s,e,i);if(n)return _.create(s.positionAt(n.offset),s.positionAt(n.end))}doRename(s,e,i,n){let f=this.findDocumentHighlights(s,e,n).map(h=>N.replace(h.range,i));return{changes:{[s.uri]:f}}}};function de(t,s){return _.create(s.positionAt(t.offset),s.positionAt(t.end))}function qc(t,s){let e=s.start.line,i=s.end.line,n=t.start.line,c=t.end.line;return!(e<n||i<n||e>c||i>c||e===n&&s.start.character<t.start.character||i===c&&s.end.character>t.end.character)}function Cn(t){return t.type===I.Label?ve.Write:ve.Read}var dt=class{constructor(){}configure(s){this.settings=s}doValidation(s,e=this.settings){if(e&&e.validate===!1)return[];let{errors:i,warnings:n}=Wt(s.getText()),c=(h,x)=>({severity:x,range:{start:s.positionAt(h.loc.start.offset),end:s.positionAt(h.loc.end.offset)},message:h.msg,source:s.languageId}),f=[];return f.push(...i.map(h=>c(h,me.Error))),f.push(...n.map(h=>c(h,me.Warning))),f}};function Ln(t,s,e){let i=Gc(t,s);return Hc(i,e)}function Gc(t,s){function e(n){return _.create(t.positionAt(n.offset),t.positionAt(n.end))}let i=[];return s.accept(n=>{if(n instanceof Ie){let c=e(n);return i.push({startLine:c.start.line,endLine:c.end.line,kind:"region"}),!1}else if(n instanceof oe||n instanceof ae){let c=e(n);return i.push({startLine:c.start.line,endLine:c.end.line,kind:"region"}),!0}return!0}),i}function Hc(t,s){let e=s&&s.rangeLimit||Number.MAX_VALUE,i=t.sort((f,h)=>{let x=f.startLine-h.startLine;return x===0&&(x=f.endLine-h.endLine),x}),n=[],c=-1;return i.forEach(f=>{f.startLine<c&&c<f.endLine||(n.push(f),c=f.endLine)}),n.length<e?n:n.slice(0,e)}var kn={version:1,mnemonics:[{name:"add",class:"ALU",cycles:8,summary:"Arithmetic Add",description:"Adds the contents of register b and c placing the result in dst (a or d). If dst is not specified then register a is assumed. Affects Z (zero), S (sign) and C (carry) flags.",synopsis:"{0} = B + C",syntax:"add [<dest>{a|d}]"},{name:"and",class:"ALU",cycles:8,summary:"Logic And",description:"Performs a bitwise AND on register b and c placing the result in dst (a or d). If dst is not specified then register a is assumed. Affects Z (zero) and S (sign) flags.",synopsis:"{0} = B & C",syntax:"and [<dest>{a|d}]"},{name:"bcs",class:"GOTO",cycles:24,summary:"Branch if Carry Set",snippet:"bcs ${1:label}",description:"Jumps to label if C is set (last ALU operation resulted in a carry).",synopsis:"PC = {0} [if CY]",syntax:"bcs <label>"},{name:"beq",class:"GOTO",cycles:24,summary:"Branch if Equal (zero)",snippet:"beq ${1:label}",description:"Jumps to label if Z flag is set (last ALU operation result was 0).",synopsis:"PC = {0} [if Z]",syntax:"beq <label>"},{name:"ble",class:"GOTO",cycles:24,summary:"Branch if Less Than or Equal (sign or zero)",snippet:"ble ${1:label}",description:"Jumps to label if S or Z is set (last ALU operation resulted in a zero or negative value).",synopsis:"PC = {0} [if S or Z]",syntax:"ble <label>"},{name:"blt",class:"GOTO",cycles:24,summary:"Branch if Less Than (sign set)",snippet:"blt ${1:label}",description:"Jumps to label if S is set (last ALU operation has most significant bit set / is negative). Synonym of `bmi`.",synopsis:"PC = {0} [if S]",syntax:"blt <label>"},{name:"bmi",class:"GOTO",cycles:24,summary:"Branch if Minus/Sign",snippet:"bmi ${1:label}",description:"Jumps to label if S is set (last ALU operation has most significant bit set / is negative). Synonym of `blt`.",synopsis:"PC = {0} [if S]",syntax:"bmi <label>"},{name:"bne",class:"GOTO",cycles:24,summary:"Branch if Not Equal (not zero)",snippet:"bne ${1:label}",description:"Jumps to label if Z is not set (last ALU operation result was not 0).",synopsis:"PC = {0} [if not Z]",syntax:"bne <label>"},{name:"clr",class:"MOV8",cycles:8,summary:"8-bit Register Clear",description:"Clears (sets to 0) general purpose 8-bit register dst. This is the equivalent of `mov dst,dst`.",synopsis:"{0} = 0",syntax:"clr <dst>{a|b|c|d|m1|m2|x|y}",variants:[{class:"MOV16",cycles:10,summary:"16-bit Register Clear",description:"Clears (sets to 0) 16-bit register xy. This is the equivalent of `mov xy,xy`.",syntax:"clr xy",whenFirstParamIs:["xy"]}]},{name:"cmp",class:"ALU",cycles:8,summary:"Compare (Logic Xor)",description:"Compares the values in register b and c setting condition flag Z (zero) if the values are the same. Overwrites dst (a or d). If dst is not specified then register a is assumed. Affects Z (zero) and S (sign) flags. Synonym of `eor`.",synopsis:"{0} = B ^ C",syntax:"cmp [<dest>{a|d}]"},{name:"eor",class:"ALU",cycles:8,summary:"Logic Xor",description:"Performs a bitwise XOR (exlusive OR) on register b and c placing the result in dst (a or d). If dst is not specified then register a is assumed. Affects Z (zero) and S (sign) flags. Synonym of `cmp`.",synopsis:"{0} = B ^ C",syntax:"eor [<dest>{a|d}]"},{name:"inc",class:"ALU",cycles:8,summary:"Increment",description:"Adds one to the contents of register b (register c is ignored) placing the result in dst (a or d). If dst is not specified then register a is assumed. Affects Z (zero), S (sign) and C (carry) flags.",synopsis:"{0} = B + 1",syntax:"inc [<dest>{a|d}]"},{name:"hlt",class:"MISC",cycles:10,summary:"Halt",description:"Halts execution of the program.",synopsis:"HALT (PC = PC + 1)"},{name:"hlr",class:"MISC",cycles:10,summary:"Halt and Reload",description:"Halts execution of the program and sets the program counter to the value on the primary switches.",synopsis:"HALT (PC = AS)"},{name:"ixy",class:"INCXY",cycles:14,summary:"XY Increment",description:"Increments the 16-bit value in the xy register by 1.",synopsis:"XY = XY + 1"},{name:"lds",class:"MISC",cycles:10,summary:"Load Register from Switches",description:"Loads register dst (a or d) from the front panel switches",synopsis:"{0} = DS",snippet:"lds ${1:a}",syntax:"lds <dst>{a|d}"},{name:"ldr",class:"LOAD",cycles:12,summary:"Load Register from Memory",snippet:"ldr ${1:b}",description:"Loads register dst (a, b, c or d) with the byte in memory currently referenced by register m.",synopsis:"{0} = (M)",syntax:"ldr <dst>{a|b|c|d}"},{name:"jmp",class:"GOTO",cycles:24,summary:"Unconditional Jump",snippet:"jmp ${1:label}",description:"Unconditionally jumps to label (via register j).",synopsis:"PC = {0}",syntax:"jmp <label>"},{name:"jsr",class:"GOTO",cycles:24,summary:"Jump Subroutine",snippet:"jsr ${1:label}",description:"Saves the address of the next instruction into register xy and then unconditionally jumps to label (via register j). Notionally behaves as a 'call subroutine' operation.",synopsis:"XY = PC, PC = {0}",syntax:"jsr <label>"},{name:"rts",class:"MOV16",cycles:10,summary:"Return from Subroutine",description:"Copies the value in register xy to the program counter pc. Notionally behaves as a 'return' operation to a previous jsr call.",synopsis:"PC = XY"},{name:"ldi",class:"SETAB",cycles:8,summary:"8-bit Load Immediate",snippet:"ldi ${1:a},${2:0}",description:"Loads an 8-bit constant value into dst (register a or b), value must be between -16 and 15.",synopsis:"{0} = {1}",syntax:"ldi <dst>{a|b} , <value>{-16,15}",variants:[{class:"GOTO",cycles:24,summary:"16-bit Load Immediate",description:"Loads a 16-bit constant value into dst (register m or j), value can be between 0x0000 and 0xFFFF.",syntax:"ldi <dst>{m|j} , [ <value>{0x0000,0xFFFF} | <label> ]",whenFirstParamIs:["m","j"]}]},{name:"mov",class:"MOV8",cycles:8,summary:"8-bit Register to Register Copy",snippet:"mov ${1:b},${2:a}",description:"Copies a value from src to dst between any of the eight general purpose 8-bit registers. If dst and src are the same then dst will be set to 0.",synopsis:"{0} = {1}",syntax:"mov <dst>{a-d|m1|m2|x|y} , <src>{a-d|m1|m2|x|y}",variants:[{class:"MOV16",cycles:10,summary:"16-bit Register to Register Copy",description:"Copies a value between the 16-bit src registers (m, xy or j) and dst (xy or the program counter pc). If dst and src are the same then dst will be set to 0.",syntax:"mov <dst>{xy|pc} , <src>{m|xy|j|as}",whenFirstParamIs:["xy","pc"]}]},{name:"not",class:"ALU",cycles:8,summary:"Logic Not",description:"Performs a bitwise NOT on register b (register c is ignored) placing the result in dst (a or d). If dst is not specified then register a is assumed. Affects Z (zero) and S (sign) flags.",synopsis:"{0} = ~B",syntax:"not [<dest>{a|d}]"},{name:"orr",class:"ALU",cycles:8,summary:"Logic Or",description:"Performs a bitwise OR on register b and c placing the result in dst (a or d). If dst is not specified then register a is assumed. Affects Z (zero) and S (sign) flags.",synopsis:"{0} = B | C",syntax:"orr [<dest>{a|d}]"},{name:"rol",class:"ALU",cycles:8,summary:"Bitwise Circular Shift Left",description:"Performs a bitwise left-rotation on register b (register c is ignored) placing the result in dst (a or d). If dst is not specified then register a is assumed. Every bit shifts one place to the left with the left most bit rotated around to right. Affects Z (zero) and S (sign) flags.",synopsis:"{0} = <<<B",syntax:"rol [<dest>{a|d}]"},{name:"str",class:"STORE",cycles:12,summary:"Store Register into Memory",snippet:"str ${1:a}",description:"Stores register src (a, b, c or d) into the byte of memory currently referenced by register m.",synopsis:"(M) = {0}",syntax:"str <src>{a|b|c|d}"}],directives:[{name:"!align",summary:"Define Align",description:"Writes 8-bit zeros into the output until the current location is a multiple of the given value.",snippet:"!align ${1:8}",syntax:"<value>{2,4,8,16...}"},{name:"!byte",summary:"Define Byte Data",description:"Writes the given 8-bit values directly into the output starting from current location.",snippet:"!byte ${1:0x00}",syntax:"<value>{0x00,0xFF} [ ,...n ]"},{name:"!word",summary:"Define Word Data",description:"Writes the given 16-bit values directly into the output starting from current location.",snippet:"!word ${1:0x0000}",syntax:"<value>{0x0000,0xFFFF} [ ,...n ]"},{name:"!fill",summary:"Define Fill Space",description:"Writes the given 8-bit value n times directly into the output starting from current location.",snippet:"!fill ${1:8},${2:0x00}",syntax:"<count>{0,255}, <value>{0x00,0xFF}"},{name:"!for",summary:"Define For Loop",description:"Defines a loop that will be expanded at assembly time. The loop will be expanded n times.",snippet:"!for ${1:i} in range(${2:5}) {\n        ${3:add}\n}",syntax:"<variable> in range([<start> ,] <end>)"},{name:"!if",summary:"Define Conditional Block",description:"Defines a block of code that will be output at assembly time if the condition is met.",snippet:"!if (${1:i == 0}) {\n        ${2:add}\n}",syntax:"(<condition>)"},{name:"!let",summary:"Define Variable",description:"Defines a variable that can be substituted into the output at assembly time.",snippet:"!let ${1:i} = ${2:0}",syntax:"<variable> = <value>"},{name:"!error",summary:"Throw Assembly Error",description:"Intentionally raises an error at assembly time. Typically used within an !if directive to assert that a condition is met.",snippet:'!if (${1:i == 0}) { !error "${2:Error message}" }',syntax:'"<message>"'}]};var pt=class{constructor(s){this._mnemonics=[],this._directives=[],this.addData(s)}provideMnemonics(){return this._mnemonics}provideDirectives(){return this._directives}addData(s){if(s.mnemonics&&(this._mnemonics=this._mnemonics.concat(s.mnemonics)),Array.isArray(s.mnemonics))for(let e of s.mnemonics)Xc(e)&&this._mnemonics.push(e);if(Array.isArray(s.directives))for(let e of s.directives)Zc(e)&&this._directives.push(e)}};function Xc(t){return typeof t.name=="string"}function Zc(t){return typeof t.name=="string"}var ht=class{constructor(s){this.dataProviders=[],this._mnemonicSet={},this._directiveSet={},this._mnemonics=[],this._directives=[],this.setDataProviders(s?.useDefaultDataProvider!==!1,s?.customDataProviders||[])}setDataProviders(s,e){this.dataProviders=[],s&&this.dataProviders.push(new pt(kn)),this.dataProviders.push(...e),this.collectData()}collectData(){this._mnemonicSet={},this._directiveSet={},this.dataProviders.forEach(s=>{s.provideMnemonics().forEach(e=>{this._mnemonicSet[e.name]||(this._mnemonicSet[e.name]=e)}),s.provideDirectives().forEach(e=>{this._directiveSet[e.name]||(this._directiveSet[e.name]=e)})}),this._mnemonics=ls(this._mnemonicSet),this._directives=ls(this._directiveSet)}getMnemonic(s){return this._mnemonicSet[s]}getDirective(s){return this._directiveSet[s]}getMnemonics(){return this._mnemonics}getDirectives(){return this._directives}};function Qc(t,s,e,i,n,c){return{configure:f=>{n.configure(f)},setDataProviders:c.setDataProviders.bind(c),doValidation:n.doValidation.bind(n),parseProgram:t.parseProgram.bind(t),doComplete:s.doComplete.bind(s),doHover:e.doHover.bind(e),findDefinition:i.findDefinition.bind(i),findReferences:i.findReferences.bind(i),findDocumentHighlights:i.findDocumentHighlights.bind(i),findDocumentSymbols:i.findSymbolInformations.bind(i),findDocumentSymbols2:i.findDocumentSymbols.bind(i),prepareRename:i.prepareRename.bind(i),doRename:i.doRename.bind(i),getFoldingRanges:Ln}}var Jc={};function _n(t=Jc){let s=new ht(t);return Qc(new nt,new lt(t&&t.clientCapabilities,s),new ut(t&&t.clientCapabilities,s),new ft,new dt,s)}var gt=class{constructor(s,e){this._ctx=s,this._languageId=e.languageId,this._languageService=_n({})}async doValidation(s){let e=this._getTextDocument(s);if(e){let i=this._languageService.doValidation(e);return Promise.resolve(i)}return Promise.resolve([])}async doComplete(s,e){let i=this._getTextDocument(s);if(!i)return null;let n=this._languageService.parseProgram(i),c=this._languageService.doComplete(i,e,n);return Promise.resolve(c)}async doHover(s,e){let i=this._getTextDocument(s);if(!i)return null;let n=this._languageService.parseProgram(i),c=this._languageService.doHover(i,e,n);return Promise.resolve(c)}async findDefinition(s,e){let i=this._getTextDocument(s);if(!i)return null;let n=this._languageService.parseProgram(i),c=this._languageService.findDefinition(i,e,n);return Promise.resolve(c)}async findReferences(s,e){let i=this._getTextDocument(s);if(!i)return[];let n=this._languageService.parseProgram(i),c=this._languageService.findReferences(i,e,n);return Promise.resolve(c)}async findDocumentHighlights(s,e){let i=this._getTextDocument(s);if(!i)return[];let n=this._languageService.parseProgram(i),c=this._languageService.findDocumentHighlights(i,e,n);return Promise.resolve(c)}async findDocumentSymbols(s){let e=this._getTextDocument(s);if(!e)return[];let i=this._languageService.parseProgram(e),n=this._languageService.findDocumentSymbols(e,i);return Promise.resolve(n)}async getFoldingRanges(s,e){let i=this._getTextDocument(s);if(!i)return[];let n=this._languageService.parseProgram(i),c=this._languageService.getFoldingRanges(i,n,e);return Promise.resolve(c)}async doRename(s,e,i){let n=this._getTextDocument(s);if(!n)return null;let c=this._languageService.parseProgram(n),f=this._languageService.doRename(n,e,i,c);return Promise.resolve(f)}_getTextDocument(s){let e=this._ctx.getMirrorModels();for(let i of e)if(i.uri.toString()===s)return He.create(s,this._languageId,i.version,i.getValue());return null}};function Kc(t,s){return new gt(t,s)}return gr(el);})();
return moduleExports;
});
