"use strict";/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.44.0(0528bcdfa41725e806ab6b214d284b49ef87231d)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/
define("vs/language/rcasm/rcasmWorker", ["require","require"],(require)=>{
var moduleExports=(()=>{var it=Object.defineProperty;var Yi=Object.getOwnPropertyDescriptor;var Qi=Object.getOwnPropertyNames;var Ki=Object.prototype.hasOwnProperty;var eo=(t,r)=>()=>(t&&(r=t(t=0)),r);var hr=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports),pr=(t,r)=>{for(var e in r)it(t,e,{get:r[e],enumerable:!0})},to=(t,r,e,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of Qi(r))!Ki.call(t,n)&&n!==e&&it(t,n,{get:()=>r[n],enumerable:!(s=Yi(r,n))||s.enumerable});return t};var gr=t=>to(it({},"__esModule",{value:!0}),t);var at={};pr(at,{DataSize:()=>fe,mkAsmLine:()=>uo,mkData:()=>go,mkFill:()=>mo,mkInsn:()=>po,mkLabel:()=>fo,mkLiteral:()=>wo,mkProgram:()=>lo,mkRegister:()=>xo,mkScopeQualifiedIdent:()=>yo,mkSetPC:()=>ho});function lo(t,r){return{lines:t,loc:r}}function uo(t,r,e){return{label:t,stmt:r,loc:e}}function fo(t,r){return{name:t,loc:r}}function ho(t,r){return{type:"setpc",pc:t,loc:r}}function po(t,r,e,s){return{type:"insn",mnemonic:t,p1:r,p2:e,loc:s}}function go(t,r,e){return{type:"data",values:r,dataSize:t,loc:e}}function mo(t,r,e){return{type:"fill",numBytes:t,fillValue:r,loc:e}}function wo(t,r,e){return{type:"literal",lit:t,ot:r,loc:e}}function xo(t,r){return{type:"register",value:t,loc:r}}function yo(t,r,e){return{type:"qualified-ident",path:t,absolute:r,loc:e}}var fe,ct=eo(()=>{(function(t){t[t.Byte=0]="Byte",t[t.Word=1]="Word"})(fe||(fe={}))});var $r=hr((No,vr)=>{"use strict";function C(t){if(this.words=[],t)if(Symbol&&Symbol.iterator&&t[Symbol.iterator]!==void 0){let r=t[Symbol.iterator](),e=r.next();for(;!e.done;)this.add(e.value),e=r.next()}else for(let r=0;r<t.length;r++)this.add(t[r])}C.fromWords=function(t){let r=Object.create(C.prototype);return r.words=t,r};C.prototype.add=function(t){this.resize(t),this.words[t>>>5]|=1<<t};C.prototype.flip=function(t){this.resize(t),this.words[t>>>5]^=1<<t};C.prototype.clear=function(){this.words.length=0};C.prototype.remove=function(t){this.resize(t),this.words[t>>>5]&=~(1<<t)};C.prototype.isEmpty=function(t){let r=this.words.length;for(let e=0;e<r;e++)if(this.words[e]!==0)return!1;return!0};C.prototype.has=function(t){return(this.words[t>>>5]&1<<t)!==0};C.prototype.checkedAdd=function(t){this.resize(t);let r=this.words[t>>>5],e=r|1<<t;return this.words[t>>>5]=e,(e^r)>>>t};C.prototype.trim=function(t){let r=this.words.length;for(;r>0&&this.words[r-1]===0;)r--;this.words.length=r};C.prototype.resize=function(t){let r=t+32>>>5;for(let e=this.words.length;e<r;e++)this.words[e]=0};C.prototype.hammingWeight=function(t){return t-=t>>>1&1431655765,t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24};C.prototype.hammingWeight4=function(t,r,e,s){return t-=t>>>1&1431655765,r-=r>>>1&1431655765,e-=e>>>1&1431655765,s-=s>>>1&1431655765,t=(t&858993459)+(t>>>2&858993459),r=(r&858993459)+(r>>>2&858993459),e=(e&858993459)+(e>>>2&858993459),s=(s&858993459)+(s>>>2&858993459),t=t+(t>>>4)&252645135,r=r+(r>>>4)&252645135,e=e+(e>>>4)&252645135,s=s+(s>>>4)&252645135,(t+r+e+s)*16843009>>>24};C.prototype.size=function(){let t=0,r=this.words.length,e=this.words;for(let s=0;s<r;s++)t+=this.hammingWeight(e[s]);return t};C.prototype.array=function(){let t=new Array(this.size()),r=0,e=this.words.length;for(let s=0;s<e;++s){let n=this.words[s];for(;n!=0;){let c=n&-n;t[r++]=(s<<5)+this.hammingWeight(c-1|0),n^=c}}return t};C.prototype.forEach=function(t){let r=this.words.length;for(let e=0;e<r;++e){let s=this.words[e];for(;s!=0;){let n=s&-s;t((e<<5)+this.hammingWeight(n-1|0)),s^=n}}};C.prototype[Symbol.iterator]=function(){let t=this.words.length,r=0,e=this.words[r],s=this.hammingWeight,n=this.words;return{[Symbol.iterator](){return this},next(){for(;r<t;)if(e!==0){let c=e&-e,u=(r<<5)+s(c-1|0);return e^=c,{done:!1,value:u}}else r++,r<t&&(e=n[r]);return{done:!0,value:void 0}}}};C.prototype.clone=function(){let t=Object.create(C.prototype);return t.words=this.words.slice(),t};C.prototype.intersects=function(t){let r=Math.min(this.words.length,t.words.length);for(let e=0;e<r;++e)if((this.words[e]&t.words[e])!==0)return!0;return!1};C.prototype.intersection=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]&=t.words[e],this.words[e+1]&=t.words[e+1],this.words[e+2]&=t.words[e+2],this.words[e+3]&=t.words[e+3],this.words[e+4]&=t.words[e+4],this.words[e+5]&=t.words[e+5],this.words[e+6]&=t.words[e+6],this.words[e+7]&=t.words[e+7];for(;e<r;++e)this.words[e]&=t.words[e];let s=this.words.length;for(e=r;e<s;++e)this.words[e]=0;return this};C.prototype.intersection_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(let s=0;s<r;++s)e+=this.hammingWeight(this.words[s]&t.words[s]);return e};C.prototype.new_intersection=function(t){let r=Object.create(C.prototype),e=Math.min(this.words.length,t.words.length);r.words=new Array(e);let s=0;for(;s+7<e;s+=8)r.words[s]=this.words[s]&t.words[s],r.words[s+1]=this.words[s+1]&t.words[s+1],r.words[s+2]=this.words[s+2]&t.words[s+2],r.words[s+3]=this.words[s+3]&t.words[s+3],r.words[s+4]=this.words[s+4]&t.words[s+4],r.words[s+5]=this.words[s+5]&t.words[s+5],r.words[s+6]=this.words[s+6]&t.words[s+6],r.words[s+7]=this.words[s+7]&t.words[s+7];for(;s<e;++s)r.words[s]=this.words[s]&t.words[s];return r};C.prototype.equals=function(t){let r=Math.min(this.words.length,t.words.length);for(let e=0;e<r;++e)if(this.words[e]!=t.words[e])return!1;if(this.words.length<t.words.length){let e=t.words.length;for(let s=this.words.length;s<e;++s)if(t.words[s]!=0)return!1}else if(t.words.length<this.words.length){let e=this.words.length;for(let s=t.words.length;s<e;++s)if(this.words[s]!=0)return!1}return!0};C.prototype.difference=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]&=~t.words[e],this.words[e+1]&=~t.words[e+1],this.words[e+2]&=~t.words[e+2],this.words[e+3]&=~t.words[e+3],this.words[e+4]&=~t.words[e+4],this.words[e+5]&=~t.words[e+5],this.words[e+6]&=~t.words[e+6],this.words[e+7]&=~t.words[e+7];for(;e<r;++e)this.words[e]&=~t.words[e];return this};C.prototype.new_difference=function(t){return this.clone().difference(t)};C.prototype.difference2=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)t.words[e]=this.words[e]&~t.words[e],t.words[e+1]=this.words[e+1]&~t.words[e+1],t.words[e+2]=this.words[e+2]&~t.words[e+2],t.words[e+3]=this.words[e+3]&~t.words[e+3],t.words[e+4]=this.words[e+4]&~t.words[e+4],t.words[e+5]=this.words[e+5]&~t.words[e+5],t.words[e+6]=this.words[e+6]&~t.words[e+6],t.words[e+7]=this.words[e+7]&~t.words[e+7];for(;e<r;++e)t.words[e]=this.words[e]&~t.words[e];for(e=this.words.length-1;e>=r;--e)t.words[e]=this.words[e];return t.words.length=this.words.length,t};C.prototype.difference_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0,s=0;for(;s<r;++s)e+=this.hammingWeight(this.words[s]&~t.words[s]);let n=this.words.length;for(;s<n;++s)e+=this.hammingWeight(this.words[s]);return e};C.prototype.change=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]^=t.words[e],this.words[e+1]^=t.words[e+1],this.words[e+2]^=t.words[e+2],this.words[e+3]^=t.words[e+3],this.words[e+4]^=t.words[e+4],this.words[e+5]^=t.words[e+5],this.words[e+6]^=t.words[e+6],this.words[e+7]^=t.words[e+7];for(;e<r;++e)this.words[e]^=t.words[e];for(e=t.words.length-1;e>=r;--e)this.words[e]=t.words[e];return this};C.prototype.new_change=function(t){let r=Object.create(C.prototype),e=Math.max(this.words.length,t.words.length);r.words=new Array(e);let s=Math.min(this.words.length,t.words.length),n=0;for(;n+7<s;n+=8)r.words[n]=this.words[n]^t.words[n],r.words[n+1]=this.words[n+1]^t.words[n+1],r.words[n+2]=this.words[n+2]^t.words[n+2],r.words[n+3]=this.words[n+3]^t.words[n+3],r.words[n+4]=this.words[n+4]^t.words[n+4],r.words[n+5]=this.words[n+5]^t.words[n+5],r.words[n+6]=this.words[n+6]^t.words[n+6],r.words[n+7]=this.words[n+7]^t.words[n+7];for(;n<s;++n)r.words[n]=this.words[n]^t.words[n];let c=this.words.length;for(n=s;n<c;++n)r.words[n]=this.words[n];let u=t.words.length;for(n=s;n<u;++n)r.words[n]=t.words[n];return r};C.prototype.change_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0,s=0;for(;s<r;++s)e+=this.hammingWeight(this.words[s]^t.words[s]);let n=this.words.length>t.words.length?this:t,c=n.words.length;for(;s<c;++s)e+=this.hammingWeight(n.words[s]);return e};C.prototype.toString=function(){return"{"+this.array().join(",")+"}"};C.prototype.union=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(;e+7<r;e+=8)this.words[e]|=t.words[e],this.words[e+1]|=t.words[e+1],this.words[e+2]|=t.words[e+2],this.words[e+3]|=t.words[e+3],this.words[e+4]|=t.words[e+4],this.words[e+5]|=t.words[e+5],this.words[e+6]|=t.words[e+6],this.words[e+7]|=t.words[e+7];for(;e<r;++e)this.words[e]|=t.words[e];if(this.words.length<t.words.length){this.resize((t.words.length<<5)-1);let s=t.words.length;for(let n=r;n<s;++n)this.words[n]=t.words[n]}return this};C.prototype.new_union=function(t){let r=Object.create(C.prototype),e=Math.max(this.words.length,t.words.length);r.words=new Array(e);let s=Math.min(this.words.length,t.words.length),n=0;for(;n+7<s;n+=8)r.words[n]=this.words[n]|t.words[n],r.words[n+1]=this.words[n+1]|t.words[n+1],r.words[n+2]=this.words[n+2]|t.words[n+2],r.words[n+3]=this.words[n+3]|t.words[n+3],r.words[n+4]=this.words[n+4]|t.words[n+4],r.words[n+5]=this.words[n+5]|t.words[n+5],r.words[n+6]=this.words[n+6]|t.words[n+6],r.words[n+7]=this.words[n+7]|t.words[n+7];for(;n<s;++n)r.words[n]=this.words[n]|t.words[n];let c=this.words.length;for(n=s;n<c;++n)r.words[n]=this.words[n];let u=t.words.length;for(n=s;n<u;++n)r.words[n]=t.words[n];return r};C.prototype.union_size=function(t){let r=Math.min(this.words.length,t.words.length),e=0;for(let s=0;s<r;++s)e+=this.hammingWeight(this.words[s]|t.words[s]);if(this.words.length<t.words.length){let s=t.words.length;for(let n=this.words.length;n<s;++n)e+=this.hammingWeight(t.words[n]|0)}else{let s=this.words.length;for(let n=t.words.length;n<s;++n)e+=this.hammingWeight(this.words[n]|0)}return e};vr.exports=C});var Cr=hr((zo,Ar)=>{"use strict";function vo(t,r){function e(){this.constructor=t}e.prototype=r.prototype,t.prototype=new e}function G(t,r,e,s){this.message=t,this.expected=r,this.found=e,this.location=s,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,G)}vo(G,Error);G.buildMessage=function(t,r){var e={literal:function(p){return'"'+n(p.text)+'"'},class:function(p){var m="",b;for(b=0;b<p.parts.length;b++)m+=p.parts[b]instanceof Array?c(p.parts[b][0])+"-"+c(p.parts[b][1]):c(p.parts[b]);return"["+(p.inverted?"^":"")+m+"]"},any:function(p){return"any character"},end:function(p){return"end of input"},other:function(p){return p.description}};function s(p){return p.charCodeAt(0).toString(16).toUpperCase()}function n(p){return p.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+s(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+s(m)})}function c(p){return p.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+s(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+s(m)})}function u(p){return e[p.type](p)}function h(p){var m=new Array(p.length),b,L;for(b=0;b<p.length;b++)m[b]=u(p[b]);if(m.sort(),m.length>0){for(b=1,L=1;b<m.length;b++)m[b-1]!==m[b]&&(m[L]=m[b],L++);m.length=L}switch(m.length){case 1:return m[0];case 2:return m[0]+" or "+m[1];default:return m.slice(0,-1).join(", ")+", or "+m[m.length-1]}}function x(p){return p?'"'+n(p)+'"':"end of input"}return"Expected "+h(t)+" but "+x(r)+" found."};function $o(t,r){r=r!==void 0?r:{};var e={},s={Lines:Kt},n=Kt,c=function(i,a){return _.mkProgram(Pe(i,a,1),P())},u=function(i){return i},h=function(i,a){return _.mkAsmLine(i,a,P())},x=function(i){return _.mkAsmLine(i,null,P())},p=function(i){return _.mkAsmLine(null,i,P())},m=function(i){return _.mkAsmLine(null,i,P())},b=function(){return _.mkAsmLine(null,null,P())},L=function(i){return i},$=function(i){return i},ce=W("directive"),Xe=function(i,a){let l=i=="byte"?_.DataSize.Byte:_.DataSize.Word;return _.mkData(l,a,P())},In=function(i,a){return _.mkFill(i,a,P())},Dn=function(i,a){return Pe(i,a,3)},On=function(i,a,l){return _.mkInsn(i,a,l,P())},Mn=function(i,a){return _.mkInsn(i,a,null,P())},Fn=function(i){return _.mkInsn(i,null,null,P())},Rn=/^[a-zA-Z_]/,Bn=N([["a","z"],["A","Z"],"_"],!1,!1),jn=/^[a-zA-Z_0-9]/,Wn=N([["a","z"],["A","Z"],"_",["0","9"]],!1,!1),Vt=/^[0-9a-f]/i,Nt=N([["0","9"],["a","f"]],!1,!0),Tt=/^[0-1]/,zt=N([["0","1"]],!1,!1),Un=/^[+\-]/,Vn=N(["+","-"],!1,!1),qt=/^[0-9]/,Ht=N([["0","9"]],!1,!1),Ce=/^[a-z]/i,Le=N([["a","z"]],!1,!0),Gt=/^[0-9a-z_]/i,Xt=N([["0","9"],["a","z"],"_"],!1,!0),Nn="a",Tn=E("a",!0),zn="b",qn=E("b",!0),Hn="c",Gn=E("c",!0),Xn="d",Jn=E("d",!0),Zn="g",Yn=E("g",!0),Qn="h",Kn=E("h",!0),es="j",ts=E("j",!0),rs="m",ns=E("m",!0),ss="o",is=E("o",!0),os="p",as=E("p",!0),cs="r",ls=E("r",!0),us="s",fs=E("s",!0),ds="x",hs=E("x",!0),ps="y",gs=E("y",!0),ms="0",ws=E("0",!1),xs="1",ys=E("1",!1),bs="2",vs=E("2",!1),$s=",",As=E(",",!1),Cs=":",Ls=E(":",!1),Ss=";",Es=E(";",!1),ks="dfb",_s=E("dfb",!0),Ps=function(){return"byte"},Is="dff",Ds=E("dff",!0),Os="dfw",Ms=E("dfw",!0),Fs=function(){return"word"},Rs=function(i){return parseInt(i,2)},Bs=function(i){return parseInt(i,16)},js=function(i){return parseInt(i)},Je='"',Ze=E('"',!1),Ws=function(i){return i.join("")},Ye=bi(),Us=function(i){return i},Jt=function(){return xi()},Zt=W("whitespace"),Vs="	",Ns=E("	",!1),Ts="\v",zs=E("\v",!1),qs="\f",Hs=E("\f",!1),Gs=" ",Xs=E(" ",!1),Js="\xA0",Zs=E("\xA0",!1),Ys="\uFEFF",Qs=E("\uFEFF",!1),Ks=W("end of line"),ei=/^[\n\r]/,ti=N([`
`,"\r"],!1,!1),ri=W("comment"),ni=W("label"),si=function(i){return _.mkLabel(i,P())},ii=W("ORG"),oi=function(i){return _.mkSetPC(i,P())},ai=W("mnemonic"),ci=W("literal"),li=function(i){return _.mkLiteral(i,"b",P())},ui=function(i){return _.mkLiteral(i,"h",P())},fi=function(i){return _.mkLiteral(i,"d",P())},di=function(i){return _.mkLiteral(i,"s",P())},hi=W("identifier"),U="::",le=E("::",!1),pi=function(i,a){return _.mkScopeQualifiedIdent(Pe(i,a,1),!1,P())},gi=function(i,a){return _.mkScopeQualifiedIdent(Pe(i,a,1),!0,P())},mi=W("register"),wi=function(i){return _.mkRegister(i.toLowerCase(),P())},o=0,S=0,Se=[{line:1,column:1}],V=0,Qe=[],w=0,Ee;if("startRule"in r){if(!(r.startRule in s))throw new Error(`Can't start parsing from rule "`+r.startRule+'".');n=s[r.startRule]}function xi(){return t.substring(S,o)}function yi(){return ue(S,o)}function Fo(i,a){throw a=a!==void 0?a:ue(S,o),Qt([W(i)],t.substring(S,o),a)}function Ro(i,a){throw a=a!==void 0?a:ue(S,o),$i(i,a)}function E(i,a){return{type:"literal",text:i,ignoreCase:a}}function N(i,a,l){return{type:"class",parts:i,inverted:a,ignoreCase:l}}function bi(){return{type:"any"}}function vi(){return{type:"end"}}function W(i){return{type:"other",description:i}}function Yt(i){var a=Se[i],l;if(a)return a;for(l=i-1;!Se[l];)l--;for(a=Se[l],a={line:a.line,column:a.column};l<i;)t.charCodeAt(l)===10?(a.line++,a.column=1):a.column++,l++;return Se[i]=a,a}function ue(i,a){var l=Yt(i),f=Yt(a);return{start:{offset:i,line:l.line,column:l.column},end:{offset:a,line:f.line,column:f.column}}}function y(i){o<V||(o>V&&(V=o,Qe=[]),Qe.push(i))}function $i(i,a){return new G(i,null,null,a)}function Qt(i,a,l){return new G(G.buildMessage(i,a),i,a,l)}function Kt(){var i,a,l,f,g,v;if(i=o,a=Ke(),a!==e){for(l=[],f=o,g=_e(),g!==e?(v=Ke(),v!==e?(g=[g,v],f=g):(o=f,f=e)):(o=f,f=e);f!==e;)l.push(f),f=o,g=_e(),g!==e?(v=Ke(),v!==e?(g=[g,v],f=g):(o=f,f=e)):(o=f,f=e);l!==e?(S=i,a=c(a,l),i=a):(o=i,i=e)}else o=i,i=e;return i}function Ke(){var i,a,l,f,g;return i=o,a=D(),a!==e?(l=Ai(),l!==e?(f=D(),f!==e?(g=Hi(),g===e&&(g=null),g!==e?(S=i,a=u(l),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),i}function Ai(){var i,a,l,f;return i=o,a=fr(),a!==e?(l=D(),l!==e?(f=er(),f!==e?(S=i,a=h(a,f),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),i===e&&(i=o,a=fr(),a!==e&&(S=i,a=x(a)),i=a,i===e&&(i=o,a=Gi(),a!==e&&(S=i,a=p(a)),i=a,i===e&&(i=o,a=er(),a!==e&&(S=i,a=m(a)),i=a,i===e&&(i=o,a=D(),a!==e&&(S=i,a=b()),i=a)))),i}function er(){var i,a;return i=o,a=Ci(),a!==e&&(S=i,a=L(a)),i=a,i===e&&(i=o,a=Si(),a!==e&&(S=i,a=$(a)),i=a),i}function Ci(){var i,a,l,f,g,v,I,F;return w++,i=o,a=Wi(),a===e&&(a=Vi()),a!==e?(l=D(),l!==e?(f=Li(),f!==e?(S=i,a=Xe(a,f),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),i===e&&(i=o,a=Ui(),a!==e?(l=D(),l!==e?(f=T(),f!==e?(g=D(),g!==e?(v=ke(),v!==e?(I=D(),I!==e?(F=T(),F!==e?(S=i,a=In(f,F),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)),w--,i===e&&(a=e,w===0&&y(ce)),i}function Li(){var i,a,l,f,g,v,I,F;if(i=o,a=T(),a!==e){for(l=[],f=o,g=D(),g!==e?(v=ke(),v!==e?(I=D(),I!==e?(F=T(),F!==e?(g=[g,v,I,F],f=g):(o=f,f=e)):(o=f,f=e)):(o=f,f=e)):(o=f,f=e);f!==e;)l.push(f),f=o,g=D(),g!==e?(v=ke(),v!==e?(I=D(),I!==e?(F=T(),F!==e?(g=[g,v,I,F],f=g):(o=f,f=e)):(o=f,f=e)):(o=f,f=e)):(o=f,f=e);l!==e?(S=i,a=Dn(a,l),i=a):(o=i,i=e)}else o=i,i=e;return i}function Si(){var i,a,l,f,g,v,I,F;return i=o,a=st(),a!==e?(l=D(),l!==e?(f=T(),f!==e?(g=D(),g!==e?(v=ke(),v!==e?(I=D(),I!==e?(F=T(),F!==e?(S=i,a=On(a,f,F),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),i===e&&(i=o,a=st(),a!==e?(l=D(),l!==e?(f=T(),f!==e?(S=i,a=Mn(a,f),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),i===e&&(i=o,a=st(),a!==e&&(S=i,a=Fn(a)),i=a)),i}function T(){var i;return i=dr(),i===e&&(i=Ji(),i===e&&(i=Xi())),i}function et(){var i;return Rn.test(t.charAt(o))?(i=t.charAt(o),o++):(i=e,w===0&&y(Bn)),i}function tr(){var i;return jn.test(t.charAt(o))?(i=t.charAt(o),o++):(i=e,w===0&&y(Wn)),i}function Ei(){var i,a;if(i=[],Vt.test(t.charAt(o))?(a=t.charAt(o),o++):(a=e,w===0&&y(Nt)),a!==e)for(;a!==e;)i.push(a),Vt.test(t.charAt(o))?(a=t.charAt(o),o++):(a=e,w===0&&y(Nt));else i=e;return i}function ki(){var i,a;if(i=[],Tt.test(t.charAt(o))?(a=t.charAt(o),o++):(a=e,w===0&&y(zt)),a!==e)for(;a!==e;)i.push(a),Tt.test(t.charAt(o))?(a=t.charAt(o),o++):(a=e,w===0&&y(zt));else i=e;return i}function _i(){var i,a,l,f;if(i=o,Un.test(t.charAt(o))?(a=t.charAt(o),o++):(a=e,w===0&&y(Vn)),a===e&&(a=null),a!==e){if(l=[],qt.test(t.charAt(o))?(f=t.charAt(o),o++):(f=e,w===0&&y(Ht)),f!==e)for(;f!==e;)l.push(f),qt.test(t.charAt(o))?(f=t.charAt(o),o++):(f=e,w===0&&y(Ht));else l=e;l!==e?(a=[a,l],i=a):(o=i,i=e)}else o=i,i=e;return i}function Pi(){var i,a,l,f;if(i=o,a=[],Ce.test(t.charAt(o))?(l=t.charAt(o),o++):(l=e,w===0&&y(Le)),l!==e)for(;l!==e;)a.push(l),Ce.test(t.charAt(o))?(l=t.charAt(o),o++):(l=e,w===0&&y(Le));else a=e;if(a!==e){for(l=[],Gt.test(t.charAt(o))?(f=t.charAt(o),o++):(f=e,w===0&&y(Xt));f!==e;)l.push(f),Gt.test(t.charAt(o))?(f=t.charAt(o),o++):(f=e,w===0&&y(Xt));l!==e?(a=[a,l],i=a):(o=i,i=e)}else o=i,i=e;return i}function rr(){var i;return t.substr(o,1).toLowerCase()===Nn?(i=t.charAt(o),o++):(i=e,w===0&&y(Tn)),i}function nr(){var i;return t.substr(o,1).toLowerCase()===zn?(i=t.charAt(o),o++):(i=e,w===0&&y(qn)),i}function sr(){var i;return t.substr(o,1).toLowerCase()===Hn?(i=t.charAt(o),o++):(i=e,w===0&&y(Gn)),i}function ir(){var i;return t.substr(o,1).toLowerCase()===Xn?(i=t.charAt(o),o++):(i=e,w===0&&y(Jn)),i}function Ii(){var i;return t.substr(o,1).toLowerCase()===Zn?(i=t.charAt(o),o++):(i=e,w===0&&y(Yn)),i}function Bo(){var i;return t.substr(o,1).toLowerCase()===Qn?(i=t.charAt(o),o++):(i=e,w===0&&y(Kn)),i}function tt(){var i;return t.substr(o,1).toLowerCase()===es?(i=t.charAt(o),o++):(i=e,w===0&&y(ts)),i}function rt(){var i;return t.substr(o,1).toLowerCase()===rs?(i=t.charAt(o),o++):(i=e,w===0&&y(ns)),i}function Di(){var i;return t.substr(o,1).toLowerCase()===ss?(i=t.charAt(o),o++):(i=e,w===0&&y(is)),i}function Oi(){var i;return t.substr(o,1).toLowerCase()===os?(i=t.charAt(o),o++):(i=e,w===0&&y(as)),i}function Mi(){var i;return t.substr(o,1).toLowerCase()===cs?(i=t.charAt(o),o++):(i=e,w===0&&y(ls)),i}function Fi(){var i;return t.substr(o,1).toLowerCase()===us?(i=t.charAt(o),o++):(i=e,w===0&&y(fs)),i}function nt(){var i;return t.substr(o,1).toLowerCase()===ds?(i=t.charAt(o),o++):(i=e,w===0&&y(hs)),i}function or(){var i;return t.substr(o,1).toLowerCase()===ps?(i=t.charAt(o),o++):(i=e,w===0&&y(gs)),i}function Ri(){var i;return t.charCodeAt(o)===48?(i=ms,o++):(i=e,w===0&&y(ws)),i}function ar(){var i;return t.charCodeAt(o)===49?(i=xs,o++):(i=e,w===0&&y(ys)),i}function cr(){var i;return t.charCodeAt(o)===50?(i=bs,o++):(i=e,w===0&&y(vs)),i}function ke(){var i;return t.charCodeAt(o)===44?(i=$s,o++):(i=e,w===0&&y(As)),i}function Bi(){var i;return t.charCodeAt(o)===58?(i=Cs,o++):(i=e,w===0&&y(Ls)),i}function ji(){var i;return t.charCodeAt(o)===59?(i=Ss,o++):(i=e,w===0&&y(Es)),i}function Wi(){var i,a;return i=o,t.substr(o,3).toLowerCase()===ks?(a=t.substr(o,3),o+=3):(a=e,w===0&&y(_s)),a!==e&&(S=i,a=Ps()),i=a,i}function Ui(){var i;return t.substr(o,3).toLowerCase()===Is?(i=t.substr(o,3),o+=3):(i=e,w===0&&y(Ds)),i}function Vi(){var i,a;return i=o,t.substr(o,3).toLowerCase()===Os?(a=t.substr(o,3),o+=3):(a=e,w===0&&y(Ms)),a!==e&&(S=i,a=Fs()),i=a,i}function Ni(){var i,a,l;return i=o,a=o,l=ki(),l!==e?a=t.substring(a,o):a=l,a!==e?(l=nr(),l!==e?(S=i,a=Rs(a),i=a):(o=i,i=e)):(o=i,i=e),i}function Ti(){var i,a,l,f,g;return i=o,a=Ri(),a!==e?(l=nt(),l!==e?(f=o,g=Ei(),g!==e?f=t.substring(f,o):f=g,f!==e?(S=i,a=Bs(f),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),i}function zi(){var i,a,l;return i=o,a=o,l=_i(),l!==e?a=t.substring(a,o):a=l,a!==e?(l=ir(),l===e&&(l=null),l!==e?(S=i,a=js(a),i=a):(o=i,i=e)):(o=i,i=e),i}function qi(){var i,a,l,f;if(i=o,t.charCodeAt(o)===34?(a=Je,o++):(a=e,w===0&&y(Ze)),a!==e){for(l=[],f=lr();f!==e;)l.push(f),f=lr();l!==e?(t.charCodeAt(o)===34?(f=Je,o++):(f=e,w===0&&y(Ze)),f!==e?(S=i,a=Ws(l),i=a):(o=i,i=e)):(o=i,i=e)}else o=i,i=e;return i}function lr(){var i,a,l;return i=o,a=o,w++,t.charCodeAt(o)===34?(l=Je,o++):(l=e,w===0&&y(Ze)),w--,l===e?a=void 0:(o=a,a=e),a!==e?(t.length>o?(l=t.charAt(o),o++):(l=e,w===0&&y(Ye)),l!==e?(S=i,a=Us(l),i=a):(o=i,i=e)):(o=i,i=e),i}function Y(){var i,a,l,f,g;if(i=o,a=o,l=[],f=et(),f!==e)for(;f!==e;)l.push(f),f=et();else l=e;if(l!==e){for(f=[],g=tr();g!==e;)f.push(g),g=tr();f!==e?(l=[l,f],a=l):(o=a,a=e)}else o=a,a=e;return a!==e&&(S=i,a=Jt()),i=a,i}function D(){var i,a;for(w++,i=[],a=ur();a!==e;)i.push(a),a=ur();return w--,i===e&&(a=e,w===0&&y(Zt)),i}function ur(){var i,a;return w++,t.charCodeAt(o)===9?(i=Vs,o++):(i=e,w===0&&y(Ns)),i===e&&(t.charCodeAt(o)===11?(i=Ts,o++):(i=e,w===0&&y(zs)),i===e&&(t.charCodeAt(o)===12?(i=qs,o++):(i=e,w===0&&y(Hs)),i===e&&(t.charCodeAt(o)===32?(i=Gs,o++):(i=e,w===0&&y(Xs)),i===e&&(t.charCodeAt(o)===160?(i=Js,o++):(i=e,w===0&&y(Zs)),i===e&&(t.charCodeAt(o)===65279?(i=Ys,o++):(i=e,w===0&&y(Qs))))))),w--,i===e&&(a=e,w===0&&y(Zt)),i}function _e(){var i,a;return w++,ei.test(t.charAt(o))?(i=t.charAt(o),o++):(i=e,w===0&&y(ti)),w--,i===e&&(a=e,w===0&&y(Ks)),i}function Hi(){var i,a,l,f,g,v;if(w++,i=o,a=ji(),a!==e){for(l=[],f=o,g=o,w++,v=_e(),w--,v===e?g=void 0:(o=g,g=e),g!==e?(t.length>o?(v=t.charAt(o),o++):(v=e,w===0&&y(Ye)),v!==e?(g=[g,v],f=g):(o=f,f=e)):(o=f,f=e);f!==e;)l.push(f),f=o,g=o,w++,v=_e(),w--,v===e?g=void 0:(o=g,g=e),g!==e?(t.length>o?(v=t.charAt(o),o++):(v=e,w===0&&y(Ye)),v!==e?(g=[g,v],f=g):(o=f,f=e)):(o=f,f=e);l!==e?(a=[a,l],i=a):(o=i,i=e)}else o=i,i=e;return w--,i===e&&(a=e,w===0&&y(ri)),i}function fr(){var i,a,l;return w++,i=o,a=o,l=Pi(),l!==e?a=t.substring(a,o):a=l,a!==e?(l=Bi(),l!==e?(S=i,a=si(a),i=a):(o=i,i=e)):(o=i,i=e),w--,i===e&&(a=e,w===0&&y(ni)),i}function Gi(){var i,a,l,f,g,v;return w++,i=o,a=Di(),a!==e?(l=Mi(),l!==e?(f=Ii(),f!==e?(g=D(),g!==e?(v=dr(),v!==e?(S=i,a=oi(v),i=a):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e)):(o=i,i=e),w--,i===e&&(a=e,w===0&&y(ii)),i}function st(){var i,a,l;if(w++,i=o,a=[],Ce.test(t.charAt(o))?(l=t.charAt(o),o++):(l=e,w===0&&y(Le)),l!==e)for(;l!==e;)a.push(l),Ce.test(t.charAt(o))?(l=t.charAt(o),o++):(l=e,w===0&&y(Le));else a=e;return a!==e&&(S=i,a=Jt()),i=a,w--,i===e&&(a=e,w===0&&y(ai)),i}function dr(){var i,a;return w++,i=o,a=Ni(),a!==e&&(S=i,a=li(a)),i=a,i===e&&(i=o,a=Ti(),a!==e&&(S=i,a=ui(a)),i=a,i===e&&(i=o,a=zi(),a!==e&&(S=i,a=fi(a)),i=a,i===e&&(i=o,a=qi(),a!==e&&(S=i,a=di(a)),i=a))),w--,i===e&&(a=e,w===0&&y(ci)),i}function Xi(){var i,a,l,f,g,v,I;if(w++,i=o,a=Y(),a!==e){for(l=[],f=o,t.substr(o,2)===U?(g=U,o+=2):(g=e,w===0&&y(le)),g!==e?(v=Y(),v!==e?(g=[g,v],f=g):(o=f,f=e)):(o=f,f=e);f!==e;)l.push(f),f=o,t.substr(o,2)===U?(g=U,o+=2):(g=e,w===0&&y(le)),g!==e?(v=Y(),v!==e?(g=[g,v],f=g):(o=f,f=e)):(o=f,f=e);l!==e?(S=i,a=pi(a,l),i=a):(o=i,i=e)}else o=i,i=e;if(i===e)if(i=o,t.substr(o,2)===U?(a=U,o+=2):(a=e,w===0&&y(le)),a!==e)if(l=Y(),l!==e){for(f=[],g=o,t.substr(o,2)===U?(v=U,o+=2):(v=e,w===0&&y(le)),v!==e?(I=Y(),I!==e?(v=[v,I],g=v):(o=g,g=e)):(o=g,g=e);g!==e;)f.push(g),g=o,t.substr(o,2)===U?(v=U,o+=2):(v=e,w===0&&y(le)),v!==e?(I=Y(),I!==e?(v=[v,I],g=v):(o=g,g=e)):(o=g,g=e);f!==e?(S=i,a=gi(l,f),i=a):(o=i,i=e)}else o=i,i=e;else o=i,i=e;return w--,i===e&&(a=e,w===0&&y(hi)),i}function Ji(){var i,a,l,f,g;return w++,i=o,a=o,l=o,f=rr(),f!==e?(g=Fi(),g!==e?(f=[f,g],l=f):(o=l,l=e)):(o=l,l=e),l===e&&(l=rr(),l===e&&(l=nr(),l===e&&(l=sr(),l===e&&(l=ir(),l===e&&(l=o,f=rt(),f!==e?(g=cr(),g!==e?(f=[f,g],l=f):(o=l,l=e)):(o=l,l=e),l===e&&(l=o,f=rt(),f!==e?(g=ar(),g!==e?(f=[f,g],l=f):(o=l,l=e)):(o=l,l=e),l===e&&(l=rt(),l===e&&(l=o,f=Oi(),f!==e?(g=sr(),g!==e?(f=[f,g],l=f):(o=l,l=e)):(o=l,l=e),l===e&&(l=o,f=nt(),f!==e?(g=or(),g!==e?(f=[f,g],l=f):(o=l,l=e)):(o=l,l=e),l===e&&(l=nt(),l===e&&(l=or(),l===e&&(l=o,f=tt(),f!==e?(g=ar(),g!==e?(f=[f,g],l=f):(o=l,l=e)):(o=l,l=e),l===e&&(l=o,f=tt(),f!==e?(g=cr(),g!==e?(f=[f,g],l=f):(o=l,l=e)):(o=l,l=e),l===e&&(l=tt())))))))))))))),l!==e?a=t.substring(a,o):a=l,a!==e?(l=o,w++,f=et(),w--,f===e?l=void 0:(o=l,l=e),l!==e?(S=i,a=wi(a),i=a):(o=i,i=e)):(o=i,i=e),w--,i===e&&(a=e,w===0&&y(mi)),i}var _=(ct(),gr(at));function Zi(i,a){return i.map(function(l){return l[a]})}function Pe(i,a,l){return[i].concat(Zi(a,l))}function P(){return{...yi()}}if(Ee=n(),Ee!==e&&o===t.length)return Ee;throw Ee!==e&&o<t.length&&y(vi()),Qt(Qe,V<t.length?t.charAt(V):null,V<t.length?ue(V,V+1):ue(V,V))}Ar.exports={SyntaxError:G,parse:$o}});var Mo={};pr(Mo,{RCASMWorker:()=>Ge,create:()=>Oo});var z={a:0,d:1},ro={a:0,d:1},no={a:0,b:1},so={m:0,j:1},ot={a:0,b:1,c:2,d:3,m1:4,m2:5,x:6,y:7},io={xy:0,pc:1},oo={m:0,xy:1,j:2,as:3},ao={xy:1},mr={a:0,b:1,c:2,d:3},A;(function(t){t[t.Direct=0]="Direct",t[t.Alu=1]="Alu",t[t.Clear=2]="Clear",t[t.Goto=3]="Goto",t[t.LodSw=4]="LodSw",t[t.LitOpc=5]="LitOpc",t[t.Move=6]="Move",t[t.Set=7]="Set",t[t.LoadStore=8]="LoadStore"})(A||(A={}));var wr={add:{mt:A.Alu,ops:[{op:129,p1:{cs:z,op:t=>t<<3},p2:null}]},inc:{mt:A.Alu,ops:[{op:130,p1:{cs:z,op:t=>t<<3},p2:null}]},and:{mt:A.Alu,ops:[{op:131,p1:{cs:z,op:t=>t<<3},p2:null}]},orr:{mt:A.Alu,ops:[{op:132,p1:{cs:z,op:t=>t<<3},p2:null}]},eor:{mt:A.Alu,ops:[{op:133,p1:{cs:z,op:t=>t<<3},p2:null}]},cmp:{mt:A.Alu,ops:[{op:133,p1:{cs:z,op:t=>t<<3},p2:null}]},not:{mt:A.Alu,ops:[{op:134,p1:{cs:z,op:t=>t<<3},p2:null}]},rol:{mt:A.Alu,ops:[{op:135,p1:{cs:z,op:t=>t<<3},p2:null}]},mov:{mt:A.Move,ops:[{op:0,p1:{cs:ot,op:t=>t<<3},p2:{cs:ot,op:t=>t}},{op:160,p1:{cs:io,op:t=>t<<2},p2:{cs:oo,op:t=>t}}]},clr:{mt:A.Clear,ops:[{op:0,p1:{cs:ot,op:t=>t<<3|t},p2:null},{op:160,p1:{cs:ao,op:t=>t},p2:null}]},rts:{mt:A.Direct,ops:[{op:165,p1:null,p2:null}]},ldr:{mt:A.LoadStore,ops:[{op:144,p1:{cs:mr,op:t=>t},p2:null}]},str:{mt:A.LoadStore,ops:[{op:152,p1:{cs:mr,op:t=>t},p2:null}]},ldi:{mt:A.Set,ops:[{op:64,p1:{cs:no,op:t=>t<<5},p2:{cs:null,op:t=>t&31}},{op:192,p1:{cs:so,op:t=>t<<5},p2:null}]},hlt:{mt:A.Direct,ops:[{op:174,p1:null,p2:null}]},hlr:{mt:A.Direct,ops:[{op:175,p1:null,p2:null}]},lds:{mt:A.LodSw,ops:[{op:172,p1:{cs:ro,op:t=>t},p2:null}]},ixy:{mt:A.Direct,ops:[{op:176,p1:null,p2:null}]},jmp:{mt:A.Goto,ops:[{op:230,p1:null,p2:null}]},jsr:{mt:A.Goto,ops:[{op:231,p1:null,p2:null}]},bne:{mt:A.Goto,ops:[{op:226,p1:null,p2:null}]},beq:{mt:A.Goto,ops:[{op:228,p1:null,p2:null}]},bcs:{mt:A.Goto,ops:[{op:232,p1:null,p2:null}]},bmi:{mt:A.Goto,ops:[{op:240,p1:null,p2:null}]},blt:{mt:A.Goto,ops:[{op:240,p1:null,p2:null}]},ble:{mt:A.Goto,ops:[{op:244,p1:null,p2:null}]},opc:{mt:A.LitOpc,ops:[{op:0,p1:{cs:null,op:t=>t},p2:null}]}};function R(t){return t.toString(16).padStart(4,"0")}ct();var Q=class{constructor(r,e,s,n){this.start=r,this.end=e,this.inferStart=s,this.id=n,this.blocks=[{start:r,binary:[]}],this.curBlock=this.blocks[0]}setCurrentPC(r){let e;if(this.inferStart&&this.blocks.length===1&&this.blocks[0].binary.length===0)this.start=r;else{let c=this.end!==void 0?`$${R(this.end)}`:"",u=`Segment address range: $${R(this.start)}-${c}`;r<this.start?e=`${u}.  Cannot set program counter to a lower address $${R(r)}.`:this.end!==void 0&&r>this.end?e=`${u}.  Trying to set program counter to $${R(r)} -- it is past segment end ${c}.`:this.blocks.length===1&&this.blocks[0].binary.length===0&&(this.start=r)}let s={start:r,binary:[]},n=this.blocks.push(s);return this.curBlock=this.blocks[n-1],e}empty(){return this.blocks.every(r=>r.binary.length===0)}currentPC(){return this.curBlock.start+this.curBlock.binary.length}emit(r){if(this.currentPC()<this.start||this.end!==void 0&&this.currentPC()>this.end){let e=this.end!==void 0?`$${R(this.end)}`:"",s=this.start!==void 0?`$${R(this.start)}`:"";return`Segment overflow at $${R(this.currentPC())}.  Segment address range: ${s}-${e}`}this.curBlock.binary.push(r)}formatRange(){let r=this.end!==void 0?`$${R(this.end)}`:"";return`${this.start!==void 0?`$${R(this.start)}`:""}-${r}`}overlaps(r){let e=this.start,s=r.start,n=this.end!==void 0?this.end:this.currentPC(),c=r.end!==void 0?r.end:r.currentPC();return e<s?s<=n:c>=e}};function xr(t){let r=[];for(let[e,s]of t){let n=s.blocks.filter(c=>c.binary.length!==0).sort((c,u)=>c.start-u.start);if(n.length!==0){let c=new Q(s.start,s.end,s.inferStart,r.length-1);c.blocks=n,c.curBlock=n[n.length-1],r.push([e,c])}}return r}function yr(t){let r=xr(t);if(r.length===0)return{startPC:0,binary:Uint8Array.from([])};let[,e]=r[0],s=e.blocks[0],n=e.blocks[e.blocks.length-1],c=s.start,u=n.start+n.binary.length;for(let x=1;x<r.length;x++){let p=r[x][1],m=p.blocks[0].start,b=p.curBlock.start+p.curBlock.binary.length;c=Math.min(m,c),u=Math.max(b,u)}let h=new Uint8Array(u);for(let[,x]of r)for(let p of x.blocks)for(let m=0;m<p.binary.length;m++)h[p.start+m]=p.binary[m];return{startPC:c,binary:h.slice(c)}}function br(t){return xr(t).sort((e,s)=>e[1].start-s[1].start).map(([e,s])=>{let n=s.blocks.map(c=>({start:c.start,end:c.start+c.binary.length-1}));return{name:e,blocks:n}})}var bo=$r(),de=class{constructor(){this.lineStack=[],this.pcToLocs={},this.insnBitset=new bo}startLine(r,e,s){let n={lineNo:r.start.line,segmentId:s.id,numBytes:0};this.lineStack.push({loc:n,pc:e,segmentId:s.id})}endLine(r,e){let s=this.lineStack.pop();if(!s)throw new Error("internal compiler error, mismatching start/end lines in debugInfo");let n=r-s.pc;if(n>0&&e.id===s.segmentId){let c={...s.loc,numBytes:n};this.pcToLocs[s.pc]===void 0?this.pcToLocs[s.pc]=[c]:this.pcToLocs[s.pc].push(c)}}markAsInstruction(r,e){for(let s=r;s<e;s++)this.insnBitset.add(s)}info(){let r=this.insnBitset.clone(),e=s=>r.has(s);return{pcToLocs:this.pcToLocs,isInstruction:e}}};var Lr=Cr();function lt(t){return{value:t,errors:!0,completeFirstPass:!1}}function ut(t,r){return{value:t,errors:!1,completeFirstPass:r}}function K(...t){return t.some(r=>r!==void 0&&r.errors)}var ft=class{constructor(r,e){this.syms=new Map,this.parent=null,this.children=new Map,this.parent=r,this.name=e}findSymbol(r){for(let e=this;e!==null;e=e.parent){let s=e.syms.get(r);if(s!==void 0)return s}}findSymbolPath(r){if(r.length===1)return this.findSymbol(r[0]);let e=this;for(;e.children.get(r[0])===void 0;)if(e=e.parent,e===null)return;for(let s=0;s<r.length-1;s++)if(e=e.children.get(r[s]),e===void 0)return;return e.syms.get(r[r.length-1])}addSymbol(r,e,s){this.syms.set(r,{...e,seen:s})}updateSymbol(r,e,s){for(let n=this;n!==null;n=n.parent)if(n.syms.get(r)!==void 0){n.syms.set(r,{...e,seen:s});return}}},dt=class{constructor(){this.passCount=0,this.root=new ft(null,""),this.curSymtab=this.root,this.anonScopeCount=0}startPass(r){this.curSymtab=this.root,this.anonScopeCount=0,this.passCount=r}findPath(r,e){return e?this.root.findSymbolPath(r):this.curSymtab.findSymbolPath(r)}findQualifiedSym(r,e){return this.findPath(r,e)}symbolSeen(r){let e=this.curSymtab.syms.get(r);return e!==void 0?e.seen===this.passCount:!1}declareLabelSymbol(r,e,s){let{name:n,loc:c}=r,u=this.curSymtab.syms.get(n);if(u===void 0){let x={type:"label",segment:s,data:ut({addr:e,loc:c},!1)};return this.curSymtab.addSymbol(n,x,this.passCount),!1}if(u.type!=="label")throw new Error("ICE: declareLabelSymbol should be called only on labels");if(u.data.value.addr!==e){let x={type:"label",segment:s,data:{...u.data,value:{...u.data.value,addr:e}}};return this.curSymtab.updateSymbol(n,x,this.passCount),!0}return this.curSymtab.updateSymbol(n,u,this.passCount),!1}dumpLabels(r,e){let s={};for(let[p,m]of e)s[m.id]=p;let n=[],c=(p,m)=>{if(p!==void 0){let b=[...p,m.name];n.push({path:b,sym:m})}else n.push({path:[],sym:m})};c(void 0,this.root);let u=[];for(;n.length>0;){let p=n.pop();if(p){for(let[m,b]of p.sym.syms)b.type==="label"&&u.push({path:[...p.path,m],addr:b.data.value.addr,size:0,segmentName:s[b.segment.id]});for(let[,m]of p.sym.children)c(p.path,m)}}let h=u.sort((p,m)=>p.addr-m.addr),x=h.length;if(x>0){for(let m=1;m<x;m++)h[m-1].size=h[m].addr-h[m-1].addr;let p=h[x-1];p.size=r-p.addr}return h.map(({path:p,addr:m,size:b,segmentName:L})=>({name:p.join("::"),addr:m,size:b,segmentName:L}))}};function Ie(t){let r=typeof t;return r==="object"&&t instanceof Array?"array":r}function Ao(t){return`${t.absolute?"::":""}${t.path.join("::")}`}var ht=class{constructor(){this.curSegmentName="",this.curSegment=new Q(0,0,!1,0),this.pass=0,this.needPass=!1,this.scopes=new dt,this.segments=[],this.errorList=[],this.warningList=[],this.debugInfo=new de,this.errors=()=>this.formatErrors(this.errorList,"error"),this.warnings=()=>this.formatErrors(this.warningList,"warning")}prg(){let{startPC:r,binary:e}=yr(this.segments),s=r&255,n=r>>8&255;return Uint8Array.from([s,n,...e])}anyErrors(){return this.errorList.length!==0}formatErrors(r,e){return[...new Set(r.map(n=>JSON.stringify(n)))].map(n=>{let{loc:c,msg:u}=JSON.parse(n),h=`<unknown>:1:1: ${e}: ${u}`;return c&&(h=`${c.start.line}:${c.start.column}: ${e}: ${u}`),{loc:c,msg:u,formatted:h}})}addError(r,e){this.errorList.push({msg:r,loc:e})}addWarning(r,e){this.warningList.push({msg:r,loc:e})}startPass(r){this.pass=r,this.needPass=!1,this.errorList=[],this.scopes.startPass(r),this.debugInfo=new de,this.segments=[];let e=this.newSegment("default",0,void 0,!0);this.setCurrentSegment({type:"segment",data:e},"default")}setCurrentSegment(r,e){this.curSegmentName=e,this.curSegment=r.data}newSegment(r,e,s,n){let c=new Q(e,s,n,this.segments.length-1);return this.segments.push([r,c]),c}getPC(){return this.curSegment.currentPC()}evalExprType(r,e,s){let n=this.evalExpr(r),{errors:c,value:u,completeFirstPass:h}=n;return!c&&typeof u!==e?(this.addError(`Expecting ${s} to be '${e}' type, got '${Ie(u)}'`,r.loc),{errors:!0,completeFirstPass:h,value:u}):n}evalExprToInt(r,e){return this.evalExprType(r,"number",e)}evalExpr(r){switch(r.type){case"literal":return ut(r.lit,!0);case"register":return this.addError("Unexpected register",r.loc),lt(0);case"ident":throw new Error("should not see an ident here -- if you do, it is probably a wrong type node in parser");case"qualified-ident":{let e=this.scopes.findQualifiedSym(r.path,r.absolute);if(e===void 0)return this.pass>=1?(this.addError(`Undefined symbol '${Ao(r)}'`,r.loc),lt(0)):(this.needPass=!0,ut(0,!1));switch(e.type){case"label":return{errors:e.data.errors,value:e.data.value.addr,completeFirstPass:e.seen===this.pass}}break}default:break}throw new Error(`should be unreachable on ${r}`)}emit(r){let e=this.curSegment.emit(r);e!==void 0&&this.addError(e,this.lineLoc)}emit16(r){this.emit(r>>8&255),this.emit(r&255)}assembleNonInstr(r,e){let s=r.ops[0];e.p1&&this.addWarning("Parameter not required",e.p1.loc),e.p2&&this.addWarning("Parameter not required",e.p2.loc),this.emit(s.op)}assembleAluInstr(r,e){let s=r.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let n=s.op;if(e.p1&&s.p1){let c=this.checkRegister(e.p1,s.p1);if(c===void 0)return;n|=s.p1.op(c)}this.emit(n)}assembleClrInstr(r,e){if(!e.p1){this.addError("Parameter required",e.loc);return}if(e.p2&&this.addWarning("Parameter not required",e.p2.loc),!r.ops[0]||!r.ops[0].p1||!r.ops[1]||!r.ops[1].p1){this.addError("Internal opcode definition error",e.loc);return}let s=this.checkRegister(e.p1,r.ops[0].p1,r.ops[1].p1);if(s===void 0)return;let n=this.hasRegister(e.p1,r.ops[1].p1)?r.ops[1]:r.ops[0];if(!n.p1){this.addError("Internal opcode definition error",e.loc);return}let c=n.op;c|=n.p1.op(s),this.emit(c)}assembleMovInstr(r,e){if(!e.p1||!e.p2){this.addError("Two parameters required",e.loc);return}if(!r.ops[0]||!r.ops[0].p1||!r.ops[1]||!r.ops[1].p1){this.addError("Internal opcode definition error",e.loc);return}let s=this.checkRegister(e.p1,r.ops[0].p1,r.ops[1].p1);if(s===void 0)return;let n=this.hasRegister(e.p1,r.ops[1].p1)?r.ops[1]:r.ops[0];if(!e.p1||!n.p1||!e.p2||!n.p2){this.addError("Two parameters required",e.loc);return}let c=n.op;c|=n.p1.op(s);let u=this.checkRegister(e.p2,n.p2);u!==void 0&&(c|=n.p2.op(u),this.emit(c))}assembleLitOpc(r,e){let s=r.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let n=s.op;if(!e.p1||!s.p1){this.addError("Parameter required",e.loc);return}let c=this.checkLiteral(e.p1,0,255,"h");c!==void 0&&(n|=s.p1.op(c),this.emit(n))}assembleLodSwInstr(r,e){let s=r.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let n=s.op;if(!e.p1||!s.p1){this.addError("Parameter required",e.loc);return}let c=this.checkRegister(e.p1,s.p1);c!==void 0&&(n|=s.p1.op(c),this.emit(n))}assembleSetInstr(r,e){if(!e.p1||!e.p2){this.addError("Two parameters required",e.loc);return}if(!r.ops[0]||!r.ops[0].p1||!r.ops[1]||!r.ops[1].p1){this.addError("Internal opcode definition error",e.loc);return}let s=this.checkRegister(e.p1,r.ops[0].p1,r.ops[1].p1);if(s===void 0)return;let n=this.hasRegister(e.p1,r.ops[1].p1),c=n?r.ops[1]:r.ops[0];if(!c.p1){this.addError("Internal opcode definition error",e.loc);return}let u=c.op;if(u|=c.p1.op(s),n){let h=this.evalExpr(e.p2);if(K(h))return;if(typeof h.value!="number"){this.addError(`Expecting branch label to evaluate to integer, got ${Ie(h.value)}`,e.p2.loc);return}let{value:x}=h;if(x>65535){this.addError("Value out of range (must be between 0x0000 and 0xFFFF)",e.p2.loc);return}this.emit(u),this.emit((x&65280)>>8),this.emit(x&255)}else{if(!c.p2){this.addError("Internal opcode definition error",e.loc);return}let h=this.checkLiteral(e.p2,-16,15);if(h===void 0)return;u|=c.p2.op(h),this.emit(u)}}assembleLoadStoreInstr(r,e){let s=r.ops[0];e.p2&&this.addWarning("Parameter not required",e.p2.loc);let n=s.op;if(!e.p1||!s.p1){this.addError("Parameter required",e.loc);return}let c=this.checkRegister(e.p1,s.p1);c!==void 0&&(n|=s.p1.op(c),this.emit(n))}checkRegister(r,e,s=void 0){if(r.type!=="register")this.addError("Register required",r.loc);else{let n=e.cs?.[r.value]??s?.cs?.[r.value];return n===void 0&&(e.cs?s&&s.cs?this.addError(`Invalid register - choose one of [${Object.keys(e.cs).join("|")}] or [${Object.keys(s.cs).join("|")}]`,r.loc):this.addError(`Invalid register - choose one of [${Object.keys(e.cs).join("|")}]`,r.loc):this.addError("Invalid register",r.loc)),n}}hasRegister(r,e){return r.type!=="register"?!1:e.cs?.[r.value]!==void 0}checkLiteral(r,e,s,n="d"){let c=this.evalExprToInt(r,"value");if(!K(c)){let u=c.value;if(u<e||u>s){let h="";switch(n){case"b":{let x=s.toString(2);h=`${("0".repeat(x.length)+e.toString(2)).slice(-x.length)}b and ${x}b`;break}case"h":{let x=s.toString(16).toUpperCase();h=`0x${("0".repeat(x.length)+e.toString(16).toUpperCase()).slice(-x.length)} and 0x${x}`;break}default:h=`${e} and ${s}`}this.addError(`Literal out of range (must be between ${h})`,r.loc)}else return u}}assembleBranch(r,e){let s=r.ops[0];if(e.p2&&this.addWarning("Parameter not required",e.p2.loc),!e.p1){this.addError("Parameter required",e.loc);return}if(e.p1.type!=="qualified-ident"){this.addError("Identifier required",e.p1.loc);return}let n=this.evalExpr(e.p1);if(K(n))return;if(typeof n.value!="number"){this.addError(`Expecting branch label to evaluate to integer, got ${Ie(n.value)}`,e.p1.loc);return}let{value:c}=n;this.emit(s.op),this.emit((c&65280)>>8),this.emit(c&255)}handleSetPC(r){let e=this.evalExprToInt(r,"pc");if(!K(e)){let{value:s,completeFirstPass:n}=e;if(!n){this.addError("Value for new program counter must evaluate to a value in the first pass",r.loc);return}!this.curSegment.empty()&&this.curSegment.currentPC()>s&&this.addError(`Cannot set program counter to a smaller value than current (current: $${R(this.curSegment.currentPC())}, trying to set $${R(s)})`,r.loc);let c=this.curSegment.setCurrentPC(s);c!==void 0&&this.addError(c,r.loc)}}emit8or16(r,e){if(e===8){this.emit(r);return}this.emit16(r)}emitData(r,e){let s=Math.pow(2,e);for(let n=0;n<r.length;n++){let c=this.evalExpr(r[n]);if(K(c))continue;let{value:u}=c;if(typeof u=="number")u>=s?this.addError(`Data out of range for ${e} bits`,r[n].loc):this.emit8or16(u,e);else if(typeof u=="string"){let h=u.split("").map(x=>x.charCodeAt(0));h.find(x=>x>=s)?this.addError(`Data contains character out of range for ${e} bits`,r[n].loc):h.forEach(x=>this.emit8or16(x,e))}else this.addError(`Only literal types can be emitted. Got ${Ie(u)}`,r[n].loc)}}fillBytes(r){let e=this.evalExprToInt(r.numBytes,"dff num_bytes"),s=this.evalExprToInt(r.fillValue,"dff value");if(K(e,s))return;let{value:n}=s;if(n<0||n>=256){this.addError(`dff value to repeat must be in 8-bit range, '${n}' given`,r.fillValue.loc);return}let c=e.value;if(c<0){this.addError(`dff repeat count must be >= 0, got ${c}`,r.numBytes.loc);return}for(let u=0;u<c;u++)this.emit(n)}checkDirectives(r,e){switch(r.type){case"data":{this.emitData(r.values,r.dataSize===fe.Byte?8:16);break}case"fill":{this.fillBytes(r);break}case"setpc":{this.handleSetPC(r.pc);break}default:this.addError(`unknown directive ${r.type}`,r.loc);return}}assembleLines(r){if(r===null||r.length===0||r.length===0)return;let e=n=>{for(let c=0;c<n.length;c++)this.debugInfo.startLine(n[c].loc,this.getPC(),this.curSegment),this.assembleLine(n[c]),this.debugInfo.endLine(this.getPC(),this.curSegment)},s=0;for(;s<r.length;){let{label:n,stmt:c}=r[s];if(n===null&&c===null)s++;else break}if(!(s>=r.length))return e(r)}checkAndDeclareLabel(r){this.scopes.symbolSeen(r.name)?this.addError(`Symbol '${r.name}' already defined`,r.loc):this.scopes.declareLabelSymbol(r,this.getPC(),this.curSegment)&&(this.needPass=!0)}assembleLine(r){if(this.lineLoc=r.loc,r.label===null&&r.stmt===null||(r.label!==null&&this.checkAndDeclareLabel(r.label),r.stmt===null))return;if(r.stmt.type!=="insn"){this.checkDirectives(r.stmt,r.label===null?null:r.label.name);return}let e=r.stmt,s=wr[e.mnemonic.toLocaleLowerCase()];s!==void 0?(c=>{let u=this.getPC();c();let h=this.getPC();this.debugInfo.markAsInstruction(u,h)})(()=>{switch(s.mt){case A.Direct:this.assembleNonInstr(s,e);break;case A.Alu:this.assembleAluInstr(s,e);break;case A.Clear:this.assembleClrInstr(s,e);break;case A.Move:this.assembleMovInstr(s,e);break;case A.LitOpc:this.assembleLitOpc(s,e);break;case A.LodSw:this.assembleLodSwInstr(s,e);break;case A.Set:this.assembleSetInstr(s,e);break;case A.LoadStore:this.assembleLoadStoreInstr(s,e);break;case A.Goto:this.assembleBranch(s,e);break;default:this.addError(`Couldn't encode instruction '${e.mnemonic} '`,r.loc)}}):this.addError(`Unknown mnemonic '${e.mnemonic}'`,e.loc)}assemble(r){try{let e=Lr.parse(r.toString());e!==void 0&&e.lines&&this.assembleLines(e.lines)}catch(e){if("name"in e&&e.name==="SyntaxError")this.addError(`Syntax error: ${e.message}`,{...e.location});else{if("name"in e&&e.name==="semantic")return;throw e}}}dumpLabels(){return this.scopes.dumpLabels(this.getPC(),this.segments)}collectSegmentInfo(){return br(this.segments)}};function pt(t){try{return Lr.parse(t.toString())}catch{return}}function gt(t){let r=new ht,e=0;do{if(r.startPass(e),r.assemble(t),e>0&&r.anyErrors())return{prg:Uint8Array.from([]),labels:[],segments:[],debugInfo:void 0,errors:r.errors(),warnings:r.warnings()};e+=1}while(r.needPass);return{prg:r.prg(),errors:r.errors(),warnings:r.warnings(),labels:r.dumpLabels(),segments:r.collectSegmentInfo(),debugInfo:r.debugInfo}}var O;(function(t){t[t.Program=0]="Program",t[t.Line=1]="Line",t[t.Label=2]="Label",t[t.LabelRef=3]="LabelRef",t[t.Instruction=4]="Instruction",t[t.Literal=5]="Literal",t[t.Register=6]="Register",t[t.SetPC=7]="SetPC",t[t.Expr=8]="Expr",t[t.Data=9]="Data"})(O||(O={}));var he;(function(t){t[t.Label=0]="Label"})(he||(he={}));function Oe(t,r){let e=null;return!t||r<t.offset||r>t.end?null:(t.accept(s=>s.offset===-1&&s.length===-1?!0:s.offset<=r&&s.end>=r?(e?s.length<=e.length&&(e=s):e=s,!0):!1),e)}function Er(t,r){let e=Oe(t,r),s=[];for(;e;)s.unshift(e),e=e.parent;return s}var B=class{get end(){return this.offset+this.length}constructor(r,e){this.nodeType=e,this.parent=null,this.offset=r?.loc.start.offset??0,this.length=(r?.loc.end.offset??0)-this.offset}get type(){return this.nodeType}getTextProvider(){let r=this;for(;r&&!r.textProvider;)r=r.parent;return r?r.textProvider:()=>"unknown"}getText(){return this.getTextProvider()(this.offset,this.length)}matches(r){return this.length===r.length&&this.getTextProvider()(this.offset,this.length)===r}accept(r){if(r(this)&&this.children)for(let e of this.children)e.accept(r)}acceptVisitor(r){this.accept(r.visitNode.bind(r))}adoptChild(r){r.parent=this;let e=this.children;return e||(e=this.children=[]),e.push(r),r}};var De=class extends B{constructor(r){super(r,O.Program),r?.lines?.forEach(e=>this.adoptChild(new mt(e)))}},mt=class extends B{constructor(r){if(super(r,O.Line),r.label&&this.adoptChild(new q(r.label)),r.stmt)switch(r.stmt.type){case"insn":this.adoptChild(new me(r.stmt));break;case"setpc":this.adoptChild(new pe(r.stmt));break;case"data":this.adoptChild(new ge(r.stmt))}}},q=class extends B{constructor(r){super(r,O.Label),this.length--}},pe=class extends B{constructor(r){super(r,O.SetPC),this.pcExpr=this.adoptChild(new wt(r.pc))}},ge=class extends B{constructor(r){super(r,O.Data)}},wt=class extends B{constructor(r){super(r,O.Expr)}},me=class extends B{constructor(r){super(r,O.Instruction);let e=s=>{switch(s.type){case"literal":return this.adoptChild(new we(s));case"register":return this.adoptChild(new xe(s));case"qualified-ident":return this.adoptChild(new X(s));default:return}};this.mnemonic=r.mnemonic.toLowerCase(),r.p1&&(this.p1=e(r.p1)),r.p2&&(this.p2=e(r.p2))}},X=class extends B{constructor(r){super(r,O.LabelRef)}},we=class extends B{constructor(r){super(r,O.Literal),this.value=r.lit}},xe=class extends B{constructor(r){super(r,O.Register),this.value=r.value.toUpperCase()}};var Fe=class{parseProgram(r){let e=r.version,s=r.getText(),n=pt(r.getText()),c=new De(n),u=(h,x)=>{if(r.version!==e)throw new Error("Underlying model has changed, AST is no longer valid");return s.substr(h,x)};return c.textProvider=u,c}};var kr={version:1,mnemonics:[{name:"add",class:"ALU",summary:"Arithmetic Add",description:"Adds the contents of register B and C (B+C) placing the result in register A or D.",synopsis:"{0} = B + C",syntax:"[ a | d ]"},{name:"and",class:"ALU",summary:"Logic And",description:"Performs a bitwise AND operation on register B and C (B&C) placing the result in register A or D.",synopsis:"{0} = B & C",syntax:"[ a | d ]"},{name:"bcs",class:"GOTO",summary:"Branch if Carry Set",snippet:"bcs ${1:label}",description:"Jumps to the given address if the carry flag is set.",synopsis:"PC = {0} [if CY]",syntax:"<label>"},{name:"beq",class:"GOTO",summary:"Branch if Equal/Zero",snippet:"beq ${1:label}",description:"Jumps to the given address if the zero flag is set (equal).",synopsis:"PC = {0} [if Z]",syntax:"<label>"},{name:"ble",class:"GOTO",summary:"Branch if Less Than or Equal (Sign+Zero)",snippet:"ble ${1:label}",description:"Jumps to the given address if the sign or zero flag is set (less than or equal).",synopsis:"PC = {0} [if S or Z]",syntax:"<label>"},{name:"blt",class:"GOTO",summary:"Branch if Less Than (Sign)",snippet:"blt ${1:label}",description:"Jumps to the given address if the sign flag is set (less than).",synopsis:"PC = {0} [if S]",syntax:"<label>"},{name:"bmi",class:"GOTO",summary:"Branch if Minus/Sign",snippet:"bmi ${1:label}",description:"Jumps to the given address if the sign flag is set (negative).",synopsis:"PC = {0} [if S]",syntax:"<label>"},{name:"bne",class:"GOTO",summary:"Branch if Not Equal/Zero",snippet:"bne ${1:label}",description:"Jumps to the given address if the zero flag is not set (not equal).",synopsis:"PC = {0} [if not Z]",syntax:"<label>"},{name:"clr",class:"MOV8",summary:"Zero Value",description:"Clears the content (=0) of a given register.",synopsis:"{0} = 0",syntax:"<target>{a,d|m1|m2|x|y|xy}"},{name:"cmp",class:"ALU",summary:"Compare (Logic Xor)",description:"Compares the values in register B and C setting the zero flag if the same (affects register A or D) (equivalent to eor).",synopsis:"{0} = B != C",syntax:"[ a | d ]"},{name:"eor",class:"ALU",summary:"Logic Xor",description:"Performs a bitwise XOR operation on register B and C (B^C) placing the result in register A or D.",synopsis:"{0} = B ^ C",syntax:"[ a | d ]"},{name:"inc",class:"ALU",summary:"Increment",description:"Increments contents of register B placing the result in register A or D",synopsis:"{0} = B + 1",syntax:"[ a | d ]"},{name:"hlt",class:"MISC",summary:"Halt",description:"Halts execution of the program",synopsis:"PC = PC + 1",syntax:"<label>"},{name:"hlr",class:"MISC",summary:"Halt and Reload",description:"Halts execution of the program and sets the program counter from the address switches",synopsis:"PC = AS",syntax:"<label>"},{name:"ixy",class:"INCXY",summary:"Increments contents of 16-bit register XY",synopsis:"XY = XY + 1"},{name:"lds",class:"MISC",summary:"Load Switches",description:"Takes the 8-bit value on the main switches and loads register A or D.",synopsis:"{0} = DS",syntax:"[ a | d ]"},{name:"ldr",class:"LOAD",summary:"Load Register from Memory",snippet:"ldr ${1:a}",description:"Loads the contents of memory at the address in register M into register A-D.",synopsis:"{0} = (M)",syntax:"[ a | b | c | d ]"},{name:"jmp",class:"GOTO",summary:"Jump to Label",snippet:"jmp ${1:label}",description:"Unconditionally jumps to the given address.",synopsis:"PC = {0}",syntax:"<label>"},{name:"jsr",class:"GOTO",summary:"Call Subroutine (Jump and Link)",snippet:"jsr ${1:label}",description:"Calls the subroutine at the given address.",synopsis:"XY = PC, PC = {0}",syntax:"<label>"},{name:"rts",class:"MOV16",summary:"Return from Subroutine",description:"Jumps back from a jsr call.",synopsis:"PC = XY"},{name:"ldi",class:"SETAB",summary:"Load Immediate",snippet:"ldi ${1:a},${2:0}",description:"Loads an 8-bit value in to register A/B or a 16-bit value in to register M/J.",synopsis:"{0} = {1}",syntax:"[ <target>{a|b} , <value>{-16,15} ] | [ <target>{m|j} , [ <value>{0x0000,0xFFFF} | <label> ] ]"},{name:"mov",class:"MOV8|MOV16",summary:"Copy Register to Register",snippet:"mov ${1:b},${2:a}",description:"Copies the content of one register to another.",synopsis:"{0} = {1}",syntax:"[ <destination>{a,d|m1|m2|x|y} , <source>{a,d|m1|m2|x|y} | <destination>{xy|pc} , <source>{m|xy|j|as} ]"},{name:"not",class:"ALU",summary:"Logic Not",description:"Performs a bitwise NOT operation on register B (~B) placing the result in register A or D.",synopsis:"{0} = ~B",syntax:"[ a | d ]"},{name:"opc",class:"PSEUDO",summary:"Literal Opcode",snippet:"opc ${1:opcode}",description:"Performs the given machine opcode directly.",syntax:"[ <opcode>{0x00,0xFF} | <opcode>{0b00000000,0b11111111} ]"},{name:"orr",class:"ALU",summary:"Logic Or",description:"Performs a bitwise OR operation on register B and C (B|C) placing the result in register A or D.",synopsis:"{0} = B | C",syntax:"[ a | d ]"},{name:"rol",class:"ALU",summary:"Bitwise Circular Shift Left",description:"Performs a bitwise left rotation on register B (<<B) placing the result in register A or D.",synopsis:"{0} = <<B",syntax:"[ a | d ]"},{name:"str",class:"STORE",summary:"Store Register into Memory",snippet:"str ${1:a}",description:"Stores the contents register A-D into memory at the address in register M.",synopsis:"(M) = {0}",syntax:"[ a | b | c | d ]"},{name:"org",class:"PSEUDO",summary:"Set Program Counter",description:"Sets the program counter to the given address such that the following instructions start from that location.",synopsis:"PC = {0}",syntax:"<value>{0x0000,0xFFFF}"},{name:"dfb",class:"PSEUDO",summary:"Define Byte Data",description:"Writes the given 8-bit values directly into the output starting from current location.",syntax:"<value>{0x00,0xFF} [ ,...n ]"},{name:"dfw",class:"PSEUDO",summary:"Define Word Data",description:"Writes the given 16-bit values directly into the output starting from current location.",syntax:"<value>{0x0000,0xFFFF} [ ,...n ]"},{name:"dff",class:"PSEUDO",summary:"Define Fill Data",description:"Writes the given 8-bit value n times directly into the output starting from current location.",syntax:"<value>{0x00,0xFF} , <count>{0,255}"}]};function _r(t){return Object.keys(t).map(r=>t[r])}function ee(t){return typeof t<"u"}var Re=class{constructor(r){this.dataProviders=r,this._mnemonicSet={},this._mnemonics=[],this.collectData()}collectData(){this.dataProviders.forEach(r=>{r.provideMnemonics().forEach(e=>{this._mnemonicSet[e.name]||(this._mnemonicSet[e.name]=e)})}),this._mnemonics=_r(this._mnemonicSet)}getMnemonic(r){return this._mnemonicSet[r]}getMnemonics(){return this._mnemonics}};var Be=class{constructor(r){this._mnemonics=[],this.addData(r)}provideMnemonics(){return this._mnemonics}addData(r){r.mnemonics&&(this._mnemonics=this._mnemonics.concat(r.mnemonics))}};function je(t,r){return r?{kind:"markdown",value:Eo(t)}:{kind:"plaintext",value:So(t)}}function So(t){if(!t.description||t.description==="")return"";if(typeof t.description!="string")return t.description.value;let r="";return r+=t.description,"syntax"in t&&(r+=`

Syntax: ${t.syntax}`),r}function Eo(t){if(!t.description||t.description==="")return"";let r="";return typeof t.description=="string"?r+=t.description:r=t.description.value,"syntax"in t&&(r+=`

Syntax: \`${t.syntax}\``),r}function xt(t,r,e){return e?{kind:"markdown",value:Pr(_o(t),r)}:{kind:"plaintext",value:Pr(ko(t),r)}}function Pr(t,r){if(!r||r.length===0)return t;for(let e=0;e<r.length;e++)t=t.replace(`{${e}}`,r[e]);return t}function ko(t){if(!t.synopsis||t.synopsis==="")return"";let r="";return t.summary&&(t.class?r+=`${t.summary} [${t.class}]

`:r+=`${t.summary}

`),r+=t.synopsis,r}function _o(t){if(!t.synopsis||t.synopsis==="")return"";let r="";return t.summary&&(t.class?r+=`${t.summary} [${t.class}]

`:r+=`${t.summary}

`),r+="`"+t.synopsis+"`",r}var te=new Re([new Be(kr)]);var Dr;(function(t){function r(e){return typeof e=="string"}t.is=r})(Dr||(Dr={}));var yt;(function(t){function r(e){return typeof e=="string"}t.is=r})(yt||(yt={}));var Or;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647;function r(e){return typeof e=="number"&&t.MIN_VALUE<=e&&e<=t.MAX_VALUE}t.is=r})(Or||(Or={}));var We;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647;function r(e){return typeof e=="number"&&t.MIN_VALUE<=e&&e<=t.MAX_VALUE}t.is=r})(We||(We={}));var M;(function(t){function r(s,n){return s===Number.MAX_VALUE&&(s=We.MAX_VALUE),n===Number.MAX_VALUE&&(n=We.MAX_VALUE),{line:s,character:n}}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&d.uinteger(n.line)&&d.uinteger(n.character)}t.is=e})(M||(M={}));var k;(function(t){function r(s,n,c,u){if(d.uinteger(s)&&d.uinteger(n)&&d.uinteger(c)&&d.uinteger(u))return{start:M.create(s,n),end:M.create(c,u)};if(M.is(s)&&M.is(n))return{start:s,end:n};throw new Error(`Range#create called with invalid arguments[${s}, ${n}, ${c}, ${u}]`)}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&M.is(n.start)&&M.is(n.end)}t.is=e})(k||(k={}));var J;(function(t){function r(s,n){return{uri:s,range:n}}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&k.is(n.range)&&(d.string(n.uri)||d.undefined(n.uri))}t.is=e})(J||(J={}));var Mr;(function(t){function r(s,n,c,u){return{targetUri:s,targetRange:n,targetSelectionRange:c,originSelectionRange:u}}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&k.is(n.targetRange)&&d.string(n.targetUri)&&k.is(n.targetSelectionRange)&&(k.is(n.originSelectionRange)||d.undefined(n.originSelectionRange))}t.is=e})(Mr||(Mr={}));var bt;(function(t){function r(s,n,c,u){return{red:s,green:n,blue:c,alpha:u}}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&d.numberRange(n.red,0,1)&&d.numberRange(n.green,0,1)&&d.numberRange(n.blue,0,1)&&d.numberRange(n.alpha,0,1)}t.is=e})(bt||(bt={}));var Fr;(function(t){function r(s,n){return{range:s,color:n}}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&k.is(n.range)&&bt.is(n.color)}t.is=e})(Fr||(Fr={}));var Rr;(function(t){function r(s,n,c){return{label:s,textEdit:n,additionalTextEdits:c}}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&d.string(n.label)&&(d.undefined(n.textEdit)||H.is(n))&&(d.undefined(n.additionalTextEdits)||d.typedArray(n.additionalTextEdits,H.is))}t.is=e})(Rr||(Rr={}));var Br;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(Br||(Br={}));var jr;(function(t){function r(s,n,c,u,h,x){let p={startLine:s,endLine:n};return d.defined(c)&&(p.startCharacter=c),d.defined(u)&&(p.endCharacter=u),d.defined(h)&&(p.kind=h),d.defined(x)&&(p.collapsedText=x),p}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&d.uinteger(n.startLine)&&d.uinteger(n.startLine)&&(d.undefined(n.startCharacter)||d.uinteger(n.startCharacter))&&(d.undefined(n.endCharacter)||d.uinteger(n.endCharacter))&&(d.undefined(n.kind)||d.string(n.kind))}t.is=e})(jr||(jr={}));var vt;(function(t){function r(s,n){return{location:s,message:n}}t.create=r;function e(s){let n=s;return d.defined(n)&&J.is(n.location)&&d.string(n.message)}t.is=e})(vt||(vt={}));var re;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(re||(re={}));var Wr;(function(t){t.Unnecessary=1,t.Deprecated=2})(Wr||(Wr={}));var Ur;(function(t){function r(e){let s=e;return d.objectLiteral(s)&&d.string(s.href)}t.is=r})(Ur||(Ur={}));var ye;(function(t){function r(s,n,c,u,h,x){let p={range:s,message:n};return d.defined(c)&&(p.severity=c),d.defined(u)&&(p.code=u),d.defined(h)&&(p.source=h),d.defined(x)&&(p.relatedInformation=x),p}t.create=r;function e(s){var n;let c=s;return d.defined(c)&&k.is(c.range)&&d.string(c.message)&&(d.number(c.severity)||d.undefined(c.severity))&&(d.integer(c.code)||d.string(c.code)||d.undefined(c.code))&&(d.undefined(c.codeDescription)||d.string((n=c.codeDescription)===null||n===void 0?void 0:n.href))&&(d.string(c.source)||d.undefined(c.source))&&(d.undefined(c.relatedInformation)||d.typedArray(c.relatedInformation,vt.is))}t.is=e})(ye||(ye={}));var ne;(function(t){function r(s,n,...c){let u={title:s,command:n};return d.defined(c)&&c.length>0&&(u.arguments=c),u}t.create=r;function e(s){let n=s;return d.defined(n)&&d.string(n.title)&&d.string(n.command)}t.is=e})(ne||(ne={}));var H;(function(t){function r(c,u){return{range:c,newText:u}}t.replace=r;function e(c,u){return{range:{start:c,end:c},newText:u}}t.insert=e;function s(c){return{range:c,newText:""}}t.del=s;function n(c){let u=c;return d.objectLiteral(u)&&d.string(u.newText)&&k.is(u.range)}t.is=n})(H||(H={}));var $t;(function(t){function r(s,n,c){let u={label:s};return n!==void 0&&(u.needsConfirmation=n),c!==void 0&&(u.description=c),u}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&d.string(n.label)&&(d.boolean(n.needsConfirmation)||n.needsConfirmation===void 0)&&(d.string(n.description)||n.description===void 0)}t.is=e})($t||($t={}));var se;(function(t){function r(e){let s=e;return d.string(s)}t.is=r})(se||(se={}));var Vr;(function(t){function r(c,u,h){return{range:c,newText:u,annotationId:h}}t.replace=r;function e(c,u,h){return{range:{start:c,end:c},newText:u,annotationId:h}}t.insert=e;function s(c,u){return{range:c,newText:"",annotationId:u}}t.del=s;function n(c){let u=c;return H.is(u)&&($t.is(u.annotationId)||se.is(u.annotationId))}t.is=n})(Vr||(Vr={}));var At;(function(t){function r(s,n){return{textDocument:s,edits:n}}t.create=r;function e(s){let n=s;return d.defined(n)&&kt.is(n.textDocument)&&Array.isArray(n.edits)}t.is=e})(At||(At={}));var Ct;(function(t){function r(s,n,c){let u={kind:"create",uri:s};return n!==void 0&&(n.overwrite!==void 0||n.ignoreIfExists!==void 0)&&(u.options=n),c!==void 0&&(u.annotationId=c),u}t.create=r;function e(s){let n=s;return n&&n.kind==="create"&&d.string(n.uri)&&(n.options===void 0||(n.options.overwrite===void 0||d.boolean(n.options.overwrite))&&(n.options.ignoreIfExists===void 0||d.boolean(n.options.ignoreIfExists)))&&(n.annotationId===void 0||se.is(n.annotationId))}t.is=e})(Ct||(Ct={}));var Lt;(function(t){function r(s,n,c,u){let h={kind:"rename",oldUri:s,newUri:n};return c!==void 0&&(c.overwrite!==void 0||c.ignoreIfExists!==void 0)&&(h.options=c),u!==void 0&&(h.annotationId=u),h}t.create=r;function e(s){let n=s;return n&&n.kind==="rename"&&d.string(n.oldUri)&&d.string(n.newUri)&&(n.options===void 0||(n.options.overwrite===void 0||d.boolean(n.options.overwrite))&&(n.options.ignoreIfExists===void 0||d.boolean(n.options.ignoreIfExists)))&&(n.annotationId===void 0||se.is(n.annotationId))}t.is=e})(Lt||(Lt={}));var St;(function(t){function r(s,n,c){let u={kind:"delete",uri:s};return n!==void 0&&(n.recursive!==void 0||n.ignoreIfNotExists!==void 0)&&(u.options=n),c!==void 0&&(u.annotationId=c),u}t.create=r;function e(s){let n=s;return n&&n.kind==="delete"&&d.string(n.uri)&&(n.options===void 0||(n.options.recursive===void 0||d.boolean(n.options.recursive))&&(n.options.ignoreIfNotExists===void 0||d.boolean(n.options.ignoreIfNotExists)))&&(n.annotationId===void 0||se.is(n.annotationId))}t.is=e})(St||(St={}));var Et;(function(t){function r(e){let s=e;return s&&(s.changes!==void 0||s.documentChanges!==void 0)&&(s.documentChanges===void 0||s.documentChanges.every(n=>d.string(n.kind)?Ct.is(n)||Lt.is(n)||St.is(n):At.is(n)))}t.is=r})(Et||(Et={}));var Nr;(function(t){function r(s){return{uri:s}}t.create=r;function e(s){let n=s;return d.defined(n)&&d.string(n.uri)}t.is=e})(Nr||(Nr={}));var Tr;(function(t){function r(s,n){return{uri:s,version:n}}t.create=r;function e(s){let n=s;return d.defined(n)&&d.string(n.uri)&&d.integer(n.version)}t.is=e})(Tr||(Tr={}));var kt;(function(t){function r(s,n){return{uri:s,version:n}}t.create=r;function e(s){let n=s;return d.defined(n)&&d.string(n.uri)&&(n.version===null||d.integer(n.version))}t.is=e})(kt||(kt={}));var zr;(function(t){function r(s,n,c,u){return{uri:s,languageId:n,version:c,text:u}}t.create=r;function e(s){let n=s;return d.defined(n)&&d.string(n.uri)&&d.string(n.languageId)&&d.integer(n.version)&&d.string(n.text)}t.is=e})(zr||(zr={}));var j;(function(t){t.PlainText="plaintext",t.Markdown="markdown";function r(e){let s=e;return s===t.PlainText||s===t.Markdown}t.is=r})(j||(j={}));var ie;(function(t){function r(e){let s=e;return d.objectLiteral(e)&&j.is(s.kind)&&d.string(s.value)}t.is=r})(ie||(ie={}));var Ue;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(Ue||(Ue={}));var be;(function(t){t.PlainText=1,t.Snippet=2})(be||(be={}));var qr;(function(t){t.Deprecated=1})(qr||(qr={}));var Hr;(function(t){function r(s,n,c){return{newText:s,insert:n,replace:c}}t.create=r;function e(s){let n=s;return n&&d.string(n.newText)&&k.is(n.insert)&&k.is(n.replace)}t.is=e})(Hr||(Hr={}));var Gr;(function(t){t.asIs=1,t.adjustIndentation=2})(Gr||(Gr={}));var Xr;(function(t){function r(e){let s=e;return s&&(d.string(s.detail)||s.detail===void 0)&&(d.string(s.description)||s.description===void 0)}t.is=r})(Xr||(Xr={}));var Jr;(function(t){function r(e){return{label:e}}t.create=r})(Jr||(Jr={}));var _t;(function(t){function r(e,s){return{items:e||[],isIncomplete:!!s}}t.create=r})(_t||(_t={}));var ve;(function(t){function r(s){return s.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}t.fromPlainText=r;function e(s){let n=s;return d.string(n)||d.objectLiteral(n)&&d.string(n.language)&&d.string(n.value)}t.is=e})(ve||(ve={}));var Pt;(function(t){function r(e){let s=e;return!!s&&d.objectLiteral(s)&&(ie.is(s.contents)||ve.is(s.contents)||d.typedArray(s.contents,ve.is))&&(e.range===void 0||k.is(e.range))}t.is=r})(Pt||(Pt={}));var Zr;(function(t){function r(e,s){return s?{label:e,documentation:s}:{label:e}}t.create=r})(Zr||(Zr={}));var Yr;(function(t){function r(e,s,...n){let c={label:e};return d.defined(s)&&(c.documentation=s),d.defined(n)?c.parameters=n:c.parameters=[],c}t.create=r})(Yr||(Yr={}));var oe;(function(t){t.Text=1,t.Read=2,t.Write=3})(oe||(oe={}));var It;(function(t){function r(e,s){let n={range:e};return d.number(s)&&(n.kind=s),n}t.create=r})(It||(It={}));var ae;(function(t){t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(ae||(ae={}));var Qr;(function(t){t.Deprecated=1})(Qr||(Qr={}));var Dt;(function(t){function r(e,s,n,c,u){let h={name:e,kind:s,location:{uri:c,range:n}};return u&&(h.containerName=u),h}t.create=r})(Dt||(Dt={}));var Kr;(function(t){function r(e,s,n,c){return c!==void 0?{name:e,kind:s,location:{uri:n,range:c}}:{name:e,kind:s,location:{uri:n}}}t.create=r})(Kr||(Kr={}));var en;(function(t){function r(s,n,c,u,h,x){let p={name:s,detail:n,kind:c,range:u,selectionRange:h};return x!==void 0&&(p.children=x),p}t.create=r;function e(s){let n=s;return n&&d.string(n.name)&&d.number(n.kind)&&k.is(n.range)&&k.is(n.selectionRange)&&(n.detail===void 0||d.string(n.detail))&&(n.deprecated===void 0||d.boolean(n.deprecated))&&(n.children===void 0||Array.isArray(n.children))&&(n.tags===void 0||Array.isArray(n.tags))}t.is=e})(en||(en={}));var tn;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(tn||(tn={}));var Ve;(function(t){t.Invoked=1,t.Automatic=2})(Ve||(Ve={}));var rn;(function(t){function r(s,n,c){let u={diagnostics:s};return n!=null&&(u.only=n),c!=null&&(u.triggerKind=c),u}t.create=r;function e(s){let n=s;return d.defined(n)&&d.typedArray(n.diagnostics,ye.is)&&(n.only===void 0||d.typedArray(n.only,d.string))&&(n.triggerKind===void 0||n.triggerKind===Ve.Invoked||n.triggerKind===Ve.Automatic)}t.is=e})(rn||(rn={}));var nn;(function(t){function r(s,n,c){let u={title:s},h=!0;return typeof n=="string"?(h=!1,u.kind=n):ne.is(n)?u.command=n:u.edit=n,h&&c!==void 0&&(u.kind=c),u}t.create=r;function e(s){let n=s;return n&&d.string(n.title)&&(n.diagnostics===void 0||d.typedArray(n.diagnostics,ye.is))&&(n.kind===void 0||d.string(n.kind))&&(n.edit!==void 0||n.command!==void 0)&&(n.command===void 0||ne.is(n.command))&&(n.isPreferred===void 0||d.boolean(n.isPreferred))&&(n.edit===void 0||Et.is(n.edit))}t.is=e})(nn||(nn={}));var sn;(function(t){function r(s,n){let c={range:s};return d.defined(n)&&(c.data=n),c}t.create=r;function e(s){let n=s;return d.defined(n)&&k.is(n.range)&&(d.undefined(n.command)||ne.is(n.command))}t.is=e})(sn||(sn={}));var on;(function(t){function r(s,n){return{tabSize:s,insertSpaces:n}}t.create=r;function e(s){let n=s;return d.defined(n)&&d.uinteger(n.tabSize)&&d.boolean(n.insertSpaces)}t.is=e})(on||(on={}));var an;(function(t){function r(s,n,c){return{range:s,target:n,data:c}}t.create=r;function e(s){let n=s;return d.defined(n)&&k.is(n.range)&&(d.undefined(n.target)||d.string(n.target))}t.is=e})(an||(an={}));var cn;(function(t){function r(s,n){return{range:s,parent:n}}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&k.is(n.range)&&(n.parent===void 0||t.is(n.parent))}t.is=e})(cn||(cn={}));var ln;(function(t){t.namespace="namespace",t.type="type",t.class="class",t.enum="enum",t.interface="interface",t.struct="struct",t.typeParameter="typeParameter",t.parameter="parameter",t.variable="variable",t.property="property",t.enumMember="enumMember",t.event="event",t.function="function",t.method="method",t.macro="macro",t.keyword="keyword",t.modifier="modifier",t.comment="comment",t.string="string",t.number="number",t.regexp="regexp",t.operator="operator",t.decorator="decorator"})(ln||(ln={}));var un;(function(t){t.declaration="declaration",t.definition="definition",t.readonly="readonly",t.static="static",t.deprecated="deprecated",t.abstract="abstract",t.async="async",t.modification="modification",t.documentation="documentation",t.defaultLibrary="defaultLibrary"})(un||(un={}));var fn;(function(t){function r(e){let s=e;return d.objectLiteral(s)&&(s.resultId===void 0||typeof s.resultId=="string")&&Array.isArray(s.data)&&(s.data.length===0||typeof s.data[0]=="number")}t.is=r})(fn||(fn={}));var dn;(function(t){function r(s,n){return{range:s,text:n}}t.create=r;function e(s){let n=s;return n!=null&&k.is(n.range)&&d.string(n.text)}t.is=e})(dn||(dn={}));var hn;(function(t){function r(s,n,c){return{range:s,variableName:n,caseSensitiveLookup:c}}t.create=r;function e(s){let n=s;return n!=null&&k.is(n.range)&&d.boolean(n.caseSensitiveLookup)&&(d.string(n.variableName)||n.variableName===void 0)}t.is=e})(hn||(hn={}));var pn;(function(t){function r(s,n){return{range:s,expression:n}}t.create=r;function e(s){let n=s;return n!=null&&k.is(n.range)&&(d.string(n.expression)||n.expression===void 0)}t.is=e})(pn||(pn={}));var gn;(function(t){function r(s,n){return{frameId:s,stoppedLocation:n}}t.create=r;function e(s){let n=s;return d.defined(n)&&k.is(s.stoppedLocation)}t.is=e})(gn||(gn={}));var Ot;(function(t){t.Type=1,t.Parameter=2;function r(e){return e===1||e===2}t.is=r})(Ot||(Ot={}));var Mt;(function(t){function r(s){return{value:s}}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&(n.tooltip===void 0||d.string(n.tooltip)||ie.is(n.tooltip))&&(n.location===void 0||J.is(n.location))&&(n.command===void 0||ne.is(n.command))}t.is=e})(Mt||(Mt={}));var mn;(function(t){function r(s,n,c){let u={position:s,label:n};return c!==void 0&&(u.kind=c),u}t.create=r;function e(s){let n=s;return d.objectLiteral(n)&&M.is(n.position)&&(d.string(n.label)||d.typedArray(n.label,Mt.is))&&(n.kind===void 0||Ot.is(n.kind))&&n.textEdits===void 0||d.typedArray(n.textEdits,H.is)&&(n.tooltip===void 0||d.string(n.tooltip)||ie.is(n.tooltip))&&(n.paddingLeft===void 0||d.boolean(n.paddingLeft))&&(n.paddingRight===void 0||d.boolean(n.paddingRight))}t.is=e})(mn||(mn={}));var wn;(function(t){function r(e){return{kind:"snippet",value:e}}t.createSnippet=r})(wn||(wn={}));var xn;(function(t){function r(e,s,n,c){return{insertText:e,filterText:s,range:n,command:c}}t.create=r})(xn||(xn={}));var yn;(function(t){function r(e){return{items:e}}t.create=r})(yn||(yn={}));var bn;(function(t){t.Invoked=0,t.Automatic=1})(bn||(bn={}));var vn;(function(t){function r(e,s){return{range:e,text:s}}t.create=r})(vn||(vn={}));var $n;(function(t){function r(e,s){return{triggerKind:e,selectedCompletionInfo:s}}t.create=r})($n||($n={}));var An;(function(t){function r(e){let s=e;return d.objectLiteral(s)&&yt.is(s.uri)&&d.string(s.name)}t.is=r})(An||(An={}));var Cn;(function(t){function r(c,u,h,x){return new Ft(c,u,h,x)}t.create=r;function e(c){let u=c;return!!(d.defined(u)&&d.string(u.uri)&&(d.undefined(u.languageId)||d.string(u.languageId))&&d.uinteger(u.lineCount)&&d.func(u.getText)&&d.func(u.positionAt)&&d.func(u.offsetAt))}t.is=e;function s(c,u){let h=c.getText(),x=n(u,(m,b)=>{let L=m.range.start.line-b.range.start.line;return L===0?m.range.start.character-b.range.start.character:L}),p=h.length;for(let m=x.length-1;m>=0;m--){let b=x[m],L=c.offsetAt(b.range.start),$=c.offsetAt(b.range.end);if($<=p)h=h.substring(0,L)+b.newText+h.substring($,h.length);else throw new Error("Overlapping edit");p=L}return h}t.applyEdits=s;function n(c,u){if(c.length<=1)return c;let h=c.length/2|0,x=c.slice(0,h),p=c.slice(h);n(x,u),n(p,u);let m=0,b=0,L=0;for(;m<x.length&&b<p.length;)u(x[m],p[b])<=0?c[L++]=x[m++]:c[L++]=p[b++];for(;m<x.length;)c[L++]=x[m++];for(;b<p.length;)c[L++]=p[b++];return c}})(Cn||(Cn={}));var Ft=class{constructor(r,e,s,n){this._uri=r,this._languageId=e,this._version=s,this._content=n,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(r){if(r){let e=this.offsetAt(r.start),s=this.offsetAt(r.end);return this._content.substring(e,s)}return this._content}update(r,e){this._content=r.text,this._version=e,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let r=[],e=this._content,s=!0;for(let n=0;n<e.length;n++){s&&(r.push(n),s=!1);let c=e.charAt(n);s=c==="\r"||c===`
`,c==="\r"&&n+1<e.length&&e.charAt(n+1)===`
`&&n++}s&&e.length>0&&r.push(e.length),this._lineOffsets=r}return this._lineOffsets}positionAt(r){r=Math.max(Math.min(r,this._content.length),0);let e=this.getLineOffsets(),s=0,n=e.length;if(n===0)return M.create(0,r);for(;s<n;){let u=Math.floor((s+n)/2);e[u]>r?n=u:s=u+1}let c=s-1;return M.create(c,r-e[c])}offsetAt(r){let e=this.getLineOffsets();if(r.line>=e.length)return this._content.length;if(r.line<0)return 0;let s=e[r.line],n=r.line+1<e.length?e[r.line+1]:this._content.length;return Math.max(Math.min(s+r.character,n),s)}get lineCount(){return this.getLineOffsets().length}},d;(function(t){let r=Object.prototype.toString;function e($){return typeof $<"u"}t.defined=e;function s($){return typeof $>"u"}t.undefined=s;function n($){return $===!0||$===!1}t.boolean=n;function c($){return r.call($)==="[object String]"}t.string=c;function u($){return r.call($)==="[object Number]"}t.number=u;function h($,ce,Xe){return r.call($)==="[object Number]"&&ce<=$&&$<=Xe}t.numberRange=h;function x($){return r.call($)==="[object Number]"&&-2147483648<=$&&$<=2147483647}t.integer=x;function p($){return r.call($)==="[object Number]"&&0<=$&&$<=2147483647}t.uinteger=p;function m($){return r.call($)==="[object Function]"}t.func=m;function b($){return $!==null&&typeof $=="object"}t.objectLiteral=b;function L($,ce){return Array.isArray($)&&$.every(ce)}t.typedArray=L})(d||(d={}));var Z=class{constructor(r,e,s,n){this._uri=r,this._languageId=e,this._version=s,this._content=n,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(r){if(r){let e=this.offsetAt(r.start),s=this.offsetAt(r.end);return this._content.substring(e,s)}return this._content}update(r,e){for(let s of r)if(Z.isIncremental(s)){let n=En(s.range),c=this.offsetAt(n.start),u=this.offsetAt(n.end);this._content=this._content.substring(0,c)+s.text+this._content.substring(u,this._content.length);let h=Math.max(n.start.line,0),x=Math.max(n.end.line,0),p=this._lineOffsets,m=Ln(s.text,!1,c);if(x-h===m.length)for(let L=0,$=m.length;L<$;L++)p[L+h+1]=m[L];else m.length<1e4?p.splice(h+1,x-h,...m):this._lineOffsets=p=p.slice(0,h+1).concat(m,p.slice(x+1));let b=s.text.length-(u-c);if(b!==0)for(let L=h+1+m.length,$=p.length;L<$;L++)p[L]=p[L]+b}else if(Z.isFull(s))this._content=s.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=e}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=Ln(this._content,!0)),this._lineOffsets}positionAt(r){r=Math.max(Math.min(r,this._content.length),0);let e=this.getLineOffsets(),s=0,n=e.length;if(n===0)return{line:0,character:r};for(;s<n;){let u=Math.floor((s+n)/2);e[u]>r?n=u:s=u+1}let c=s-1;return r=this.ensureBeforeEOL(r,e[c]),{line:c,character:r-e[c]}}offsetAt(r){let e=this.getLineOffsets();if(r.line>=e.length)return this._content.length;if(r.line<0)return 0;let s=e[r.line];if(r.character<=0)return s;let n=r.line+1<e.length?e[r.line+1]:this._content.length,c=Math.min(s+r.character,n);return this.ensureBeforeEOL(c,s)}ensureBeforeEOL(r,e){for(;r>e&&Sn(this._content.charCodeAt(r-1));)r--;return r}get lineCount(){return this.getLineOffsets().length}static isIncremental(r){let e=r;return e!=null&&typeof e.text=="string"&&e.range!==void 0&&(e.rangeLength===void 0||typeof e.rangeLength=="number")}static isFull(r){let e=r;return e!=null&&typeof e.text=="string"&&e.range===void 0&&e.rangeLength===void 0}},$e;(function(t){function r(n,c,u,h){return new Z(n,c,u,h)}t.create=r;function e(n,c,u){if(n instanceof Z)return n.update(c,u),n;throw new Error("TextDocument.update: document must be created by TextDocument.create")}t.update=e;function s(n,c){let u=n.getText(),h=Rt(c.map(Po),(m,b)=>{let L=m.range.start.line-b.range.start.line;return L===0?m.range.start.character-b.range.start.character:L}),x=0,p=[];for(let m of h){let b=n.offsetAt(m.range.start);if(b<x)throw new Error("Overlapping edit");b>x&&p.push(u.substring(x,b)),m.newText.length&&p.push(m.newText),x=n.offsetAt(m.range.end)}return p.push(u.substr(x)),p.join("")}t.applyEdits=s})($e||($e={}));function Rt(t,r){if(t.length<=1)return t;let e=t.length/2|0,s=t.slice(0,e),n=t.slice(e);Rt(s,r),Rt(n,r);let c=0,u=0,h=0;for(;c<s.length&&u<n.length;)r(s[c],n[u])<=0?t[h++]=s[c++]:t[h++]=n[u++];for(;c<s.length;)t[h++]=s[c++];for(;u<n.length;)t[h++]=n[u++];return t}function Ln(t,r,e=0){let s=r?[e]:[];for(let n=0;n<t.length;n++){let c=t.charCodeAt(n);Sn(c)&&(c===13&&n+1<t.length&&t.charCodeAt(n+1)===10&&n++,s.push(e+n+1))}return s}function Sn(t){return t===13||t===10}function En(t){let r=t.start,e=t.end;return r.line>e.line||r.line===e.line&&r.character>e.character?{start:e,end:r}:t}function Po(t){let r=En(t.range);return r!==t.range?{newText:t.newText,range:r}:t}var kn;(function(t){t.LATEST={textDocument:{completion:{completionItem:{documentationFormat:[j.Markdown,j.PlainText]}},hover:{contentFormat:[j.Markdown,j.PlainText]}}}})(kn||(kn={}));var Ne=class{constructor(r){this.clientCapabilities=r}doComplete(r,e,s){this.offset=r.offsetAt(e),this.position=e,this.currentWord=Io(r,this.offset),this.defaultReplaceRange=k.create(M.create(this.position.line,this.position.character-this.currentWord.length),this.position),this.textDocument=r,this.program=s;try{let c={isIncomplete:!1,items:[]};var n=r.getText(k.create(M.create(this.position.line,0),this.position));return n.match(/^([a-z]+:)?([ \t]+)?([a-z]{0,3})$/i)&&this.getCompletionsForMnemonic(c),c}finally{this.position=null,this.currentWord=null,this.textDocument=null,this.program=null,this.defaultReplaceRange=null}}getCompletionsForMnemonic(r){return te.getMnemonics().forEach(s=>{let n,c;n=this.getCompletionRange(null),c=s.snippet??s.name;let u={label:s.name,detail:s.class?`${s.summary} [${s.class}]`:s.summary,documentation:je(s,this.doesSupportMarkdown()),textEdit:H.replace(n,c),insertTextFormat:be.Snippet,kind:Ue.Function};r.items.push(u)}),r}doesSupportMarkdown(){if(!ee(this.supportsMarkdown)){if(!ee(this.clientCapabilities))return this.supportsMarkdown=!0,this.supportsMarkdown;let r=this.clientCapabilities&&this.clientCapabilities.textDocument&&this.clientCapabilities.textDocument.hover;this.supportsMarkdown=r&&r.contentFormat&&Array.isArray(r.contentFormat)&&r.contentFormat.indexOf(j.Markdown)!==-1}return this.supportsMarkdown}getCompletionRange(r){if(r&&r.offset<=this.offset&&this.offset<=r.end){let e=r.end!==-1?this.textDocument.positionAt(r.end):this.position,s=this.textDocument.positionAt(r.offset);if(s.line===e.line)return k.create(s,e)}return this.defaultReplaceRange}};function Io(t,r){let e=r-1,s=t.getText();for(;e>=0&&` 	
\r:,`.indexOf(s.charAt(e))===-1;)e--;return s.substring(e+1,r)}var Te=class{constructor(r){this.clientCapabilities=r}doHover(r,e,s){function n(x){return k.create(r.positionAt(x.offset),r.positionAt(x.end))}let c=r.offsetAt(e),u=Er(s,c),h=null;for(let x=0;x<u.length;x++){let p=u[x];if(p instanceof me){let m=p.mnemonic,b=te.getMnemonic(m);if(b){let L=this.getParamNames(b,p);h={contents:xt(b,L,this.doesSupportMarkdown()),range:n(p)}}}if(p instanceof pe){let m=te.getMnemonic("org");if(m){let b=[p.pcExpr.getText()];h={contents:xt(m,b,this.doesSupportMarkdown()),range:n(p)}}}if(p instanceof ge){let m=p.getText().slice(0,3).toLowerCase(),b=te.getMnemonic(m);b&&(h={contents:je(b,this.doesSupportMarkdown()),range:n(p)})}}return h&&(h.contents=this.convertContents(h.contents)),h}getParamNames(r,e){let s=[];return e.p1?s.push(this.getParamName(e.p1,e.mnemonic)):r.class==="ALU"?s.push("A"):s.push("?"),e.p2?s.push(this.getParamName(e.p2,e.mnemonic)):s.push("?"),s}getParamName(r,e){return r instanceof xe?r.value:r instanceof X?`(${r.getText()})`:r instanceof we?e.toLowerCase()==="ldi"&&+r.value>15?`0x${r.value.toString(16).toUpperCase()}`:r.value.toString():"?"}convertContents(r){return this.doesSupportMarkdown()||typeof r=="string"?r:"kind"in r?{kind:"plaintext",value:r.value}:Array.isArray(r)?r.map(e=>typeof e=="string"?e:e.value):r.value}doesSupportMarkdown(){if(!ee(this.supportsMarkdown)){if(!ee(this.clientCapabilities))return this.supportsMarkdown=!0,this.supportsMarkdown;let r=this.clientCapabilities.textDocument&&this.clientCapabilities.textDocument.hover;this.supportsMarkdown=r&&r.contentFormat&&Array.isArray(r.contentFormat)&&r.contentFormat.indexOf(j.Markdown)!==-1}return this.supportsMarkdown}};var Bt=class{constructor(r,e){this.symbols=[]}addSymbol(r){this.symbols.push(r)}getSymbol(r,e){for(let s=0;s<this.symbols.length;s++){let n=this.symbols[s];if(n.name===r&&n.type===e)return n}return null}},jt=class extends Bt{constructor(){super(0,Number.MAX_VALUE)}},Wt=class{constructor(r,e,s,n){this.name=r,this.value=e,this.node=s,this.type=n}},Ut=class{constructor(r){this.scope=r}addSymbol(r,e,s,n){r.offset!==-1&&this.scope.addSymbol(new Wt(e,s,r,n))}visitNode(r){switch(r.type){case O.Label:return this.addSymbol(r,r.getText(),void 0,he.Label),!0}return!0}},Ae=class{constructor(r){this.global=new jt,r.acceptVisitor(new Ut(this.global))}internalFindSymbol(r,e){let s=r.getText(),n=this.global;for(let c=0;c<e.length;c++){let u=e[c],h=n.getSymbol(s,u);if(h)return h}return null}evaluateReferenceTypes(r){return r instanceof X||r instanceof q?[he.Label]:null}findSymbolFromNode(r){if(!r)return null;let e=this.evaluateReferenceTypes(r);return e?this.internalFindSymbol(r,e):null}matchesSymbol(r,e){if(!r||!r.matches(e.name))return!1;let s=this.evaluateReferenceTypes(r);return!s||s.indexOf(e.type)===-1?!1:this.internalFindSymbol(r,s)===e}};var qe=class{findDefinition(r,e,s){let n=new Ae(s),c=r.offsetAt(e),u=Oe(s,c);if(!u)return null;let h=n.findSymbolFromNode(u);return h?{uri:r.uri,range:ze(h.node,r)}:null}findReferences(r,e,s){return this.findDocumentHighlights(r,e,s).map(c=>({uri:r.uri,range:c.range}))}findDocumentHighlights(r,e,s){let n=[],c=r.offsetAt(e),u=Oe(s,c);if(!u||u.type!==O.Label&&u.type!==O.LabelRef)return n;let h=new Ae(s),x=h.findSymbolFromNode(u),p=u.getText();return s.accept(m=>{if(x){if(h.matchesSymbol(m,x))return n.push({kind:_n(m),range:ze(m,r)}),!1}else u&&u.type===m.type&&m.matches(p)&&n.push({kind:_n(m),range:ze(m,r)});return!0}),n}findDocumentSymbols(r,e){let s=[];return e.accept(n=>{let c={name:null,kind:ae.Class,location:null},u=n;return n instanceof q&&(c.name=n.getText(),c.kind=ae.Variable),c.name&&(c.location=J.create(r.uri,ze(u,r)),s.push(c)),!0}),s}};function _n(t){return t instanceof q?oe.Write:oe.Read}function ze(t,r){return k.create(r.positionAt(t.offset),r.positionAt(t.end))}var He=class{constructor(){}configure(r){this.settings=r}doValidation(r,e=this.settings){if(e&&e.validate===!1)return[];let{errors:s,warnings:n}=gt(r.getText()),c=(h,x)=>({severity:x,range:{start:r.positionAt(h.loc.start.offset),end:r.positionAt(h.loc.end.offset)},message:h.msg,source:r.languageId}),u=[];return u.push(...s.map(h=>c(h,re.Error))),u.push(...n.map(h=>c(h,re.Warning))),u}};function Pn(t){let r=new Fe,e=new Te(t&&t.clientCapabilities),s=new Ne(t&&t.clientCapabilities),n=new qe,c=new He;return{doValidation:c.doValidation.bind(c),parseProgram:r.parseProgram.bind(r),doComplete:s.doComplete.bind(s),doHover:e.doHover.bind(e),findDefinition:n.findDefinition.bind(n),findReferences:n.findReferences.bind(n),findDocumentHighlights:n.findDocumentHighlights.bind(n),findDocumentSymbols:n.findDocumentSymbols.bind(n)}}var Ge=class{_ctx;_languageService;_languageId;constructor(r,e){this._ctx=r,this._languageId=e.languageId,this._languageService=Pn({})}async doValidation(r){let e=this._getTextDocument(r);if(e){let s=this._languageService.doValidation(e);return Promise.resolve(s)}return Promise.resolve([])}async doComplete(r,e){let s=this._getTextDocument(r);if(!s)return null;let n=this._languageService.parseProgram(s),c=this._languageService.doComplete(s,e,n);return Promise.resolve(c)}async doHover(r,e){let s=this._getTextDocument(r);if(!s)return null;let n=this._languageService.parseProgram(s),c=this._languageService.doHover(s,e,n);return Promise.resolve(c)}async findDefinition(r,e){let s=this._getTextDocument(r);if(!s)return null;let n=this._languageService.parseProgram(s),c=this._languageService.findDefinition(s,e,n);return Promise.resolve(c)}async findReferences(r,e){let s=this._getTextDocument(r);if(!s)return[];let n=this._languageService.parseProgram(s),c=this._languageService.findReferences(s,e,n);return Promise.resolve(c)}async findDocumentHighlights(r,e){let s=this._getTextDocument(r);if(!s)return[];let n=this._languageService.parseProgram(s),c=this._languageService.findDocumentHighlights(s,e,n);return Promise.resolve(c)}async findDocumentSymbols(r){let e=this._getTextDocument(r);if(!e)return[];let s=this._languageService.parseProgram(e),n=this._languageService.findDocumentSymbols(e,s);return Promise.resolve(n)}_getTextDocument(r){let e=this._ctx.getMirrorModels();for(let s of e)if(s.uri.toString()===r)return $e.create(r,this._languageId,s.version,s.getValue());return null}};function Oo(t,r){return new Ge(t,r)}return gr(Mo);})();
return moduleExports;
});
